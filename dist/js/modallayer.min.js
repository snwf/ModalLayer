!function(window){"use strict";var aa="function"==typeof Object.defineProperties?Object.defineProperty:function(d,a,b){if(d==Array.prototype||d==Object.prototype)return d;d[a]=b.value;return d};function ba(d){d=["object"==typeof globalThis&&globalThis,d,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var a=0;a<d.length;++a){var b=d[a];if(b&&b.Math==Math)return b}throw Error("Cannot find global object");}var ca=ba(this);
function m(d,a){if(a)a:{var b=ca;d=d.split(".");for(var c=0;c<d.length-1;c++){var e=d[c];if(!(e in b))break a;b=b[e]}d=d[d.length-1];c=b[d];a=a(c);a!=c&&null!=a&&aa(b,d,{configurable:!0,writable:!0,value:a})}}m("Reflect",function(d){return d?d:{}});
var da="function"==typeof Object.create?Object.create:function(d){function a(){}a.prototype=d;return new a},ea=function(){function d(){function b(){}new b;Reflect.construct(b,[],function(){});return new b instanceof b}if("undefined"!=typeof Reflect&&Reflect.construct){if(d())return Reflect.construct;var a=Reflect.construct;return function(b,c,e){b=a(b,c);e&&Reflect.setPrototypeOf(b,e.prototype);return b}}return function(b,c,e){void 0===e&&(e=b);e=da(e.prototype||Object.prototype);return Function.prototype.apply.call(b,
e,c)||e}}();m("Reflect.construct",function(){return ea});var fa;if("function"==typeof Object.setPrototypeOf)fa=Object.setPrototypeOf;else{var ha;a:{var ia={s:!0},ja={};try{ja.__proto__=ia;ha=ja.s;break a}catch(d){}ha=!1}fa=ha?function(d,a){d.__proto__=a;if(d.__proto__!==a)throw new TypeError(d+" is not extensible");return d}:null}var ka=fa;m("Object.setPrototypeOf",function(d){return d||ka});function la(d){var a=0;return function(){return a<d.length?{done:!1,value:d[a++]}:{done:!0}}}
m("Symbol",function(d){function a(e){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new b("jscomp_symbol_"+(e||"")+"_"+c++,e)}function b(e,f){this.a=e;aa(this,"description",{configurable:!0,writable:!0,value:f})}if(d)return d;b.prototype.toString=function(){return this.a};var c=0;return a});
m("Symbol.iterator",function(d){if(d)return d;d=Symbol("Symbol.iterator");for(var a="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),b=0;b<a.length;b++){var c=ca[a[b]];"function"===typeof c&&"function"!=typeof c.prototype[d]&&aa(c.prototype,d,{configurable:!0,writable:!0,value:function(){return ma(la(this))}})}return d});function ma(d){d={next:d};d[Symbol.iterator]=function(){return this};return d}
m("Array.from",function(d){return d?d:function(a,b,c){b=null!=b?b:function(h){return h};var e=[],f="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];if("function"==typeof f){a=f.call(a);for(var g=0;!(f=a.next()).done;)e.push(b.call(c,f.value,g++))}else for(f=a.length,g=0;g<f;g++)e.push(b.call(c,a[g],g));return e}});
function na(d,a){d instanceof String&&(d+="");var b=0,c=!1,e={next:function(){if(!c&&b<d.length){var f=b++;return{value:a(f,d[f]),done:!1}}c=!0;return{done:!0,value:void 0}}};e[Symbol.iterator]=function(){return e};return e}m("Array.prototype.keys",function(d){return d?d:function(){return na(this,function(a){return a})}});m("Object.is",function(d){return d?d:function(a,b){return a===b?0!==a||1/a===1/b:a!==a&&b!==b}});
m("Array.prototype.includes",function(d){return d?d:function(a,b){var c=this;c instanceof String&&(c=String(c));var e=c.length;b=b||0;for(0>b&&(b=Math.max(b+e,0));b<e;b++){var f=c[b];if(f===a||Object.is(f,a))return!0}return!1}});function oa(d,a,b){if(null==d)throw new TypeError("The 'this' value for String.prototype."+b+" must not be null or undefined");if(a instanceof RegExp)throw new TypeError("First argument to String.prototype."+b+" must not be a regular expression");return d+""}
m("String.prototype.includes",function(d){return d?d:function(a,b){return-1!==oa(this,a,"includes").indexOf(a,b||0)}});function z(d,a){return Object.prototype.hasOwnProperty.call(d,a)}m("Object.values",function(d){return d?d:function(a){var b=[],c;for(c in a)z(a,c)&&b.push(a[c]);return b}});function B(d){var a="undefined"!=typeof Symbol&&Symbol.iterator&&d[Symbol.iterator];return a?a.call(d):{next:la(d)}}
m("Promise",function(d){function a(g){this.c=0;this.i=void 0;this.a=[];var h=this.g();try{g(h.resolve,h.reject)}catch(k){h.reject(k)}}function b(){this.a=null}function c(g){return g instanceof a?g:new a(function(h){h(g)})}if(d)return d;b.prototype.c=function(g){if(null==this.a){this.a=[];var h=this;this.g(function(){h.i()})}this.a.push(g)};var e=ca.setTimeout;b.prototype.g=function(g){e(g,0)};b.prototype.i=function(){for(;this.a&&this.a.length;){var g=this.a;this.a=[];for(var h=0;h<g.length;++h){var k=
g[h];g[h]=null;try{k()}catch(l){this.h(l)}}}this.a=null};b.prototype.h=function(g){this.g(function(){throw g;})};a.prototype.g=function(){function g(l){return function(n){k||(k=!0,l.call(h,n))}}var h=this,k=!1;return{resolve:g(this.B),reject:g(this.h)}};a.prototype.B=function(g){if(g===this)this.h(new TypeError("A Promise cannot resolve to itself"));else if(g instanceof a)this.D(g);else{a:switch(typeof g){case "object":var h=null!=g;break a;case "function":h=!0;break a;default:h=!1}h?this.A(g):this.l(g)}};
a.prototype.A=function(g){var h=void 0;try{h=g.then}catch(k){this.h(k);return}"function"==typeof h?this.F(h,g):this.l(g)};a.prototype.h=function(g){this.m(2,g)};a.prototype.l=function(g){this.m(1,g)};a.prototype.m=function(g,h){if(0!=this.c)throw Error("Cannot settle("+g+", "+h+"): Promise already settled in state"+this.c);this.c=g;this.i=h;this.v()};a.prototype.v=function(){if(null!=this.a){for(var g=0;g<this.a.length;++g)f.c(this.a[g]);this.a=null}};var f=new b;a.prototype.D=function(g){var h=this.g();
g.j(h.resolve,h.reject)};a.prototype.F=function(g,h){var k=this.g();try{g.call(h,k.resolve,k.reject)}catch(l){k.reject(l)}};a.prototype.then=function(g,h){function k(q,u){return"function"==typeof q?function(v){try{l(q(v))}catch(t){n(t)}}:u}var l,n,r=new a(function(q,u){l=q;n=u});this.j(k(g,l),k(h,n));return r};a.prototype.catch=function(g){return this.then(void 0,g)};a.prototype.j=function(g,h){function k(){switch(l.c){case 1:g(l.i);break;case 2:h(l.i);break;default:throw Error("Unexpected state: "+
l.c);}}var l=this;null==this.a?f.c(k):this.a.push(k)};a.resolve=c;a.reject=function(g){return new a(function(h,k){k(g)})};a.race=function(g){return new a(function(h,k){for(var l=B(g),n=l.next();!n.done;n=l.next())c(n.value).j(h,k)})};a.all=function(g){var h=B(g),k=h.next();return k.done?c([]):new a(function(l,n){function r(v){return function(t){q[v]=t;u--;0==u&&l(q)}}var q=[],u=0;do q.push(void 0),u++,c(k.value).j(r(q.length-1),n),k=h.next();while(!k.done)})};return a});
m("Number.isFinite",function(d){return d?d:function(a){return"number"!==typeof a?!1:!isNaN(a)&&Infinity!==a&&-Infinity!==a}});m("Number.isInteger",function(d){return d?d:function(a){return Number.isFinite(a)?a===Math.floor(a):!1}});
m("WeakMap",function(d){function a(k){this.a=(h+=Math.random()+1).toString();if(k){k=B(k);for(var l;!(l=k.next()).done;)l=l.value,this.set(l[0],l[1])}}function b(){}function c(k){var l=typeof k;return"object"===l&&null!==k||"function"===l}function e(k){if(!z(k,g)){var l=new b;aa(k,g,{value:l})}}function f(k){var l=Object[k];l&&(Object[k]=function(n){if(n instanceof b)return n;Object.isExtensible(n)&&e(n);return l(n)})}if(function(){if(!d||!Object.seal)return!1;try{var k=Object.seal({}),l=Object.seal({}),
n=new d([[k,2],[l,3]]);if(2!=n.get(k)||3!=n.get(l))return!1;n.delete(k);n.set(l,4);return!n.has(k)&&4==n.get(l)}catch(r){return!1}}())return d;var g="$jscomp_hidden_"+Math.random();f("freeze");f("preventExtensions");f("seal");var h=0;a.prototype.set=function(k,l){if(!c(k))throw Error("Invalid WeakMap key");e(k);if(!z(k,g))throw Error("WeakMap key fail: "+k);k[g][this.a]=l;return this};a.prototype.get=function(k){return c(k)&&z(k,g)?k[g][this.a]:void 0};a.prototype.has=function(k){return c(k)&&z(k,
g)&&z(k[g],this.a)};a.prototype.delete=function(k){return c(k)&&z(k,g)&&z(k[g],this.a)?delete k[g][this.a]:!1};return a});
m("Map",function(d){function a(){var h={};return h.f=h.next=h.head=h}function b(h,k){var l=h.a;return ma(function(){if(l){for(;l.head!=h.a;)l=l.f;for(;l.next!=l.head;)return l=l.next,{done:!1,value:k(l)};l=null}return{done:!0,value:void 0}})}function c(h,k){var l=k&&typeof k;"object"==l||"function"==l?f.has(k)?l=f.get(k):(l=""+ ++g,f.set(k,l)):l="p_"+k;var n=h.c[l];if(n&&z(h.c,l))for(h=0;h<n.length;h++){var r=n[h];if(k!==k&&r.key!==r.key||k===r.key)return{id:l,list:n,index:h,b:r}}return{id:l,list:n,
index:-1,b:void 0}}function e(h){this.c={};this.a=a();this.size=0;if(h){h=B(h);for(var k;!(k=h.next()).done;)k=k.value,this.set(k[0],k[1])}}if(function(){if(!d||"function"!=typeof d||!d.prototype.entries||"function"!=typeof Object.seal)return!1;try{var h=Object.seal({x:4}),k=new d(B([[h,"s"]]));if("s"!=k.get(h)||1!=k.size||k.get({x:4})||k.set({x:4},"t")!=k||2!=k.size)return!1;var l=k.entries(),n=l.next();if(n.done||n.value[0]!=h||"s"!=n.value[1])return!1;n=l.next();return n.done||4!=n.value[0].x||
"t"!=n.value[1]||!l.next().done?!1:!0}catch(r){return!1}}())return d;var f=new WeakMap;e.prototype.set=function(h,k){h=0===h?0:h;var l=c(this,h);l.list||(l.list=this.c[l.id]=[]);l.b?l.b.value=k:(l.b={next:this.a,f:this.a.f,head:this.a,key:h,value:k},l.list.push(l.b),this.a.f.next=l.b,this.a.f=l.b,this.size++);return this};e.prototype.delete=function(h){h=c(this,h);return h.b&&h.list?(h.list.splice(h.index,1),h.list.length||delete this.c[h.id],h.b.f.next=h.b.next,h.b.next.f=h.b.f,h.b.head=null,this.size--,
!0):!1};e.prototype.clear=function(){this.c={};this.a=this.a.f=a();this.size=0};e.prototype.has=function(h){return!!c(this,h).b};e.prototype.get=function(h){return(h=c(this,h).b)&&h.value};e.prototype.entries=function(){return b(this,function(h){return[h.key,h.value]})};e.prototype.keys=function(){return b(this,function(h){return h.key})};e.prototype.values=function(){return b(this,function(h){return h.value})};e.prototype.forEach=function(h,k){for(var l=this.entries(),n;!(n=l.next()).done;)n=n.value,
h.call(k,n[1],n[0],this)};e.prototype[Symbol.iterator]=e.prototype.entries;var g=0;return e});
m("Set",function(d){function a(b){this.a=new Map;if(b){b=B(b);for(var c;!(c=b.next()).done;)this.add(c.value)}this.size=this.a.size}if(function(){if(!d||"function"!=typeof d||!d.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),c=new d(B([b]));if(!c.has(b)||1!=c.size||c.add(b)!=c||1!=c.size||c.add({x:4})!=c||2!=c.size)return!1;var e=c.entries(),f=e.next();if(f.done||f.value[0]!=b||f.value[1]!=b)return!1;f=e.next();return f.done||f.value[0]==b||4!=f.value[0].x||
f.value[1]!=f.value[0]?!1:e.next().done}catch(g){return!1}}())return d;a.prototype.add=function(b){b=0===b?0:b;this.a.set(b,b);this.size=this.a.size;return this};a.prototype.delete=function(b){b=this.a.delete(b);this.size=this.a.size;return b};a.prototype.clear=function(){this.a.clear();this.size=0};a.prototype.has=function(b){return this.a.has(b)};a.prototype.entries=function(){return this.a.entries()};a.prototype.values=function(){return this.a.values()};a.prototype.keys=a.prototype.values;a.prototype[Symbol.iterator]=
a.prototype.values;a.prototype.forEach=function(b,c){var e=this;this.a.forEach(function(f){return b.call(c,f,f,e)})};return a});
m("WeakSet",function(d){function a(b){this.a=new WeakMap;if(b){b=B(b);for(var c;!(c=b.next()).done;)this.add(c.value)}}if(function(){if(!d||!Object.seal)return!1;try{var b=Object.seal({}),c=Object.seal({}),e=new d([b]);if(!e.has(b)||e.has(c))return!1;e.delete(b);e.add(c);return!e.has(b)&&e.has(c)}catch(f){return!1}}())return d;a.prototype.add=function(b){this.a.set(b,!0);return this};a.prototype.has=function(b){return this.a.has(b)};a.prototype.delete=function(b){return this.a.delete(b)};return a});
m("Object.entries",function(d){return d?d:function(a){var b=[],c;for(c in a)z(a,c)&&b.push([c,a[c]]);return b}});m("Array.prototype.values",function(d){return d?d:function(){return na(this,function(a,b){return b})}});m("String.prototype.endsWith",function(d){return d?d:function(a,b){var c=oa(this,a,"endsWith");void 0===b&&(b=c.length);b=Math.max(0,Math.min(b|0,c.length));for(var e=a.length;0<e&&0<b;)if(c[--b]!=a[--e])return!1;return 0>=e}});
var pa="function"==typeof Object.assign?Object.assign:function(d,a){for(var b=1;b<arguments.length;b++){var c=arguments[b];if(c)for(var e in c)z(c,e)&&(d[e]=c[e])}return d};m("Object.assign",function(d){return d||pa});m("Array.prototype.fill",function(d){return d?d:function(a,b,c){var e=this.length||0;0>b&&(b=Math.max(0,e+b));if(null==c||c>e)c=e;c=Number(c);0>c&&(c=Math.max(0,e+c));for(b=Number(b||0);b<c;b++)this[b]=a;return this}});function C(d){return d?d:Array.prototype.fill}
m("Int8Array.prototype.fill",C);m("Uint8Array.prototype.fill",C);m("Uint8ClampedArray.prototype.fill",C);m("Int16Array.prototype.fill",C);m("Uint16Array.prototype.fill",C);m("Int32Array.prototype.fill",C);m("Uint32Array.prototype.fill",C);m("Float32Array.prototype.fill",C);m("Float64Array.prototype.fill",C);
m("String.prototype.startsWith",function(d){return d?d:function(a,b){var c=oa(this,a,"startsWith"),e=c.length,f=a.length;b=Math.max(0,Math.min(b|0,c.length));for(var g=0;g<f&&b<e;)if(c[b++]!=a[g++])return!1;return g>=f}});function qa(d){"@babel/helpers - typeof";qa="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};return qa(d)}
function E(d,a,b){"undefined"!==typeof Reflect&&Reflect.get?E=Reflect.get:E=function(c,e,f){for(;!Object.prototype.hasOwnProperty.call(c,e)&&(c=F(c),null!==c););if(c)return e=Object.getOwnPropertyDescriptor(c,e),e.get?e.get.call(f):e.value};return E(d,a,b||d)}function G(d,a){if("function"!==typeof a&&null!==a)throw new TypeError("Super expression must either be null or a function");d.prototype=Object.create(a&&a.prototype,{constructor:{value:d,writable:!0,configurable:!0}});a&&ra(d,a)}
function H(d){var a=sa();return function(){var b=F(d);if(a){var c=F(this).constructor;b=Reflect.construct(b,arguments,c)}else b=b.apply(this,arguments);if(!b||"object"!==qa(b)&&"function"!==typeof b){if(void 0===this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");b=this}return b}}function F(d){F=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)};return F(d)}
function ta(d,a,b){sa()?ta=Reflect.construct:ta=function(c,e,f){var g=[null];g.push.apply(g,e);c=new (Function.bind.apply(c,g));f&&ra(c,f.prototype);return c};return ta.apply(null,arguments)}function sa(){if("undefined"===typeof Reflect||!Reflect.construct||Reflect.construct.a)return!1;if("function"===typeof Proxy)return!0;try{return Reflect.construct(Date,[],function(){}),!0}catch(d){return!1}}function ra(d,a){ra=Object.setPrototypeOf||function(b,c){b.__proto__=c;return b};return ra(d,a)}
function J(d){var a=Array.isArray(d)?d:void 0;if(!a)if("undefined"!==typeof Symbol&&Symbol.iterator in Object(d)){a=[];var b=!0,c=!1,e=void 0;try{for(var f=d[Symbol.iterator](),g;!(b=(g=f.next()).done)&&(a.push(g.value),2!==a.length);b=!0);}catch(h){c=!0,e=h}finally{try{if(!b&&null!=f["return"])f["return"]()}finally{if(c)throw e;}}}else a=void 0;if(!(d=a||ua(d,2)))throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
return d}function K(d,a){if(!(d instanceof a))throw new TypeError("Cannot call a class as a function");}function va(d,a){for(var b=0;b<a.length;b++){var c=a[b];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(d,c.key,c)}}function O(d,a,b){a&&va(d.prototype,a);b&&va(d,b)}function P(d,a,b){a in d?Object.defineProperty(d,a,{value:b,enumerable:!0,configurable:!0,writable:!0}):d[a]=b}
function R(d){var a=Array.isArray(d)?wa(d):void 0;a||(a="undefined"!==typeof Symbol&&Symbol.iterator in Object(d)?Array.from(d):void 0);if(!(d=a||ua(d)))throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");return d}
function ua(d,a){if(d){if("string"===typeof d)return wa(d,a);var b=Object.prototype.toString.call(d).slice(8,-1);"Object"===b&&d.constructor&&(b=d.constructor.name);if("Map"===b||"Set"===b)return Array.from(d);if("Arguments"===b||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b))return wa(d,a)}}function wa(d,a){if(null==a||a>d.length)a=d.length;for(var b=0,c=Array(a);b<a;b++)c[b]=d[b];return c}var xa=Object.create(null);xa.browser=Object.create(null);xa.feature=Object.create(null);
["proxy","symbol","worker","promise"].forEach(function(d){d=d[0].toUpperCase()+d.substring(1);xa.feature[d]=window[d]?!0:!1});Object.freeze(xa);var S=Object.create(null);Object.defineProperty(S,"clickMask",{enumerable:!0,value:function(){void this.remove()}});Object.defineProperty(S,"interaction",{enumerable:!0,value:{ok:null,no:null,cancel:function(){void this.remove()}}});
Object.defineProperty(S,"active",{enumerable:!0,value:function(d){var a;var b=0;var c=this.variable.nodes;d=null!==(a=d)&&void 0!==a?a:window.event;T._instance.forEach(function(f){f.status===T._enum.STATUS.SHOW&&b++});if(2<=b){var e=T._assistant.element.maxZIndex();c.container.style.zIndex!=e&&(Object.keys(c).forEach(function(f){c[f].style.zIndex=e+1}),c.container.style.zIndex=parseInt(c.container.style.zIndex)+1)}}});
Object.defineProperty(S,"drag",{enumerable:!0,value:function(d){var a,b,c,e,f,g,h,k,l=this,n;var r=this.status;d=null!==(k=d)&&void 0!==k?k:window.event;var q=this.variable.nodes.container;var u=q.getBoundingClientRect();if(this.option.window){var v;k=this.option.window===document.body?document.documentElement:this.option.window;var t=this.option.window?window.getComputedStyle(this.option.window):null;d=parseInt(null!==(a=null===t||void 0===t?void 0:t.marginTop)&&void 0!==a?a:0);a=parseInt(null!==
(b=null===t||void 0===t?void 0:t.paddingTop)&&void 0!==b?b:0);b=parseInt(null!==(c=null===t||void 0===t?void 0:t.marginLeft)&&void 0!==c?c:0);c=parseInt(null!==(e=null===t||void 0===t?void 0:t.paddingLeft)&&void 0!==e?e:0);e=parseInt(null!==(f=null===t||void 0===t?void 0:t.marginRight)&&void 0!==f?f:0);f=parseInt(null!==(g=null===t||void 0===t?void 0:t.paddingRight)&&void 0!==g?g:0);g=parseInt(null!==(h=null===t||void 0===t?void 0:t.marginBottom)&&void 0!==h?h:0);h=parseInt(null!==(v=null===t||void 0===
t?void 0:t.paddingBottom)&&void 0!==v?v:0);var w=[0,k.offsetWidth-b-e-c-f,0,k.offsetHeight-d-g-a-h];if(this.option.position)u.y=q.offsetTop,u.x=q.offsetLeft;else{var y,p;u.y+=null!==(y=null===k||void 0===k?void 0:k.scrollTop)&&void 0!==y?y:0;u.x+=null!==(p=null===k||void 0===k?void 0:k.scrollLeft)&&void 0!==p?p:0}}else w=[0,document.documentElement.clientWidth,0,document.documentElement.clientHeight];window.getSelection().empty();var A=function(L){n=null!==L&&void 0!==L?L:window.event;if(1===n.buttons){u.x+=
n.movementX;u.y+=n.movementY;if(!l.option.drag.overflow){if(u.x<w[0]||u.x>w[1]-u.width)u.x-=n.movementX;if(u.y<w[2]||u.y>w[3]-u.height)u.y-=n.movementY}l.resizeBy(u.x,u.y,u.width,u.height);l.setStatus(T._enum.STATUS.DRAG)}};var I=function(L){var X;var x=[0,0];L=null!==(X=L)&&void 0!==X?X:window.event;"ArrowLeft"===L.code&&(x[0]=-1);"ArrowRight"===L.code&&(x[0]=1);"ArrowUp"===L.code&&(x[1]=-1);"ArrowDown"===L.code&&(x[1]=1);L.preventDefault();(void 0).apply(void 0,R(x))};var Q=function(){document.removeEventListener("keydown",
I,!0);document.removeEventListener("mousemove",A);document.removeEventListener("mouseup",Q);l.setStatus(r)};document.addEventListener("mouseup",Q);document.addEventListener("mousemove",A);document.addEventListener("keydown",I,!0)}});
Object.defineProperty(S,"resize",{enumerable:!0,value:function(d){var a,b,c,e,f,g,h,k=this;var l=this.status;d=null!==(e=d)&&void 0!==e?e:window.event;var n=d.target;var r=this.variable.nodes.container;var q=r.getBoundingClientRect();e=this.option.window===document.body?document.documentElement:this.option.window;var u=this.option.window?window.getComputedStyle(this.option.window):null;d=parseInt(null!==(a=null===u||void 0===u?void 0:u.marginTop)&&void 0!==a?a:0);a=parseInt(null!==(b=null===u||void 0===
u?void 0:u.paddingTop)&&void 0!==b?b:0);b=parseInt(null!==(c=null===u||void 0===u?void 0:u.marginLeft)&&void 0!==c?c:0);c=parseInt(null!==(f=null===u||void 0===u?void 0:u.paddingLeft)&&void 0!==f?f:0);var v=null!==(g=null===e||void 0===e?void 0:e.offsetWidth)&&void 0!==g?g:window.innerWidth;var t=null!==(h=null===e||void 0===e?void 0:e.offsetHeight)&&void 0!==h?h:window.innerHeight;window.getSelection().empty();this.option.position?(q.y=r.offsetTop,q.x=r.offsetLeft):(q.y+=e?e.scrollTop-d-a:0,q.x+=
e?e.scrollLeft-b-c:0);var w=function(p){var A;p=null!==(A=p)&&void 0!==A?A:window.event;1!==p.buttons?y():(k.setStatus("resize"),A=n.getAttribute("position-resize-bar"),A.includes("top")&&0<q.y+p.movementY&&q.height-p.movementY>k.variable.defaultRect.height&&(q.y+=p.movementY,q.height-=p.movementY),A.includes("bottom")&&(q.height+=p.movementY,q.y+q.height>t||q.height<k.variable.defaultRect.height)&&(q.height-=p.movementY),A.includes("left")&&0<q.x+p.movementX&&q.width-p.movementX>k.variable.defaultRect.width&&
(q.x+=p.movementX,q.width-=p.movementX),A.includes("right")&&(q.width+=p.movementX,q.x+q.width>v||q.width<k.variable.defaultRect.width)&&(q.width-=p.movementX),k.resizeBy(q.x,q.y,q.width,q.height))};var y=function(){document.removeEventListener("mousemove",w);document.removeEventListener("mouseup",y);k.setStatus(l)};document.addEventListener("mouseup",y);document.addEventListener("mousemove",w)}});
Object.defineProperty(S,"minimizeRevert",{enumerable:!0,value:function(){if("1"!=this.getAttribute("clicked")){this.setAttribute("clicked",1);var d=Number(this.getAttribute("modal-layer-index"));delete T._minimizeQueue[T._minimizeQueue.indexOf(T._instance[d])]}}});
Object.defineProperty(S,"autoShutdown",{enumerable:!0,value:function(){var d=this;var a=1E3*this.option.popupTime;var b=setInterval(function(){if(d.variable.nodes.container.classList.contains("modal-layer-show")){if(d.option.progress.enable){var c=d.variable.nodes.container.querySelector(".modal-layer-progress-bar-progress");switch(d.option.progress.position){case "top":case "bottom":var e="widthFull";break;case "left":case "right":e="heightFull"}c.style.animation=e+" "+d.option.popupTime+"s linear forwards"}d.variable.timeout.auto_shutdown=
setTimeout(function(){return void d.remove()},a);window.clearInterval(b)}},10)}});
Object.defineProperty(S,"action",{enumerable:!0,value:{close:function(){void this.remove()},expand:function(){var d=this;var a=this.status;var b=this.variable.nodes.container.querySelector("iframe[name="+this.option.layer.name+this.option.index+"]");var c=function(f){f.target===b?d.setStatus(T._enum.STATUS.EXPAND):!1===f.target&&d.setStatus(a);window.removeEventListener("fullscreenerror",e);window.removeEventListener("fullscreenchange",c)};var e=function(f){T.K({J:!1,L:5,title:"\u9519\u8bef",H:!0,
I:"bottom",content:'<i class="fas fa-window-close" style="color: red"></i> \u5168\u5c4f\u5931\u8d25, \u9519\u8bef\u539f\u56e0: '+f});window.removeEventListener("fullscreenerror",e);window.removeEventListener("fullscreenchange",c)};window.addEventListener("fullscreenerror",e);window.addEventListener("fullscreenchange",c);T._assistant.element.launchFullscreen(b)},minimize:function(){var d=T._minimizeQueue.indexOf(this);0>d?T._minimizeQueue.push(this):T._minimizeQueue.splice(d,1)}}});
Object.defineProperty(S,"imageTools",{enumerable:!0,value:{crop:function(){this.variable.image.status===T._enum.LOAD_STATUS.LOADED&&this.crop()},spin:function(){this.variable.image.status===T._enum.LOAD_STATUS.LOADED&&this.spin()},filter:function(d){this.variable.image.status===T._enum.LOAD_STATUS.LOADED&&this.filter((null!==d&&void 0!==d?d:window.event).target)},revert:function(){this.variable.image.status===T._enum.LOAD_STATUS.LOADED&&this.revert()},download:function(){this.variable.image.status===
T._enum.LOAD_STATUS.LOADED&&this.download()}}});Object.freeze(S);var U=Object.create(null);Object.defineProperty(U,"page",{value:{src:null,srcdoc:null,frameborder:0,scrolling:"no",area:[800,600],allowfullscreen:!0,name:"modal-layer-page-"}});Object.defineProperty(U,"loading",{value:{icon:0,size:48,rate:null,duration:2,area:[48,48],color:"white",background:"transparent",position:["center","center"]}});
Object.defineProperty(U,"image",{value:{image:[],size:null,sizeRange:{min:[.15625,.160257],max:[.9,.9]},toolbar:{enable:!1,config:{crop:{enable:!1,title:"crop",grid:"quarter",icon:"fas fa-crop-alt"},spin:{enable:!1,title:"spin",icon:"fas fa-redo-alt"},filter:{enable:!1,config:{blur:{enable:!1,title:"blur",icon:null,textIcon:"\u6a21"},gray:{enable:!1,title:"gray",icon:null,textIcon:"\u7070"},mirror:{enable:!1,title:"mirror",icon:null,textIcon:"\u955c"}},title:"filter",icon:"fas fa-filter"},revert:{enable:!1,
title:"revert",icon:"fas fa-sync-alt"},download:{enable:!1,name:"picture-",mime:"image/png",title:"download",icon:"fas fa-download"}}}}});
Object.defineProperty(U,"common",{value:{index:0,ui:"modal-layer-ui",title:null,window:null,position:null,popupTime:5,skin:"default",parentModalLayer:null,areaProportion:[.18,.21],content:{value:null,fullContainer:!1},text:{action:{close:"\u5173\u95ed",expand:"\u5168\u5c4f",minimize:"\u6700\u5c0f\u5316"},interaction:{ok:"\u786e\u5b9a",no:"\u62d2\u7edd",cancel:"\u53d6\u6d88"}},transition:{time:.2,opacity:0,scale:[.45,.45]},mask:{enable:!0,clickRemove:!0},drag:{enable:!0,overflow:!1},resize:{enable:!0},
progress:{enable:!1,position:"bottom",color:"deepskyblue",background:"#cecece"},layer:{},hook:{initStart:null,initEnded:null}}});Object.freeze(U);var V=Object.create(null);Object.defineProperty(V,"mask",{get:function(){return JSON.parse(JSON.stringify({nodeType:"div","class":"modal-layer-mask"}))},enumerable:!0,configurable:!1});Object.defineProperty(V,"container",{get:function(){return JSON.parse(JSON.stringify({innerHTML:[],nodeType:"div","class":"modal-layer-container"}))},enumerable:!0,configurable:!1});
Object.defineProperty(V,"action",{get:function(){return JSON.parse(JSON.stringify({innerHTML:[],nodeType:"div","class":"modal-layer-action"}))},enumerable:!0,configurable:!1});
Object.defineProperty(V,"action_button",{get:function(){return JSON.parse(JSON.stringify({minimize:{nodeType:"span","data-fa-transform":"up-4 shrink-2","class":"fas fa-window-minimize modal-layer-action-btn modal-layer-action-btn-minimize"},expand:{nodeType:"span","data-fa-transform":"shrink-2","class":"fas fa-expand-arrows-alt modal-layer-action-btn modal-layer-action-btn-expand"},close:{nodeType:"span","data-fa-transform":"rotate-45 grow-1","class":"fas fa-plus modal-layer-action-btn modal-layer-action-btn-close"}}))},
enumerable:!0,configurable:!1});Object.defineProperty(V,"title",{get:function(){return JSON.parse(JSON.stringify({nodeType:"div","class":"modal-layer-title",innerHTML:[{nodeType:"h4","class":"modal-layer-title-content"}]}))},enumerable:!0,configurable:!1});Object.defineProperty(V,"content",{get:function(){return JSON.parse(JSON.stringify({innerHTML:[],nodeType:"div","class":"modal-layer-content"}))},enumerable:!0,configurable:!1});
Object.defineProperty(V,"content_text",{get:function(){return JSON.parse(JSON.stringify({nodeType:"div","class":"modal-layer-text-content"}))},enumerable:!0,configurable:!1});Object.defineProperty(V,"content_page",{get:function(){return JSON.parse(JSON.stringify({name:"",frameborder:0,scrolling:"no",nodeType:"iframe","class":"modal-layer-page-content"}))},enumerable:!0,configurable:!1});
Object.defineProperty(V,"content_image",{get:function(){return JSON.parse(JSON.stringify({"load-status":2,nodeType:"canvas","class":"modal-layer-image-canvas"}))},enumerable:!0,configurable:!1});Object.defineProperty(V,"content_loading",{get:function(){return JSON.parse(JSON.stringify({nodeType:"div","class":"modal-layer-loading-box",innerHTML:[{nodeType:"span","class":"modal-layer-loading-icon"}]}))},enumerable:!0,configurable:!1});
Object.defineProperty(V,"content_loading_icon",{get:function(){return JSON.parse(JSON.stringify([{nodeType:"span","class":"modal-layer-loading-icon fas fa-spinner fa-spin fa-fw"},{nodeType:"span","class":"modal-layer-loading-icon fas fa-circle-notch fa-spin fa-fw"},{nodeType:"span","class":"modal-layer-loading-icon fas fa-sync fa-spin fa-fw"},{nodeType:"span","class":"modal-layer-loading-icon fas fa-cog fa-spin fa-fw"}]))},enumerable:!0,configurable:!1});
Object.defineProperty(V,"toolbar",{get:function(){return JSON.parse(JSON.stringify({innerHTML:[],nodeType:"div","class":"modal-layer-toolbar"}))},enumerable:!0,configurable:!1});Object.defineProperty(V,"interaction",{get:function(){return JSON.parse(JSON.stringify({innerHTML:[],nodeType:"div","class":"modal-layer-interaction"}))},enumerable:!0,configurable:!1});
Object.defineProperty(V,"interaction_button",{get:function(){return JSON.parse(JSON.stringify({ok:{nodeType:"span","class":"modal-layer-interaction-btn modal-layer-interaction-btn-ok"},no:{nodeType:"span","class":"modal-layer-interaction-btn modal-layer-interaction-btn-no"},cancel:{nodeType:"span","class":"modal-layer-interaction-btn modal-layer-interaction-btn-cancel"}}))},enumerable:!0,configurable:!1});
Object.defineProperty(V,"progress_bar",{get:function(){return JSON.parse(JSON.stringify({nodeType:"div","class":"modal-layer-progress-bar",innerHTML:[{nodeType:"div","class":"modal-layer-progress-bar-background",innerHTML:[{nodeType:"span","class":"modal-layer-progress-bar-progress"}]}]}))},enumerable:!0,configurable:!1});
Object.defineProperty(V,"resize_box",{get:function(){return JSON.parse(JSON.stringify({nodeType:"div","class":"modal-layer-resize-box",innerHTML:[{nodeType:"div","class":"modal-layer-resize-bar","position-resize-bar":"top"},{nodeType:"div","class":"modal-layer-resize-bar","position-resize-bar":"left"},{nodeType:"div","class":"modal-layer-resize-bar","position-resize-bar":"right"},{nodeType:"div","class":"modal-layer-resize-bar","position-resize-bar":"bottom"},{nodeType:"div","class":"modal-layer-resize-bar",
"position-resize-bar":"left-top"},{nodeType:"div","class":"modal-layer-resize-bar","position-resize-bar":"right-top"},{nodeType:"div","class":"modal-layer-resize-bar","position-resize-bar":"left-bottom"},{nodeType:"div","class":"modal-layer-resize-bar","position-resize-bar":"right-bottom"}]}))},enumerable:!0,configurable:!1});Object.defineProperty(V,"minimize_queue",{get:function(){return JSON.parse(JSON.stringify({innerHTML:[],nodeType:"div",id:"modal-layer-minimize-queue"}))},enumerable:!0,configurable:!1});
Object.defineProperty(V,"minimize_queue_item",{get:function(){return JSON.parse(JSON.stringify({nodeType:"div","class":"modal-layer-minimize-queue-item",innerHTML:[{nodeType:"h4","class":"modal-layer-minimize-queue-item-title"}]}))},enumerable:!0,configurable:!1});
Object.defineProperty(V,"image_tools",{get:function(){return JSON.parse(JSON.stringify({crop:{title:"crop",nodeType:"div","tool-type":"crop",innerHTML:[{nodeType:"span","class":"modal-layer-toolbar-item-icon"}],"class":"modal-layer-toolbar-item"},spin:{title:"spin",nodeType:"div","tool-type":"spin",innerHTML:[{nodeType:"span","class":"modal-layer-toolbar-item-icon"}],"class":"modal-layer-toolbar-item"},revert:{title:"revert",nodeType:"div","tool-type":"revert",innerHTML:[{nodeType:"span","class":"modal-layer-toolbar-item-icon"}],
"class":"modal-layer-toolbar-item"},filter:{title:"filter",nodeType:"div","tool-type":"filter",innerHTML:[{nodeType:"span","class":"modal-layer-toolbar-item-icon"},{innerHTML:[],nodeType:"div","class":"modal-layer-toolbar-item-child-list"}],"class":"modal-layer-toolbar-item"},download:{title:"save",nodeType:"div","tool-type":"download",innerHTML:[{nodeType:"span","class":"modal-layer-toolbar-item-icon"}],"class":"modal-layer-toolbar-item"}}))},enumerable:!0,configurable:!1});
Object.defineProperty(V,"image_tools_child",{get:function(){return JSON.parse(JSON.stringify({filter:{mirror:{title:"\u955c\u50cf",innerText:"\u955c",nodeType:"span","filter-type":"mirror","class":"modal-layer-toolbar-filter-icon"},blur:{"data-radius":3,"data-sigma":1.5,innerText:"\u6a21",title:"\u9ad8\u65af\u6a21\u7cca",nodeType:"span","filter-type":"blur","class":"modal-layer-toolbar-filter-icon"},gray:{title:"\u7070\u5ea6\u5316",innerText:"\u7070",nodeType:"span","filter-type":"gray","class":"modal-layer-toolbar-filter-icon"}}}))},
enumerable:!0,configurable:!1});Object.freeze(V);var W=Object.create(null);Object.defineProperty(W,"ARROW",{enumerable:!0,value:{LEFT:37,UP:38,RIGHT:39,DOWN:40}});Object.defineProperty(W,"POSITION",{enumerable:!0,value:{EAST:"e",WEST:"w",SOUTH:"s",NORTH:"n"}});Object.defineProperty(W,"TYPE",{enumerable:!0,value:{MSG:0,MESSAGE:0,ALERT:1,PROMPT:2,CONFIRM:3,PAGE:4,LOADING:5,IMAGE:6,VIDEO:7,AUTDIO:8}});
Object.defineProperty(W,"STATUS",{enumerable:!0,value:{HIDE:0,SHOW:1,EXPAND:2,MINIMIZE:3,REMOVING:4,REMOVED:5,DRAG:6,RESIZE:7}});Object.defineProperty(W,"LOAD_STATUS",{enumerable:!0,value:{FAILED:0,LOADED:1,LOADING:2}});Object.defineProperty(W,"BROWSER_STORAGE",{enumerable:!0,value:{WEBSQL:"webSQL",INDEXDB:"indexedDB",LOCALSTORAGE:"localStorage",SESSIONSTORAGE:"sessionStorage"}});Object.freeze(W);
var T=function(){function d(a,b){K(this,d);P(this,"type",null);P(this,"status",null);P(this,"event",null);P(this,"option",null);P(this,"variable",{});try{var c,e,f,g,h,k;null===(c=a.hook)||void 0===c?void 0:null===(e=c.initStart)||void 0===e?void 0:null===(f=e.call)||void 0===f?void 0:f.call(e,a);this.type=a.type;this.status=d._enum.STATUS.HIDE;this.compatibleOption(a);this.initOption(a);this.checkOption();this.linkageOption();this.initVariable();this.initStruct();this.initNode();this.initNodeFinally();
this.initEvent();this.bindEvent();null===(g=this.option.hook)||void 0===g?void 0:null===(h=g.initEnded)||void 0===h?void 0:null===(k=h.call)||void 0===k?void 0:k.call(h,this);this.insertNode()}catch(l){d._instance.splice(d._instance.indexOf(this),1),null===b||void 0===b?void 0:b.call(null,l)}}O(d,[{key:"initOption",value:function(a){a.index=d._instance.length;d._instance[a.index]=this;this.option=d._assistant.object.merge(a,d._option.common)}},{key:"compatibleOption",value:function(a){var b,c;d._assistant.object.isString(a.window)&&
(a.window=document.querySelector(a.window));a.position&&(Array.isArray(a.position)||(window.isNaN(a.position)?a.position=null:a.position=[a.position,a.position]));if("boolean"===typeof a.mask||["true","false"].includes(a.mask))a.mask={enable:!!a.mask,clickRemove:!0};if(!a.content||d._assistant.object.isEmpty(a.content.value))a.content={value:a.content,fullContainer:null!==(b=null===(c=a.content)||void 0===c?void 0:c.fullContainer)&&void 0!==b?b:!1}}},{key:"linkageOption",value:function(){0>=this.option.popupTime&&
(this.option.progress.enable=!1);!1===this.option.title&&(this.option.drag.enable=!1)}},{key:"checkOption",value:function(){}},{key:"initVariable",value:function(){this.variable.struct=Object.create(null);this.variable.timeout=Object.create(null);this.variable.interval=Object.create(null);this.variable.eventSymbol=Object.create(null);this.variable.defaultRect=Object.create(null);this.variable.animationName=Object.create(null);this.variable.struct._build=Object.create(null);this.variable.struct._backup=
Object.create(null)}},{key:"initStruct",value:function(){var a;if(null===(a=this.option.mask)||void 0===a?0:a.enable)this.variable.struct._build.mask=d._struct.mask;this.variable.struct._build.container=d._struct.container}},{key:"initNode",value:function(){this.variable.nodes=d._assistant.element.objectToNode(this.variable.struct._build);var a=this.variable.nodes.mask;var b=this.variable.nodes.container;var c=b.querySelector(".modal-layer-interaction-btn-ok");var e=b.querySelector(".modal-layer-interaction-btn-no");
var f=b.querySelector(".modal-layer-interaction-btn-cancel");null!==this.option.window&&(null===a||void 0===a?void 0:a.setAttribute("has-window",""),b.setAttribute("has-window",""));b.setAttribute("modal-layer-popup-time",this.option.popupTime);b.setAttribute("content-full-container",Number(this.option.content.fullContainer));b.setAttribute("modal-layer-type",d._assistant.object.getKeyByValue(d._enum.TYPE,this.type).toLowerCase());b.setAttribute("allow-drag",Number(this.option.drag.enable));b.setAttribute("allow-resize",
Number(this.option.resize.enable));if(this.option.progress.enable){a=["top","left","right","bottom"];var g=b.querySelector(".modal-layer-progress-bar");a.includes(this.option.progress.position)||(this.option.progress.position=a[3]);g.setAttribute("progress-bar-position",this.option.progress.position);g.querySelector(".modal-layer-progress-bar-progress").style.cssText+="background: "+this.option.progress.color;g.querySelector(".modal-layer-progress-bar-background").style.cssText+="background: "+this.option.progress.background}if(!1!==
this.option.title){var h=b.querySelector(".modal-layer-title-content");if(this.option.title instanceof Object){var k=d._assistant.element.objectToNode(this.option.title);Object.keys(k).forEach(function(l){h.appendChild(k[l])})}else h.innerHTML=this.option.title}c&&(c.innerText=this.option.text.interaction.ok);e&&(e.innerText=this.option.text.interaction.no);f&&(f.innerText=this.option.text.interaction.cancel)}},{key:"initNodeFinally",value:function(){var a=this.option.ui;var b="modal-layer-skin-"+
this.option.skin;var c="modal-layer-index-"+this.option.index;var e="transition-opacity-"+100*this.option.transition.opacity+"-animation";var f="transition-scale-"+100*this.option.transition.scale[0]+"-"+100*this.option.transition.scale[1]+"-animation";this.variable.animationName.transition_opacity=e;this.variable.animationName.transition_scale=f;if(!d._assistant.css.hasCss(e)){var g={from:"opacity: "+this.option.transition.opacity,to:"opacity: 1"};var h=d._assistant.css.createAnimation(e,g);d._assistant.css.addCss(e,
h);d._assistant.css.addCss(e+"-reverse",d._assistant.css.createAnimation(e+"-reverse",{from:g.to,to:g.from}))}d._assistant.css.hasCss(f)||(e={from:"transform: scale("+this.option.transition.scale[0]+", "+this.option.transition.scale[1]+")",to:"transform: scale(1, 1)"},h=d._assistant.css.createAnimation(f,e),d._assistant.css.addCss(f,h),d._assistant.css.addCss(f+"-reverse",d._assistant.css.createAnimation(f+"-reverse",{from:e.N,to:e.from})));Object.keys(this.variable.nodes).forEach(function(k){for(var l=
d._assistant.element.getAllElement(this.variable.nodes[k]),n=0;n<l.length;n++)l[n].classList.add(a);this.variable.nodes[k].className=a+" "+b+" "+c+" "+this.variable.nodes[k].className.trim()+" modal-layer-hide"},this)}},{key:"initEvent",value:function(){var a;this.event=d._assistant.object.merge(null!==(a=this.option.event)&&void 0!==a?a:{},d._event)}},{key:"bindEvent",value:function(){var a={once:!1,capture:!1,passive:!1,mozSystemGroup:!1};this.option.mask.enable&&this.option.mask.clickRemove&&(this.variable.eventSymbol.maskClickRemove=
d._assistant.event.add(this.variable.nodes.mask,"click",null,this.event.clickMask,this,null,a));this.option.drag.enable&&(this.variable.eventSymbol.drag=d._assistant.event.add(this.variable.nodes.container.querySelector(".modal-layer-title"),"mousedown",null,this.event.drag,this,null,a));this.option.resize.enable&&(this.variable.eventSymbol.resize=d._assistant.event.add(this.variable.nodes.container,"mousedown",".modal-layer-resize-bar",this.event.resize,this,null,a));this.variable.eventSymbol.active=
d._assistant.event.add(this.variable.nodes.container,"mousedown",null,this.event.active,this,null,a);this.event.action.close instanceof Function&&(this.variable.eventSymbol.actionClose=d._assistant.event.add(this.variable.nodes.container,"click",".modal-layer-action-btn-close",this.event.action.close,this,null,a));this.event.action.expand instanceof Function&&(this.variable.eventSymbol.actionExpand=d._assistant.event.add(this.variable.nodes.container,"click",".modal-layer-action-btn-expand",this.event.action.expand,
this,null,a));this.event.action.minimize instanceof Function&&(this.variable.eventSymbol.actionMinimize=d._assistant.event.add(this.variable.nodes.container,"click",".modal-layer-action-btn-minimize",this.event.action.minimize,this,null,a));var b=this.variable.nodes.container.querySelector(".modal-layer-interaction-btn-ok");var c=this.variable.nodes.container.querySelector(".modal-layer-interaction-btn-no");var e=this.variable.nodes.container.querySelector(".modal-layer-interaction-btn-cancel");this.event.interaction.ok&&
b&&(this.variable.eventSymbol.interactionOk=d._assistant.event.add(b,"click",null,this.event.interaction.ok,this,null,a));this.event.interaction.no&&c&&(this.variable.eventSymbol.interactionNo=d._assistant.event.add(c,"click",null,this.event.interaction.no,this,null,a));e&&(this.variable.eventSymbol.interactionCancel=d._assistant.event.add(e,"click",null,this.event.interaction.cancel,this,null,a))}},{key:"insertNode",value:function(){var a,b=this,c=document.createDocumentFragment(),e=null!==(a=this.option.window)&&
void 0!==a?a:window.document.body;Object.keys(this.variable.nodes).forEach(function(f){return c.appendChild(b.variable.nodes[f])},this);e.appendChild(c)}}]);O(d,[{key:"setStatus",value:function(a){if(Object.values(d._enum.STATUS).includes(a))var b=d._assistant.object.getKeyByValue(d._enum.STATUS,a);else if(b=a.toUpperCase(),void 0===(a=d._enum.STATUS[b]))throw Error("Illegal value");this.status=a;this.variable.nodes.container.setAttribute("modal-layer-status",b.toLowerCase())}},{key:"resize",value:function(){var a=
[0,0];var b=this.variable.nodes.container;var c=b.children;a[0]=d._assistant.number.multiply(window.innerWidth,this.option.areaProportion[0]);b.style.width=a[0]+"px";for(var e=0;e<c.length;e++)a[1]="absolute"==getComputedStyle(c[e]).position?a[1]:Math.max(d._assistant.element.getNodeHeight(c[e]),a[1]);b.style.height=a[1]+"px";this.variable.defaultArea=a;this.variable.defaultRect.width=a[0];this.variable.defaultRect.height=a[1]}},{key:"resizeBy",value:function(a,b,c,e){var f=this.variable.nodes.container;
f.style.cssText+="top: ".concat(b,"px; left: ").concat(a,"px; width: ").concat(c,"px; height: ").concat(e,"px;");[d._enum.TYPE.PAGE,d._enum.TYPE.VIDEO,d._enum.TYPE.AUDIO].includes(this.type)&&(f.querySelector("iframe[name="+this.option.layer.name+this.option.index+"]").style.cssText+="width: ".concat(this.option.layer.area[0]+c-this.variable.defaultRect.width,"px; height: ").concat(this.option.layer.area[1]+e-this.variable.defaultRect.height,"px;"))}},{key:"positioning",value:function(){var a,b;var c=
this.variable.nodes.container;var e=this.option.window===document.body?document.documentElement:this.option.window;if(this.option.position){var f=J(this.option.position);var g=f[0];f=f[1]}else{g=this.variable.defaultRect.width;var h=this.variable.defaultRect.height;f=null!==(a=null===e||void 0===e?void 0:e.scrollTop)&&void 0!==a?a:0;a=null!==(b=null===e||void 0===e?void 0:e.scrollLeft)&&void 0!==b?b:0;b=e?e.clientWidth:window.innerWidth;e=e?e.clientHeight:window.innerHeight;g=d._assistant.number.chain(b).subtract(g).divide(2).add(a).floor().done();
f=d._assistant.number.chain(e).subtract(h).divide(2).add(f).floor().done()}c.style.cssText+="top: ".concat(f,"px; left: ").concat(g,"px;");this.variable.defaultRect.top=f;this.variable.defaultRect.left=g}},{key:"show",value:function(){var a=this;var b=this.variable.nodes;var c=d._assistant.element.maxZIndex();if(0===Object.keys(b).length||this.status===d._enum.STATUS.SHOW)return Promise.resolve();var e=this.variable.animationName.transition_opacity+" "+this.option.transition.time+"s ease forwards";
var f=this.variable.animationName.transition_scale+" "+this.option.transition.time+"s ease forwards";Object.keys(b).forEach(function(h){b[h].style.zIndex=c+1});var g=new Promise(function(h){b.container.onanimationend=function(){0<a.option.popupTime&&a.event.autoShutdown.call(a);b.container.onanimationend=null;h()}});b.mask&&(b.mask.style.animation=e);b.container.style.animation=e+", "+f;Object.keys(b).forEach(function(h){b[h].classList.contains("modal-layer-hide")&&b[h].classList.replace("modal-layer-hide",
"modal-layer-show")},this);this.setStatus("show");return g}},{key:"hide",value:function(){var a=this;var b=this.variable.nodes;if(0===Object.keys(b).length||this.status===d._enum.STATUS.HIDE)return Promise.resolve();Number.isInteger(this.variable.timeout.auto_shutdown)&&window.clearTimeout(this.variable.timeout.auto_shutdown);var c=this.variable.animationName.transition_opacity+"-reverse "+this.option.transition.time+"s ease forwards";var e=this.variable.animationName.transition_scale+"-reverse "+
this.option.transition.time+"s ease forwards";var f=new Promise(function(g){b.container.onanimationend=function(){Object.keys(b).forEach(function(h){b[h].classList.contains("modal-layer-show")&&b[h].classList.replace("modal-layer-show","modal-layer-hide")});a.setStatus("hide");b.container.onanimationend=null;null!==a.option.parentModalLayer&&a.option.parentModalLayer.show();g()}});b.mask&&(b.mask.style.animation=c);b.container.style.animation=c+", "+e;return f}},{key:"minimize",value:function(){var a=
this;if(this.status!==d._enum.STATUS.MINIMIZE){var b=document.querySelector("#modal-layer-minimize-queue");b||(b=d._assistant.element.objectToNode([d._struct.minimize_queue])[0],b.classList.add(this.option.ui,"modal-layer-skin-".concat(this.option.skin)),d._assistant.cache.set("minimizeQueueEvent",d._assistant.event.add(b,"click",".modal-layer-minimize-queue-item",this.event.minimizeRevert,null,null,!1)),document.body.insertAdjacentElement("beforeend",b));var c=this.variable.nodes.container.querySelector(".modal-layer-title-content").innerHTML;
var e=d._assistant.element.objectToNode([d._struct.minimize_queue_item])[0];e.classList.add(this.option.ui);e.setAttribute("modal-layer-index",this.option.index);e.querySelector(".modal-layer-minimize-queue-item-title").innerHTML=c;b.insertAdjacentElement("beforeend",e);var f=setInterval(function(){e.parentNode&&(e.style.animation="opacity 0.3s ease forwards, "+a.variable.animationName.minimize_queue_transition_scale+" 0.3s ease forwards",clearInterval(f))},10);this.hide().then(function(){return void a.setStatus("minimize")})}}},
{key:"revert",value:function(){var a=this;var b=document.querySelector("#modal-layer-minimize-queue");var c=b.querySelector('.modal-layer-minimize-queue-item[modal-layer-index="'+this.option.index+'"]');if([d._enum.STATUS.MINIMIZE].includes(this.status)){c.onanimationstart=function(){setTimeout(function(){a.show();c.onanimationstart=null},150)};var e=new Promise(function(f){c.onanimationend=function(){c.remove();0>=d._minimizeQueue.length&&(b.remove(),d._assistant.cache.has("minimizeQueueEvent")&&
d._assistant.event.remove(d._assistant.cache.get("minimizeQueueEvent")));f()}});c.style.animation="opacity-reverse 0.3s ease forwards, "+this.variable.animationName.minimize_queue_transition_scale+"-reverse 0.3s ease forwards";return e}}},{key:"remove",value:function(){var a=this;var b=this.status;var c=this.variable.nodes;b===d._enum.STATUS.MINIMIZE&&delete d._minimizeQueue[d._minimizeQueue.indexOf(this)];this.setStatus(d._enum.STATUS.REMOVING);return 0===Object.keys(c).length||[d._enum.STATUS.HIDE,
d._enum.STATUS.REMOVING,d._enum.STATUS.REMOVED].includes(b)?Promise.resolve():this.hide().then(function(){a.removeAllEvent();Object.keys(c).forEach(function(e){c[e].remove()});a.setStatus("removed")})}},{key:"delete",value:function(){var a=this;this.remove().then(function(){d.a.splice(d.a.indexOf(a),1);d._assistant.object.dereference(a.event);d._assistant.object.dereference(a.option);d._assistant.object.dereference(a.variable);a.event=a.option=a.variable=null})}},{key:"removeAllEvent",value:function(){0!==
Object.keys(this.variable.nodes).length&&Object.values(this.variable.eventSymbol).forEach(function(a){return d._assistant.event.remove(a)})}}],[{key:"removeAll",value:function(){for(var a=0;a<d._instance.length;a++)d._instance[a].remove()}},{key:"msg",value:function(a,b){d.message(a,b)}},{key:"message",value:function(a,b){"string"===typeof a?a={content:a,type:d._enum.TYPE.MESSAGE}:a.type=d._enum.TYPE.MESSAGE;a=new (d._achieve.get("message"))(a,b);a.resize();a.positioning();a.show();return a}},{key:"alert",
value:function(a,b){a.type=d._enum.TYPE.ALERT;a=new (d._achieve.get("alert"))(a,b);a.resize();a.positioning();a.show();return a}},{key:"confirm",value:function(a,b){a.type=d._enum.TYPE.CONFIRM;a=new (d._achieve.get("confirm"))(a,b);a.resize();a.positioning();a.show();return a}},{key:"prompt",value:function(a,b){a.type=d._enum.TYPE.PROMPT;a=new (d._achieve.get("prompt"))(a,b);a.resize();a.positioning();a.show();return a}},{key:"page",value:function(a,b){a.type=d._enum.TYPE.PAGE;a=new (d._achieve.get("page"))(a,
b);a.resize();a.positioning();a.show();return a}},{key:"image",value:function(a,b){var c=null;a.type=d._enum.TYPE.IMAGE;c=new (d._achieve.get("image"))(a,b);c.variable.image.finish.then(function(){c.resize();c.variable.image.layer.resize()}).then(function(){c.positioning();c.variable.image.layer.M()}).then(function(){return c.show()});return c}},{key:"loading",value:function(a,b){a.type=d._enum.TYPE.LOADING;a=new (d._achieve.get("loading"))(a,b);a.resize();a.positioning();a.show();return a}}]);return d}();
P(T,"_env",xa);P(T,"_enum",W);P(T,"_struct",V);P(T,"_option",U);P(T,"_variable",new Map);P(T,"_worker",window.Worker?new Map:void 0);P(T,"_event",S);P(T,"_version",1);P(T,"_achieve",new Map);P(T,"_assistant",Object.create(null));P(T,"_instance",new Proxy([],{set:function(d,a,b){if(b instanceof T||"length"===a)return d[a]=b,!0;throw new TypeError("Must be of type ModalLayer");}}));
P(T,"_minimizeQueue",new Proxy([],{set:function(d,a,b){if(b instanceof T){var c=d.indexOf(b);b.minimize();0>c?d[a]=b:d[c]=b;return!0}return"length"===a?(d[a]=b,!0):!1},deleteProperty:function(d,a){a=parseInt(a);if(Number.isInteger(a)&&d[a]instanceof T){d[a].revert();if(d[a+1])for(;a<d.length-1;a++)d[a]=d[a+1];delete d[d.length-1];d.length--;return!0}}}));Object.seal(T);
Object.is(window.ModalLayer,T)?(console.group("ModalLayer already exists"),console.log("Already version ".concat(window.ModalLayer._version)),console.log("Try to introduce version: ".concat(T._version)),console.groupEnd()):(Object.preventExtensions(T),Object.defineProperty(window,"ModalLayer",{value:T}));
var ya=function(){function d(){K(this,d)}O(d,null,[{key:"createAnimation",value:function(a,b){var c="@keyframes "+a+" {";Object.keys(b).forEach(function(e){c+=e+"{"+b[e]+"}"});return c+"}"}},{key:"hasCss",value:function(a){return d.cssList.has(a)}},{key:"addCss",value:function(a,b){if(d.hasCss(a))return!1;d.styleNode||(d.styleNode=document.createElement("style"),document.head.appendChild(d.styleNode));b=b.trim();d.cssList.set(a,b);d.styleNode.innerHTML+=d.delimiter+b}},{key:"delCss",value:function(a){d.hasCss(a)&&
(a=new RegExp(d.delimiter+d.cssList.get(a),"g"),d.styleNode.innerHTML=d.styleNode.innerHTML.replace(a,""))}}]);return d}();P(ya,"cssList",new Map);P(ya,"delimiter","\n");P(ya,"styleNode",null);Object.defineProperty(T._assistant,"css",{value:ya});
var za=function(){function d(){K(this,d)}O(d,null,[{key:"getFileBinary",value:function(a,b){var c;b=null!==(c=b)&&void 0!==c?c:{};b=Y.merge(b,{mode:"cors",method:"get",cache:"no-cache",redirect:"follow",credentials:"include",referrer:"no-referrer",headers:{"content-type":"text/plain"}});return fetch(a,b)}},{key:"getFileBlob",value:function(a){var b=null;a instanceof Blob?b=Promise.resolve(a):a instanceof Image||a instanceof Element&&"IMAGE"===a.nodeName?b=this.u(a.src).then(function(c){return c.blob()}):
"string"===typeof a||a instanceof String?b=this.u(a).then(function(c){return c.blob()}):b=Promise.reject(!1);return b}},{key:"getImage",value:function(a){var b=null;"string"===typeof a||a instanceof String?b=a:a instanceof Image||a instanceof Element&&"IMAGE"===a.nodeName?b=a.src:a instanceof Blob||a instanceof MediaSource?b=URL.createObjectURL(a):b=!1;return b}}]);return d}();Object.defineProperty(T._assistant,"file",{value:za});
var Z=function(){function d(){K(this,d)}O(d,null,[{key:"has",value:function(a){var b,c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;c=null!==(b=c)&&void 0!==b?b:d;return(b=d._symbol.get(c))?c[b].has(a):!1}},{key:"get",value:function(a){var b,c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;c=null!==(b=c)&&void 0!==b?b:d;return(b=d._symbol.get(c))?c[b].get(a):void 0}},{key:"set",value:function(a,b){var c,e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;e=null!==
(c=e)&&void 0!==c?c:d;d._symbol.has(e)?c=d._symbol.get(e):(c=Symbol("cache"),d._symbol.set(e,c));Object.hasOwnProperty.call(e,c)||Object.defineProperty(e,c,{value:new Map,writable:!1,enumerable:!1,configurable:!1});e[c].set(a,b)}},{key:"delete",value:function(){var a,b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;c=null!==(a=c)&&void 0!==a?a:d;var e=d._symbol.get(c);if(b)c[e]["delete"](b);else c[e].forEach(function(f,g){c[e]["delete"](g)})}},
{key:"clear",value:function(){d._symbol.forEach(function(a,b){d["delete"](null,b)})}}]);return d}();P(Z,"_symbol",new Map);Object.defineProperty(T._assistant,"cache",{value:Z});
var Aa=function(){function d(){K(this,d)}O(d,null,[{key:"add",value:function(a,b,c,e,f,g,h){var k,l=7<arguments.length&&void 0!==arguments[7]?arguments[7]:!1,n;var r=!1;var q=Symbol();(n=Z.get("cache",d))||(n=new Map,Z.set("cache",n,d));if(!(a instanceof EventTarget||(a=document.querySelector(a))))throw Error("Is not a valid element.");if(!Y.isString(b))throw Error("Event type not allowed to be empty");c instanceof EventTarget&&(a=c,c=null);e instanceof Function||(r=!0);Y.isEmpty(f)&&(f=null!==(k=
c)&&void 0!==k?k:a);Y.isEmpty(g)||Array.isArray(g)||(g=[g]);Y.isEmpty(h)&&(h=!1);if(r){var u;g=[{target:f,symbol:q,parameter:null!==(u=g)&&void 0!==u?u:[]}]}else{var v;g=null!==(v=g)&&void 0!==v?v:[]}k=c?new Promise(function(t){function w(y){var p=(null!==y&&void 0!==y?y:window.event).target;var A=a.querySelectorAll(c);if(p.contains(a)||0===A.length)return!1;for(var I=0;I<A.length;I++){var Q=A[I];if(Q.contains(p)){p=Q===p?p:Q;r?(g[0].event=y,g[0].target=f===c?p:f):0<g.length&&g[g.length-1]instanceof
Event?g[g.length-1]=y:g.push(y);(r?t:e).apply(f===c?p:f,g);break}}}n.set(q,{type:b,element:a,options:h,selector:c,callback:w,wantsUntrusted:l});a.addEventListener(b,w,h,l)}):new Promise(function(t){var w;e=(w=r?t:e).bind.apply(w,[f].concat(R(g)));n.set(q,{type:b,element:a,options:h,selector:c,callback:e,wantsUntrusted:l});a.addEventListener(b,e,h,l)});return r?k:q}},{key:"remove",value:function(a){var b;var c=Z.get("cache",d);if(b=null===c||void 0===c?void 0:c.get(a))b.element.removeEventListener(b.type,
b.callback,b.options),c["delete"](a),Y.dereference(b)}},{key:"removeBy",value:function(a,b){var c=Z.get("cache",d);if(!["element","selector","callback"].includes(a))throw Error("key value is invalid");null===c||void 0===c?void 0:c.forEach(function(e,f){e[a]===b&&(e.element.removeEventListener(e.type,e.callback,e.options,e.wantsUntrusted),c["delete"](f))})}},{key:"removeAll",value:function(){var a=Z.get("cache",d);null===a||void 0===a?void 0:a.forEach(function(b,c){b.element.removeEventListener(b.type,
b.callback,b.options,b.wantsUntrusted);a["delete"](c)})}}]);return d}();Object.defineProperty(T._assistant,"event",{value:Aa});
var Ba=function(){function d(){K(this,d)}O(d,null,[{key:"has",value:function(a){var b,c;return null!==(b=null===(c=Z.get("list",d))||void 0===c?void 0:c.has(a))&&void 0!==b?b:!1}},{key:"add",value:function(a,b){var c;(c=Z.get("list",d))||Z.set("list",c=new Map,d);if(!(b instanceof Worker))throw new TypeError("Not a Worker instance.");if(d.has(a))throw Error("The key already exists.");c.set(a,b)}},{key:"get",value:function(a){var b;return null===(b=Z.get("list",d))||void 0===b?void 0:b.get(a)}},{key:"create",
value:function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:!1,e;(e=Z.get("list",d))||Z.set("list",e=new Map,d);try{var f=new Worker(b);e.set(a,f);c&&d.add(a,f)}catch(g){throw g;}return f}},{key:"close",value:function(a){var b;a instanceof Worker||(a=d.get(a),d.list["delete"](a));null===(b=a)||void 0===b?void 0:b.terminate()}},{key:"listener",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:void 0;if(!(a instanceof Worker)&&(a=d.get(a),void 0===a))throw Error("Worker not found.");
return new Promise(function(c,e){a.C=e;a.onmessage=function(f){null===b||void 0===b?void 0:b(f);c(f)}})}},{key:"addListener",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:void 0;if(!(a instanceof Worker)&&(a=d.get(a),void 0===a))throw Error("Worker not found.");return new Promise(function(c,e){a.addEventListener("messageerror",e);a.addEventListener("message",function(f){null===b||void 0===b?void 0:b(f);c(f)})})}}]);return d}();
Object.defineProperty(T._assistant,"worker",{value:Ba});
var Y=function(){function d(){K(this,d)}O(d,null,[{key:"dereference",value:function(a){Object.keys(a).forEach(function(b){var c=a[b];if(d.isCollection(c))if(d.dereference(c),c instanceof Map)a["delete"](b);else if(c instanceof Set)a["delete"](c);else a[b]=null;else a[b]=null})}},{key:"get",value:function(a,b){b=Array.isArray(b)?b:b.split(".");for(var c=0;c<b.length&&!d.isEmpty(a);c++)a=a[b[c]];return a}},{key:"set",value:function(a,b,c){b=Array.isArray(b)?b:b.split(".");for(var e=0;e<b.length;a=a[b[e]],
e++)d.isEmpty(a[b[e]])&&(a[b[e]]={}),e===b.length-1&&(a instanceof Map?a.set(b[e],c):Object.defineProperty(a,b[e],{value:c,writable:!0,enumerable:!0,configurable:!0}))}},{key:"isEmpty",value:function(a){return null===a||void 0===a}},{key:"isString",value:function(a){return"string"===typeof a||a instanceof String}},{key:"isCollection",value:function(a){var b=[Map,Set,Array,WeakMap,WeakSet,Int8Array,Uint8Array,Int16Array,Int32Array,Uint16Array,Uint32Array,Float32Array,Float64Array,Uint8ClampedArray];
return!d.isEmpty(a)&&(d.isOnlyObject(a)||b.includes(a.constructor))}},{key:"isOnlyObject",value:function(a){return a&&(a.constructor===Object||void 0===a.constructor)}},{key:"getKeyByValue",value:function(a,b){a=Object.entries(a);for(var c=0;c<a.length;c++)if(a[c][1]===b)return a[c][0];return null}},{key:"deepCopy",value:function(a){var b,c;if(d.isEmpty(a))return a;var e=null!==(b=null===(c=a.constructor)||void 0===c?void 0:c.call(a))&&void 0!==b?b:Object.create(null);b=[e];c=[[Object.keys(a),Object.values(a)]];
do{a=b.shift();var f=c.shift();var g=J(f);f=g[0];var h=g[1];for(var k=0;k<f.length;k++){g=f[k];var l=h[k];if(d.isCollection(l)){var n,r,q;a[g]=null!==(n=null===(r=(q=l).constructor)||void 0===r?void 0:r.call(q))&&void 0!==n?n:Object.create(null);c.push([Object.keys(l),Object.values(l)]);b.push(a[g])}else a[g]=l}}while(0<c.length);return e}},{key:"merge",value:function(a,b){var c,e;if(d.isEmpty(a))return b;if(d.isEmpty(b))return a;var f=null!==(c=null===(e=b.constructor)||void 0===e?void 0:e.call(b))&&
void 0!==c?c:Object.create(null);c=[f];b=[[[Object.keys(a),Object.values(a)],[Object.keys(b),Object.values(b)]]];do{a=c.shift();e=b.shift();var g=J(e);var h=J(g[0]);e=h[0];h=h[1];var k=J(g[1]);g=k[0];var l=k[1];g=R(new Set(g.concat(e)));for(var n=0;n<g.length;n++){var r=[g[n],l[n]];k=r[0];var q=r[1];r=h[e.indexOf(k)];var u=d.isEmpty(r);if((d.isEmpty(r)||d.isCollection(r))&&d.isCollection(q)){var v,t,w=[];a[k]=null!==(v=null===(t=u?q.constructor:r.constructor)||void 0===t?void 0:t())&&void 0!==v?v:
Object.create(null);w[1]=[Object.keys(q),Object.values(q)];w[0]=u?[[],[]]:[Object.keys(r),Object.values(r)];c.push(a[k]);b.push(w)}else!d.isCollection(r)&&d.isCollection(q)?a[k]=r:Object.defineProperty(a,k,{writable:!0,enumerable:!0,value:u?q:r})}}while(0<b.length);return f}}]);return d}();Object.defineProperty(T._assistant,"object",{value:Y});
var Ca=function(){function d(){K(this,d)}O(d,null,[{key:"multiply",value:function(a,b){var c,e;a=a.toString();b=b.toString();var f=null!==(c=null===(e=b.split(".")[1])||void 0===e?void 0:e.length)&&void 0!==c?c:0;c=Math.pow(10,f);return Number(a.replace(".",""))*Number(b.replace(".",""))/c}},{key:"divide",value:function(a,b){var c,e,f,g;var h=Math.pow(10,Math.max(null!==(c=null===(e=a.toString().split(".")[1])||void 0===e?void 0:e.length)&&void 0!==c?c:0,null!==(f=null===(g=b.toString().split(".")[1])||
void 0===g?void 0:g.length)&&void 0!==f?f:0));return a*h/(b*h)}},{key:"getMedian",value:function(a){a=a.map(function(c){return c}).sort(function(c,e){return c-e});if(1===a.length%2){var b=window.parseInt(a.length/2);a=a[b]}else b=window.parseInt(a.length/2),a=(a[b-1]+a[b])/2;return a}},{key:"getMode",value:function(a){var b,c;var e=0;var f=[];var g=new Map;a.forEach(function(h){var k;c=null!==(k=g.get(h))&&void 0!==k?k:0;g.set(h,c+1)});e=(b=Math).max.apply(b,R(g.values()));g.forEach(function(h,k){h===
e&&f.push(k)});return f}},{key:"isFloat",value:function(a){var b;if(window.isNaN(b=window.parseFloat(a))||Math.floor(b)==b)return!1;if(a.endsWith("%")){if(100<b)return!1}else if(a.endsWith("\u2030")){if(1E3<b)return!1}else return!1;return!0}},{key:"getMinLegalSize",value:function(a,b){var c=[];var e=a[0]/a[1];var f=1>e?0:1;var g=Number(!f);a[f]<b[f]?(c[f]=b[f],c[g]=0===f?b[f]/e:b[f]*e):c=a;return c}},{key:"getMaxLegalSize",value:function(a,b){if(!a||!b||a[0]<=b[0]&&a[1]<=b[1])return a;var c=[];var e=
a[0]/a[1];var f=1<=b[0]/b[1]?1:0;var g=Number(!f);a[f]>b[f]?(c[f]=b[f],c[g]=0===f?b[f]/e:b[f]*e):c=a;return c}},{key:"intervalJudgment",value:function(a,b){b=b.replace(/ /g,"").toLowerCase();var c={"(":">",")":"<","[":">=","]":"<="};var e=b[0];var f=b.slice(-1);var g=Object.keys(c);b=b.slice(1,-1).split(",");b[0]=Number(b[0]);b[1]=Number(b[1]);return g.includes(e)||g.includes(f)?(new Function('"use strict"; return '+(a+c[e]+b[0]+"&&"+a+c[f]+b[1])))():!1}},{key:"insideRect",value:function(a,b){var c=
b[0];b=b[1];return a[0]<c[0]||a[1]<c[1]||a[0]>b[0]||a[1]>b[1]?!1:!0}}]);return d}();window.math&&(Ca=Object.assign(Ca,window.math));Object.defineProperty(T._assistant,"number",{value:Ca});
var Da=function(){function d(){K(this,d)}O(d,null,[{key:"base64Encode",value:function(a){return window.btoa(window.unescape(window.encodeURIComponent(a)))}},{key:"base64Decode",value:function(a){return window.decodeURIComponent(window.escape(window.atob(a)))}},{key:"ucfirst",value:function(a){return a[0].toUpperCase()+a.substring(1)}},{key:"replace",value:function(a,b,c){var e,f,g,h,k,l=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,n,r;b=Array.isArray(b)?b:[b];c=Array.isArray(c)?c:[c];
Array.isArray(a)?n=!0:(a=[a],n=!1);if(1<c.length&&b.length!==c.length)throw Error("The number of search strings does not match the number of replacement strings.");var q=[];for(k=0;k<a.length;k++){q[k]="";var u=a[k];for(r=e=g=h=0;g<b.length;g++,h+=1<c.length?1:0){var v=[];var t=b[g];var w=c[h];for(f=0;0<=f&&(0===l||0<l&&r<l);)f=u.indexOf(t,0===f&&0===r?0:f+1),r+=0<=f?1:0,v.push(f);-1!==v[v.length-1]&&v.push(-1);for(var y=0;0<v.length;y++)f=v.shift(),q[k]+=0<=f?u.substring(e,f)+w:u.substring(e),e=
f+t.length;e=0;u=q[k];q[k]=""}q[k]=u}return n?q:q.shift()}},{key:"colorConvert",value:function(a){a=a.toLowerCase();var b=Error("Not a legal color.");if(0===a.indexOf("#")){var c="rgba(";a=a.substring(1);3===a.length&&(a=a.split("").reduce(function(f,g){return f+g+g},""));if(6===a.length)for(b=0;3>b;b++)c+=Number("0x"+a[2*b]+a[2*b+1])+", ";else throw b;c+="255)"}else if(0===a.indexOf("rgb")){c="#";a=a.replace(/(rgb\(|rgba\(|\)| )/g,"").split(",");for(var e=0;3>e;e++)b=Number(a[e]).toString(16),c+=
1===b.length?b+b:b}else throw b;return c}}]);return d}();Object.defineProperty(T._assistant,"string",{value:Da});
var Ea=function(){function d(){K(this,d)}O(d,null,[{key:"isOverflow",value:function(a,b){a=a.getBoundingClientRect();b=b?b.getBoundingClientRect():{x:0,y:0,width:window.innerWidth,height:window.innerHeight};return a.x<b.x||a.x+a.width>b.x+b.width||a.y<b.y||a.y+a.height>b.y+b.height?!0:!1}},{key:"getAllElement",value:function(a){var b=[];a=a.children;if(0!==a.length)for(var c=0;c<a.length;c++)b.push(a[c]),b=b.concat(d.getAllElement(a[c]));return b}},{key:"getNodeHeight",value:function(a){return a.offsetTop+
a.offsetHeight+parseInt(getComputedStyle(a,1<arguments.length&&void 0!==arguments[1]?arguments[1]:null).marginBottom)}},{key:"getBeforeElementHeight",value:function(a){var b;for(b=0;(a=a.previousElementSibling)&&!["absolute","fixed"].includes(getComputedStyle(a,null).position);)b+=a.offsetHeight;return b}},{key:"getNodeOriginalSize",value:function(a){var b=[0,0];d.getAllElement(a).forEach(function(c){"absolute"!=getComputedStyle(c,null).position&&(b[0]=c.offsetWidth>b[0]?c.offsetWidth:b[0],c.parentNode===
a&&(b[1]+=c.offsetHeight))});return b}},{key:"maxZIndex",value:function(a){var b;a?b=d.a(a):b=Array.from(document.all);return parseInt(b.reduce(function(c,e){e=getComputedStyle(e,null).zIndex;return Math.max(c,isNaN(e)?0:e)},0))}},{key:"objectToNode",value:function(a){var b={},c;for(c in a){var e=document.createElement(a[c].nodeType);if("undefined"!=typeof a[c].nodeType){for(var f in a[c])if("nodeType"!=f)if("innerhtml"==f.toLocaleLowerCase()){var g=d.objectToNode(a[c][f]),h;for(h in g)e.insertAdjacentElement("beforeend",
g[h])}else"innertext"==f.toLocaleLowerCase()?e.insertAdjacentText("beforeend",a[c][f]):e.setAttribute(f,a[c][f]);b[c]=e}}return b}},{key:"launchFullscreen",value:function(a){return a.requestFullscreen(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{navigationUI:"show"})}},{key:"exitFullscreen",value:function(){document.exitFullscreen()}},{key:"getFullscreenNode",value:function(){return document.fullscreenElement}},{key:"createScript",value:function(a){var b=document.createElement("script");
"src type async defer charset innerHTML".split(" ").forEach(function(c){a[c]&&(b[c]=a[c])});return b}}]);return d}();Object.defineProperty(T._assistant,"element",{value:Ea});
var Fa=function(){function d(){K(this,d)}O(d,null,[{key:"getDistribution",value:function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:2,e,f;if(1===c&&Array.isArray(a))throw Error("One-dimensional operation position value cannot be an array");if(2===c&&!Array.isArray(a))throw Error("Two-dimensional operation position value must be an array");(f=Z.get("gaussian",d))||(f=new Map,Z.set("gaussian",f,d));(e=f.get(b))||(e=Object.create(null),e.square=b*b,e.multiplier=[1/(b*Math.sqrt(2*
Math.PI)),1/(2*Math.PI*e.square)],f.set(b,e));switch(c){case 1:var g=Math.exp(-(a*a)/(2*e.square));break;case 2:g=Math.exp(-(Math.pow(a[0],2)+Math.pow(a[1],2))/(2*e.square))}return e.multiplier[c-1]*g}}]);return d}();Object.defineProperty(T._assistant,"formula",{value:Fa});
var Ga=function(){function d(){K(this,d)}O(d,null,[{key:"getStorage",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];if(!d._achieve[a])throw Error("The specified storage ".concat(a," was not found."));return ta(d._achieve[a],R(b))}}]);return d}();P(Ga,"_achieve",Object.create(null));Object.defineProperty(T._assistant,"storage",{value:Ga});
var Ha=function(){function d(){K(this,d)}O(d,null,[{key:"drawText",value:function(a,b){b=Y.o(b,{text:null,fill:!0,color:"black",direction:"ltr",textAlign:"center",textBaseline:"middle",font:"normal 16px Microsoft YaHei, serif",point:[a.canvas.width/2,a.canvas.height/2]});b.text&&(a.save(),a.font=b.font,a.fillStyle=b.color,a.direction=b.direction,a.textAlign=b.textAlign,a.textBaseline=b.textBaseline,b.point[1]+=a.measureText(b.text).G/2,!0===b.fill?a.fillText.apply(a,[b.text].concat(R(b.point),[b.maxWidth])):
a.strokeText.apply(a,[b.text].concat(R(b.point),[b.maxWidth])),a.restore())}},{key:"drawRound",value:function(a,b){b=Y.o(b,{step:[],radius:5,fill:!0,borderWidth:5,borderColor:"black",fillColor:"transparent",point:[a.canvas.width/2,a.canvas.height/2]});a.save();a.fillStyle=b.fillColor;a.lineWidth=b.borderWidth;a.strokeStyle=b.borderColor;a.beginPath();a.setLineDash(b.step);a.arc.apply(a,R(b.point).concat([b.radius,0,2*Math.PI]));a.stroke();!0===b.fill&&a.fill();a.restore()}},{key:"drawRect",value:function(a){var b=
1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,e=3<arguments.length?arguments[3]:void 0,f=4<arguments.length?arguments[4]:void 0,g=5<arguments.length&&void 0!==arguments[5]?arguments[5]:1,h=6<arguments.length&&void 0!==arguments[6]?arguments[6]:"white",k=7<arguments.length&&void 0!==arguments[7]?arguments[7]:!1;a.save();a.lineWidth=g;Array.isArray(k)?(a.strokeStyle=h,a.setLineDash(k),a.strokeRect(b,c,e,f)):(a.fillStyle=h,a.fillRect(b,
c,e,f));a.restore()}},{key:"drawLBorder",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,e=3<arguments.length?arguments[3]:void 0,f=4<arguments.length?arguments[4]:void 0,g=5<arguments.length&&void 0!==arguments[5]?arguments[5]:25,h=6<arguments.length&&void 0!==arguments[6]?arguments[6]:5,k=7<arguments.length&&void 0!==arguments[7]?arguments[7]:"#0eb0f1",l=8<arguments.length&&void 0!==arguments[8]?arguments[8]:
!1;a.save();Array.isArray(l)?a.strokeStyle=k:(a.fillStyle=k,a.fillRect(b,c,g,h),a.fillRect(b,c,h,g),a.fillRect(b+e,c,-g,h),a.fillRect(b+e,c,-h,g),a.fillRect(b+e,c+f,-g,-h),a.fillRect(b+e,c+f,-h,-g),a.fillRect(b,c+f,g,-h),a.fillRect(b,c+f,h,-g));a.restore()}},{key:"drawGrid",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,e=3<arguments.length?arguments[3]:void 0,f=4<arguments.length?arguments[4]:void 0,g=5<
arguments.length&&void 0!==arguments[5]?arguments[5]:1,h=6<arguments.length&&void 0!==arguments[6]?arguments[6]:"black",k=7<arguments.length&&void 0!==arguments[7]?arguments[7]:"quarter",l=8<arguments.length&&void 0!==arguments[8]?arguments[8]:!1;if(d["drawGrid"+Da.ucfirst(k)]instanceof Function)d["drawGrid"+Da.ucfirst(k)](a,b,c,null!==e&&void 0!==e?e:a.canvas.width,null!==f&&void 0!==f?f:a.canvas.height,g,h,l);else throw Error(k+" grid not detected");}},{key:"drawGridQuarter",value:function(a){var b=
1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,e=3<arguments.length?arguments[3]:void 0,f=4<arguments.length?arguments[4]:void 0,g=5<arguments.length&&void 0!==arguments[5]?arguments[5]:1,h=6<arguments.length&&void 0!==arguments[6]?arguments[6]:"black",k=7<arguments.length&&void 0!==arguments[7]?arguments[7]:!1;var l=[Ca.divide(e,4),Ca.divide(f,4)];a.save();a.beginPath();a.lineWidth=g;a.strokeStyle=h;Array.isArray(k)&&a.setLineDash(k);
for(g=1;4>g;g++)a.moveTo(l[0]*g+b,c),a.lineTo(l[0]*g+b,c+f),a.moveTo(b,l[1]*g+c),a.lineTo(b+e,l[1]*g+c);a.stroke();a.restore()}},{key:"layerMerge",value:function(a,b,c,e,f){var g=5<arguments.length&&void 0!==arguments[5]?arguments[5]:"source-over",h;(h=Z.get("mergeCas",d))||(h=new OffscreenCanvas(a.canvas.width,a.canvas.height),Z.set("mergeCas",h,d));var k=h.getContext("2d");k.save();k.drawImage.apply(k,[b].concat(R(c)));k.globalCompositeOperation=g;k.drawImage.apply(k,[e].concat(R(f)));a.clearRect(0,
0,a.canvas.width,a.canvas.height);a.drawImage(h,0,0);k.restore();k.clearRect(0,0,h.width,h.height)}},{key:"download",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"canvas",c=2<arguments.length?arguments[2]:void 0;if(Z.has("downloadNode",d))var e=Z.get("downloadNode",d);else e=document.createElement("a"),Z.set("downloadNode",e,d);e.download=b;e.href=a.toDataURL(c);e.click()}}]);return d}();Object.defineProperty(T._assistant,"canvas",{value:Ha});
var Ia=function(){function d(){K(this,d)}O(d,null,[{key:"getImagedata",value:function(a){if(a instanceof Image){var b=document.createElement("canvas");var c=b.getContext("2d");c.drawImage(a,0,0);a=c.getImageData(0,0,b.width,b.height)}else if(!(a instanceof ImageData))throw Error("can not parse image");return a}},{key:"grayscale",value:function(a){try{var b=d.getImagedata(a);var c=b.width*b.height*4;var e=new Uint8ClampedArray(b.data.length);for(a=0;a<c;a+=4){var f=b.data[a];var g=b.data[a+1];var h=
b.data[a+2];var k=b.data[a+3];var l=.299*f+.587*g+.114*h;e[a]=l;e[a+1]=l;e[a+2]=l;e[a+3]=k}}catch(n){throw n;}return new ImageData(e,b.width,b.height)}},{key:"gaussianBlur",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:3,c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,e,f,g,h,k,l,n;try{var r=d.getImagedata(a);var q=r.width;var u=r.height;var v=0;(f=Z.get("gaussianMask",d))||(f=new Map,Z.set("gaussianMask",f,d));if(!(e=f.get("".concat(b,",").concat(c)))){e=
[];for(n=-b;n<=b;n++){var t=Fa.getDistribution(n,c,1);e.push(t);v+=t}for(t=0;t<e.length;t++)e[t]/=v;f.set("".concat(b,",").concat(c),e)}var w=new Uint8ClampedArray(r.data.length);for(l=0;l<u;l++)for(k=0;k<q;k++){var y=g=h=v=0;var p=4*(l*q+k);for(c=-b;c<=b;c++){var A=k+c;n=c+b;if(0<=A&&A<q){var I=4*(l*q+A);y+=r.data[I]*e[n];g+=r.data[I+1]*e[n];h+=r.data[I+2]*e[n];v+=e[n]}}w[p]=y/v;w[p+1]=g/v;w[p+2]=h/v;w[p+3]=r.data[p+3]}for(k=0;k<q;k++)for(l=0;l<u;l++){y=g=h=v=0;p=4*(l*q+k);for(r=-b;r<=b;r++)A=l+
r,n=r+b,0<=A&&A<u&&(I=4*(A*q+k),y+=w[I]*e[n],g+=w[I+1]*e[n],h+=w[I+2]*e[n],v+=e[n]);w[p]=y/v;w[p+1]=g/v;w[p+2]=h/v}}catch(Q){throw Q;}return new ImageData(w,q,u)}},{key:"mirror",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,c,e;try{var f=d.getImagedata(a);var g=f.width;var h=f.height;var k=new Uint8ClampedArray(f.data.length);for(e=0;e<h;e++)for(c=0;c<g;c++){var l=4*(e*g+c);if(0==b)var n=4*(e*g+g-c);else if(1==b)n=4*((h-e)*g+c);else throw Error("not give axis");
k[l]=f.data[n];k[l+1]=f.data[n+1];k[l+2]=f.data[n+2];k[l+3]=f.data[n+3];k[n]=f.data[l];k[n+1]=f.data[l+1];k[n+2]=f.data[l+2];k[n+3]=f.data[l+3]}}catch(r){throw r;}return new ImageData(k,g,h)}}]);return d}();P(Ia,"__gaussianMask",{});Object.defineProperty(T._assistant,"canvasFilter",{value:Ia});
var Ja=function(){function d(){K(this,d)}O(d,null,[{key:"loadFailedFade",value:function(a,b){var c,e,f,g;if(!(a instanceof CanvasRenderingContext2D))throw Error('Requires a value of type "CanvasRenderingContext2D"');Y.isEmpty(b)&&(b=Object.create(null));var h="animation-loadFailedFade-"+Date.now()+"-"+performance.now()+(b.sign?"-"+b.sign:"");b=Y.o(b,{duration:4,speed:null,icon:{size:72,"char":["!","?"],color:"rgba(220, 53, 69)",font:"bold 72px Microsoft YaHei, serif"},text:{size:16,color:"black",
text:"Load Failed",font:"normal 16px Microsoft YaHei, serif"},round:{step:[5],radius:48,fill:!1,borderWidth:5,fillColor:"#ddd",borderColor:"#ddd"}});var k=JSON.stringify(b.icon);var l=JSON.stringify(b.text);var n=JSON.stringify(b.round);b.speed=null!==(c=b.speed)&&void 0!==c?c:b.duration/(2*b.icon["char"].length);(c=Z.get("loadFailedFade",d))||(c=new Map,Z.set("loadFailedFade",c,d));if(!(f=c.get(k))){f=[];for(var r=0;r<b.icon["char"].length;r++){f[r]=new OffscreenCanvas(b.icon.size,b.icon.size);var q=
f[r].getContext("2d");b.icon.text=b.icon["char"][r];Ha.drawText(q,b.icon)}c.set(k,f)}(g=c.get(l))||(g=new OffscreenCanvas(b.text.size*b.text.text.length,2*b.text.size),k=g.getContext("2d"),Ha.drawText(k,b.text),c.set(l,g));(l=c.get(n))||(l=k=2*(b.round.radius+b.round.borderWidth),l=new OffscreenCanvas(l,k),k=l.getContext("2d"),Ha.drawRound(k,b.round),c.set(n,l));var u=1;var v=e=0;var t=[a.canvas.width/2,a.canvas.height/2];c=[l.width/2,(l.height+g.height)/2];n=[g.width/2,(l.height-g.height)/2];var w=
1/(b.duration/f.length/2*1E3/(1E3/60));var y=function(){var p=w*u,A=Number(a.canvas.getAttribute(h)),I=[f[v].width/2,(f[v].height+g.height)/2];void 0!==A&&0!==A&&(a.clearRect(t[0]-I[0],t[1]-I[1],f[v].width,f[v].height),1<e+p?(e=1,u=-u):0>e+p?(e=0,u=-u,v=v+1<f.length?v+1:0):e+=p,a.globalAlpha=e,a.drawImage(f[v],t[0]-I[0],t[1]-I[1]),window.requestAnimationFrame(y))};a.globalAlpha=1;a.drawImage(l,t[0]-c[0],t[1]-c[1]);a.drawImage(g,t[0]-n[0],t[1]+n[1]);a.canvas.setAttribute(h,1);window.requestAnimationFrame(y);
return h}}]);return d}();Object.defineProperty(T._assistant,"canvasAnimation",{value:Ja});
var Ka=function(d){function a(){K(this,a);return b.apply(this,arguments)}G(a,d);var b=H(a);O(a,[{key:"initOption",value:function(c){E(F(a.prototype),"initOption",this).call(this,c);this.option.layer=T._assistant.object.merge(this.option.layer,T._option.page)}},{key:"linkageOption",value:function(){E(F(a.prototype),"linkageOption",this).call(this);null!==this.option.layer.src&&null!==this.option.layer.srcdoc&&(this.option.layer.srcdoc=null)}},{key:"initStruct",value:function(){E(F(a.prototype),"initStruct",
this).call(this);var c=this.variable.struct._build.container;var e=this.variable.struct._backup.title=T._struct.title;var f=this.variable.struct._backup.action=T._struct.action;var g=this.variable.struct._backup.content=T._struct.content;var h=this.variable.struct._backup.content_page=T._struct.content_page;var k=this.variable.struct._backup.action_button=T._struct.action_button;f.innerHTML.push(k.minimize,k.expand,k.close);e.innerHTML.push(f);!1!==this.option.title&&c.innerHTML.push(e);g.innerHTML.push(h);
c.innerHTML.push(g);this.option.resize.enable&&(h=this.variable.struct._backup.resize_box=T._struct.resize_box,c.innerHTML.push(h));this.option.progress.enable&&(h=this.variable.struct._backup.progress_bar=T._struct.progress_bar,c.innerHTML.push(h))}},{key:"initNode",value:function(){var c=this;E(F(a.prototype),"initNode",this).call(this);var e=this.variable.nodes.container.querySelector(".modal-layer-page-content");var f="display: block; width: "+this.option.layer.area[0]+"px; height: "+this.option.layer.area[1]+
"px";Object.keys(this.option.layer).forEach(function(h){T._assistant.object.isEmpty(c.option.layer[h])||("name"===h?e.setAttribute("name",c.option.layer.name+c.option.index):e.setAttribute(h,c.option.layer[h]))});e.style=f;this.variable.animationName.minimize_queue_transition_scale="transition-scale-50-50-animation";if(!T._assistant.css.hasCss("transition-scale-50-50-animation")){var g={from:"transform: scale(0.5, 0.5)",to:"transform: scale(1, 1)"};f=T._assistant.css.createAnimation("transition-scale-50-50-animation",
g);T._assistant.css.addCss("transition-scale-50-50-animation",f);T._assistant.css.addCss("transition-scale-50-50-animation-reverse",T._assistant.css.createAnimation("transition-scale-50-50-animation-reverse",{from:g.to,to:g.from}))}}},{key:"resize",value:function(){var c=0;var e=this.variable.nodes.container;var f=e.children;var g=e.querySelector("iframe[name="+this.option.layer.name+this.option.index+"]");g=g.offsetWidth+2*g.parentNode.offsetLeft;for(var h=0;h<f.length;h++)c="absolute"==getComputedStyle(f[h],
null).position?c:Math.max(T._assistant.element.getNodeHeight(f[h]),c);e.style.width=g+"px";e.style.height=c+"px";this.variable.defaultRect.width=g;this.variable.defaultRect.height=c;this.variable.defaultArea=[g,c]}}]);return a}(T);T._achieve.set("page",Ka);
var La=function(d){function a(){K(this,a);return b.apply(this,arguments)}G(a,d);var b=H(a);O(a,[{key:"initStruct",value:function(){E(F(a.prototype),"initStruct",this).call(this);var c=this.variable.struct._build.container;var e=this.variable.struct._backup.title=T._struct.title;var f=this.variable.struct._backup.action=T._struct.action;var g=this.variable.struct._backup.content=T._struct.content;var h=this.variable.struct._backup.interaction=T._struct.interaction;var k=this.variable.struct._backup.action_button=
T._struct.action_button;var l=this.variable.struct._backup.interaction_button=T._struct.interaction_button;f.innerHTML.push(k.close);e.innerHTML.push(f);!1!==this.option.title&&c.innerHTML.push(e);c.innerHTML.push(g);this.option.resize.enable&&(f=this.variable.struct._backup.resize_box=T._struct.resize_box,c.innerHTML.push(f));this.option.progress.enable&&(f=this.variable.struct._backup.progress_bar=T._struct.progress_bar,c.innerHTML.push(f));h.innerHTML.push(l.ok);c.innerHTML.push(h)}},{key:"initNode",
value:function(){E(F(a.prototype),"initNode",this).call(this);var c=this.variable.nodes.container.querySelector(".modal-layer-content");if(Array.isArray(this.option.content.value)){var e=T._assistant.element.objectToNode(this.option.content.value);Object.keys(e).forEach(function(f){c.appendChild(e[f])})}else c.innerHTML=this.option.content.value}}]);return a}(T);T._achieve.set("alert",La);
var Na=function(d){function a(){K(this,a);return b.apply(this,arguments)}G(a,d);var b=H(a);O(a,[{key:"initOption",value:function(c){var e=this,f;E(F(a.prototype),"initOption",this).call(this,c);this.option.layer=T._assistant.object.merge(this.option.layer,T._option.image);var g=[window.innerWidth,window.innerHeight];Object.values(this.option.layer.sizeRange).forEach(function(h){h.forEach(function(k,l){if((""+k).endsWith("%"))f=100;else if((""+k).endsWith("\u2030"))f=1E3;else if((""+k).includes("0."))f=
1;else return k;h[l]=g[l]*window.parseFloat(k)/f})});this.option.layer.sizeRange.min[0]>this.option.layer.sizeRange.max[0]&&(this.option.layer.sizeRange.min[0]=this.option.layer.sizeRange.max[0]);this.option.layer.sizeRange.min[1]>this.option.layer.sizeRange.max[1]&&(this.option.layer.sizeRange.min[1]=this.option.layer.sizeRange.max[1]);Object.keys(this.option.layer.toolbar.config).forEach(function(h,k){k=e.option.layer.toolbar.config[h];"boolean"==typeof k&&(e.option.layer.toolbar.config[h]={enable:k,
title:T._option.image.toolbar.config[h].title,icon:T._option.image.toolbar.config[h].icon});T._assistant.object.isOnlyObject(k.config)?Object.keys(k.config).forEach(function(l,n){n=k.config[l];"boolean"==typeof n&&(e.option.layer.toolbar.config[h].config[l]={enable:n,title:T._option.image.toolbar.config[h].config[l].title,icon:T._option.image.toolbar.config[h].config[l].icon})}):T._option.image.toolbar.config[h].config&&(e.option.layer.toolbar.config[h].config=JSON.parse(JSON.stringify(T._option.image.toolbar.config[h].config)))})}},
{key:"compatibleOption",value:function(c){var e,f;E(F(a.prototype),"compatibleOption",this).call(this,c);var g=T._assistant.object.get(c,"layer.image");g instanceof FileList&&(c.layer.image=Object.values(g));Array.isArray(c.layer.image)||(c.layer.image=[c.layer.image]);var h=null!==(e=T._assistant.object.get(c,"layer.toolbar.config"))&&void 0!==e?e:[];Object.keys(h).forEach(function(l){h[l]="boolean"===typeof h[l]?{enable:h[l]}:h[l]});var k=null!==(f=T._assistant.object.get(c,"layer.toolbar.config.filter.config"))&&
void 0!==f?f:[];Object.keys(k).forEach(function(l){k[l]="boolean"===typeof k[l]?{enable:k[l]}:k[l]})}},{key:"linkageOption",value:function(){var c;E(F(a.prototype),"linkageOption",this).call(this);var e=c=!1;var f=Object.entries(this.option.layer.toolbar.config);var g=Object.entries(this.option.layer.toolbar.config.filter.config);for(var h=0;h<g.length;h++)if(!0===g[h][1].enable){c=!0;break}this.option.layer.toolbar.config.filter.enable=c;for(c=0;c<f.length;c++)if(!0===f[c][1].enable){e=!0;break}this.option.layer.toolbar.enable=
e;!1===this.option.layer.toolbar.config.crop.enable&&(this.option.layer.toolbar.config.crop.grid=!1)}},{key:"checkOption",value:function(){E(F(a.prototype),"checkOption",this).call(this);if(T._assistant.object.isEmpty(this.option.layer.image))throw Error("layer.image can not be empty!");if(this.option.layer.size&&!Array.isArray(this.option.layer.size))throw Error("layer.size does not meet expectations.");if(!this.option.layer.size&&(window.isNaN(parseInt(this.option.layer.sizeRange.min[0]))||window.isNaN(parseInt(this.option.layer.sizeRange.min[1]))||
window.isNaN(parseInt(this.option.layer.sizeRange.max[0]))||window.isNaN(parseInt(this.option.layer.sizeRange.max[1]))))throw Error("layer.sizeRange does not meet expectations.");}},{key:"initVariable",value:function(){E(F(a.prototype),"initVariable",this).call(this);this.variable.image={spin:{scale:1,angle:90},"default":{size:null,imageData:null},reload:0,link:null,history:[],finish:null,status:T._enum.LOAD_STATUS.LOADING}}},{key:"initStruct",value:function(){var c=this;E(F(a.prototype),"initStruct",
this).call(this);var e=this.variable.struct._build.container;var f=this.variable.struct._backup.title=T._struct.title;var g=this.variable.struct._backup.action=T._struct.action;var h=this.variable.struct._backup.toolbar=T._struct.toolbar;var k=this.variable.struct._backup.tools=T._struct.image_tools;var l=this.variable.struct._backup.content=T._struct.content;var n=this.variable.struct._backup.action_button=T._struct.action_button;var r=this.variable.struct._backup.content_image=T._struct.content_image;
var q=this.variable.struct._backup.image_tools_child=T._struct.image_tools_child;g.innerHTML.push(n.close);f.innerHTML.push(g);!1!==this.option.title&&e.innerHTML.push(f);Object.keys(this.option.layer.toolbar.config).forEach(function(u){c.option.layer.toolbar.config[u].enable&&h.innerHTML.push(k[u]);c.option.layer.toolbar.config[u].config instanceof Object&&c.option.layer.toolbar.config[u].enable&&Object.keys(c.option.layer.toolbar.config[u].config).forEach(function(v){k[u].innerHTML[1].innerHTML.push(q[u][v])})});
this.option.layer.toolbar.enable&&e.innerHTML.push(h);l.innerHTML.push(r);e.innerHTML.push(l);this.option.resize.enable&&(g=this.variable.struct._backup.resize_box=T._struct.resize_box,e.innerHTML.push(g));this.option.progress.enable&&(g=this.variable.struct._backup.progress_bar=T._struct.progress_bar,e.innerHTML.push(g))}},{key:"initNode",value:function(){var c=this;E(F(a.prototype),"initNode",this).call(this);var e=this.variable.nodes.container.querySelector(".modal-layer-toolbar");this.option.layer.toolbar.enable&&
Object.keys(this.option.layer.toolbar.config).forEach(function(f,g){g=c.option.layer.toolbar.config[f];if(g.enable){var h;var k=e.querySelector('.modal-layer-toolbar-item[tool-type="'+f+'"]');var l=k.querySelector(".modal-layer-toolbar-item-icon");k.setAttribute("title",g.title);(h=l.classList).add.apply(h,R(g.icon.split(" ")));g.config instanceof Object&&Object.entries(g.config).forEach(function(n,r){r=n[0];n=n[1];if(n.enable){var q=k.querySelector(".modal-layer-toolbar-item-child-list");r=k.querySelector(".modal-layer-toolbar-"+
f+"-icon["+f+'-type="'+r+'"]');q.setAttribute("title",n.title);n.icon?r.classList.add(n.icon):r.innerText=n.textIcon}})}});this.variable.image.finish=this.load().then(function(f){return c.loaded(f)})["catch"](function(){return c.failed()})}},{key:"bindEvent",value:function(){var c=this;E(F(a.prototype),"bindEvent",this).call(this);var e={once:!1,capture:!1,passive:!1,mozSystemGroup:!1};var f=this.variable.nodes.container;var g=T._assistant.object.getKeyByValue(T._enum.LOAD_STATUS,T._enum.LOAD_STATUS.FAILED);
this.variable.eventSymbol.imageReload=T._assistant.event.add(f,"click",'.modal-layer-image-canvas[load-status="'+g+'"]',this.reload,this,null,e);Object.keys(this.event.imageTools).forEach(function(h){c.event.imageTools[h]&&c.event.imageTools[h]instanceof Function&&(c.variable.eventSymbol["imageTool".concat(h)]=T._assistant.event.add(f,"click",'.modal-layer-toolbar-item[tool-type="'.concat(h,'"]'),c.event.imageTools[h],c,null,e))})}},{key:"resize",value:function(){var c,e;var f=this.variable.nodes.container;
var g=f.querySelector(".modal-layer-content");var h=g.querySelector(".modal-layer-image-canvas").getBoundingClientRect();var k=f.querySelector(".modal-layer-toolbar");var l=k.getBoundingClientRect().height;var n=window.getComputedStyle(g,null);var r=T._assistant.element.getBeforeElementHeight(g);g=g.offsetTop-r;r+=this.option.content.fullContainer?0:2*g;this.option.layer.size?e=R(this.option.layer.size):this.variable.image.status!==T._enum.LOAD_STATUS.LOADING?e=[h.width,h.height]:e=R(this.option.layer.sizeRange.min);
e[0]+=parseFloat(n.marginLeft)+parseFloat(n.marginRight);e[1]+=r;f.style.width=e[0]+"px";this.option.layer.toolbar.enable&&(h=k.getBoundingClientRect().height,e[1]=e[1]-l+h);f.style.height=e[1]+"px";this.variable.defaultArea=e;this.variable.defaultRect.width=e[0];this.variable.defaultRect.height=e[1];!this.option.drag.overflow&&T._assistant.element.isOverflow(f,null!==(c=this.option.window)&&void 0!==c?c:document.body)&&(f.style.cssText+="margin-top: auto; margin-left: auto")}},{key:"load",value:function(){var c=
this,e=this.variable.nodes.container.querySelector(".modal-layer-image-canvas");this.variable.image.status=T._enum.LOAD_STATUS.LOADING;e.setAttribute("load-status",T._assistant.object.getKeyByValue(T._enum.LOAD_STATUS,T._enum.LOAD_STATUS.LOADING));this.variable.image.fadeAttr&&e.removeAttribute(this.variable.image.fadeAttr);this.variable.image.layer instanceof Ma?this.variable.image.layer.show():this.variable.image.layer=T.loading({mask:!1,popupTime:0,layer:{icon:1,duration:1,color:"deepskyblue"},
window:this.variable.nodes.container.querySelector(".modal-layer-content")},function(f){throw f;});return this.variable.image.finish=new Promise(function(f,g){for(var h=new Image;!c.variable.image.link&&c.variable.image.reload<c.option.layer.image.length;){var k;(null===(k=c.variable.image.link)||void 0===k?0:k.startsWith("blob:"))&&URL.revokeObjectURL(c.variable.image.link);c.variable.image.link=T._assistant.file.getImage(c.option.layer.image[c.variable.image.reload++])}h.onload=function(){return f(h)};
h.onerror=g;h.src=c.variable.image.link})}},{key:"reload",value:function(){var c=this;this.variable.image.finish=this.load().then(function(e){return c.loaded(e)})["catch"](function(){return c.failed()})["finally"](function(){return c.resize()})}},{key:"loaded",value:function(c){var e=this;var f=this.variable.nodes.container.querySelector(".modal-layer-image-canvas");this.variable.image.status=T._enum.LOAD_STATUS.LOADED;this.variable.image["default"].size=this.option.layer.size?this.option.layer.size:
c.naturalWidth>this.option.layer.sizeRange.max[0]||c.naturalHeight>this.option.layer.sizeRange.max[1]?T._assistant.number.getMaxLegalSize([c.naturalWidth,c.naturalHeight],this.option.layer.sizeRange.max):c.naturalWidth<this.option.layer.sizeRange.min[0]||c.naturalHeight<this.option.layer.sizeRange.min[1]?T._assistant.number.getMinLegalSize([c.naturalWidth,c.naturalHeight],this.option.layer.sizeRange.min):[c.naturalWidth,c.naturalHeight];f.width=this.variable.image["default"].size[0];f.height=this.variable.image["default"].size[1];
f.setAttribute("load-status",T._assistant.object.getKeyByValue(T._enum.LOAD_STATUS,T._enum.LOAD_STATUS.LOADED));window.requestAnimationFrame(function(){var g,h;e.variable.image.layer&&e.variable.image.layer instanceof Ma&&e.variable.image.layer.hide();(g=f.getContext("2d")).drawImage.apply(g,[c,0,0,c.width,c.height,0,0].concat(R(e.variable.image["default"].size)));e.variable.image["default"].imageData=(h=f.getContext("2d")).getImageData.apply(h,[0,0].concat(R(e.variable.image["default"].size)))})}},
{key:"failed",value:function(){var c,e;var f=this.variable.nodes.container.querySelector(".modal-layer-image-canvas");this.variable.image.status=T._enum.LOAD_STATUS.FAILED;f.setAttribute("load-status",T._assistant.object.getKeyByValue(T._enum.LOAD_STATUS,T._enum.LOAD_STATUS.FAILED));this.variable.image.reload<this.option.layer.image.length?e={duration:4,sign:"load-failed",icon:{size:72,"char":"!?",color:"rgba(220, 53, 69)",font:"bold 72px Microsoft YaHei, serif"},round:{step:[4],radius:50,borderWidth:5,
borderColor:"rgb(230, 230, 230)"},text:{color:"rgba(220, 53, 69)",text:"\u56fe\u7247\u52a0\u8f7d\u5931\u8d25, \u8bf7\u70b9\u51fb\u91cd\u8bd5",font:"lighter 16px Microsoft YaHei, serif"}}:e={duration:4,sign:"finally-load-failed",icon:{size:80,"char":"\u00d7",font:"bold 80px Microsoft YaHei, serif"},round:{step:[5],radius:50,borderWidth:5,borderColor:"rgb(230, 230, 230)"},text:{color:"rgba(220, 53, 69)",text:"\u56fe\u7247\u52a0\u8f7d\u5931\u8d25, \u8bf7\u8054\u7cfb\u7ba1\u7406\u5458",font:"lighter 16px Microsoft YaHei, serif"}};
this.variable.image.fadeAttr=T._assistant.canvasAnimation.loadFailedFade(f.getContext("2d"),e);(null===(c=this.variable.image.link)||void 0===c?0:c.startsWith("blob:"))&&URL.revokeObjectURL(this.variable.image.link);this.variable.image.link=null;this.variable.image.layer instanceof Ma&&this.variable.image.layer.hide()}},{key:"removeAllEvent",value:function(){var c=this,e=this.variable.nodes.container;E(F(a.prototype),"removeAllEvent",this).call(this);Object.keys(this.event.imageTools).forEach(function(f){c.event.imageTools[f]&&
c.event.imageTools[f]instanceof Function&&e.removeEventListener("click",c.event.imageTools[f])})}},{key:"crop",value:function(){var c=this,e,f;var g=!0;var h=null;var k=[];var l=T._assistant.number.divide(5,2);k[2]=T._assistant.number.multiply(5,2);k[4]=T._assistant.number.multiply(5,4);k[6]=T._assistant.number.multiply(5,6);var n=this.variable.nodes.container.querySelector(".modal-layer-image-canvas");var r=n.width;var q=n.height;var u=T._assistant.number.floor(.1*r);var v=T._assistant.number.floor(.1*
q);var t=n.cloneNode();var w=t.getContext("2d");t.width=window.innerWidth;t.height=window.innerHeight;t.style="display: block; position: fixed; top: 0px; bottom: 0px; left: 0px; right: 0px; visibility: visible; opacity: 1; border: 0px; margin: 0px; z-index: "+T._assistant.element.maxZIndex()+";";var y=[T._assistant.number.chain(t.width).subtract(r).divide(2).round().done(),T._assistant.number.chain(t.height).subtract(q).divide(2).round().done()];var p=[].concat(R(y),[r,q]);var A=function(){var x;
w.save();w.clearRect(0,0,t.width,t.height);w.fillStyle="rgba(0, 0, 0, 0.4)";w.fillRect(0,0,t.width,t.height);w.globalCompositeOperation="destination-out";w.fillStyle="white";w.fillRect.apply(w,R(p));w.globalCompositeOperation="source-over";(x=T._assistant.canvas).drawGrid.apply(x,[w].concat(R(p),[2,"white","quarter"]));T._assistant.canvas.drawRect(w,p[0]-l,p[1]-l,p[2]+5,p[3]+5,5,"white",[0]);T._assistant.canvas.drawLBorder(w,p[0]-k[2],p[1]-k[2],p[2]+k[4],p[3]+k[4],k[6],5,"white");w.globalCompositeOperation=
"destination-over";w.drawImage.apply(w,[n].concat(R(y)));w.restore();g?h=window.requestAnimationFrame(A):window.cancelAnimationFrame(h)};var I=function(){document.removeEventListener("keyup",Q);t.removeEventListener("mousemove",X);t.removeEventListener("dbclick",L);g=!1;t.remove()};var Q=function(x){var D;x=null!==(D=x)&&void 0!==D?D:window.event;switch(x.code){case "Enter":L();x.preventDefault();break;case "Escape":c.show(),I(),x.preventDefault()}};var L=function(x){var D;I();x=null!==(D=x)&&void 0!==
D?D:window.event;x=new OffscreenCanvas(n.width,n.height);x.getContext("2d").drawImage(n,0,0);n.width=p[2];n.height=p[3];n.getContext("2d").drawImage(x,p[0]-y[0],p[1]-y[1],p[2],p[3],0,0,n.width,n.height);c.show().then(function(){return c.resize()})};var X=function(x){var D;x=null!==(D=x)&&void 0!==D?D:window.event;if(e&&1===x.buttons)if("drag"===e)p[0]+x.movementX>y[0]&&p[0]+p[2]+x.movementX<y[0]+r&&(p[0]+=x.movementX),p[1]+x.movementY>y[1]&&p[1]+p[3]+x.movementY<y[1]+q&&(p[1]+=x.movementY);else{if("resize"===
e){D=R(p);f.includes(T._enum.POSITION.WEST)&&(p[0]+=x.movementX,p[2]-=x.movementX);f.includes(T._enum.POSITION.EAST)&&(p[2]+=x.movementX);f.includes(T._enum.POSITION.NORTH)&&(p[1]+=x.movementY,p[3]-=x.movementY);f.includes(T._enum.POSITION.SOUTH)&&(p[3]+=x.movementY);if(p[0]<y[0]||p[0]+p[2]>y[0]+r)p[0]=D[0],p[2]=D[2];if(p[1]<y[1]||p[1]+p[3]>y[1]+q)p[1]=D[1],p[3]=D[3];p[2]<u&&(p[2]=D[2],p[0]+p[2]>y[0]+r&&(p[0]=y[0]+r-p[2]));p[3]<v&&(p[3]=D[3],p[1]+p[3]>y[1]+q&&(p[1]=y[1]+q-p[3]))}}else{x=[x.x,x.y];
var M=[p[0]-k[2],p[1]-k[2],p[2]+k[4],p[3]+k[4]];var N=[p[0]-l,p[1]-l,p[2]+5,p[3]+5];x[0]>N[0]&&x[0]<N[0]+N[2]&&x[1]>N[1]&&x[1]<N[1]+N[3]?(D="move",e="drag"):x[0]>M[0]&&x[0]<M[0]+M[2]&&x[1]>M[1]&&x[1]<M[1]+M[3]?(e="resize",D=f="",x[1]>M[1]&&x[1]<N[1]&&(D=f+=T._enum.POSITION.NORTH),x[1]>N[1]+N[3]&&x[1]<M[1]+M[3]&&(D=f+=T._enum.POSITION.SOUTH),x[0]>M[0]&&x[0]<N[0]&&(D=f+=T._enum.POSITION.WEST),x[0]>N[0]+N[2]&&x[0]<M[0]+M[2]&&(D=f+=T._enum.POSITION.EAST),D+="-resize"):(e=null,D="default");t.style.cssText+=
"cursor: "+D}};this.hide();A();document.addEventListener("keyup",Q);t.addEventListener("mousemove",X);t.addEventListener("dblclick",L);document.body.appendChild(t)}},{key:"spin",value:function(){var c=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:void 0,f,g,h,k;var l=this.variable.nodes.container.querySelector(".modal-layer-image-canvas");var n=l.getContext("2d");var r=new OffscreenCanvas(l.width,l.height);r.getContext("2d").drawImage(l,0,0,l.width,l.height);this.variable.image.finish.then(function(){var q;
e=null!==(q=e)&&void 0!==q?q:c.variable.image.spin.angle;l.style.transform="rotate("+e+"deg)";f=l.getBoundingClientRect();l.style.transform="scale(".concat(c.variable.image.spin.scale,")");c.option.layer.size||c.option.layer.sizeRange.max[0]>=f.width&&c.option.layer.sizeRange.max[1]>=f.height?h=c.variable.image.spin.scale:(k=T._assistant.number.getMaxLegalSize([f.width,f.height],c.option.layer.sizeRange.max),h=k[0]/f.width);l.width=f.width;l.height=f.height;l.style.transform="scale(".concat(h,")");
g=e*Math.PI/180;n.save();n.translate(l.width/2,l.height/2);n.rotate(g);n.drawImage(r,-r.width/2,-r.height/2);n.restore();c.resize()})}},{key:"filter",value:function(c){var e=this,f,g;var h=c.getAttribute("filter-type");var k=this.variable.nodes.container.querySelector(".modal-layer-image-canvas");if(k.getAttribute("load-status")!=T._enum.LOAD_STATUS.FAILED&&h){var l=k.getContext("2d");var n=l.getImageData(0,0,k.width,k.height);var r=this.variable.image.layer.show();if(T._env.feature.Worker){var q=
"image-layer-worker-"+Date.now();var u="!"+T._worker.get("canvasFilter").toString()+"()";u=URL.createObjectURL(new Blob(u.split(""),{type:"text/javascript"}));T._assistant.worker.has(q)||T._assistant.worker.create(q,u);T._assistant.worker.listener(q).then(function(v){0==v.data.error?l.putImageData(new ImageData(new Uint8ClampedArray(v.data.buffer),k.width,k.height),0,0):console.error(Error(v.data.message));r.then(function(){return e.variable.image.layer.hide()});T._assistant.worker.close(q)})}null===
(f=(g={blur:function(){var v,t;var w=null!==(v=Number(c.getAttribute("data-sigma")))&&void 0!==v?v:1;v=null!==(t=Number(c.getAttribute("data-radius")))&&void 0!==t?t:3;if(T._env.feature.worker){var y;if(T._assistant.canvasFilter.__gaussianMask[["".concat(v,",").concat(w)]])var p=T._assistant.canvasFilter.__gaussianMask[["".concat(v,",").concat(w)]];else{t=0;p=[];for(y=-v;y<=v;y++){var A=T._assistant.formula.getDistribution(y,w,1);p.push(A);t+=A}for(y=0;y<p.length;y++)p[y]/=t;T._assistant.canvasFilter.__gaussianMask[["".concat(v,
",").concat(w)]]=p}T._assistant.worker.get(q).postMessage({sigma:w,radius:v,type:h,gaussianMask:p,buffer:n.data.buffer,size:[k.width,k.height]},[n.data.buffer])}else n=T._assistant.canvasFilter.gaussianBlur(n,v,w),l.putImageData(n,0,0),r.then(function(){return e.variable.image.layer.hide()})},gray:function(){T._env.feature.worker?T._assistant.worker.get(q).postMessage({type:h,buffer:n.data.buffer},[n.data.buffer]):(n=T._assistant.canvasFilter.grayscale(l.getImageData(0,0,k.width,k.height)),l.putImageData(n,
0,0),r.then(function(){return e.variable.image.layer.hide()}))},mirror:function(){var v,t=null!==(v=Number(c.getAttribute("mirror-axis")))&&void 0!==v?v:0;T._env.feature.worker?T._assistant.worker.get(q).postMessage({axis:t,type:h,buffer:n.data.buffer,size:[k.width,k.height]},[n.data.buffer]):(n=T._assistant.canvasFilter.mirror(l.getImageData(0,0,k.width,k.height),t),l.putImageData(n,0,0),r.then(function(){return e.variable.image.layer.hide()}))}})[h])||void 0===f?void 0:f.call(g)}}},{key:"revert",
value:function(){var c=this.variable.nodes.container.querySelector(".modal-layer-image-canvas");var e=c.getContext("2d");this.variable.image.spin.scale=1;c.width=this.variable.image["default"].size[0];c.height=this.variable.image["default"].size[1];c.removeAttribute("style");e.putImageData(this.variable.image["default"].imageData,0,0);this.resize()}},{key:"download",value:function(){var c,e=this.variable.nodes.container.querySelector(".modal-layer-image-canvas"),f=null!==(c=e.getAttribute("download-filename"))&&
void 0!==c?c:this.option.layer.toolbar.config.download.name+Date.now();T._assistant.canvas.download(e,f,this.option.layer.toolbar.config.download.mime)}}]);return a}(T);T._achieve.set("image",Na);var Oa=function(d){function a(){K(this,a);return b.apply(this,arguments)}G(a,d);var b=H(a);O(a,[{key:"initStruct",value:function(){E(F(a.prototype),"initStruct",this).call(this);this.variable.struct._backup.interaction.innerHTML.push(this.variable.struct._backup.interaction_button.cancel)}}]);return a}(La);
T._achieve.set("prompt",Oa);var Pa=function(d){function a(){K(this,a);return b.apply(this,arguments)}G(a,d);var b=H(a);O(a,[{key:"initStruct",value:function(){E(F(a.prototype),"initStruct",this).call(this);this.variable.struct._backup.interaction.innerHTML.push(this.variable.struct._backup.interaction_button.no)}}]);return a}(La);T._achieve.set("confirm",Pa);
var Ma=function(d){function a(){K(this,a);return b.apply(this,arguments)}G(a,d);var b=H(a);O(a,[{key:"initOption",value:function(c){E(F(a.prototype),"initOption",this).call(this,c);this.option.layer=T._assistant.object.merge(this.option.layer,T._option.loading);this.option.title=!1;this.option.drag.enable=!1;this.option.resize.enable=!1;this.option.progress.enable=!1;this.option.mask.clickRemove=!1;this.option.content.fullContainer=!0}},{key:"compatibleOption",value:function(c){var e={center:"center",
right:"flex-end",left:"flex-start"};E(F(a.prototype),"compatibleOption",this).call(this,c);if(!T._assistant.object.isEmpty(c.layer.position)){Array.isArray(c.layer.position)||(c.layer.position=[c.layer.position,c.layer.position]);for(var f=0;2>f;f++){var g;c.layer.position[f]=null!==(g=e[c.layer.position[f]])&&void 0!==g?g:c.layer.position[f];c.layer.position[f]=window.isNaN(c.layer.position[f])?c.layer.position[f]:c.layer.position[f]+"px"}}}},{key:"checkOption",value:function(){E(F(a.prototype),
"checkOption",this).call(this);if(!Array.isArray(this.option.layer.position)&&!["left","center","right"].includes(this.option.layer.position))throw Error("layer.position does not meet expectations");}},{key:"initStruct",value:function(){E(F(a.prototype),"initStruct",this).call(this);var c=this.variable.struct._build.container;var e=this.variable.struct._backup.content=T._struct.content;var f=this.variable.struct._backup.content_loading=T._struct.content_loading;var g=this.variable.struct._backup.content_loading_icon=
T._struct.content_loading_icon;window.isNaN(Number(this.option.layer.icon))?f.innerHTML[0]["class"]+=" "+this.option.layer.icon:f.innerHTML[0]=g[this.option.layer.icon];e.innerHTML.push(f);c.innerHTML.push(e)}},{key:"initNodeFinally",value:function(){E(F(a.prototype),"initNodeFinally",this).call(this);var c=this.variable.nodes.container;var e=c.querySelector(".modal-layer-content");var f=e.querySelector(".modal-layer-loading-icon");var g=e.querySelector(".modal-layer-loading-box");c.style.cssText+=
"background: transparent; box-shadow: none;";e.style.cssText+="background: "+this.option.layer.background;this.option.layer.position[0].endsWith("px")?f.style.cssText+="margin-left: ".concat(this.option.layer.position[0]):g.style.cssText+="align-items: ".concat(this.option.layer.position[0]);this.option.layer.position[1].endsWith("px")?f.style.cssText+="margin-top: ".concat(this.option.layer.position[1]):g.style.cssText+="justify-content: ".concat(this.option.layer.position[1],";");f.style.cssText+=
"font-size: "+this.option.layer.size+"px; width: "+this.option.layer.area[0]+"px; height: "+this.option.layer.area[1]+"px; color: "+this.option.layer.color+"; animation-duration: "+this.option.layer.duration+"s;";T._assistant.object.isEmpty(this.option.layer.rate)||(f.style.animationTimingFunction=this.option.layer.rate)}},{key:"resize",value:function(){if(this.option.window){var c=this.option.window.getBoundingClientRect();c=[0===c.width?window.innerWidth:c.width,0===c.height?window.innerHeight:
c.height]}else c=[window.innerWidth,window.innerHeight];this.variable.nodes.container.style.cssText+="width: ".concat(c[0],"px; height: ").concat(c[1],"px");this.variable.defaultArea=c;this.variable.defaultRect.width=c[0];this.variable.defaultRect.height=c[1]}}]);return a}(T);T._achieve.set("loading",Ma);
var Qa=function(d){function a(){K(this,a);return b.apply(this,arguments)}G(a,d);var b=H(a);O(a,[{key:"initOption",value:function(c){E(F(a.prototype),"initOption",this).call(this,c);this.option.title=!1;this.option.drag.enable=!1;this.option.drag.overflow=!1}},{key:"initStruct",value:function(){E(F(a.prototype),"initStruct",this).call(this);var c=this.variable.struct._build.container;var e=this.variable.struct._backup.content=T._struct.content;c.innerHTML.push(e);this.option.resize.enable&&(e=this.variable.struct._backup.resize_box=
T._struct.resize_box,c.innerHTML.push(e));this.option.progress.enable&&(e=this.variable.struct._backup.progress_bar=T._struct.progress_bar,c.innerHTML.push(e))}},{key:"initNode",value:function(){E(F(a.prototype),"initNode",this).call(this);var c=this.variable.nodes.container.querySelector(".modal-layer-content");if(this.option.content.value instanceof Object){var e=T._assistant.element.objectToNode(this.option.content.value);Object.keys(e).forEach(function(f){c.appendChild(e[f])})}else c.innerHTML=
this.option.content.value}}]);return a}(T);T._achieve.set("msg",Qa);T._achieve.set("message",Qa);window.Worker&&T._worker.set("canvasFilter",function(){this.onmessage=function(d){var a,b;d=null===(a=(b=d.data).type)||void 0===a?void 0:a.call(b,d.data);this.postMessage({error:0,buffer:d?d.buffer:void 0},[d.buffer])};this.C=function(){this.postMessage({error:1,message:"Failed to send message."})}});
var Ra=function(d){function a(){var c=0<arguments.length&&void 0!==arguments[0]?arguments[0]:T._enum.BROWSER_STORAGE.SESSIONSTORAGE;K(this,a);if(!window[c])throw Error("The current browser does not support ".concat(c," function"));var e=b.call(this);e._record=[];e._type=c;e._storage=window[c];return e}G(a,d);var b=H(a);O(a,[{key:"has",value:function(c){return null!==this._storage.getItem(c)?!0:!1}},{key:"get",value:function(c){var e;return null!==(e=this._storage.getItem(c))&&void 0!==e?e:!1}},{key:"set",
value:function(c){this._storage.setItem(c,1<arguments.length&&void 0!==arguments[1]?arguments[1]:"");this._record.push(c);return!0}},{key:"del",value:function(c){var e=this._record.indexOf(c);if(!(1<arguments.length&&void 0!==arguments[1]&&arguments[1])&&0>e)return!1;0<=e&&this._record.splice(e,1);this._storage.removeItem(c);return!0}},{key:"clear",value:function(){for(;0<this._record.length;)this._storage.removeItem(this._record.shift());return!0}}]);return a}(function(){function d(){K(this,d);P(this,
"_type",null);P(this,"_record",null);P(this,"_storage",null)}O(d,[{key:"has",value:function(){}},{key:"get",value:function(){}},{key:"set",value:function(){}},{key:"del",value:function(){}},{key:"clear",value:function(){}}]);return d}());Ga&&(Object.defineProperty(Ga._achieve,T._enum.BROWSER_STORAGE.LOCALSTORAGE,{value:Ra}),Object.defineProperty(Ga._achieve,T._enum.BROWSER_STORAGE.SESSIONSTORAGE,{value:Ra}));}(window);
