!function(window){"use strict";var aa="function"==typeof Object.defineProperties?Object.defineProperty:function(e,a,b){if(e==Array.prototype||e==Object.prototype)return e;e[a]=b.value;return e};function ba(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var a=0;a<e.length;++a){var b=e[a];if(b&&b.Math==Math)return b}throw Error("Cannot find global object");}var ca=ba(this);
function m(e,a){if(a)a:{var b=ca;e=e.split(".");for(var c=0;c<e.length-1;c++){var d=e[c];if(!(d in b))break a;b=b[d]}e=e[e.length-1];c=b[e];a=a(c);a!=c&&null!=a&&aa(b,e,{configurable:!0,writable:!0,value:a})}}m("Reflect",function(e){return e?e:{}});
var da="function"==typeof Object.create?Object.create:function(e){function a(){}a.prototype=e;return new a},ea=function(){function e(){function b(){}new b;Reflect.construct(b,[],function(){});return new b instanceof b}if("undefined"!=typeof Reflect&&Reflect.construct){if(e())return Reflect.construct;var a=Reflect.construct;return function(b,c,d){b=a(b,c);d&&Reflect.setPrototypeOf(b,d.prototype);return b}}return function(b,c,d){void 0===d&&(d=b);d=da(d.prototype||Object.prototype);return Function.prototype.apply.call(b,
d,c)||d}}();m("Reflect.construct",function(){return ea});var fa;if("function"==typeof Object.setPrototypeOf)fa=Object.setPrototypeOf;else{var ha;a:{var ia={s:!0},ja={};try{ja.__proto__=ia;ha=ja.s;break a}catch(e){}ha=!1}fa=ha?function(e,a){e.__proto__=a;if(e.__proto__!==a)throw new TypeError(e+" is not extensible");return e}:null}var ka=fa;m("Object.setPrototypeOf",function(e){return e||ka});function la(e){var a=0;return function(){return a<e.length?{done:!1,value:e[a++]}:{done:!0}}}
m("Symbol",function(e){function a(d){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new b("jscomp_symbol_"+(d||"")+"_"+c++,d)}function b(d,f){this.a=d;aa(this,"description",{configurable:!0,writable:!0,value:f})}if(e)return e;b.prototype.toString=function(){return this.a};var c=0;return a});
m("Symbol.iterator",function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var a="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),b=0;b<a.length;b++){var c=ca[a[b]];"function"===typeof c&&"function"!=typeof c.prototype[e]&&aa(c.prototype,e,{configurable:!0,writable:!0,value:function(){return ma(la(this))}})}return e});function ma(e){e={next:e};e[Symbol.iterator]=function(){return this};return e}
m("Array.from",function(e){return e?e:function(a,b,c){b=null!=b?b:function(k){return k};var d=[],f="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];if("function"==typeof f){a=f.call(a);for(var g=0;!(f=a.next()).done;)d.push(b.call(c,f.value,g++))}else for(f=a.length,g=0;g<f;g++)d.push(b.call(c,a[g],g));return d}});
function na(e,a){e instanceof String&&(e+="");var b=0,c=!1,d={next:function(){if(!c&&b<e.length){var f=b++;return{value:a(f,e[f]),done:!1}}c=!0;return{done:!0,value:void 0}}};d[Symbol.iterator]=function(){return d};return d}m("Array.prototype.keys",function(e){return e?e:function(){return na(this,function(a){return a})}});m("Object.is",function(e){return e?e:function(a,b){return a===b?0!==a||1/a===1/b:a!==a&&b!==b}});
m("Array.prototype.includes",function(e){return e?e:function(a,b){var c=this;c instanceof String&&(c=String(c));var d=c.length;b=b||0;for(0>b&&(b=Math.max(b+d,0));b<d;b++){var f=c[b];if(f===a||Object.is(f,a))return!0}return!1}});function oa(e,a,b){if(null==e)throw new TypeError("The 'this' value for String.prototype."+b+" must not be null or undefined");if(a instanceof RegExp)throw new TypeError("First argument to String.prototype."+b+" must not be a regular expression");return e+""}
m("String.prototype.includes",function(e){return e?e:function(a,b){return-1!==oa(this,a,"includes").indexOf(a,b||0)}});m("Number.isFinite",function(e){return e?e:function(a){return"number"!==typeof a?!1:!isNaN(a)&&Infinity!==a&&-Infinity!==a}});m("Number.isInteger",function(e){return e?e:function(a){return Number.isFinite(a)?a===Math.floor(a):!1}});function z(e,a){return Object.prototype.hasOwnProperty.call(e,a)}
m("Object.values",function(e){return e?e:function(a){var b=[],c;for(c in a)z(a,c)&&b.push(a[c]);return b}});function A(e){var a="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];return a?a.call(e):{next:la(e)}}
m("Promise",function(e){function a(g){this.c=0;this.i=void 0;this.a=[];var k=this.g();try{g(k.resolve,k.reject)}catch(h){k.reject(h)}}function b(){this.a=null}function c(g){return g instanceof a?g:new a(function(k){k(g)})}if(e)return e;b.prototype.c=function(g){if(null==this.a){this.a=[];var k=this;this.g(function(){k.i()})}this.a.push(g)};var d=ca.setTimeout;b.prototype.g=function(g){d(g,0)};b.prototype.i=function(){for(;this.a&&this.a.length;){var g=this.a;this.a=[];for(var k=0;k<g.length;++k){var h=
g[k];g[k]=null;try{h()}catch(l){this.h(l)}}}this.a=null};b.prototype.h=function(g){this.g(function(){throw g;})};a.prototype.g=function(){function g(l){return function(n){h||(h=!0,l.call(k,n))}}var k=this,h=!1;return{resolve:g(this.B),reject:g(this.h)}};a.prototype.B=function(g){if(g===this)this.h(new TypeError("A Promise cannot resolve to itself"));else if(g instanceof a)this.F(g);else{a:switch(typeof g){case "object":var k=null!=g;break a;case "function":k=!0;break a;default:k=!1}k?this.A(g):this.l(g)}};
a.prototype.A=function(g){var k=void 0;try{k=g.then}catch(h){this.h(h);return}"function"==typeof k?this.G(k,g):this.l(g)};a.prototype.h=function(g){this.m(2,g)};a.prototype.l=function(g){this.m(1,g)};a.prototype.m=function(g,k){if(0!=this.c)throw Error("Cannot settle("+g+", "+k+"): Promise already settled in state"+this.c);this.c=g;this.i=k;this.v()};a.prototype.v=function(){if(null!=this.a){for(var g=0;g<this.a.length;++g)f.c(this.a[g]);this.a=null}};var f=new b;a.prototype.F=function(g){var k=this.g();
g.j(k.resolve,k.reject)};a.prototype.G=function(g,k){var h=this.g();try{g.call(k,h.resolve,h.reject)}catch(l){h.reject(l)}};a.prototype.then=function(g,k){function h(q,r){return"function"==typeof q?function(v){try{l(q(v))}catch(t){n(t)}}:r}var l,n,u=new a(function(q,r){l=q;n=r});this.j(h(g,l),h(k,n));return u};a.prototype.catch=function(g){return this.then(void 0,g)};a.prototype.j=function(g,k){function h(){switch(l.c){case 1:g(l.i);break;case 2:k(l.i);break;default:throw Error("Unexpected state: "+
l.c);}}var l=this;null==this.a?f.c(h):this.a.push(h)};a.resolve=c;a.reject=function(g){return new a(function(k,h){h(g)})};a.race=function(g){return new a(function(k,h){for(var l=A(g),n=l.next();!n.done;n=l.next())c(n.value).j(k,h)})};a.all=function(g){var k=A(g),h=k.next();return h.done?c([]):new a(function(l,n){function u(v){return function(t){q[v]=t;r--;0==r&&l(q)}}var q=[],r=0;do q.push(void 0),r++,c(h.value).j(u(q.length-1),n),h=k.next();while(!h.done)})};return a});
m("WeakMap",function(e){function a(h){this.a=(k+=Math.random()+1).toString();if(h){h=A(h);for(var l;!(l=h.next()).done;)l=l.value,this.set(l[0],l[1])}}function b(){}function c(h){var l=typeof h;return"object"===l&&null!==h||"function"===l}function d(h){if(!z(h,g)){var l=new b;aa(h,g,{value:l})}}function f(h){var l=Object[h];l&&(Object[h]=function(n){if(n instanceof b)return n;Object.isExtensible(n)&&d(n);return l(n)})}if(function(){if(!e||!Object.seal)return!1;try{var h=Object.seal({}),l=Object.seal({}),
n=new e([[h,2],[l,3]]);if(2!=n.get(h)||3!=n.get(l))return!1;n.delete(h);n.set(l,4);return!n.has(h)&&4==n.get(l)}catch(u){return!1}}())return e;var g="$jscomp_hidden_"+Math.random();f("freeze");f("preventExtensions");f("seal");var k=0;a.prototype.set=function(h,l){if(!c(h))throw Error("Invalid WeakMap key");d(h);if(!z(h,g))throw Error("WeakMap key fail: "+h);h[g][this.a]=l;return this};a.prototype.get=function(h){return c(h)&&z(h,g)?h[g][this.a]:void 0};a.prototype.has=function(h){return c(h)&&z(h,
g)&&z(h[g],this.a)};a.prototype.delete=function(h){return c(h)&&z(h,g)&&z(h[g],this.a)?delete h[g][this.a]:!1};return a});
m("Map",function(e){function a(){var k={};return k.f=k.next=k.head=k}function b(k,h){var l=k.a;return ma(function(){if(l){for(;l.head!=k.a;)l=l.f;for(;l.next!=l.head;)return l=l.next,{done:!1,value:h(l)};l=null}return{done:!0,value:void 0}})}function c(k,h){var l=h&&typeof h;"object"==l||"function"==l?f.has(h)?l=f.get(h):(l=""+ ++g,f.set(h,l)):l="p_"+h;var n=k.c[l];if(n&&z(k.c,l))for(k=0;k<n.length;k++){var u=n[k];if(h!==h&&u.key!==u.key||h===u.key)return{id:l,list:n,index:k,b:u}}return{id:l,list:n,
index:-1,b:void 0}}function d(k){this.c={};this.a=a();this.size=0;if(k){k=A(k);for(var h;!(h=k.next()).done;)h=h.value,this.set(h[0],h[1])}}if(function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var k=Object.seal({x:4}),h=new e(A([[k,"s"]]));if("s"!=h.get(k)||1!=h.size||h.get({x:4})||h.set({x:4},"t")!=h||2!=h.size)return!1;var l=h.entries(),n=l.next();if(n.done||n.value[0]!=k||"s"!=n.value[1])return!1;n=l.next();return n.done||4!=n.value[0].x||
"t"!=n.value[1]||!l.next().done?!1:!0}catch(u){return!1}}())return e;var f=new WeakMap;d.prototype.set=function(k,h){k=0===k?0:k;var l=c(this,k);l.list||(l.list=this.c[l.id]=[]);l.b?l.b.value=h:(l.b={next:this.a,f:this.a.f,head:this.a,key:k,value:h},l.list.push(l.b),this.a.f.next=l.b,this.a.f=l.b,this.size++);return this};d.prototype.delete=function(k){k=c(this,k);return k.b&&k.list?(k.list.splice(k.index,1),k.list.length||delete this.c[k.id],k.b.f.next=k.b.next,k.b.next.f=k.b.f,k.b.head=null,this.size--,
!0):!1};d.prototype.clear=function(){this.c={};this.a=this.a.f=a();this.size=0};d.prototype.has=function(k){return!!c(this,k).b};d.prototype.get=function(k){return(k=c(this,k).b)&&k.value};d.prototype.entries=function(){return b(this,function(k){return[k.key,k.value]})};d.prototype.keys=function(){return b(this,function(k){return k.key})};d.prototype.values=function(){return b(this,function(k){return k.value})};d.prototype.forEach=function(k,h){for(var l=this.entries(),n;!(n=l.next()).done;)n=n.value,
k.call(h,n[1],n[0],this)};d.prototype[Symbol.iterator]=d.prototype.entries;var g=0;return d});
m("Set",function(e){function a(b){this.a=new Map;if(b){b=A(b);for(var c;!(c=b.next()).done;)this.add(c.value)}this.size=this.a.size}if(function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),c=new e(A([b]));if(!c.has(b)||1!=c.size||c.add(b)!=c||1!=c.size||c.add({x:4})!=c||2!=c.size)return!1;var d=c.entries(),f=d.next();if(f.done||f.value[0]!=b||f.value[1]!=b)return!1;f=d.next();return f.done||f.value[0]==b||4!=f.value[0].x||
f.value[1]!=f.value[0]?!1:d.next().done}catch(g){return!1}}())return e;a.prototype.add=function(b){b=0===b?0:b;this.a.set(b,b);this.size=this.a.size;return this};a.prototype.delete=function(b){b=this.a.delete(b);this.size=this.a.size;return b};a.prototype.clear=function(){this.a.clear();this.size=0};a.prototype.has=function(b){return this.a.has(b)};a.prototype.entries=function(){return this.a.entries()};a.prototype.values=function(){return this.a.values()};a.prototype.keys=a.prototype.values;a.prototype[Symbol.iterator]=
a.prototype.values;a.prototype.forEach=function(b,c){var d=this;this.a.forEach(function(f){return b.call(c,f,f,d)})};return a});
m("WeakSet",function(e){function a(b){this.a=new WeakMap;if(b){b=A(b);for(var c;!(c=b.next()).done;)this.add(c.value)}}if(function(){if(!e||!Object.seal)return!1;try{var b=Object.seal({}),c=Object.seal({}),d=new e([b]);if(!d.has(b)||d.has(c))return!1;d.delete(b);d.add(c);return!d.has(b)&&d.has(c)}catch(f){return!1}}())return e;a.prototype.add=function(b){this.a.set(b,!0);return this};a.prototype.has=function(b){return this.a.has(b)};a.prototype.delete=function(b){return this.a.delete(b)};return a});
m("Object.entries",function(e){return e?e:function(a){var b=[],c;for(c in a)z(a,c)&&b.push([c,a[c]]);return b}});m("Array.prototype.values",function(e){return e?e:function(){return na(this,function(a,b){return b})}});m("String.prototype.endsWith",function(e){return e?e:function(a,b){var c=oa(this,a,"endsWith");void 0===b&&(b=c.length);b=Math.max(0,Math.min(b|0,c.length));for(var d=a.length;0<d&&0<b;)if(c[--b]!=a[--d])return!1;return 0>=d}});
var pa="function"==typeof Object.assign?Object.assign:function(e,a){for(var b=1;b<arguments.length;b++){var c=arguments[b];if(c)for(var d in c)z(c,d)&&(e[d]=c[d])}return e};m("Object.assign",function(e){return e||pa});m("Array.prototype.fill",function(e){return e?e:function(a,b,c){var d=this.length||0;0>b&&(b=Math.max(0,d+b));if(null==c||c>d)c=d;c=Number(c);0>c&&(c=Math.max(0,d+c));for(b=Number(b||0);b<c;b++)this[b]=a;return this}});function C(e){return e?e:Array.prototype.fill}
m("Int8Array.prototype.fill",C);m("Uint8Array.prototype.fill",C);m("Uint8ClampedArray.prototype.fill",C);m("Int16Array.prototype.fill",C);m("Uint16Array.prototype.fill",C);m("Int32Array.prototype.fill",C);m("Uint32Array.prototype.fill",C);m("Float32Array.prototype.fill",C);m("Float64Array.prototype.fill",C);
m("String.prototype.startsWith",function(e){return e?e:function(a,b){var c=oa(this,a,"startsWith"),d=c.length,f=a.length;b=Math.max(0,Math.min(b|0,c.length));for(var g=0;g<f&&b<d;)if(c[b++]!=a[g++])return!1;return g>=f}});function qa(e){"@babel/helpers - typeof";qa="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};return qa(e)}
function E(e,a,b){"undefined"!==typeof Reflect&&Reflect.get?E=Reflect.get:E=function(c,d,f){for(;!Object.prototype.hasOwnProperty.call(c,d)&&(c=F(c),null!==c););if(c)return d=Object.getOwnPropertyDescriptor(c,d),d.get?d.get.call(f):d.value};return E(e,a,b||e)}function G(e,a){if("function"!==typeof a&&null!==a)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(a&&a.prototype,{constructor:{value:e,writable:!0,configurable:!0}});a&&ra(e,a)}
function H(e){var a=sa();return function(){var b=F(e);if(a){var c=F(this).constructor;b=Reflect.construct(b,arguments,c)}else b=b.apply(this,arguments);if(!b||"object"!==qa(b)&&"function"!==typeof b){if(void 0===this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");b=this}return b}}function F(e){F=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)};return F(e)}
function ta(e,a,b){sa()?ta=Reflect.construct:ta=function(c,d,f){var g=[null];g.push.apply(g,d);c=new (Function.bind.apply(c,g));f&&ra(c,f.prototype);return c};return ta.apply(null,arguments)}function sa(){if("undefined"===typeof Reflect||!Reflect.construct||Reflect.construct.a)return!1;if("function"===typeof Proxy)return!0;try{return Reflect.construct(Date,[],function(){}),!0}catch(e){return!1}}function ra(e,a){ra=Object.setPrototypeOf||function(b,c){b.__proto__=c;return b};return ra(e,a)}
function J(e){var a=Array.isArray(e)?e:void 0;if(!a)if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){a=[];var b=!0,c=!1,d=void 0;try{for(var f=e[Symbol.iterator](),g;!(b=(g=f.next()).done)&&(a.push(g.value),2!==a.length);b=!0);}catch(k){c=!0,d=k}finally{try{if(!b&&null!=f["return"])f["return"]()}finally{if(c)throw d;}}}else a=void 0;if(!(e=a||ua(e,2)))throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
return e}function K(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function");}function va(e,a){for(var b=0;b<a.length;b++){var c=a[b];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(e,c.key,c)}}function O(e,a,b){a&&va(e.prototype,a);b&&va(e,b)}function P(e,a,b){a in e?Object.defineProperty(e,a,{value:b,enumerable:!0,configurable:!0,writable:!0}):e[a]=b}
function R(e){var a=Array.isArray(e)?wa(e):void 0;a||(a="undefined"!==typeof Symbol&&Symbol.iterator in Object(e)?Array.from(e):void 0);if(!(e=a||ua(e)))throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");return e}
function ua(e,a){if(e){if("string"===typeof e)return wa(e,a);var b=Object.prototype.toString.call(e).slice(8,-1);"Object"===b&&e.constructor&&(b=e.constructor.name);if("Map"===b||"Set"===b)return Array.from(e);if("Arguments"===b||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b))return wa(e,a)}}function wa(e,a){if(null==a||a>e.length)a=e.length;for(var b=0,c=Array(a);b<a;b++)c[b]=e[b];return c}var xa=Object.create(null);xa.browser=Object.create(null);xa.feature=Object.create(null);
["proxy","symbol","worker","promise"].forEach(function(e){e=e[0].toUpperCase()+e.substring(1);xa.feature[e]=window[e]?!0:!1});Object.freeze(xa);var S=Object.create(null);Object.defineProperty(S,"clickMask",{enumerable:!0,value:function(){void this.remove()}});Object.defineProperty(S,"interaction",{enumerable:!0,value:{ok:null,no:null,cancel:function(){void this.remove()}}});
Object.defineProperty(S,"active",{enumerable:!0,value:function(e){var a;var b=0;var c=this.variable.nodes;e=null!==(a=e)&&void 0!==a?a:window.event;T._instance.forEach(function(f){f.status===T._enum.STATUS.SHOW&&b++});if(2<=b){var d=T._assistant.element.maxZIndex();c.container.style.zIndex!=d&&(Object.keys(c).forEach(function(f){c[f].style.zIndex=d+1}),c.container.style.zIndex=parseInt(c.container.style.zIndex)+1)}}});
Object.defineProperty(S,"drag",{enumerable:!0,value:function(e){var a,b,c,d,f,g,k,h,l=this,n;var u=this.status;e=null!==(h=e)&&void 0!==h?h:window.event;var q=this.variable.nodes.container;var r=q.getBoundingClientRect();if(this.option.window){var v;h=this.option.window===document.body?document.documentElement:this.option.window;var t=this.option.window?window.getComputedStyle(this.option.window):null;e=parseInt(null!==(a=null===t||void 0===t?void 0:t.marginTop)&&void 0!==a?a:0);a=parseInt(null!==
(b=null===t||void 0===t?void 0:t.paddingTop)&&void 0!==b?b:0);b=parseInt(null!==(c=null===t||void 0===t?void 0:t.marginLeft)&&void 0!==c?c:0);c=parseInt(null!==(d=null===t||void 0===t?void 0:t.paddingLeft)&&void 0!==d?d:0);d=parseInt(null!==(f=null===t||void 0===t?void 0:t.marginRight)&&void 0!==f?f:0);f=parseInt(null!==(g=null===t||void 0===t?void 0:t.paddingRight)&&void 0!==g?g:0);g=parseInt(null!==(k=null===t||void 0===t?void 0:t.marginBottom)&&void 0!==k?k:0);k=parseInt(null!==(v=null===t||void 0===
t?void 0:t.paddingBottom)&&void 0!==v?v:0);var w=[0,h.offsetWidth-b-d-c-f,0,h.offsetHeight-e-g-a-k];if(this.option.position)r.y=q.offsetTop,r.x=q.offsetLeft;else{var y,p;r.y+=null!==(y=null===h||void 0===h?void 0:h.scrollTop)&&void 0!==y?y:0;r.x+=null!==(p=null===h||void 0===h?void 0:h.scrollLeft)&&void 0!==p?p:0}}else w=[0,document.documentElement.clientWidth,0,document.documentElement.clientHeight];window.getSelection().empty();var D=function(L,x){r.x+=L;r.y+=x;if(!l.option.drag.overflow){if(r.x<
w[0]||r.x>w[1]-r.width)r.x-=L;if(r.y<w[2]||r.y>w[3]-r.height)r.y-=x}l.resizeBy(r.x,r.y,r.width,r.height);l.setStatus(T._enum.STATUS.DRAG)};var I=function(L){n=null!==L&&void 0!==L?L:window.event;1===n.buttons&&D(n.movementX,n.movementY)};var Q=function(L){var x;var B=[0,0];L=null!==(x=L)&&void 0!==x?x:window.event;"ArrowLeft"===L.code&&(B[0]=-1);"ArrowRight"===L.code&&(B[0]=1);"ArrowUp"===L.code&&(B[1]=-1);"ArrowDown"===L.code&&(B[1]=1);L.preventDefault();D.apply(void 0,R(B))};var Y=function(){document.removeEventListener("keydown",
Q,!0);document.removeEventListener("mousemove",I);document.removeEventListener("mouseup",Y);l.setStatus(u)};document.addEventListener("mouseup",Y);document.addEventListener("mousemove",I);document.addEventListener("keydown",Q,!0)}});
Object.defineProperty(S,"resize",{enumerable:!0,value:function(e){var a,b,c,d,f,g,k,h=this;var l=this.status;e=null!==(d=e)&&void 0!==d?d:window.event;var n=e.target;var u=this.variable.nodes.container;var q=u.getBoundingClientRect();d=this.option.window===document.body?document.documentElement:this.option.window;var r=this.option.window?window.getComputedStyle(this.option.window):null;e=parseInt(null!==(a=null===r||void 0===r?void 0:r.marginTop)&&void 0!==a?a:0);a=parseInt(null!==(b=null===r||void 0===
r?void 0:r.paddingTop)&&void 0!==b?b:0);b=parseInt(null!==(c=null===r||void 0===r?void 0:r.marginLeft)&&void 0!==c?c:0);c=parseInt(null!==(f=null===r||void 0===r?void 0:r.paddingLeft)&&void 0!==f?f:0);var v=null!==(g=null===d||void 0===d?void 0:d.offsetWidth)&&void 0!==g?g:window.innerWidth;var t=null!==(k=null===d||void 0===d?void 0:d.offsetHeight)&&void 0!==k?k:window.innerHeight;window.getSelection().empty();this.option.position?(q.y=u.offsetTop,q.x=u.offsetLeft):(q.y+=d?d.scrollTop-e-a:0,q.x+=
d?d.scrollLeft-b-c:0);var w=function(p){var D;p=null!==(D=p)&&void 0!==D?D:window.event;1!==p.buttons?y():(h.setStatus("resize"),D=n.getAttribute("position-resize-bar"),D.includes("top")&&0<q.y+p.movementY&&q.height-p.movementY>h.variable.defaultRect.height&&(q.y+=p.movementY,q.height-=p.movementY),D.includes("bottom")&&(q.height+=p.movementY,q.y+q.height>t||q.height<h.variable.defaultRect.height)&&(q.height-=p.movementY),D.includes("left")&&0<q.x+p.movementX&&q.width-p.movementX>h.variable.defaultRect.width&&
(q.x+=p.movementX,q.width-=p.movementX),D.includes("right")&&(q.width+=p.movementX,q.x+q.width>v||q.width<h.variable.defaultRect.width)&&(q.width-=p.movementX),h.resizeBy(q.x,q.y,q.width,q.height))};var y=function(){document.removeEventListener("mousemove",w);document.removeEventListener("mouseup",y);h.setStatus(l)};document.addEventListener("mouseup",y);document.addEventListener("mousemove",w)}});
Object.defineProperty(S,"minimizeRevert",{enumerable:!0,value:function(){if("1"!=this.getAttribute("clicked")){this.setAttribute("clicked",1);var e=Number(this.getAttribute("modal-layer-index"));delete T._minimizeQueue[T._minimizeQueue.indexOf(T._instance[e])]}}});
Object.defineProperty(S,"autoShutdown",{enumerable:!0,value:function(){var e=this;var a=1E3*this.option.popupTime;var b=setInterval(function(){if(e.variable.nodes.container.classList.contains("modal-layer-show")){if(e.option.progress.enable){var c=e.variable.nodes.container.querySelector(".modal-layer-progress-bar-progress");switch(e.option.progress.position){case "top":case "bottom":var d="widthFull";break;case "left":case "right":d="heightFull"}c.style.animation=d+" "+e.option.popupTime+"s linear forwards"}e.variable.timeout.auto_shutdown=
setTimeout(function(){return void e.remove()},a);window.clearInterval(b)}},10)}});
Object.defineProperty(S,"action",{enumerable:!0,value:{close:function(){void this.remove()},expand:function(){var e=this;var a=this.status;var b=this.variable.nodes.container.querySelector("iframe[name="+this.option.layer.name+this.option.index+"]");var c=function(f){f.target===b?e.setStatus(T._enum.STATUS.EXPAND):!1===f.target&&e.setStatus(a);window.removeEventListener("fullscreenerror",d);window.removeEventListener("fullscreenchange",c)};var d=function(f){T.L({K:!1,M:5,title:"\u9519\u8bef",I:!0,
J:"bottom",content:'<i class="fas fa-window-close" style="color: red"></i> \u5168\u5c4f\u5931\u8d25, \u9519\u8bef\u539f\u56e0: '+f});window.removeEventListener("fullscreenerror",d);window.removeEventListener("fullscreenchange",c)};window.addEventListener("fullscreenerror",d);window.addEventListener("fullscreenchange",c);T._assistant.element.launchFullscreen(b)},minimize:function(){var e=T._minimizeQueue.indexOf(this);0>e?T._minimizeQueue.push(this):T._minimizeQueue.splice(e,1)}}});
Object.defineProperty(S,"imageTools",{enumerable:!0,value:{crop:function(){this.variable.image.status===T._enum.LOAD_STATUS.LOADED&&this.crop()},spin:function(){this.variable.image.status===T._enum.LOAD_STATUS.LOADED&&this.spin()},filter:function(e){this.variable.image.status===T._enum.LOAD_STATUS.LOADED&&this.filter((null!==e&&void 0!==e?e:window.event).target)},revert:function(){this.variable.image.status===T._enum.LOAD_STATUS.LOADED&&this.revert()},download:function(){this.variable.image.status===
T._enum.LOAD_STATUS.LOADED&&this.download()}}});Object.freeze(S);var U=Object.create(null);Object.defineProperty(U,"page",{value:{src:null,srcdoc:null,frameborder:0,scrolling:"no",area:[800,600],allowfullscreen:!0,name:"modal-layer-page-"}});Object.defineProperty(U,"tips",{value:{location:null,position:3,iconSize:10}});Object.defineProperty(U,"loading",{value:{icon:0,size:48,rate:null,duration:2,area:[48,48],color:"white",background:"transparent",position:["center","center"]}});
Object.defineProperty(U,"image",{value:{image:[],size:null,sizeRange:{min:[.15625,.160257],max:[.9,.9]},toolbar:{enable:!1,config:{crop:{enable:!1,title:"crop",grid:"quarter",icon:"fas fa-crop-alt"},spin:{enable:!1,title:"spin",icon:"fas fa-redo-alt"},filter:{enable:!1,config:{blur:{enable:!1,title:"blur",icon:null,textIcon:"\u6a21"},gray:{enable:!1,title:"gray",icon:null,textIcon:"\u7070"},mirror:{enable:!1,title:"mirror",icon:null,textIcon:"\u955c"}},title:"filter",icon:"fas fa-filter"},revert:{enable:!1,
title:"revert",icon:"fas fa-sync-alt"},download:{enable:!1,name:"picture-",mime:"image/png",title:"download",icon:"fas fa-download"}}}}});
Object.defineProperty(U,"common",{value:{index:0,ui:"modal-layer-ui",title:null,window:null,position:null,popupTime:5,skin:"default",parentModalLayer:null,areaProportion:[.18,.21],content:{value:null,fullContainer:!1},text:{action:{close:"\u5173\u95ed",expand:"\u5168\u5c4f",minimize:"\u6700\u5c0f\u5316"},interaction:{ok:"\u786e\u5b9a",no:"\u62d2\u7edd",cancel:"\u53d6\u6d88"}},transition:{duration:.2,animation:0,easing:"ease"},mask:{enable:!0,clickRemove:!0},drag:{enable:!0,overflow:!1},resize:{enable:!0},
progress:{enable:!1,position:"bottom",color:"deepskyblue",background:"#cecece"},layer:{},hook:{initStart:null,initEnded:null}}});Object.freeze(U);var V=Object.create(null);Object.defineProperty(V,"mask",{get:function(){return JSON.parse(JSON.stringify({nodeType:"div","class":"modal-layer-mask"}))},enumerable:!0,configurable:!1});Object.defineProperty(V,"container",{get:function(){return JSON.parse(JSON.stringify({innerHTML:[],nodeType:"div","class":"modal-layer-container"}))},enumerable:!0,configurable:!1});
Object.defineProperty(V,"action",{get:function(){return JSON.parse(JSON.stringify({innerHTML:[],nodeType:"div","class":"modal-layer-action"}))},enumerable:!0,configurable:!1});
Object.defineProperty(V,"action_button",{get:function(){return JSON.parse(JSON.stringify({minimize:{nodeType:"span","data-fa-transform":"up-4 shrink-2","class":"fas fa-window-minimize modal-layer-action-btn modal-layer-action-btn-minimize"},expand:{nodeType:"span","data-fa-transform":"shrink-2","class":"fas fa-expand-arrows-alt modal-layer-action-btn modal-layer-action-btn-expand"},close:{nodeType:"span","data-fa-transform":"rotate-45 grow-1","class":"fas fa-plus modal-layer-action-btn modal-layer-action-btn-close"}}))},
enumerable:!0,configurable:!1});Object.defineProperty(V,"title",{get:function(){return JSON.parse(JSON.stringify({nodeType:"div","class":"modal-layer-title",innerHTML:[{nodeType:"h4","class":"modal-layer-title-content"}]}))},enumerable:!0,configurable:!1});Object.defineProperty(V,"content",{get:function(){return JSON.parse(JSON.stringify({innerHTML:[],nodeType:"div","class":"modal-layer-content"}))},enumerable:!0,configurable:!1});
Object.defineProperty(V,"content_text",{get:function(){return JSON.parse(JSON.stringify({nodeType:"div","class":"modal-layer-text-content"}))},enumerable:!0,configurable:!1});Object.defineProperty(V,"content_page",{get:function(){return JSON.parse(JSON.stringify({name:"",frameborder:0,scrolling:"no",nodeType:"iframe","class":"modal-layer-page-content"}))},enumerable:!0,configurable:!1});
Object.defineProperty(V,"content_image",{get:function(){return JSON.parse(JSON.stringify({"load-status":2,nodeType:"canvas","class":"modal-layer-image-canvas"}))},enumerable:!0,configurable:!1});Object.defineProperty(V,"content_loading",{get:function(){return JSON.parse(JSON.stringify({nodeType:"div","class":"modal-layer-loading-box",innerHTML:[{nodeType:"span","class":"modal-layer-loading-icon"}]}))},enumerable:!0,configurable:!1});
Object.defineProperty(V,"content_loading_icon",{get:function(){return JSON.parse(JSON.stringify([{nodeType:"span","class":"modal-layer-loading-icon fas fa-spinner fa-spin fa-fw"},{nodeType:"span","class":"modal-layer-loading-icon fas fa-circle-notch fa-spin fa-fw"},{nodeType:"span","class":"modal-layer-loading-icon fas fa-sync fa-spin fa-fw"},{nodeType:"span","class":"modal-layer-loading-icon fas fa-cog fa-spin fa-fw"}]))},enumerable:!0,configurable:!1});
Object.defineProperty(V,"toolbar",{get:function(){return JSON.parse(JSON.stringify({innerHTML:[],nodeType:"div","class":"modal-layer-toolbar"}))},enumerable:!0,configurable:!1});Object.defineProperty(V,"interaction",{get:function(){return JSON.parse(JSON.stringify({innerHTML:[],nodeType:"div","class":"modal-layer-interaction"}))},enumerable:!0,configurable:!1});
Object.defineProperty(V,"interaction_button",{get:function(){return JSON.parse(JSON.stringify({ok:{nodeType:"span","class":"modal-layer-interaction-btn modal-layer-interaction-btn-ok"},no:{nodeType:"span","class":"modal-layer-interaction-btn modal-layer-interaction-btn-no"},cancel:{nodeType:"span","class":"modal-layer-interaction-btn modal-layer-interaction-btn-cancel"}}))},enumerable:!0,configurable:!1});
Object.defineProperty(V,"progress_bar",{get:function(){return JSON.parse(JSON.stringify({nodeType:"div","class":"modal-layer-progress-bar",innerHTML:[{nodeType:"div","class":"modal-layer-progress-bar-background",innerHTML:[{nodeType:"span","class":"modal-layer-progress-bar-progress"}]}]}))},enumerable:!0,configurable:!1});
Object.defineProperty(V,"resize_box",{get:function(){return JSON.parse(JSON.stringify({nodeType:"div","class":"modal-layer-resize-box",innerHTML:[{nodeType:"div","class":"modal-layer-resize-bar","position-resize-bar":"top"},{nodeType:"div","class":"modal-layer-resize-bar","position-resize-bar":"left"},{nodeType:"div","class":"modal-layer-resize-bar","position-resize-bar":"right"},{nodeType:"div","class":"modal-layer-resize-bar","position-resize-bar":"bottom"},{nodeType:"div","class":"modal-layer-resize-bar",
"position-resize-bar":"left-top"},{nodeType:"div","class":"modal-layer-resize-bar","position-resize-bar":"right-top"},{nodeType:"div","class":"modal-layer-resize-bar","position-resize-bar":"left-bottom"},{nodeType:"div","class":"modal-layer-resize-bar","position-resize-bar":"right-bottom"}]}))},enumerable:!0,configurable:!1});Object.defineProperty(V,"minimize_queue",{get:function(){return JSON.parse(JSON.stringify({innerHTML:[],nodeType:"div",id:"modal-layer-minimize-queue"}))},enumerable:!0,configurable:!1});
Object.defineProperty(V,"minimize_queue_item",{get:function(){return JSON.parse(JSON.stringify({nodeType:"div","class":"modal-layer-minimize-queue-item",innerHTML:[{nodeType:"h4","class":"modal-layer-minimize-queue-item-title"}]}))},enumerable:!0,configurable:!1});
Object.defineProperty(V,"image_tools",{get:function(){return JSON.parse(JSON.stringify({crop:{title:"crop",nodeType:"div","tool-type":"crop",innerHTML:[{nodeType:"span","class":"modal-layer-toolbar-item-icon"}],"class":"modal-layer-toolbar-item"},spin:{title:"spin",nodeType:"div","tool-type":"spin",innerHTML:[{nodeType:"span","class":"modal-layer-toolbar-item-icon"}],"class":"modal-layer-toolbar-item"},revert:{title:"revert",nodeType:"div","tool-type":"revert",innerHTML:[{nodeType:"span","class":"modal-layer-toolbar-item-icon"}],
"class":"modal-layer-toolbar-item"},filter:{title:"filter",nodeType:"div","tool-type":"filter",innerHTML:[{nodeType:"span","class":"modal-layer-toolbar-item-icon"},{innerHTML:[],nodeType:"div","class":"modal-layer-toolbar-item-child-list"}],"class":"modal-layer-toolbar-item"},download:{title:"save",nodeType:"div","tool-type":"download",innerHTML:[{nodeType:"span","class":"modal-layer-toolbar-item-icon"}],"class":"modal-layer-toolbar-item"}}))},enumerable:!0,configurable:!1});
Object.defineProperty(V,"image_tools_child",{get:function(){return JSON.parse(JSON.stringify({filter:{mirror:{title:"\u955c\u50cf",innerText:"\u955c",nodeType:"span","filter-type":"mirror","class":"modal-layer-toolbar-filter-icon"},blur:{"data-radius":3,"data-sigma":1.5,innerText:"\u6a21",title:"\u9ad8\u65af\u6a21\u7cca",nodeType:"span","filter-type":"blur","class":"modal-layer-toolbar-filter-icon"},gray:{title:"\u7070\u5ea6\u5316",innerText:"\u7070",nodeType:"span","filter-type":"gray","class":"modal-layer-toolbar-filter-icon"}}}))},
enumerable:!0,configurable:!1});Object.freeze(V);var W=Object.create(null);Object.defineProperty(W,"ARROW",{enumerable:!0,value:{LEFT:37,UP:38,RIGHT:39,DOWN:40}});Object.defineProperty(W,"TIPS_POSITION",{enumerable:!0,value:{LEFT:1,UP:0,RIGHT:2,DOWN:3}});Object.defineProperty(W,"DIRECTION",{enumerable:!0,value:{EAST:"e",WEST:"w",SOUTH:"s",NORTH:"n"}});Object.defineProperty(W,"POSITION",{enumerable:!0,value:{CENTER:null,LEFT_TOP:"lt",RIGHT_TOP:"rt",LEFT_BOTTOM:"lb",RIGHT_BOTTOM:"rb"}});
Object.defineProperty(W,"TYPE",{enumerable:!0,value:{MSG:0,MESSAGE:0,ALERT:1,PROMPT:2,CONFIRM:3,PAGE:4,LOADING:5,IMAGE:6,VIDEO:7,AUTDIO:8,TIPS:9}});Object.defineProperty(W,"STATUS",{enumerable:!0,value:{HIDE:0,SHOW:1,EXPAND:2,MINIMIZE:3,REMOVING:4,REMOVED:5,DRAG:6,RESIZE:7}});Object.defineProperty(W,"LOAD_STATUS",{enumerable:!0,value:{FAILED:0,LOADED:1,LOADING:2}});Object.defineProperty(W,"BROWSER_STORAGE",{enumerable:!0,value:{WEBSQL:"webSQL",INDEXDB:"indexedDB",LOCALSTORAGE:"localStorage",SESSIONSTORAGE:"sessionStorage"}});
Object.defineProperty(W,"TRANSITION_ANIMATION_PRESET",{enumerable:!0,value:{CENTER_SCALE:0,SHIFT_DOWN:1,UNFOLD_X:2,DIAGONAL_STRETCH:3,POP_UP:4}});Object.freeze(W);
var T=function(){function e(a,b){K(this,e);P(this,"type",null);P(this,"status",null);P(this,"event",null);P(this,"option",null);P(this,"variable",{});try{var c,d,f,g,k,h;null===(c=a.hook)||void 0===c?void 0:null===(d=c.initStart)||void 0===d?void 0:null===(f=d.call)||void 0===f?void 0:f.call(d,a);this.type=a.type;this.status=e._enum.STATUS.HIDE;this.compatibleOption(a);this.initOption(a);this.checkOption();this.linkageOption();this.initVariable();this.initStruct();this.initNode();this.initNodeFinally();
this.initAnimation();this.initEvent();this.bindEvent();null===(g=this.option.hook)||void 0===g?void 0:null===(k=g.initEnded)||void 0===k?void 0:null===(h=k.call)||void 0===h?void 0:h.call(k,this);this.insertNode()}catch(l){e._instance.splice(e._instance.indexOf(this),1),null===b||void 0===b?void 0:b.call(null,l)}}O(e,[{key:"initOption",value:function(a){a.index=e._instance.length;e._instance[a.index]=this;this.option=e._assistant.object.merge(a,e._option.common)}},{key:"compatibleOption",value:function(a){var b,
c;e._assistant.object.isString(a.window)&&(a.window=document.querySelector(a.window));a.position&&(Array.isArray(a.position)||Number.isInteger(a.position)&&(a.position=[a.position,a.position]));if("boolean"===typeof a.mask||["true","false"].includes(a.mask))a.mask={enable:!!a.mask,clickRemove:!0};e._assistant.object.isOnlyObject(a.content)||(a.content={value:a.content,fullContainer:null!==(b=null===(c=a.content)||void 0===c?void 0:c.fullContainer)&&void 0!==b?b:!1})}},{key:"linkageOption",value:function(){0>=
this.option.popupTime&&(this.option.progress.enable=!1);!1===this.option.title&&(this.option.drag.enable=!1)}},{key:"checkOption",value:function(){if(Number.isFinite(this.option.transition.animation)){if(!Object.values(e._enum.TRANSITION_ANIMATION_PRESET).includes(this.option.transition.animation))throw Error("No preset animation found.");}else if(null!==this.option.transition.animation&&!(Array.isArray(this.option.transition.animation)||this.option.transition.animation instanceof Animation))throw Error("Expects a css animation name or Animation object.");
if(this.option.position&&!Array.isArray(this.option.position)&&!Object.values(e._enum.POSITION).includes(this.option.position))throw Error("option.position does not meet the expected value.");}},{key:"initVariable",value:function(){this.variable.struct=Object.create(null);this.variable.timeout=Object.create(null);this.variable.interval=Object.create(null);this.variable.animation=Object.create(null);this.variable.eventSymbol=Object.create(null);this.variable.defaultRect=Object.create(null);this.variable.struct._build=
Object.create(null);this.variable.struct._backup=Object.create(null)}},{key:"initStruct",value:function(){var a;if(null===(a=this.option.mask)||void 0===a?0:a.enable)this.variable.struct._build.mask=e._struct.mask;this.variable.struct._build.container=e._struct.container}},{key:"initNode",value:function(){this.variable.nodes=e._assistant.element.objectToNode(this.variable.struct._build);var a=this.variable.nodes.mask;var b=this.variable.nodes.container;var c=b.querySelector(".modal-layer-interaction-btn-ok");
var d=b.querySelector(".modal-layer-interaction-btn-no");var f=b.querySelector(".modal-layer-interaction-btn-cancel");null!==this.option.window&&(null===a||void 0===a?void 0:a.setAttribute("has-window",""),b.setAttribute("has-window",""));b.setAttribute("modal-layer-popup-time",this.option.popupTime);b.setAttribute("content-full-container",Number(this.option.content.fullContainer));b.setAttribute("modal-layer-type",e._assistant.object.getKeyByValue(e._enum.TYPE,this.type).toLowerCase());b.setAttribute("allow-drag",
Number(this.option.drag.enable));b.setAttribute("allow-resize",Number(this.option.resize.enable));if(this.option.progress.enable){a=["top","left","right","bottom"];var g=b.querySelector(".modal-layer-progress-bar");a.includes(this.option.progress.position)||(this.option.progress.position=a[3]);g.setAttribute("progress-bar-position",this.option.progress.position);g.querySelector(".modal-layer-progress-bar-progress").style.cssText+="background: "+this.option.progress.color;g.querySelector(".modal-layer-progress-bar-background").style.cssText+=
"background: "+this.option.progress.background}if(!1!==this.option.title){var k=b.querySelector(".modal-layer-title-content");if(this.option.title instanceof Object){var h=e._assistant.element.objectToNode(this.option.title);Object.keys(h).forEach(function(l){k.appendChild(h[l])})}else k.innerHTML=this.option.title}c&&(c.innerText=this.option.text.interaction.ok);d&&(d.innerText=this.option.text.interaction.no);f&&(f.innerText=this.option.text.interaction.cancel)}},{key:"initNodeFinally",value:function(){var a=
this.option.ui;var b="modal-layer-skin-"+this.option.skin;var c="modal-layer-index-"+this.option.index;Object.keys(this.variable.nodes).forEach(function(d){for(var f=e._assistant.element.getAllElement(this.variable.nodes[d]),g=0;g<f.length;g++)f[g].classList.contains(a)&&f[g].classList.remove(a),f[g].className="".concat(a," ").concat(f[g].className);this.variable.nodes[d].className=a+" "+b+" "+c+" "+this.variable.nodes[d].className.trim()+" modal-layer-hide"},this)}},{key:"initAnimation",value:function(){var a=
this;var b=Object.create(null);var c=this.variable.nodes;if(null!==this.option.transition.animation){var d=this.option.transition.animation;b.D=[{opacity:0},{opacity:1}];b.container=[[{opacity:0,transform:"scale(.45)"},{opacity:1,transform:"scale(1)"}],[{opacity:0,transform:"translateY(-100%)"},{opacity:1,transform:"translateY(0)"}],[{opacity:0,transform:"rotateY(-120deg)"},{opacity:1,transform:"rotateY(0)"}],[{opacity:0,transform:"skewX(-100deg)"},{opacity:1,transform:"skewX(0deg)"}],[{opacity:0,
transform:"translateY(200%) scale(.45)"},{opacity:1,transform:"translateY(0) scale(1)"}]];var f={fill:"both",id:"modal-layer-transition-animation",easing:this.option.transition.easing,duration:1E3*this.option.transition.duration};this.variable.animation.transition=Object.create(null);Object.keys(c).forEach(function(g){"container"===g?(d instanceof Animation?d.effect.target=c[g]:(d=Array.isArray(d)?d:b[g][d],d=c[g].animate(d,f)),a.variable.animation.transition[g]=d):a.variable.animation.transition[g]=
c[g].animate(b.D,f);a.variable.animation.transition[g].cancel()})}}},{key:"initEvent",value:function(){var a;this.event=e._assistant.object.merge(null!==(a=this.option.event)&&void 0!==a?a:{},e._event)}},{key:"bindEvent",value:function(){var a={once:!1,capture:!1,passive:!1,mozSystemGroup:!1};this.option.mask.enable&&this.option.mask.clickRemove&&(this.variable.eventSymbol.maskClickRemove=e._assistant.event.add(this.variable.nodes.mask,"click",null,this.event.clickMask,this,null,a));this.option.drag.enable&&
(this.variable.eventSymbol.drag=e._assistant.event.add(this.variable.nodes.container.querySelector(".modal-layer-title"),"mousedown",null,this.event.drag,this,null,a));this.option.resize.enable&&(this.variable.eventSymbol.resize=e._assistant.event.add(this.variable.nodes.container,"mousedown",".modal-layer-resize-bar",this.event.resize,this,null,a));this.variable.eventSymbol.active=e._assistant.event.add(this.variable.nodes.container,"mousedown",null,this.event.active,this,null,a);this.event.action.close instanceof
Function&&(this.variable.eventSymbol.actionClose=e._assistant.event.add(this.variable.nodes.container,"click",".modal-layer-action-btn-close",this.event.action.close,this,null,a));this.event.action.expand instanceof Function&&(this.variable.eventSymbol.actionExpand=e._assistant.event.add(this.variable.nodes.container,"click",".modal-layer-action-btn-expand",this.event.action.expand,this,null,a));this.event.action.minimize instanceof Function&&(this.variable.eventSymbol.actionMinimize=e._assistant.event.add(this.variable.nodes.container,
"click",".modal-layer-action-btn-minimize",this.event.action.minimize,this,null,a));var b=this.variable.nodes.container.querySelector(".modal-layer-interaction-btn-ok");var c=this.variable.nodes.container.querySelector(".modal-layer-interaction-btn-no");var d=this.variable.nodes.container.querySelector(".modal-layer-interaction-btn-cancel");this.event.interaction.ok&&b&&(this.variable.eventSymbol.interactionOk=e._assistant.event.add(b,"click",null,this.event.interaction.ok,this,null,a));this.event.interaction.no&&
c&&(this.variable.eventSymbol.interactionNo=e._assistant.event.add(c,"click",null,this.event.interaction.no,this,null,a));d&&(this.variable.eventSymbol.interactionCancel=e._assistant.event.add(d,"click",null,this.event.interaction.cancel,this,null,a))}},{key:"insertNode",value:function(){var a,b=this,c=document.createDocumentFragment(),d=null!==(a=this.option.window)&&void 0!==a?a:window.document.body;Object.keys(this.variable.nodes).forEach(function(f){return c.appendChild(b.variable.nodes[f])},
this);d.appendChild(c)}}]);O(e,[{key:"setStatus",value:function(a){if(Object.values(e._enum.STATUS).includes(a))var b=e._assistant.object.getKeyByValue(e._enum.STATUS,a);else if(b=a.toUpperCase(),void 0===(a=e._enum.STATUS[b]))throw Error("Illegal value");this.status=a;this.variable.nodes.container.setAttribute("modal-layer-status",b.toLowerCase())}},{key:"resize",value:function(){var a=[0,0];var b=this.variable.nodes.container;var c=b.children;a[0]=e._assistant.number.multiply(window.innerWidth,
this.option.areaProportion[0]);b.style.width=a[0]+"px";for(var d=0;d<c.length;d++)a[1]="absolute"==getComputedStyle(c[d]).position?a[1]:Math.max(e._assistant.element.getNodeHeight(c[d]),a[1]);b.style.height=a[1]+"px";this.variable.defaultArea=a;this.variable.defaultRect.width=a[0];this.variable.defaultRect.height=a[1]}},{key:"resizeBy",value:function(a,b,c,d){var f=this.variable.nodes.container;f.style.cssText+="top: ".concat(b,"px; left: ").concat(a,"px; width: ").concat(c,"px; height: ").concat(d,
"px;");[e._enum.TYPE.PAGE,e._enum.TYPE.VIDEO,e._enum.TYPE.AUDIO].includes(this.type)&&(f.querySelector("iframe[name="+this.option.layer.name+this.option.index+"]").style.cssText+="width: ".concat(this.option.layer.area[0]+c-this.variable.defaultRect.width,"px; height: ").concat(this.option.layer.area[1]+d-this.variable.defaultRect.height,"px;"))}},{key:"positioning",value:function(){var a,b;var c=this.variable.nodes.container;var d=this.option.window===document.body?document.documentElement:this.option.window;
if(Array.isArray(this.option.position)){var f=J(this.option.position);var g=f[0];f=f[1]}else if(e._enum.POSITION.LEFT_TOP===this.option.position)g=f=0;else if(e._enum.POSITION.RIGHT_TOP===this.option.position)f=0,g=(d?d.offsetWidth:window.innerWidth)-c.offsetWidth;else if(e._enum.POSITION.LEFT_BOTTOM===this.option.position)g=0,f=(d?d.offsetHeight:window.innerHeight)-c.offsetHeight;else if(e._enum.POSITION.RIGHT_BOTTOM===this.option.position)g=(d?d.offsetWidth:window.innerWidth)-c.offsetWidth,f=(d?
d.offsetHeight:window.innerHeight)-c.offsetHeight;else{g=this.variable.defaultRect.width;var k=this.variable.defaultRect.height;f=null!==(a=null===d||void 0===d?void 0:d.scrollTop)&&void 0!==a?a:0;a=null!==(b=null===d||void 0===d?void 0:d.scrollLeft)&&void 0!==b?b:0;b=d?d.clientWidth:window.innerWidth;d=d?d.clientHeight:window.innerHeight;g=e._assistant.number.chain(b).subtract(g).divide(2).add(a).floor().done();f=e._assistant.number.chain(d).subtract(k).divide(2).add(f).floor().done()}c.style.cssText+=
"top: ".concat(f,"px; left: ").concat(g,"px;");this.variable.defaultRect.top=f;this.variable.defaultRect.left=g}},{key:"show",value:function(){var a=this;var b=this.variable.nodes;var c=Object.keys(b);var d=this.variable.animation.transition;var f=e._assistant.element.maxZIndex();if(0===Object.keys(b).length||this.status===e._enum.STATUS.SHOW)return Promise.resolve();var g=new Promise(function(k){function h(){0<a.option.popupTime&&a.event.autoShutdown.call(a);k()}null!==a.option.transition.animation?
d.container.onfinish=h:h()});c.forEach(function(k){var h=0>d[k].playbackRate?"reverse":"play";b[k].style.zIndex=f+1;b[k].classList.contains("modal-layer-hide")&&b[k].classList.replace("modal-layer-hide","modal-layer-show");if(null===d||void 0===d?0:d[k])d[k][h]()});this.setStatus("show");return g}},{key:"hide",value:function(){var a=this;var b=this.variable.nodes;var c=Object.keys(b);var d=this.variable.animation.transition;if(0===Object.keys(b).length||this.status===e._enum.STATUS.HIDE)return Promise.resolve();
Number.isInteger(this.variable.timeout.auto_shutdown)&&window.clearTimeout(this.variable.timeout.auto_shutdown);var f=new Promise(function(g){function k(){c.forEach(function(h){b[h].classList.contains("modal-layer-show")&&b[h].classList.replace("modal-layer-show","modal-layer-hide")});a.option.parentModalLayer instanceof e&&a.option.parentModalLayer.show();a.setStatus("hide");g()}null!==a.option.transition.animation?d.container.onfinish=k:k()});c.forEach(function(g){var k=0<d[g].playbackRate?"reverse":
"play";if(null===d||void 0===d?0:d[g])d[g][k]()});return f}},{key:"minimize",value:function(){var a=this;if(this.status!==e._enum.STATUS.MINIMIZE){var b=this.option.transition.duration;var c=document.querySelector("#modal-layer-minimize-queue");c||(c=e._assistant.element.objectToNode([e._struct.minimize_queue])[0],c.classList.add(this.option.ui,"modal-layer-skin-".concat(this.option.skin)),e._assistant.cache.set("minimizeQueueEvent",e._assistant.event.add(c,"click",".modal-layer-minimize-queue-item",
this.event.minimizeRevert,null,null,!1)),document.body.insertAdjacentElement("beforeend",c));var d=this.variable.nodes.container.querySelector(".modal-layer-title-content").innerHTML;var f=e._assistant.element.objectToNode([e._struct.minimize_queue_item])[0];f.classList.add(this.option.ui);f.setAttribute("modal-layer-index",this.option.index);f.querySelector(".modal-layer-minimize-queue-item-title").innerHTML=d;c.insertAdjacentElement("beforeend",f);(d=e._assistant.cache.get("minimizeQueueAnimations"))||
(d=new Map,e._assistant.cache.set("minimizeQueueAnimations",d));(c=d.get(this.option.index))?c.reverse():(c=[{opacity:0,transform:"scale(.45)"},{opacity:1,transform:"scale(1)"}],b={fill:"both",id:"modal-layer-minimize-queue-transition-animation",easing:this.option.transition.easing,duration:1E3*b},c=f.animate(c,b),d.set(this.option.index,c));this.hide().then(function(){return void a.setStatus("minimize")})}}},{key:"revert",value:function(){var a=this;var b=this.option.transition.duration;var c=document.querySelector("#modal-layer-minimize-queue");
b=e._assistant.number.divide(b,2);var d=c.querySelector('.modal-layer-minimize-queue-item[modal-layer-index="'+this.option.index+'"]');if([e._enum.STATUS.MINIMIZE].includes(this.status)){var f=e._assistant.cache.get("minimizeQueueAnimations").get(this.option.index);setTimeout(function(){a.show()},1E3*b);b=new Promise(function(g){f.onfinish=function(){d.remove();0>=e._minimizeQueue.length&&(c.remove(),e._assistant.cache.has("minimizeQueueEvent")&&e._assistant.event.remove(e._assistant.cache.get("minimizeQueueEvent")));
f.onfinish=null;g()}});f.reverse();return b}}},{key:"remove",value:function(){var a=this;var b=this.status;var c=this.variable.nodes;b===e._enum.STATUS.MINIMIZE&&delete e._minimizeQueue[e._minimizeQueue.indexOf(this)];this.setStatus(e._enum.STATUS.REMOVING);return 0===Object.keys(c).length||[e._enum.STATUS.HIDE,e._enum.STATUS.REMOVING,e._enum.STATUS.REMOVED].includes(b)?Promise.resolve():this.hide().then(function(){a.removeAllEvent();Object.keys(c).forEach(function(d){c[d].remove()});a.setStatus("removed")})}},
{key:"delete",value:function(){var a=this;this.remove().then(function(){e.a.splice(e.a.indexOf(a),1);e._assistant.object.dereference(a.event);e._assistant.object.dereference(a.option);e._assistant.object.dereference(a.variable);a.event=a.option=a.variable=null})}},{key:"removeAllEvent",value:function(){0!==Object.keys(this.variable.nodes).length&&Object.values(this.variable.eventSymbol).forEach(function(a){return e._assistant.event.remove(a)})}}],[{key:"removeAll",value:function(){for(var a=0;a<e._instance.length;a++)e._instance[a].remove()}},
{key:"msg",value:function(a,b){e.message(a,b)}},{key:"message",value:function(a,b){"string"===typeof a?a={content:a,type:e._enum.TYPE.MESSAGE}:a.type=e._enum.TYPE.MESSAGE;a=new (e._achieve.get("message"))(a,b);a.resize();a.positioning();a.show();return a}},{key:"tips",value:function(a,b){"string"===typeof a?a={content:a,type:e._enum.TYPE.TIPS}:a.type=e._enum.TYPE.TIPS;a=new (e._achieve.get("tips"))(a,b);a.resize();a.positioning();a.show();return a}},{key:"alert",value:function(a,b){a.type=e._enum.TYPE.ALERT;
a=new (e._achieve.get("alert"))(a,b);a.resize();a.positioning();a.show();return a}},{key:"confirm",value:function(a,b){a.type=e._enum.TYPE.CONFIRM;a=new (e._achieve.get("confirm"))(a,b);a.resize();a.positioning();a.show();return a}},{key:"prompt",value:function(a,b){a.type=e._enum.TYPE.PROMPT;a=new (e._achieve.get("prompt"))(a,b);a.resize();a.positioning();a.show();return a}},{key:"page",value:function(a,b){a.type=e._enum.TYPE.PAGE;a=new (e._achieve.get("page"))(a,b);a.resize();a.positioning();a.show();
return a}},{key:"image",value:function(a,b){var c=null;a.type=e._enum.TYPE.IMAGE;c=new (e._achieve.get("image"))(a,b);c.variable.image.finish.then(function(){c.resize();c.variable.image.layer.resize()}).then(function(){c.positioning();c.variable.image.layer.positioning()}).then(function(){return c.show()});return c}},{key:"loading",value:function(a,b){a.type=e._enum.TYPE.LOADING;a=new (e._achieve.get("loading"))(a,b);a.resize();a.positioning();a.show();return a}}]);return e}();P(T,"_env",xa);
P(T,"_enum",W);P(T,"_struct",V);P(T,"_option",U);P(T,"_variable",new Map);P(T,"_worker",window.Worker?new Map:void 0);P(T,"_event",S);P(T,"_version",1);P(T,"_achieve",new Map);P(T,"_assistant",Object.create(null));P(T,"_instance",new Proxy([],{set:function(e,a,b){if(b instanceof T||"length"===a)return e[a]=b,!0;throw new TypeError("Must be of type ModalLayer");}}));
P(T,"_minimizeQueue",new Proxy([],{set:function(e,a,b){if(b instanceof T){var c=e.indexOf(b);b.minimize();0>c?e[a]=b:e[c]=b;return!0}return"length"===a?(e[a]=b,!0):!1},deleteProperty:function(e,a){a=parseInt(a);if(Number.isInteger(a)&&e[a]instanceof T){e[a].revert();if(e[a+1])for(;a<e.length-1;a++)e[a]=e[a+1];delete e[e.length-1];e.length--;return!0}}}));Object.seal(T);
Object.is(window.ModalLayer,T)?(console.group("ModalLayer already exists"),console.log("Already version ".concat(window.ModalLayer._version)),console.log("Try to introduce version: ".concat(T._version)),console.groupEnd()):(Object.preventExtensions(T),Object.defineProperty(window,"ModalLayer",{value:T}));
var ya=function(){function e(){K(this,e)}O(e,null,[{key:"getFileBinary",value:function(a,b){var c;b=null!==(c=b)&&void 0!==c?c:{};b=X.merge(b,{mode:"cors",method:"get",cache:"no-cache",redirect:"follow",credentials:"include",referrer:"no-referrer",headers:{"content-type":"text/plain"}});return fetch(a,b)}},{key:"getFileBlob",value:function(a){var b=null;a instanceof Blob?b=Promise.resolve(a):a instanceof Image||a instanceof Element&&"IMAGE"===a.nodeName?b=this.u(a.src).then(function(c){return c.blob()}):
"string"===typeof a||a instanceof String?b=this.u(a).then(function(c){return c.blob()}):b=Promise.reject(!1);return b}},{key:"getImage",value:function(a){var b=null;"string"===typeof a||a instanceof String?b=a:a instanceof Image||a instanceof Element&&"IMAGE"===a.nodeName?b=a.src:a instanceof Blob||a instanceof MediaSource?b=URL.createObjectURL(a):b=!1;return b}}]);return e}();Object.defineProperty(T._assistant,"file",{value:ya});
var Z=function(){function e(){K(this,e)}O(e,null,[{key:"has",value:function(a){var b,c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;c=null!==(b=c)&&void 0!==b?b:e;return(b=e._symbol.get(c))?c[b].has(a):!1}},{key:"get",value:function(a){var b,c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;c=null!==(b=c)&&void 0!==b?b:e;return(b=e._symbol.get(c))?c[b].get(a):void 0}},{key:"set",value:function(a,b){var c,d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;d=null!==
(c=d)&&void 0!==c?c:e;e._symbol.has(d)?c=e._symbol.get(d):(c=Symbol("cache"),e._symbol.set(d,c));Object.hasOwnProperty.call(d,c)||Object.defineProperty(d,c,{value:new Map,writable:!1,enumerable:!1,configurable:!1});d[c].set(a,b)}},{key:"delete",value:function(){var a,b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;c=null!==(a=c)&&void 0!==a?a:e;var d=e._symbol.get(c);if(b)c[d]["delete"](b);else c[d].forEach(function(f,g){c[d]["delete"](g)})}},
{key:"clear",value:function(){e._symbol.forEach(function(a,b){e["delete"](null,b)})}}]);return e}();P(Z,"_symbol",new Map);Object.defineProperty(T._assistant,"cache",{value:Z});
var za=function(){function e(){K(this,e)}O(e,null,[{key:"add",value:function(a,b,c,d,f,g,k){var h,l=7<arguments.length&&void 0!==arguments[7]?arguments[7]:!1,n;var u=!1;var q=Symbol();(n=Z.get("cache",e))||(n=new Map,Z.set("cache",n,e));if(!(a instanceof EventTarget||(a=document.querySelector(a))))throw Error("Is not a valid element.");if(!X.isString(b))throw Error("Event type not allowed to be empty");c instanceof EventTarget&&(a=c,c=null);d instanceof Function||(u=!0);X.isEmpty(f)&&(f=null!==(h=
c)&&void 0!==h?h:a);X.isEmpty(g)||Array.isArray(g)||(g=[g]);X.isEmpty(k)&&(k=!1);if(u){var r;g=[{target:f,symbol:q,parameter:null!==(r=g)&&void 0!==r?r:[]}]}else{var v;g=null!==(v=g)&&void 0!==v?v:[]}h=c?new Promise(function(t){function w(y){var p=(null!==y&&void 0!==y?y:window.event).target;var D=a.querySelectorAll(c);if(p.contains(a)||0===D.length)return!1;for(var I=0;I<D.length;I++){var Q=D[I];if(Q.contains(p)){p=Q===p?p:Q;u?(g[0].event=y,g[0].target=f===c?p:f):0<g.length&&g[g.length-1]instanceof
Event?g[g.length-1]=y:g.push(y);(u?t:d).apply(f===c?p:f,g);break}}}n.set(q,{type:b,element:a,options:k,selector:c,callback:w,wantsUntrusted:l});a.addEventListener(b,w,k,l)}):new Promise(function(t){var w;d=(w=u?t:d).bind.apply(w,[f].concat(R(g)));n.set(q,{type:b,element:a,options:k,selector:c,callback:d,wantsUntrusted:l});a.addEventListener(b,d,k,l)});return u?h:q}},{key:"remove",value:function(a){var b;var c=Z.get("cache",e);if(b=null===c||void 0===c?void 0:c.get(a))b.element.removeEventListener(b.type,
b.callback,b.options),c["delete"](a),X.dereference(b)}},{key:"removeBy",value:function(a,b){var c=Z.get("cache",e);if(!["element","selector","callback"].includes(a))throw Error("key value is invalid");null===c||void 0===c?void 0:c.forEach(function(d,f){d[a]===b&&(d.element.removeEventListener(d.type,d.callback,d.options,d.wantsUntrusted),c["delete"](f))})}},{key:"removeAll",value:function(){var a=Z.get("cache",e);null===a||void 0===a?void 0:a.forEach(function(b,c){b.element.removeEventListener(b.type,
b.callback,b.options,b.wantsUntrusted);a["delete"](c)})}}]);return e}();Object.defineProperty(T._assistant,"event",{value:za});
var Aa=function(){function e(){K(this,e)}O(e,null,[{key:"has",value:function(a){var b,c;return null!==(b=null===(c=Z.get("list",e))||void 0===c?void 0:c.has(a))&&void 0!==b?b:!1}},{key:"add",value:function(a,b){var c;(c=Z.get("list",e))||Z.set("list",c=new Map,e);if(!(b instanceof Worker))throw new TypeError("Not a Worker instance.");if(e.has(a))throw Error("The key already exists.");c.set(a,b)}},{key:"get",value:function(a){var b;return null===(b=Z.get("list",e))||void 0===b?void 0:b.get(a)}},{key:"create",
value:function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:!1,d;(d=Z.get("list",e))||Z.set("list",d=new Map,e);try{var f=new Worker(b);d.set(a,f);c&&e.add(a,f)}catch(g){throw g;}return f}},{key:"close",value:function(a){var b;a instanceof Worker||(a=e.get(a),e.list["delete"](a));null===(b=a)||void 0===b?void 0:b.terminate()}},{key:"listener",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:void 0;if(!(a instanceof Worker)&&(a=e.get(a),void 0===a))throw Error("Worker not found.");
return new Promise(function(c,d){a.C=d;a.onmessage=function(f){null===b||void 0===b?void 0:b(f);c(f)}})}},{key:"addListener",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:void 0;if(!(a instanceof Worker)&&(a=e.get(a),void 0===a))throw Error("Worker not found.");return new Promise(function(c,d){a.addEventListener("messageerror",d);a.addEventListener("message",function(f){null===b||void 0===b?void 0:b(f);c(f)})})}}]);return e}();
Object.defineProperty(T._assistant,"worker",{value:Aa});
var X=function(){function e(){K(this,e)}O(e,null,[{key:"dereference",value:function(a){Object.keys(a).forEach(function(b){var c=a[b];if(e.isCollection(c))if(e.dereference(c),c instanceof Map)a["delete"](b);else if(c instanceof Set)a["delete"](c);else a[b]=null;else a[b]=null})}},{key:"get",value:function(a,b){b=Array.isArray(b)?b:b.split(".");for(var c=0;c<b.length&&!e.isEmpty(a);c++)a=a[b[c]];return a}},{key:"set",value:function(a,b,c){b=Array.isArray(b)?b:b.split(".");for(var d=0;d<b.length;a=a[b[d]],
d++)e.isEmpty(a[b[d]])&&(a[b[d]]={}),d===b.length-1&&(a instanceof Map?a.set(b[d],c):Object.defineProperty(a,b[d],{value:c,writable:!0,enumerable:!0,configurable:!0}))}},{key:"isEmpty",value:function(a){return null===a||void 0===a}},{key:"isString",value:function(a){return"string"===typeof a||a instanceof String}},{key:"isCollection",value:function(a){var b=[Map,Set,Array,WeakMap,WeakSet,Int8Array,Uint8Array,Int16Array,Int32Array,Uint16Array,Uint32Array,Float32Array,Float64Array,Uint8ClampedArray];
return!e.isEmpty(a)&&(e.isOnlyObject(a)||b.includes(a.constructor))}},{key:"isOnlyObject",value:function(a){return a&&(a.constructor===Object||void 0===a.constructor)}},{key:"getKeyByValue",value:function(a,b){a=Object.entries(a);for(var c=0;c<a.length;c++)if(a[c][1]===b)return a[c][0];return null}},{key:"deepCopy",value:function(a){var b,c;if(e.isEmpty(a))return a;var d=null!==(b=null===(c=a.constructor)||void 0===c?void 0:c.call(a))&&void 0!==b?b:Object.create(null);b=[d];c=[[Object.keys(a),Object.values(a)]];
do{a=b.shift();var f=c.shift();var g=J(f);f=g[0];var k=g[1];for(var h=0;h<f.length;h++){g=f[h];var l=k[h];if(e.isCollection(l)){var n,u,q;a[g]=null!==(n=null===(u=(q=l).constructor)||void 0===u?void 0:u.call(q))&&void 0!==n?n:Object.create(null);c.push([Object.keys(l),Object.values(l)]);b.push(a[g])}else a[g]=l}}while(0<c.length);return d}},{key:"merge",value:function(a,b){var c,d;if(e.isEmpty(a))return b;if(e.isEmpty(b))return a;var f=null!==(c=null===(d=b.constructor)||void 0===d?void 0:d.call(b))&&
void 0!==c?c:Object.create(null);c=[f];b=[[[Object.keys(a),Object.values(a)],[Object.keys(b),Object.values(b)]]];do{a=c.shift();d=b.shift();var g=J(d);var k=J(g[0]);d=k[0];k=k[1];var h=J(g[1]);g=h[0];var l=h[1];g=R(new Set(g.concat(d)));for(var n=0;n<g.length;n++){var u;var q=[g[n],l[n]];h=q[0];var r=q[1];q=k[d.indexOf(h)];if(((u=void 0===q)||e.isCollection(q))&&e.isCollection(r)){var v,t,w=[];a[h]=null!==(v=null===(t=u?r.constructor:q.constructor)||void 0===t?void 0:t())&&void 0!==v?v:Object.create(null);
w[1]=[Object.keys(r),Object.values(r)];w[0]=u?[[],[]]:[Object.keys(q),Object.values(q)];c.push(a[h]);b.push(w)}else!e.isCollection(q)&&e.isCollection(r)?a[h]=q:Object.defineProperty(a,h,{writable:!0,enumerable:!0,value:u?r:q})}}while(0<b.length);return f}}]);return e}();Object.defineProperty(T._assistant,"object",{value:X});
var Ba=function(){function e(){K(this,e)}O(e,null,[{key:"multiply",value:function(a,b){var c,d;a=a.toString();b=b.toString();var f=null!==(c=null===(d=b.split(".")[1])||void 0===d?void 0:d.length)&&void 0!==c?c:0;c=Math.pow(10,f);return Number(a.replace(".",""))*Number(b.replace(".",""))/c}},{key:"divide",value:function(a,b){var c,d,f,g;var k=Math.pow(10,Math.max(null!==(c=null===(d=a.toString().split(".")[1])||void 0===d?void 0:d.length)&&void 0!==c?c:0,null!==(f=null===(g=b.toString().split(".")[1])||
void 0===g?void 0:g.length)&&void 0!==f?f:0));return a*k/(b*k)}},{key:"getMedian",value:function(a){a=a.map(function(c){return c}).sort(function(c,d){return c-d});if(1===a.length%2){var b=window.parseInt(a.length/2);a=a[b]}else b=window.parseInt(a.length/2),a=(a[b-1]+a[b])/2;return a}},{key:"getMode",value:function(a){var b,c;var d=0;var f=[];var g=new Map;a.forEach(function(k){var h;c=null!==(h=g.get(k))&&void 0!==h?h:0;g.set(k,c+1)});d=(b=Math).max.apply(b,R(g.values()));g.forEach(function(k,h){k===
d&&f.push(h)});return f}},{key:"isFloat",value:function(a){var b;if(!Number.isFinite(b=window.parseFloat(a))||Math.floor(b)==b)return!1;if(a.endsWith("%")){if(100<b)return!1}else if(a.endsWith("\u2030")){if(1E3<b)return!1}else return!1;return!0}},{key:"getMinLegalSize",value:function(a,b){var c=[];var d=a[0]/a[1];var f=1>d?0:1;var g=Number(!f);a[f]<b[f]?(c[f]=b[f],c[g]=0===f?b[f]/d:b[f]*d):c=a;return c}},{key:"getMaxLegalSize",value:function(a,b){if(!a||!b||a[0]<=b[0]&&a[1]<=b[1])return a;var c=[];
var d=a[0]/a[1];var f=1<=b[0]/b[1]?1:0;var g=Number(!f);a[f]>b[f]?(c[f]=b[f],c[g]=0===f?b[f]/d:b[f]*d):c=a;return c}},{key:"intervalJudgment",value:function(a,b){b=b.replace(/ /g,"").toLowerCase();var c={"(":">",")":"<","[":">=","]":"<="};var d=b[0];var f=b.slice(-1);var g=Object.keys(c);b=b.slice(1,-1).split(",");b[0]=Number(b[0]);b[1]=Number(b[1]);return g.includes(d)||g.includes(f)?(new Function('"use strict"; return '+(a+c[d]+b[0]+"&&"+a+c[f]+b[1])))():!1}},{key:"insideRect",value:function(a,
b){var c=b[0];b=b[1];return a[0]<c[0]||a[1]<c[1]||a[0]>b[0]||a[1]>b[1]?!1:!0}}]);return e}();window.math&&(Ba=Object.assign(Ba,window.math));Object.defineProperty(T._assistant,"number",{value:Ba});
var Ca=function(){function e(){K(this,e)}O(e,null,[{key:"base64Encode",value:function(a){return window.btoa(window.unescape(window.encodeURIComponent(a)))}},{key:"base64Decode",value:function(a){return window.decodeURIComponent(window.escape(window.atob(a)))}},{key:"ucfirst",value:function(a){return a[0].toUpperCase()+a.substring(1)}},{key:"replace",value:function(a,b,c){var d,f,g,k,h,l=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,n,u;b=Array.isArray(b)?b:[b];c=Array.isArray(c)?c:[c];
Array.isArray(a)?n=!0:(a=[a],n=!1);if(1<c.length&&b.length!==c.length)throw Error("The number of search strings does not match the number of replacement strings.");var q=[];for(h=0;h<a.length;h++){q[h]="";var r=a[h];for(u=d=g=k=0;g<b.length;g++,k+=1<c.length?1:0){var v=[];var t=b[g];var w=c[k];for(f=0;0<=f&&(0===l||0<l&&u<l);)f=r.indexOf(t,0===f&&0===u?0:f+1),u+=0<=f?1:0,v.push(f);-1!==v[v.length-1]&&v.push(-1);for(var y=0;0<v.length;y++)f=v.shift(),q[h]+=0<=f?r.substring(d,f)+w:r.substring(d),d=
f+t.length;d=0;r=q[h];q[h]=""}q[h]=r}return n?q:q.shift()}},{key:"colorConvert",value:function(a){a=a.toLowerCase();var b=Error("Not a legal color.");if(0===a.indexOf("#")){var c="rgba(";a=a.substring(1);3===a.length&&(a=a.split("").reduce(function(f,g){return f+g+g},""));if(6===a.length)for(b=0;3>b;b++)c+=Number("0x"+a[2*b]+a[2*b+1])+", ";else throw b;c+="255)"}else if(0===a.indexOf("rgb")){c="#";a=a.replace(/(rgb\(|rgba\(|\)| )/g,"").split(",");for(var d=0;3>d;d++)b=Number(a[d]).toString(16),c+=
1===b.length?b+b:b}else throw b;return c}}]);return e}();Object.defineProperty(T._assistant,"string",{value:Ca});
var Da=function(){function e(){K(this,e)}O(e,null,[{key:"isOverflow",value:function(a,b){a=a.getBoundingClientRect();b=b?b.getBoundingClientRect():{x:0,y:0,width:window.innerWidth,height:window.innerHeight};return a.x<b.x||a.x+a.width>b.x+b.width||a.y<b.y||a.y+a.height>b.y+b.height?!0:!1}},{key:"getAllElement",value:function(a){var b=[];a=a.children;if(0!==a.length)for(var c=0;c<a.length;c++)b.push(a[c]),b=b.concat(e.getAllElement(a[c]));return b}},{key:"getNodeHeight",value:function(a){return a.offsetTop+
a.offsetHeight+parseInt(getComputedStyle(a,1<arguments.length&&void 0!==arguments[1]?arguments[1]:null).marginBottom)}},{key:"getBeforeElementHeight",value:function(a){var b;for(b=0;(a=a.previousElementSibling)&&!["absolute","fixed"].includes(getComputedStyle(a,null).position);)b+=a.offsetHeight;return b}},{key:"getNodeOriginalSize",value:function(a){var b=[0,0];e.getAllElement(a).forEach(function(c){"absolute"!=getComputedStyle(c,null).position&&(b[0]=c.offsetWidth>b[0]?c.offsetWidth:b[0],c.parentNode===
a&&(b[1]+=c.offsetHeight))});return b}},{key:"maxZIndex",value:function(a){var b;a?b=e.a(a):b=Array.from(document.all);return parseInt(b.reduce(function(c,d){d=getComputedStyle(d,null).zIndex;return Math.max(c,Number.isInteger(d)?0:d)},0))}},{key:"objectToNode",value:function(a){var b={},c;for(c in a){var d=document.createElement(a[c].nodeType);if("undefined"!=typeof a[c].nodeType){for(var f in a[c])if("nodeType"!=f)if("innerhtml"==f.toLocaleLowerCase()){var g=e.objectToNode(a[c][f]),k;for(k in g)d.insertAdjacentElement("beforeend",
g[k])}else"innertext"==f.toLocaleLowerCase()?d.insertAdjacentText("beforeend",a[c][f]):d.setAttribute(f,a[c][f]);b[c]=d}}return b}},{key:"launchFullscreen",value:function(a){return a.requestFullscreen(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{navigationUI:"show"})}},{key:"exitFullscreen",value:function(){document.exitFullscreen()}},{key:"getFullscreenNode",value:function(){return document.fullscreenElement}},{key:"createScript",value:function(a){var b=document.createElement("script");
"src type async defer charset innerHTML".split(" ").forEach(function(c){a[c]&&(b[c]=a[c])});return b}}]);return e}();Object.defineProperty(T._assistant,"element",{value:Da});
var Ea=function(){function e(){K(this,e)}O(e,null,[{key:"getDistribution",value:function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:2,d,f;if(1===c&&Array.isArray(a))throw Error("One-dimensional operation position value cannot be an array");if(2===c&&!Array.isArray(a))throw Error("Two-dimensional operation position value must be an array");(f=Z.get("gaussian",e))||(f=new Map,Z.set("gaussian",f,e));(d=f.get(b))||(d=Object.create(null),d.square=b*b,d.multiplier=[1/(b*Math.sqrt(2*
Math.PI)),1/(2*Math.PI*d.square)],f.set(b,d));switch(c){case 1:var g=Math.exp(-(a*a)/(2*d.square));break;case 2:g=Math.exp(-(Math.pow(a[0],2)+Math.pow(a[1],2))/(2*d.square))}return d.multiplier[c-1]*g}}]);return e}();Object.defineProperty(T._assistant,"formula",{value:Ea});
var Fa=function(){function e(){K(this,e)}O(e,null,[{key:"getStorage",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];if(!e._achieve[a])throw Error("The specified storage ".concat(a," was not found."));return ta(e._achieve[a],R(b))}}]);return e}();P(Fa,"_achieve",Object.create(null));Object.defineProperty(T._assistant,"storage",{value:Fa});
var Ga=function(){function e(){K(this,e)}O(e,null,[{key:"drawText",value:function(a,b){b=X.o(b,{text:null,fill:!0,color:"black",direction:"ltr",textAlign:"center",textBaseline:"middle",font:"normal 16px Microsoft YaHei, serif",point:[a.canvas.width/2,a.canvas.height/2]});b.text&&(a.save(),a.font=b.font,a.fillStyle=b.color,a.direction=b.direction,a.textAlign=b.textAlign,a.textBaseline=b.textBaseline,b.point[1]+=a.measureText(b.text).H/2,!0===b.fill?a.fillText.apply(a,[b.text].concat(R(b.point),[b.maxWidth])):
a.strokeText.apply(a,[b.text].concat(R(b.point),[b.maxWidth])),a.restore())}},{key:"drawRound",value:function(a,b){b=X.o(b,{step:[],radius:5,fill:!0,borderWidth:5,borderColor:"black",fillColor:"transparent",point:[a.canvas.width/2,a.canvas.height/2]});a.save();a.fillStyle=b.fillColor;a.lineWidth=b.borderWidth;a.strokeStyle=b.borderColor;a.beginPath();a.setLineDash(b.step);a.arc.apply(a,R(b.point).concat([b.radius,0,2*Math.PI]));a.stroke();!0===b.fill&&a.fill();a.restore()}},{key:"drawRect",value:function(a){var b=
1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,d=3<arguments.length?arguments[3]:void 0,f=4<arguments.length?arguments[4]:void 0,g=5<arguments.length&&void 0!==arguments[5]?arguments[5]:1,k=6<arguments.length&&void 0!==arguments[6]?arguments[6]:"white",h=7<arguments.length&&void 0!==arguments[7]?arguments[7]:!1;a.save();a.lineWidth=g;Array.isArray(h)?(a.strokeStyle=k,a.setLineDash(h),a.strokeRect(b,c,d,f)):(a.fillStyle=k,a.fillRect(b,
c,d,f));a.restore()}},{key:"drawLBorder",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,d=3<arguments.length?arguments[3]:void 0,f=4<arguments.length?arguments[4]:void 0,g=5<arguments.length&&void 0!==arguments[5]?arguments[5]:25,k=6<arguments.length&&void 0!==arguments[6]?arguments[6]:5,h=7<arguments.length&&void 0!==arguments[7]?arguments[7]:"#0eb0f1",l=8<arguments.length&&void 0!==arguments[8]?arguments[8]:
!1;a.save();Array.isArray(l)?a.strokeStyle=h:(a.fillStyle=h,a.fillRect(b,c,g,k),a.fillRect(b,c,k,g),a.fillRect(b+d,c,-g,k),a.fillRect(b+d,c,-k,g),a.fillRect(b+d,c+f,-g,-k),a.fillRect(b+d,c+f,-k,-g),a.fillRect(b,c+f,g,-k),a.fillRect(b,c+f,k,-g));a.restore()}},{key:"drawGrid",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,d=3<arguments.length?arguments[3]:void 0,f=4<arguments.length?arguments[4]:void 0,g=5<
arguments.length&&void 0!==arguments[5]?arguments[5]:1,k=6<arguments.length&&void 0!==arguments[6]?arguments[6]:"black",h=7<arguments.length&&void 0!==arguments[7]?arguments[7]:"quarter",l=8<arguments.length&&void 0!==arguments[8]?arguments[8]:!1;if(e["drawGrid"+Ca.ucfirst(h)]instanceof Function)e["drawGrid"+Ca.ucfirst(h)](a,b,c,null!==d&&void 0!==d?d:a.canvas.width,null!==f&&void 0!==f?f:a.canvas.height,g,k,l);else throw Error(h+" grid not detected");}},{key:"drawGridQuarter",value:function(a){var b=
1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,d=3<arguments.length?arguments[3]:void 0,f=4<arguments.length?arguments[4]:void 0,g=5<arguments.length&&void 0!==arguments[5]?arguments[5]:1,k=6<arguments.length&&void 0!==arguments[6]?arguments[6]:"black",h=7<arguments.length&&void 0!==arguments[7]?arguments[7]:!1;var l=[Ba.divide(d,4),Ba.divide(f,4)];a.save();a.beginPath();a.lineWidth=g;a.strokeStyle=k;Array.isArray(h)&&a.setLineDash(h);
for(g=1;4>g;g++)a.moveTo(l[0]*g+b,c),a.lineTo(l[0]*g+b,c+f),a.moveTo(b,l[1]*g+c),a.lineTo(b+d,l[1]*g+c);a.stroke();a.restore()}},{key:"layerMerge",value:function(a,b,c,d,f){var g=5<arguments.length&&void 0!==arguments[5]?arguments[5]:"source-over",k;(k=Z.get("mergeCas",e))||(k=new OffscreenCanvas(a.canvas.width,a.canvas.height),Z.set("mergeCas",k,e));var h=k.getContext("2d");h.save();h.drawImage.apply(h,[b].concat(R(c)));h.globalCompositeOperation=g;h.drawImage.apply(h,[d].concat(R(f)));a.clearRect(0,
0,a.canvas.width,a.canvas.height);a.drawImage(k,0,0);h.restore();h.clearRect(0,0,k.width,k.height)}},{key:"download",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"canvas",c=2<arguments.length?arguments[2]:void 0;if(Z.has("downloadNode",e))var d=Z.get("downloadNode",e);else d=document.createElement("a"),Z.set("downloadNode",d,e);d.download=b;d.href=a.toDataURL(c);d.click()}}]);return e}();Object.defineProperty(T._assistant,"canvas",{value:Ga});
var Ha=function(){function e(){K(this,e)}O(e,null,[{key:"getImagedata",value:function(a){if(a instanceof Image){var b=document.createElement("canvas");var c=b.getContext("2d");c.drawImage(a,0,0);a=c.getImageData(0,0,b.width,b.height)}else if(!(a instanceof ImageData))throw Error("can not parse image");return a}},{key:"grayscale",value:function(a){try{var b=e.getImagedata(a);var c=b.width*b.height*4;var d=new Uint8ClampedArray(b.data.length);for(a=0;a<c;a+=4){var f=b.data[a];var g=b.data[a+1];var k=
b.data[a+2];var h=b.data[a+3];var l=.299*f+.587*g+.114*k;d[a]=l;d[a+1]=l;d[a+2]=l;d[a+3]=h}}catch(n){throw n;}return new ImageData(d,b.width,b.height)}},{key:"gaussianBlur",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:3,c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,d,f,g,k,h,l,n;try{var u=e.getImagedata(a);var q=u.width;var r=u.height;var v=0;(f=Z.get("gaussianMask",e))||(f=new Map,Z.set("gaussianMask",f,e));if(!(d=f.get("".concat(b,",").concat(c)))){d=
[];for(n=-b;n<=b;n++){var t=Ea.getDistribution(n,c,1);d.push(t);v+=t}for(t=0;t<d.length;t++)d[t]/=v;f.set("".concat(b,",").concat(c),d)}var w=new Uint8ClampedArray(u.data.length);for(l=0;l<r;l++)for(h=0;h<q;h++){var y=g=k=v=0;var p=4*(l*q+h);for(c=-b;c<=b;c++){var D=h+c;n=c+b;if(0<=D&&D<q){var I=4*(l*q+D);y+=u.data[I]*d[n];g+=u.data[I+1]*d[n];k+=u.data[I+2]*d[n];v+=d[n]}}w[p]=y/v;w[p+1]=g/v;w[p+2]=k/v;w[p+3]=u.data[p+3]}for(h=0;h<q;h++)for(l=0;l<r;l++){y=g=k=v=0;p=4*(l*q+h);for(u=-b;u<=b;u++)D=l+
u,n=u+b,0<=D&&D<r&&(I=4*(D*q+h),y+=w[I]*d[n],g+=w[I+1]*d[n],k+=w[I+2]*d[n],v+=d[n]);w[p]=y/v;w[p+1]=g/v;w[p+2]=k/v}}catch(Q){throw Q;}return new ImageData(w,q,r)}},{key:"mirror",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,c,d;try{var f=e.getImagedata(a);var g=f.width;var k=f.height;var h=new Uint8ClampedArray(f.data.length);for(d=0;d<k;d++)for(c=0;c<g;c++){var l=4*(d*g+c);if(0==b)var n=4*(d*g+g-c);else if(1==b)n=4*((k-d)*g+c);else throw Error("not give axis");
h[l]=f.data[n];h[l+1]=f.data[n+1];h[l+2]=f.data[n+2];h[l+3]=f.data[n+3];h[n]=f.data[l];h[n+1]=f.data[l+1];h[n+2]=f.data[l+2];h[n+3]=f.data[l+3]}}catch(u){throw u;}return new ImageData(h,g,k)}}]);return e}();P(Ha,"__gaussianMask",{});Object.defineProperty(T._assistant,"canvasFilter",{value:Ha});
var Ia=function(){function e(){K(this,e)}O(e,null,[{key:"loadFailedFade",value:function(a,b){var c,d,f,g;if(!(a instanceof CanvasRenderingContext2D))throw Error('Requires a value of type "CanvasRenderingContext2D"');X.isEmpty(b)&&(b=Object.create(null));var k="animation-loadFailedFade-"+Date.now()+"-"+performance.now()+(b.sign?"-"+b.sign:"");b=X.o(b,{duration:4,speed:null,icon:{size:72,"char":["!","?"],color:"rgba(220, 53, 69)",font:"bold 72px Microsoft YaHei, serif"},text:{size:16,color:"black",
text:"Load Failed",font:"normal 16px Microsoft YaHei, serif"},round:{step:[5],radius:48,fill:!1,borderWidth:5,fillColor:"#ddd",borderColor:"#ddd"}});var h=JSON.stringify(b.icon);var l=JSON.stringify(b.text);var n=JSON.stringify(b.round);b.speed=null!==(c=b.speed)&&void 0!==c?c:b.duration/(2*b.icon["char"].length);(c=Z.get("loadFailedFade",e))||(c=new Map,Z.set("loadFailedFade",c,e));if(!(f=c.get(h))){f=[];for(var u=0;u<b.icon["char"].length;u++){f[u]=new OffscreenCanvas(b.icon.size,b.icon.size);var q=
f[u].getContext("2d");b.icon.text=b.icon["char"][u];Ga.drawText(q,b.icon)}c.set(h,f)}(g=c.get(l))||(g=new OffscreenCanvas(b.text.size*b.text.text.length,2*b.text.size),h=g.getContext("2d"),Ga.drawText(h,b.text),c.set(l,g));(l=c.get(n))||(l=h=2*(b.round.radius+b.round.borderWidth),l=new OffscreenCanvas(l,h),h=l.getContext("2d"),Ga.drawRound(h,b.round),c.set(n,l));var r=1;var v=d=0;var t=[a.canvas.width/2,a.canvas.height/2];c=[l.width/2,(l.height+g.height)/2];n=[g.width/2,(l.height-g.height)/2];var w=
1/(b.duration/f.length/2*1E3/(1E3/60));var y=function(){var p=w*r,D=Number(a.canvas.getAttribute(k)),I=[f[v].width/2,(f[v].height+g.height)/2];void 0!==D&&0!==D&&(a.clearRect(t[0]-I[0],t[1]-I[1],f[v].width,f[v].height),1<d+p?(d=1,r=-r):0>d+p?(d=0,r=-r,v=v+1<f.length?v+1:0):d+=p,a.globalAlpha=d,a.drawImage(f[v],t[0]-I[0],t[1]-I[1]),window.requestAnimationFrame(y))};a.globalAlpha=1;a.drawImage(l,t[0]-c[0],t[1]-c[1]);a.drawImage(g,t[0]-n[0],t[1]+n[1]);a.canvas.setAttribute(k,1);window.requestAnimationFrame(y);
return k}}]);return e}();Object.defineProperty(T._assistant,"canvasAnimation",{value:Ia});
var Ja=function(e){function a(){K(this,a);return b.apply(this,arguments)}G(a,e);var b=H(a);O(a,[{key:"initOption",value:function(c){E(F(a.prototype),"initOption",this).call(this,c);this.option.layer=T._assistant.object.merge(this.option.layer,T._option.page)}},{key:"linkageOption",value:function(){E(F(a.prototype),"linkageOption",this).call(this);null!==this.option.layer.src&&null!==this.option.layer.srcdoc&&(this.option.layer.srcdoc=null)}},{key:"initStruct",value:function(){E(F(a.prototype),"initStruct",
this).call(this);var c=this.variable.struct._build.container;var d=this.variable.struct._backup.title=T._struct.title;var f=this.variable.struct._backup.action=T._struct.action;var g=this.variable.struct._backup.content=T._struct.content;var k=this.variable.struct._backup.content_page=T._struct.content_page;var h=this.variable.struct._backup.action_button=T._struct.action_button;f.innerHTML.push(h.minimize,h.expand,h.close);d.innerHTML.push(f);!1!==this.option.title&&c.innerHTML.push(d);g.innerHTML.push(k);
c.innerHTML.push(g);this.option.resize.enable&&(k=this.variable.struct._backup.resize_box=T._struct.resize_box,c.innerHTML.push(k));this.option.progress.enable&&(k=this.variable.struct._backup.progress_bar=T._struct.progress_bar,c.innerHTML.push(k))}},{key:"initNode",value:function(){var c=this;E(F(a.prototype),"initNode",this).call(this);var d=this.variable.nodes.container.querySelector(".modal-layer-page-content");Object.keys(this.option.layer).forEach(function(f){T._assistant.object.isEmpty(c.option.layer[f])||
("name"===f?d.setAttribute("name",c.option.layer.name+c.option.index):d.setAttribute(f,c.option.layer[f]))})}},{key:"resize",value:function(){var c=0;var d=this.variable.nodes.container;var f=d.children;var g=d.querySelector("iframe[name="+this.option.layer.name+this.option.index+"]");g.style.cssText="width: ".concat(this.option.layer.area[0],"px; height: ").concat(this.option.layer.area[1],"px;");g=this.option.layer.area[0]+2*g.parentNode.offsetLeft;for(var k=0;k<f.length;k++)c="absolute"==getComputedStyle(f[k],
null).position?c:Math.max(T._assistant.element.getNodeHeight(f[k]),c);d.style.cssText+="width: ".concat(g,"px; height: ").concat(c,"px;");this.variable.defaultRect.width=g;this.variable.defaultRect.height=c;this.variable.defaultArea=[g,c]}}]);return a}(T);T._achieve.set("page",Ja);
var Ka=function(e){function a(){K(this,a);return b.apply(this,arguments)}G(a,e);var b=H(a);O(a,[{key:"initStruct",value:function(){E(F(a.prototype),"initStruct",this).call(this);var c=this.variable.struct._build.container;var d=this.variable.struct._backup.title=T._struct.title;var f=this.variable.struct._backup.action=T._struct.action;var g=this.variable.struct._backup.content=T._struct.content;var k=this.variable.struct._backup.interaction=T._struct.interaction;var h=this.variable.struct._backup.action_button=
T._struct.action_button;var l=this.variable.struct._backup.interaction_button=T._struct.interaction_button;f.innerHTML.push(h.close);d.innerHTML.push(f);!1!==this.option.title&&c.innerHTML.push(d);c.innerHTML.push(g);this.option.resize.enable&&(f=this.variable.struct._backup.resize_box=T._struct.resize_box,c.innerHTML.push(f));this.option.progress.enable&&(f=this.variable.struct._backup.progress_bar=T._struct.progress_bar,c.innerHTML.push(f));k.innerHTML.push(l.ok);c.innerHTML.push(k)}},{key:"initNode",
value:function(){E(F(a.prototype),"initNode",this).call(this);var c=this.variable.nodes.container.querySelector(".modal-layer-content");if(Array.isArray(this.option.content.value)){var d=T._assistant.element.objectToNode(this.option.content.value);Object.keys(d).forEach(function(f){c.appendChild(d[f])})}else c.innerHTML=this.option.content.value}}]);return a}(T);T._achieve.set("alert",Ka);
var Ma=function(e){function a(){K(this,a);return b.apply(this,arguments)}G(a,e);var b=H(a);O(a,[{key:"initOption",value:function(c){var d=this,f;E(F(a.prototype),"initOption",this).call(this,c);this.option.layer=T._assistant.object.merge(this.option.layer,T._option.image);var g=[window.innerWidth,window.innerHeight];Object.values(this.option.layer.sizeRange).forEach(function(k){k.forEach(function(h,l){if((""+h).endsWith("%"))f=100;else if((""+h).endsWith("\u2030"))f=1E3;else if((""+h).includes("0."))f=
1;else return h;k[l]=g[l]*window.parseFloat(h)/f})});this.option.layer.sizeRange.min[0]>this.option.layer.sizeRange.max[0]&&(this.option.layer.sizeRange.min[0]=this.option.layer.sizeRange.max[0]);this.option.layer.sizeRange.min[1]>this.option.layer.sizeRange.max[1]&&(this.option.layer.sizeRange.min[1]=this.option.layer.sizeRange.max[1]);Object.keys(this.option.layer.toolbar.config).forEach(function(k,h){h=d.option.layer.toolbar.config[k];"boolean"==typeof h&&(d.option.layer.toolbar.config[k]={enable:h,
title:T._option.image.toolbar.config[k].title,icon:T._option.image.toolbar.config[k].icon});T._assistant.object.isOnlyObject(h.config)?Object.keys(h.config).forEach(function(l,n){n=h.config[l];"boolean"==typeof n&&(d.option.layer.toolbar.config[k].config[l]={enable:n,title:T._option.image.toolbar.config[k].config[l].title,icon:T._option.image.toolbar.config[k].config[l].icon})}):T._option.image.toolbar.config[k].config&&(d.option.layer.toolbar.config[k].config=JSON.parse(JSON.stringify(T._option.image.toolbar.config[k].config)))})}},
{key:"compatibleOption",value:function(c){var d,f;E(F(a.prototype),"compatibleOption",this).call(this,c);var g=T._assistant.object.get(c,"layer.image");g instanceof FileList&&(c.layer.image=Object.values(g));Array.isArray(c.layer.image)||(c.layer.image=[c.layer.image]);var k=null!==(d=T._assistant.object.get(c,"layer.toolbar.config"))&&void 0!==d?d:[];Object.keys(k).forEach(function(l){k[l]="boolean"===typeof k[l]?{enable:k[l]}:k[l]});var h=null!==(f=T._assistant.object.get(c,"layer.toolbar.config.filter.config"))&&
void 0!==f?f:[];Object.keys(h).forEach(function(l){h[l]="boolean"===typeof h[l]?{enable:h[l]}:h[l]})}},{key:"linkageOption",value:function(){var c;E(F(a.prototype),"linkageOption",this).call(this);var d=c=!1;var f=Object.entries(this.option.layer.toolbar.config);var g=Object.entries(this.option.layer.toolbar.config.filter.config);for(var k=0;k<g.length;k++)if(!0===g[k][1].enable){c=!0;break}this.option.layer.toolbar.config.filter.enable=c;for(c=0;c<f.length;c++)if(!0===f[c][1].enable){d=!0;break}this.option.layer.toolbar.enable=
d;!1===this.option.layer.toolbar.config.crop.enable&&(this.option.layer.toolbar.config.crop.grid=!1)}},{key:"checkOption",value:function(){E(F(a.prototype),"checkOption",this).call(this);if(T._assistant.object.isEmpty(this.option.layer.image))throw Error("layer.image can not be empty!");if(this.option.layer.size&&!Array.isArray(this.option.layer.size))throw Error("layer.size does not meet expectations.");if(!(this.option.layer.size||Number.isFinite(parseInt(this.option.layer.sizeRange.min[0]))&&Number.isFinite(parseInt(this.option.layer.sizeRange.min[1]))&&
Number.isFinite(parseInt(this.option.layer.sizeRange.max[0]))&&Number.isFinite(parseInt(this.option.layer.sizeRange.max[1]))))throw Error("layer.sizeRange does not meet expectations.");}},{key:"initVariable",value:function(){E(F(a.prototype),"initVariable",this).call(this);this.variable.image={spin:{scale:1,angle:90},"default":{size:null,imageData:null},reload:0,link:null,history:[],finish:null,status:T._enum.LOAD_STATUS.LOADING}}},{key:"initStruct",value:function(){var c=this;E(F(a.prototype),"initStruct",
this).call(this);var d=this.variable.struct._build.container;var f=this.variable.struct._backup.title=T._struct.title;var g=this.variable.struct._backup.action=T._struct.action;var k=this.variable.struct._backup.toolbar=T._struct.toolbar;var h=this.variable.struct._backup.tools=T._struct.image_tools;var l=this.variable.struct._backup.content=T._struct.content;var n=this.variable.struct._backup.action_button=T._struct.action_button;var u=this.variable.struct._backup.content_image=T._struct.content_image;
var q=this.variable.struct._backup.image_tools_child=T._struct.image_tools_child;g.innerHTML.push(n.close);f.innerHTML.push(g);!1!==this.option.title&&d.innerHTML.push(f);Object.keys(this.option.layer.toolbar.config).forEach(function(r){c.option.layer.toolbar.config[r].enable&&k.innerHTML.push(h[r]);c.option.layer.toolbar.config[r].config instanceof Object&&c.option.layer.toolbar.config[r].enable&&Object.keys(c.option.layer.toolbar.config[r].config).forEach(function(v){h[r].innerHTML[1].innerHTML.push(q[r][v])})});
this.option.layer.toolbar.enable&&d.innerHTML.push(k);l.innerHTML.push(u);d.innerHTML.push(l);this.option.resize.enable&&(g=this.variable.struct._backup.resize_box=T._struct.resize_box,d.innerHTML.push(g));this.option.progress.enable&&(g=this.variable.struct._backup.progress_bar=T._struct.progress_bar,d.innerHTML.push(g))}},{key:"initNode",value:function(){var c=this;E(F(a.prototype),"initNode",this).call(this);var d=this.variable.nodes.container.querySelector(".modal-layer-toolbar");this.option.layer.toolbar.enable&&
Object.keys(this.option.layer.toolbar.config).forEach(function(f,g){g=c.option.layer.toolbar.config[f];if(g.enable){var k;var h=d.querySelector('.modal-layer-toolbar-item[tool-type="'+f+'"]');var l=h.querySelector(".modal-layer-toolbar-item-icon");h.setAttribute("title",g.title);(k=l.classList).add.apply(k,R(g.icon.split(" ")));g.config instanceof Object&&Object.entries(g.config).forEach(function(n,u){u=n[0];n=n[1];if(n.enable){var q=h.querySelector(".modal-layer-toolbar-item-child-list");u=h.querySelector(".modal-layer-toolbar-"+
f+"-icon["+f+'-type="'+u+'"]');q.setAttribute("title",n.title);n.icon?u.classList.add(n.icon):u.innerText=n.textIcon}})}});this.variable.image.finish=this.load().then(function(f){return c.loaded(f)})["catch"](function(){return c.failed()})}},{key:"bindEvent",value:function(){var c=this;E(F(a.prototype),"bindEvent",this).call(this);var d={once:!1,capture:!1,passive:!1,mozSystemGroup:!1};var f=this.variable.nodes.container;var g=T._assistant.object.getKeyByValue(T._enum.LOAD_STATUS,T._enum.LOAD_STATUS.FAILED);
this.variable.eventSymbol.imageReload=T._assistant.event.add(f,"click",'.modal-layer-image-canvas[load-status="'+g+'"]',this.reload,this,null,d);Object.keys(this.event.imageTools).forEach(function(k){c.event.imageTools[k]&&c.event.imageTools[k]instanceof Function&&(c.variable.eventSymbol["imageTool".concat(k)]=T._assistant.event.add(f,"click",'.modal-layer-toolbar-item[tool-type="'.concat(k,'"]'),c.event.imageTools[k],c,null,d))})}},{key:"resize",value:function(){var c;var d=this.variable.nodes.container;
var f=d.querySelector(".modal-layer-content");var g=f.querySelector(".modal-layer-image-canvas").getBoundingClientRect();var k=d.querySelector(".modal-layer-toolbar");var h=k.getBoundingClientRect().height;var l=window.getComputedStyle(f,null);var n=T._assistant.element.getBeforeElementHeight(f);f=f.offsetTop-n;n+=this.option.content.fullContainer?0:2*f;this.option.layer.size?c=R(this.option.layer.size):this.variable.image.status!==T._enum.LOAD_STATUS.LOADING?c=[g.width,g.height]:c=R(this.option.layer.sizeRange.min);
c[0]+=parseFloat(l.marginLeft)+parseFloat(l.marginRight);c[1]+=n;d.style.width=c[0]+"px";this.option.layer.toolbar.enable&&(g=k.getBoundingClientRect().height,c[1]=c[1]-h+g);d.style.height=c[1]+"px";this.variable.defaultArea=c;this.variable.defaultRect.width=c[0];this.variable.defaultRect.height=c[1];!this.option.drag.overflow&&T._assistant.element.isOverflow(d,this.option.window)&&this.positioning()}},{key:"load",value:function(){var c=this,d=this.variable.nodes.container.querySelector(".modal-layer-image-canvas");
this.variable.image.status=T._enum.LOAD_STATUS.LOADING;d.setAttribute("load-status",T._assistant.object.getKeyByValue(T._enum.LOAD_STATUS,T._enum.LOAD_STATUS.LOADING));this.variable.image.fadeAttr&&d.removeAttribute(this.variable.image.fadeAttr);this.variable.image.layer instanceof La?this.variable.image.layer.show():this.variable.image.layer=T.loading({mask:!1,popupTime:0,layer:{icon:1,duration:1,color:"deepskyblue"},window:this.variable.nodes.container.querySelector(".modal-layer-content")},function(f){throw f;
});return this.variable.image.finish=new Promise(function(f,g){for(var k=new Image;!c.variable.image.link&&c.variable.image.reload<c.option.layer.image.length;){var h;(null===(h=c.variable.image.link)||void 0===h?0:h.startsWith("blob:"))&&URL.revokeObjectURL(c.variable.image.link);c.variable.image.link=T._assistant.file.getImage(c.option.layer.image[c.variable.image.reload++])}k.onload=function(){return f(k)};k.onerror=g;k.src=c.variable.image.link})}},{key:"reload",value:function(){var c=this;this.variable.image.finish=
this.load().then(function(d){return c.loaded(d)})["catch"](function(){return c.failed()})["finally"](function(){return c.resize()})}},{key:"loaded",value:function(c){var d=this;var f=this.variable.nodes.container.querySelector(".modal-layer-image-canvas");this.variable.image.status=T._enum.LOAD_STATUS.LOADED;this.variable.image["default"].size=this.option.layer.size?this.option.layer.size:c.naturalWidth>this.option.layer.sizeRange.max[0]||c.naturalHeight>this.option.layer.sizeRange.max[1]?T._assistant.number.getMaxLegalSize([c.naturalWidth,
c.naturalHeight],this.option.layer.sizeRange.max):c.naturalWidth<this.option.layer.sizeRange.min[0]||c.naturalHeight<this.option.layer.sizeRange.min[1]?T._assistant.number.getMinLegalSize([c.naturalWidth,c.naturalHeight],this.option.layer.sizeRange.min):[c.naturalWidth,c.naturalHeight];f.width=this.variable.image["default"].size[0];f.height=this.variable.image["default"].size[1];f.setAttribute("load-status",T._assistant.object.getKeyByValue(T._enum.LOAD_STATUS,T._enum.LOAD_STATUS.LOADED));window.requestAnimationFrame(function(){var g,
k;d.variable.image.layer&&d.variable.image.layer instanceof La&&d.variable.image.layer.hide();(g=f.getContext("2d")).drawImage.apply(g,[c,0,0,c.width,c.height,0,0].concat(R(d.variable.image["default"].size)));d.variable.image["default"].imageData=(k=f.getContext("2d")).getImageData.apply(k,[0,0].concat(R(d.variable.image["default"].size)))})}},{key:"failed",value:function(){var c,d;var f=this.variable.nodes.container.querySelector(".modal-layer-image-canvas");this.variable.image.status=T._enum.LOAD_STATUS.FAILED;
f.setAttribute("load-status",T._assistant.object.getKeyByValue(T._enum.LOAD_STATUS,T._enum.LOAD_STATUS.FAILED));this.variable.image.reload<this.option.layer.image.length?d={duration:4,sign:"load-failed",icon:{size:72,"char":"!?",color:"rgba(220, 53, 69)",font:"bold 72px Microsoft YaHei, serif"},round:{step:[4],radius:50,borderWidth:5,borderColor:"rgb(230, 230, 230)"},text:{color:"rgba(220, 53, 69)",text:"\u56fe\u7247\u52a0\u8f7d\u5931\u8d25, \u8bf7\u70b9\u51fb\u91cd\u8bd5",font:"lighter 16px Microsoft YaHei, serif"}}:
d={duration:4,sign:"finally-load-failed",icon:{size:80,"char":"\u00d7",font:"bold 80px Microsoft YaHei, serif"},round:{step:[5],radius:50,borderWidth:5,borderColor:"rgb(230, 230, 230)"},text:{color:"rgba(220, 53, 69)",text:"\u56fe\u7247\u52a0\u8f7d\u5931\u8d25, \u8bf7\u8054\u7cfb\u7ba1\u7406\u5458",font:"lighter 16px Microsoft YaHei, serif"}};this.variable.image.fadeAttr=T._assistant.canvasAnimation.loadFailedFade(f.getContext("2d"),d);(null===(c=this.variable.image.link)||void 0===c?0:c.startsWith("blob:"))&&
URL.revokeObjectURL(this.variable.image.link);this.variable.image.link=null;this.variable.image.layer instanceof La&&this.variable.image.layer.hide()}},{key:"removeAllEvent",value:function(){var c=this,d=this.variable.nodes.container;E(F(a.prototype),"removeAllEvent",this).call(this);Object.keys(this.event.imageTools).forEach(function(f){c.event.imageTools[f]&&c.event.imageTools[f]instanceof Function&&d.removeEventListener("click",c.event.imageTools[f])})}},{key:"crop",value:function(){var c=this,
d,f;var g=!0;var k=null;var h=[];var l=T._assistant.number.divide(5,2);h[2]=T._assistant.number.multiply(5,2);h[4]=T._assistant.number.multiply(5,4);h[6]=T._assistant.number.multiply(5,6);var n=this.variable.nodes.container.querySelector(".modal-layer-image-canvas");var u=n.width;var q=n.height;var r=T._assistant.number.floor(.1*u);var v=T._assistant.number.floor(.1*q);var t=n.cloneNode();var w=t.getContext("2d");t.width=window.innerWidth;t.height=window.innerHeight;t.style="display: block; position: fixed; top: 0px; bottom: 0px; left: 0px; right: 0px; visibility: visible; opacity: 1; border: 0px; margin: 0px; z-index: "+
T._assistant.element.maxZIndex()+";";var y=[T._assistant.number.chain(t.width).subtract(u).divide(2).round().done(),T._assistant.number.chain(t.height).subtract(q).divide(2).round().done()];var p=[].concat(R(y),[u,q]);var D=function(){var x;w.save();w.clearRect(0,0,t.width,t.height);w.fillStyle="rgba(0, 0, 0, 0.4)";w.fillRect(0,0,t.width,t.height);w.globalCompositeOperation="destination-out";w.fillStyle="white";w.fillRect.apply(w,R(p));w.globalCompositeOperation="source-over";(x=T._assistant.canvas).drawGrid.apply(x,
[w].concat(R(p),[2,"white","quarter"]));T._assistant.canvas.drawRect(w,p[0]-l,p[1]-l,p[2]+5,p[3]+5,5,"white",[0]);T._assistant.canvas.drawLBorder(w,p[0]-h[2],p[1]-h[2],p[2]+h[4],p[3]+h[4],h[6],5,"white");w.globalCompositeOperation="destination-over";w.drawImage.apply(w,[n].concat(R(y)));w.restore();g?k=window.requestAnimationFrame(D):window.cancelAnimationFrame(k)};var I=function(){document.removeEventListener("keyup",Q);t.removeEventListener("mousemove",L);t.removeEventListener("dbclick",Y);g=!1;
t.remove()};var Q=function(x){var B;x=null!==(B=x)&&void 0!==B?B:window.event;switch(x.code){case "Enter":Y();x.preventDefault();break;case "Escape":c.show(),I(),x.preventDefault()}};var Y=function(x){var B;I();x=null!==(B=x)&&void 0!==B?B:window.event;x=new OffscreenCanvas(n.width,n.height);x.getContext("2d").drawImage(n,0,0);n.width=p[2];n.height=p[3];n.getContext("2d").drawImage(x,p[0]-y[0],p[1]-y[1],p[2],p[3],0,0,n.width,n.height);c.show().then(function(){return c.resize()})};var L=function(x){var B;
x=null!==(B=x)&&void 0!==B?B:window.event;if(d&&1===x.buttons)if("drag"===d)p[0]+x.movementX>y[0]&&p[0]+p[2]+x.movementX<y[0]+u&&(p[0]+=x.movementX),p[1]+x.movementY>y[1]&&p[1]+p[3]+x.movementY<y[1]+q&&(p[1]+=x.movementY);else{if("resize"===d){B=R(p);f.includes(T._enum.DIRECTION.WEST)&&(p[0]+=x.movementX,p[2]-=x.movementX);f.includes(T._enum.DIRECTION.EAST)&&(p[2]+=x.movementX);f.includes(T._enum.DIRECTION.NORTH)&&(p[1]+=x.movementY,p[3]-=x.movementY);f.includes(T._enum.DIRECTION.SOUTH)&&(p[3]+=x.movementY);
if(p[0]<y[0]||p[0]+p[2]>y[0]+u)p[0]=B[0],p[2]=B[2];if(p[1]<y[1]||p[1]+p[3]>y[1]+q)p[1]=B[1],p[3]=B[3];p[2]<r&&(p[2]=B[2],p[0]+p[2]>y[0]+u&&(p[0]=y[0]+u-p[2]));p[3]<v&&(p[3]=B[3],p[1]+p[3]>y[1]+q&&(p[1]=y[1]+q-p[3]))}}else{x=[x.x,x.y];var M=[p[0]-h[2],p[1]-h[2],p[2]+h[4],p[3]+h[4]];var N=[p[0]-l,p[1]-l,p[2]+5,p[3]+5];x[0]>N[0]&&x[0]<N[0]+N[2]&&x[1]>N[1]&&x[1]<N[1]+N[3]?(B="move",d="drag"):x[0]>M[0]&&x[0]<M[0]+M[2]&&x[1]>M[1]&&x[1]<M[1]+M[3]?(d="resize",B=f="",x[1]>M[1]&&x[1]<N[1]&&(B=f+=T._enum.DIRECTION.NORTH),
x[1]>N[1]+N[3]&&x[1]<M[1]+M[3]&&(B=f+=T._enum.DIRECTION.SOUTH),x[0]>M[0]&&x[0]<N[0]&&(B=f+=T._enum.DIRECTION.WEST),x[0]>N[0]+N[2]&&x[0]<M[0]+M[2]&&(B=f+=T._enum.DIRECTION.EAST),B+="-resize"):(d=null,B="default");t.style.cssText+="cursor: "+B}};this.hide();D();document.addEventListener("keyup",Q);t.addEventListener("mousemove",L);t.addEventListener("dblclick",Y);document.body.appendChild(t)}},{key:"spin",value:function(c){var d=this,f,g,k,h;var l=this.variable.nodes.container.querySelector(".modal-layer-image-canvas");
var n=l.getContext("2d");var u=new OffscreenCanvas(l.width,l.height);u.getContext("2d").drawImage(l,0,0,l.width,l.height);this.variable.image.finish.then(function(){var q;c=null!==(q=c)&&void 0!==q?q:d.variable.image.spin.angle;l.style.transform="rotate("+c+"deg)";f=l.getBoundingClientRect();l.style.transform="scale(".concat(d.variable.image.spin.scale,")");d.option.layer.size||d.option.layer.sizeRange.max[0]>=f.width&&d.option.layer.sizeRange.max[1]>=f.height?k=d.variable.image.spin.scale:(h=T._assistant.number.getMaxLegalSize([f.width,
f.height],d.option.layer.sizeRange.max),k=h[0]/f.width);l.width=f.width;l.height=f.height;l.style.transform="scale(".concat(k,")");g=c*Math.PI/180;n.save();n.translate(l.width/2,l.height/2);n.rotate(g);n.drawImage(u,-u.width/2,-u.height/2);n.restore();d.resize()})}},{key:"filter",value:function(c){var d=this,f,g;var k=c.getAttribute("filter-type");var h=this.variable.nodes.container.querySelector(".modal-layer-image-canvas");if(h.getAttribute("load-status")!=T._enum.LOAD_STATUS.FAILED&&k){var l=h.getContext("2d");
var n=l.getImageData(0,0,h.width,h.height);var u=this.variable.image.layer.show();if(T._env.feature.Worker){var q="image-layer-worker-"+Date.now();var r="!"+T._worker.get("canvasFilter").toString()+"()";r=URL.createObjectURL(new Blob(r.split(""),{type:"text/javascript"}));T._assistant.worker.has(q)||T._assistant.worker.create(q,r);T._assistant.worker.listener(q).then(function(v){0==v.data.error?l.putImageData(new ImageData(new Uint8ClampedArray(v.data.buffer),h.width,h.height),0,0):console.error(Error(v.data.message));
u.then(function(){return d.variable.image.layer.hide()});T._assistant.worker.close(q)})}null===(f=(g={blur:function(){var v,t;var w=null!==(v=Number(c.getAttribute("data-sigma")))&&void 0!==v?v:1;v=null!==(t=Number(c.getAttribute("data-radius")))&&void 0!==t?t:3;if(T._env.feature.worker){var y;if(T._assistant.canvasFilter.__gaussianMask[["".concat(v,",").concat(w)]])var p=T._assistant.canvasFilter.__gaussianMask[["".concat(v,",").concat(w)]];else{t=0;p=[];for(y=-v;y<=v;y++){var D=T._assistant.formula.getDistribution(y,
w,1);p.push(D);t+=D}for(y=0;y<p.length;y++)p[y]/=t;T._assistant.canvasFilter.__gaussianMask[["".concat(v,",").concat(w)]]=p}T._assistant.worker.get(q).postMessage({sigma:w,radius:v,type:k,gaussianMask:p,buffer:n.data.buffer,size:[h.width,h.height]},[n.data.buffer])}else n=T._assistant.canvasFilter.gaussianBlur(n,v,w),l.putImageData(n,0,0),u.then(function(){return d.variable.image.layer.hide()})},gray:function(){T._env.feature.worker?T._assistant.worker.get(q).postMessage({type:k,buffer:n.data.buffer},
[n.data.buffer]):(n=T._assistant.canvasFilter.grayscale(l.getImageData(0,0,h.width,h.height)),l.putImageData(n,0,0),u.then(function(){return d.variable.image.layer.hide()}))},mirror:function(){var v,t=null!==(v=Number(c.getAttribute("mirror-axis")))&&void 0!==v?v:0;T._env.feature.worker?T._assistant.worker.get(q).postMessage({axis:t,type:k,buffer:n.data.buffer,size:[h.width,h.height]},[n.data.buffer]):(n=T._assistant.canvasFilter.mirror(l.getImageData(0,0,h.width,h.height),t),l.putImageData(n,0,0),
u.then(function(){return d.variable.image.layer.hide()}))}})[k])||void 0===f?void 0:f.call(g)}}},{key:"revert",value:function(){var c=this.variable.nodes.container.querySelector(".modal-layer-image-canvas");var d=c.getContext("2d");this.variable.image.spin.scale=1;c.width=this.variable.image["default"].size[0];c.height=this.variable.image["default"].size[1];c.removeAttribute("style");d.putImageData(this.variable.image["default"].imageData,0,0);this.resize()}},{key:"download",value:function(){var c,
d=this.variable.nodes.container.querySelector(".modal-layer-image-canvas"),f=null!==(c=d.getAttribute("download-filename"))&&void 0!==c?c:this.option.layer.toolbar.config.download.name+Date.now();T._assistant.canvas.download(d,f,this.option.layer.toolbar.config.download.mime)}}]);return a}(T);T._achieve.set("image",Ma);
var Na=function(e){function a(){K(this,a);return b.apply(this,arguments)}G(a,e);var b=H(a);O(a,[{key:"initStruct",value:function(){E(F(a.prototype),"initStruct",this).call(this);this.variable.struct._backup.interaction.innerHTML.push(this.variable.struct._backup.interaction_button.cancel)}}]);return a}(Ka);T._achieve.set("prompt",Na);
var Oa=function(e){function a(){K(this,a);return b.apply(this,arguments)}G(a,e);var b=H(a);O(a,[{key:"initStruct",value:function(){E(F(a.prototype),"initStruct",this).call(this);this.variable.struct._backup.interaction.innerHTML.push(this.variable.struct._backup.interaction_button.no)}}]);return a}(Ka);T._achieve.set("confirm",Oa);
var La=function(e){function a(){K(this,a);return b.apply(this,arguments)}G(a,e);var b=H(a);O(a,[{key:"initOption",value:function(c){E(F(a.prototype),"initOption",this).call(this,c);this.option.layer=T._assistant.object.merge(this.option.layer,T._option.loading);this.option.title=!1;this.option.drag.enable=!1;this.option.resize.enable=!1;this.option.progress.enable=!1;this.option.mask.clickRemove=!1;this.option.content.fullContainer=!0}},{key:"compatibleOption",value:function(c){var d={center:"center",
right:"flex-end",left:"flex-start"};E(F(a.prototype),"compatibleOption",this).call(this,c);if(!T._assistant.object.isEmpty(c.layer.position)){Array.isArray(c.layer.position)||(c.layer.position=[c.layer.position,c.layer.position]);for(var f=0;2>f;f++){var g;c.layer.position[f]=null!==(g=d[c.layer.position[f]])&&void 0!==g?g:c.layer.position[f];c.layer.position[f]=Number.isInteger(c.layer.position[f])?c.layer.position[f]+"px":c.layer.position[f]}}}},{key:"checkOption",value:function(){E(F(a.prototype),
"checkOption",this).call(this);if(!Array.isArray(this.option.layer.position)&&!["left","center","right"].includes(this.option.layer.position))throw Error("layer.position does not meet expectations");}},{key:"initStruct",value:function(){E(F(a.prototype),"initStruct",this).call(this);var c=this.variable.struct._build.container;var d=this.variable.struct._backup.content=T._struct.content;var f=this.variable.struct._backup.content_loading=T._struct.content_loading;var g=this.variable.struct._backup.content_loading_icon=
T._struct.content_loading_icon;Number.isInteger(Number(this.option.layer.icon))?f.innerHTML[0]=g[this.option.layer.icon]:f.innerHTML[0]["class"]+=" "+this.option.layer.icon;d.innerHTML.push(f);c.innerHTML.push(d)}},{key:"initNodeFinally",value:function(){E(F(a.prototype),"initNodeFinally",this).call(this);var c=this.variable.nodes.container;var d=c.querySelector(".modal-layer-content");var f=d.querySelector(".modal-layer-loading-icon");var g=d.querySelector(".modal-layer-loading-box");c.style.cssText+=
"background: transparent; box-shadow: none;";d.style.cssText+="background: "+this.option.layer.background;this.option.layer.position[0].endsWith("px")?f.style.cssText+="margin-left: ".concat(this.option.layer.position[0]):g.style.cssText+="align-items: ".concat(this.option.layer.position[0]);this.option.layer.position[1].endsWith("px")?f.style.cssText+="margin-top: ".concat(this.option.layer.position[1]):g.style.cssText+="justify-content: ".concat(this.option.layer.position[1],";");f.style.cssText+=
"font-size: "+this.option.layer.size+"px; width: "+this.option.layer.area[0]+"px; height: "+this.option.layer.area[1]+"px; color: "+this.option.layer.color+"; animation-duration: "+this.option.layer.duration+"s;";T._assistant.object.isEmpty(this.option.layer.rate)||(f.style.animationTimingFunction=this.option.layer.rate)}},{key:"resize",value:function(){if(this.option.window){var c=this.option.window.getBoundingClientRect();c=[0===c.width?window.innerWidth:c.width,0===c.height?window.innerHeight:
c.height]}else c=[window.innerWidth,window.innerHeight];this.variable.nodes.container.style.cssText+="width: ".concat(c[0],"px; height: ").concat(c[1],"px");this.variable.defaultArea=c;this.variable.defaultRect.width=c[0];this.variable.defaultRect.height=c[1]}}]);return a}(T);T._achieve.set("loading",La);
var Pa=function(e){function a(){K(this,a);return b.apply(this,arguments)}G(a,e);var b=H(a);O(a,[{key:"initOption",value:function(c){E(F(a.prototype),"initOption",this).call(this,c);this.option.title=!1;this.option.drag.enable=!1;this.option.drag.overflow=!1}},{key:"initStruct",value:function(){E(F(a.prototype),"initStruct",this).call(this);var c=this.variable.struct._build.container;var d=this.variable.struct._backup.content=T._struct.content;c.innerHTML.push(d);this.option.resize.enable&&(d=this.variable.struct._backup.resize_box=
T._struct.resize_box,c.innerHTML.push(d));this.option.progress.enable&&(d=this.variable.struct._backup.progress_bar=T._struct.progress_bar,c.innerHTML.push(d))}},{key:"initNode",value:function(){E(F(a.prototype),"initNode",this).call(this);var c=this.variable.nodes.container.querySelector(".modal-layer-content");if(this.option.content.value instanceof Object){var d=T._assistant.element.objectToNode(this.option.content.value);Object.keys(d).forEach(function(f){c.appendChild(d[f])})}else c.innerHTML=
this.option.content.value}}]);return a}(T);T._achieve.set("msg",Pa);T._achieve.set("message",Pa);
var Qa=function(e){function a(){K(this,a);return b.apply(this,arguments)}G(a,e);var b=H(a);O(a,[{key:"compatibleOption",value:function(c){E(F(a.prototype),"compatibleOption",this).call(this,c);T._assistant.object.isString(c.layer.location)&&(c.layer.location=document.querySelector(c.layer.location))}},{key:"checkOption",value:function(){E(F(a.prototype),"checkOption",this).call(this);var c=Object.values(T._enum.TIPS_POSITION);if(!this.option.layer.location instanceof Element)throw Error("option.layer.location does not meet the expected value");
if(!c.includes(this.option.layer.position))throw Error("option.layer.position does not meet the expected value.");}},{key:"initStruct",value:function(){E(F(a.prototype),"initStruct",this).call(this);var c=this.variable.struct._build.container;var d=T._assistant.object.getKeyByValue(T._enum.TIPS_POSITION,this.option.layer.position);var f=this.option.layer.iconSize;d={left:"right",right:"left",up:"bottom",down:"top"}[d.toLowerCase()];c.innerHTML.push({nodeType:"span","class":"depend-icon triangle-".concat(d),
style:"".concat(d,": -").concat(f,"px;border-width: ").concat(f,"px;border-").concat(d,"-width:0px")})}},{key:"initOption",value:function(c){var d=this;E(F(a.prototype),"initOption",this).call(this,c);this.option.layer=T._assistant.object.merge(this.option.layer,T._option.tips);T._instance.forEach(function(f){f instanceof a&&f!==d&&f.option.layer.location==d.option.layer.location&&f.option.layer.position==d.option.layer.position&&f.remove()});this.option.resize.enable=!1;this.option.progress.enable=
!1;this.option.mask.enable=!1}},{key:"positioning",value:function(){var c=this.option.layer.iconSize;var d=this.option.layer.position;var f=this.option.layer.location;var g=this.variable.nodes.container.getBoundingClientRect();f=f.getBoundingClientRect();if(d==T._enum.TIPS_POSITION.LEFT){var k=f.left-g.width-c;var h=f.top+(f.height-g.height)/2}d==T._enum.TIPS_POSITION.UP&&(k=f.left-(g.width-f.width)/2,h=f.top-g.height-c);d==T._enum.TIPS_POSITION.DOWN&&(k=f.left-(g.width-f.width)/2,h=f.top+f.height+
c);d==T._enum.TIPS_POSITION.RIGHT&&(k=f.width+f.left+c,h=f.top+(f.height-g.height)/2);this.variable.nodes.container.style.cssText+="top: ".concat(h,"px; left: ").concat(k,"px;")}}]);return a}(Pa);T._achieve.set("tips",Qa);window.Worker&&T._worker.set("canvasFilter",function(){this.onmessage=function(e){var a,b;e=null===(a=(b=e.data).type)||void 0===a?void 0:a.call(b,e.data);this.postMessage({error:0,buffer:e?e.buffer:void 0},[e.buffer])};this.C=function(){this.postMessage({error:1,message:"Failed to send message."})}});
var Ra=function(e){function a(){var c=0<arguments.length&&void 0!==arguments[0]?arguments[0]:T._enum.BROWSER_STORAGE.SESSIONSTORAGE;K(this,a);if(!window[c])throw Error("The current browser does not support ".concat(c," function"));var d=b.call(this);d._record=[];d._type=c;d._storage=window[c];return d}G(a,e);var b=H(a);O(a,[{key:"has",value:function(c){return null!==this._storage.getItem(c)?!0:!1}},{key:"get",value:function(c){var d;return null!==(d=this._storage.getItem(c))&&void 0!==d?d:!1}},{key:"set",
value:function(c){this._storage.setItem(c,1<arguments.length&&void 0!==arguments[1]?arguments[1]:"");this._record.push(c);return!0}},{key:"del",value:function(c){var d=this._record.indexOf(c);if(!(1<arguments.length&&void 0!==arguments[1]&&arguments[1])&&0>d)return!1;0<=d&&this._record.splice(d,1);this._storage.removeItem(c);return!0}},{key:"clear",value:function(){for(;0<this._record.length;)this._storage.removeItem(this._record.shift());return!0}}]);return a}(function(){function e(){K(this,e);P(this,
"_type",null);P(this,"_record",null);P(this,"_storage",null)}O(e,[{key:"has",value:function(){}},{key:"get",value:function(){}},{key:"set",value:function(){}},{key:"del",value:function(){}},{key:"clear",value:function(){}}]);return e}());Fa&&(Object.defineProperty(Fa._achieve,T._enum.BROWSER_STORAGE.LOCALSTORAGE,{value:Ra}),Object.defineProperty(Fa._achieve,T._enum.BROWSER_STORAGE.SESSIONSTORAGE,{value:Ra}));}(window);
