!function(window){"use strict";var n="function"==typeof Object.defineProperties?Object.defineProperty:function(e,b,c){if(e==Array.prototype||e==Object.prototype)return e;e[b]=c.value;return e};function aa(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<e.length;++b){var c=e[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");}var ba=aa(this);
function A(e,b){if(b)a:{var c=ba;e=e.split(".");for(var d=0;d<e.length-1;d++){var f=e[d];if(!(f in c))break a;c=c[f]}e=e[e.length-1];d=c[e];b=b(d);b!=d&&null!=b&&n(c,e,{configurable:!0,writable:!0,value:b})}}var ca;if("function"==typeof Object.setPrototypeOf)ca=Object.setPrototypeOf;else{var ea;a:{var fa={s:!0},ha={};try{ha.__proto__=fa;ea=ha.s;break a}catch(e){}ea=!1}ca=ea?function(e,b){e.__proto__=b;if(e.__proto__!==b)throw new TypeError(e+" is not extensible");return e}:null}var ia=ca;
A("Object.setPrototypeOf",function(e){return e||ia});A("Reflect",function(e){return e?e:{}});
var ja="function"==typeof Object.create?Object.create:function(e){function b(){}b.prototype=e;return new b},ka=function(){function e(){function c(){}new c;Reflect.construct(c,[],function(){});return new c instanceof c}if("undefined"!=typeof Reflect&&Reflect.construct){if(e())return Reflect.construct;var b=Reflect.construct;return function(c,d,f){c=b(c,d);f&&Reflect.setPrototypeOf(c,f.prototype);return c}}return function(c,d,f){void 0===f&&(f=c);f=ja(f.prototype||Object.prototype);return Function.prototype.apply.call(c,
f,d)||f}}();A("Reflect.construct",function(){return ka});function la(e){var b=0;return function(){return b<e.length?{done:!1,value:e[b++]}:{done:!0}}}A("Symbol",function(e){function b(f){if(this instanceof b)throw new TypeError("Symbol is not a constructor");return new c("jscomp_symbol_"+(f||"")+"_"+d++,f)}function c(f,g){this.a=f;n(this,"description",{configurable:!0,writable:!0,value:g})}if(e)return e;c.prototype.toString=function(){return this.a};var d=0;return b});
A("Symbol.iterator",function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var b="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),c=0;c<b.length;c++){var d=ba[b[c]];"function"===typeof d&&"function"!=typeof d.prototype[e]&&n(d.prototype,e,{configurable:!0,writable:!0,value:function(){return ma(la(this))}})}return e});function ma(e){e={next:e};e[Symbol.iterator]=function(){return this};return e}
A("Array.from",function(e){return e?e:function(b,c,d){c=null!=c?c:function(k){return k};var f=[],g="undefined"!=typeof Symbol&&Symbol.iterator&&b[Symbol.iterator];if("function"==typeof g){b=g.call(b);for(var h=0;!(g=b.next()).done;)f.push(c.call(d,g.value,h++))}else for(g=b.length,h=0;h<g;h++)f.push(c.call(d,b[h],h));return f}});
function na(e,b){e instanceof String&&(e+="");var c=0,d=!1,f={next:function(){if(!d&&c<e.length){var g=c++;return{value:b(g,e[g]),done:!1}}d=!0;return{done:!0,value:void 0}}};f[Symbol.iterator]=function(){return f};return f}A("Array.prototype.keys",function(e){return e?e:function(){return na(this,function(b){return b})}});A("Object.is",function(e){return e?e:function(b,c){return b===c?0!==b||1/b===1/c:b!==b&&c!==c}});
A("Array.prototype.includes",function(e){return e?e:function(b,c){var d=this;d instanceof String&&(d=String(d));var f=d.length;c=c||0;for(0>c&&(c=Math.max(c+f,0));c<f;c++){var g=d[c];if(g===b||Object.is(g,b))return!0}return!1}});function oa(e,b,c){if(null==e)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return e+""}
A("String.prototype.includes",function(e){return e?e:function(b,c){return-1!==oa(this,b,"includes").indexOf(b,c||0)}});function B(e,b){return Object.prototype.hasOwnProperty.call(e,b)}A("Object.values",function(e){return e?e:function(b){var c=[],d;for(d in b)B(b,d)&&c.push(b[d]);return c}});function C(e){var b="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];return b?b.call(e):{next:la(e)}}
A("Promise",function(e){function b(h){this.c=0;this.i=void 0;this.a=[];var k=this.g();try{h(k.resolve,k.reject)}catch(l){k.reject(l)}}function c(){this.a=null}function d(h){return h instanceof b?h:new b(function(k){k(h)})}if(e)return e;c.prototype.c=function(h){if(null==this.a){this.a=[];var k=this;this.g(function(){k.i()})}this.a.push(h)};var f=ba.setTimeout;c.prototype.g=function(h){f(h,0)};c.prototype.i=function(){for(;this.a&&this.a.length;){var h=this.a;this.a=[];for(var k=0;k<h.length;++k){var l=
h[k];h[k]=null;try{l()}catch(m){this.h(m)}}}this.a=null};c.prototype.h=function(h){this.g(function(){throw h;})};b.prototype.g=function(){function h(m){return function(p){l||(l=!0,m.call(k,p))}}var k=this,l=!1;return{resolve:h(this.B),reject:h(this.h)}};b.prototype.B=function(h){if(h===this)this.h(new TypeError("A Promise cannot resolve to itself"));else if(h instanceof b)this.D(h);else{a:switch(typeof h){case "object":var k=null!=h;break a;case "function":k=!0;break a;default:k=!1}k?this.A(h):this.l(h)}};
b.prototype.A=function(h){var k=void 0;try{k=h.then}catch(l){this.h(l);return}"function"==typeof k?this.F(k,h):this.l(h)};b.prototype.h=function(h){this.m(2,h)};b.prototype.l=function(h){this.m(1,h)};b.prototype.m=function(h,k){if(0!=this.c)throw Error("Cannot settle("+h+", "+k+"): Promise already settled in state"+this.c);this.c=h;this.i=k;this.v()};b.prototype.v=function(){if(null!=this.a){for(var h=0;h<this.a.length;++h)g.c(this.a[h]);this.a=null}};var g=new c;b.prototype.D=function(h){var k=this.g();
h.j(k.resolve,k.reject)};b.prototype.F=function(h,k){var l=this.g();try{h.call(k,l.resolve,l.reject)}catch(m){l.reject(m)}};b.prototype.then=function(h,k){function l(v,t){return"function"==typeof v?function(w){try{m(v(w))}catch(q){p(q)}}:t}var m,p,r=new b(function(v,t){m=v;p=t});this.j(l(h,m),l(k,p));return r};b.prototype.catch=function(h){return this.then(void 0,h)};b.prototype.j=function(h,k){function l(){switch(m.c){case 1:h(m.i);break;case 2:k(m.i);break;default:throw Error("Unexpected state: "+
m.c);}}var m=this;null==this.a?g.c(l):this.a.push(l)};b.resolve=d;b.reject=function(h){return new b(function(k,l){l(h)})};b.race=function(h){return new b(function(k,l){for(var m=C(h),p=m.next();!p.done;p=m.next())d(p.value).j(k,l)})};b.all=function(h){var k=C(h),l=k.next();return l.done?d([]):new b(function(m,p){function r(w){return function(q){v[w]=q;t--;0==t&&m(v)}}var v=[],t=0;do v.push(void 0),t++,d(l.value).j(r(v.length-1),p),l=k.next();while(!l.done)})};return b});
A("Number.isFinite",function(e){return e?e:function(b){return"number"!==typeof b?!1:!isNaN(b)&&Infinity!==b&&-Infinity!==b}});A("Number.isInteger",function(e){return e?e:function(b){return Number.isFinite(b)?b===Math.floor(b):!1}});
A("WeakMap",function(e){function b(l){this.a=(k+=Math.random()+1).toString();if(l){l=C(l);for(var m;!(m=l.next()).done;)m=m.value,this.set(m[0],m[1])}}function c(){}function d(l){var m=typeof l;return"object"===m&&null!==l||"function"===m}function f(l){if(!B(l,h)){var m=new c;n(l,h,{value:m})}}function g(l){var m=Object[l];m&&(Object[l]=function(p){if(p instanceof c)return p;Object.isExtensible(p)&&f(p);return m(p)})}if(function(){if(!e||!Object.seal)return!1;try{var l=Object.seal({}),m=Object.seal({}),
p=new e([[l,2],[m,3]]);if(2!=p.get(l)||3!=p.get(m))return!1;p.delete(l);p.set(m,4);return!p.has(l)&&4==p.get(m)}catch(r){return!1}}())return e;var h="$jscomp_hidden_"+Math.random();g("freeze");g("preventExtensions");g("seal");var k=0;b.prototype.set=function(l,m){if(!d(l))throw Error("Invalid WeakMap key");f(l);if(!B(l,h))throw Error("WeakMap key fail: "+l);l[h][this.a]=m;return this};b.prototype.get=function(l){return d(l)&&B(l,h)?l[h][this.a]:void 0};b.prototype.has=function(l){return d(l)&&B(l,
h)&&B(l[h],this.a)};b.prototype.delete=function(l){return d(l)&&B(l,h)&&B(l[h],this.a)?delete l[h][this.a]:!1};return b});
A("Map",function(e){function b(){var k={};return k.f=k.next=k.head=k}function c(k,l){var m=k.a;return ma(function(){if(m){for(;m.head!=k.a;)m=m.f;for(;m.next!=m.head;)return m=m.next,{done:!1,value:l(m)};m=null}return{done:!0,value:void 0}})}function d(k,l){var m=l&&typeof l;"object"==m||"function"==m?g.has(l)?m=g.get(l):(m=""+ ++h,g.set(l,m)):m="p_"+l;var p=k.c[m];if(p&&B(k.c,m))for(k=0;k<p.length;k++){var r=p[k];if(l!==l&&r.key!==r.key||l===r.key)return{id:m,list:p,index:k,b:r}}return{id:m,list:p,
index:-1,b:void 0}}function f(k){this.c={};this.a=b();this.size=0;if(k){k=C(k);for(var l;!(l=k.next()).done;)l=l.value,this.set(l[0],l[1])}}if(function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var k=Object.seal({x:4}),l=new e(C([[k,"s"]]));if("s"!=l.get(k)||1!=l.size||l.get({x:4})||l.set({x:4},"t")!=l||2!=l.size)return!1;var m=l.entries(),p=m.next();if(p.done||p.value[0]!=k||"s"!=p.value[1])return!1;p=m.next();return p.done||4!=p.value[0].x||
"t"!=p.value[1]||!m.next().done?!1:!0}catch(r){return!1}}())return e;var g=new WeakMap;f.prototype.set=function(k,l){k=0===k?0:k;var m=d(this,k);m.list||(m.list=this.c[m.id]=[]);m.b?m.b.value=l:(m.b={next:this.a,f:this.a.f,head:this.a,key:k,value:l},m.list.push(m.b),this.a.f.next=m.b,this.a.f=m.b,this.size++);return this};f.prototype.delete=function(k){k=d(this,k);return k.b&&k.list?(k.list.splice(k.index,1),k.list.length||delete this.c[k.id],k.b.f.next=k.b.next,k.b.next.f=k.b.f,k.b.head=null,this.size--,
!0):!1};f.prototype.clear=function(){this.c={};this.a=this.a.f=b();this.size=0};f.prototype.has=function(k){return!!d(this,k).b};f.prototype.get=function(k){return(k=d(this,k).b)&&k.value};f.prototype.entries=function(){return c(this,function(k){return[k.key,k.value]})};f.prototype.keys=function(){return c(this,function(k){return k.key})};f.prototype.values=function(){return c(this,function(k){return k.value})};f.prototype.forEach=function(k,l){for(var m=this.entries(),p;!(p=m.next()).done;)p=p.value,
k.call(l,p[1],p[0],this)};f.prototype[Symbol.iterator]=f.prototype.entries;var h=0;return f});
A("Set",function(e){function b(c){this.a=new Map;if(c){c=C(c);for(var d;!(d=c.next()).done;)this.add(d.value)}this.size=this.a.size}if(function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var c=Object.seal({x:4}),d=new e(C([c]));if(!d.has(c)||1!=d.size||d.add(c)!=d||1!=d.size||d.add({x:4})!=d||2!=d.size)return!1;var f=d.entries(),g=f.next();if(g.done||g.value[0]!=c||g.value[1]!=c)return!1;g=f.next();return g.done||g.value[0]==c||4!=g.value[0].x||
g.value[1]!=g.value[0]?!1:f.next().done}catch(h){return!1}}())return e;b.prototype.add=function(c){c=0===c?0:c;this.a.set(c,c);this.size=this.a.size;return this};b.prototype.delete=function(c){c=this.a.delete(c);this.size=this.a.size;return c};b.prototype.clear=function(){this.a.clear();this.size=0};b.prototype.has=function(c){return this.a.has(c)};b.prototype.entries=function(){return this.a.entries()};b.prototype.values=function(){return this.a.values()};b.prototype.keys=b.prototype.values;b.prototype[Symbol.iterator]=
b.prototype.values;b.prototype.forEach=function(c,d){var f=this;this.a.forEach(function(g){return c.call(d,g,g,f)})};return b});
A("WeakSet",function(e){function b(c){this.a=new WeakMap;if(c){c=C(c);for(var d;!(d=c.next()).done;)this.add(d.value)}}if(function(){if(!e||!Object.seal)return!1;try{var c=Object.seal({}),d=Object.seal({}),f=new e([c]);if(!f.has(c)||f.has(d))return!1;f.delete(c);f.add(d);return!f.has(c)&&f.has(d)}catch(g){return!1}}())return e;b.prototype.add=function(c){this.a.set(c,!0);return this};b.prototype.has=function(c){return this.a.has(c)};b.prototype.delete=function(c){return this.a.delete(c)};return b});
A("Object.entries",function(e){return e?e:function(b){var c=[],d;for(d in b)B(b,d)&&c.push([d,b[d]]);return c}});A("Array.prototype.values",function(e){return e?e:function(){return na(this,function(b,c){return c})}});A("String.prototype.endsWith",function(e){return e?e:function(b,c){var d=oa(this,b,"endsWith");void 0===c&&(c=d.length);c=Math.max(0,Math.min(c|0,d.length));for(var f=b.length;0<f&&0<c;)if(d[--c]!=b[--f])return!1;return 0>=f}});
A("Array.prototype.fill",function(e){return e?e:function(b,c,d){var f=this.length||0;0>c&&(c=Math.max(0,f+c));if(null==d||d>f)d=f;d=Number(d);0>d&&(d=Math.max(0,f+d));for(c=Number(c||0);c<d;c++)this[c]=b;return this}});function E(e){return e?e:Array.prototype.fill}A("Int8Array.prototype.fill",E);A("Uint8Array.prototype.fill",E);A("Uint8ClampedArray.prototype.fill",E);A("Int16Array.prototype.fill",E);A("Uint16Array.prototype.fill",E);A("Int32Array.prototype.fill",E);
A("Uint32Array.prototype.fill",E);A("Float32Array.prototype.fill",E);A("Float64Array.prototype.fill",E);A("String.prototype.startsWith",function(e){return e?e:function(b,c){var d=oa(this,b,"startsWith"),f=d.length,g=b.length;c=Math.max(0,Math.min(c|0,d.length));for(var h=0;h<g&&c<f;)if(d[c++]!=b[h++])return!1;return h>=g}});
function qa(e){"@babel/helpers - typeof";qa="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(b){return typeof b}:function(b){return b&&"function"===typeof Symbol&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b};return qa(e)}
function F(e,b,c){"undefined"!==typeof Reflect&&Reflect.get?F=Reflect.get:F=function(d,f,g){for(;!Object.prototype.hasOwnProperty.call(d,f)&&(d=G(d),null!==d););if(d)return f=Object.getOwnPropertyDescriptor(d,f),f.get?f.get.call(g):f.value};return F(e,b,c||e)}function H(e,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(b&&b.prototype,{constructor:{value:e,writable:!0,configurable:!0}});b&&ra(e,b)}
function ra(e,b){ra=Object.setPrototypeOf||function(c,d){c.__proto__=d;return c};return ra(e,b)}function J(e){var b=sa();return function(){var c=G(e);if(b){var d=G(this).constructor;c=Reflect.construct(c,arguments,d)}else c=c.apply(this,arguments);if(!c||"object"!==qa(c)&&"function"!==typeof c){if(void 0===this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");c=this}return c}}
function sa(){if("undefined"===typeof Reflect||!Reflect.construct||Reflect.construct.a)return!1;if("function"===typeof Proxy)return!0;try{return Reflect.construct(Date,[],function(){}),!0}catch(e){return!1}}function G(e){G=Object.setPrototypeOf?Object.getPrototypeOf:function(b){return b.__proto__||Object.getPrototypeOf(b)};return G(e)}
function L(e){var b=Array.isArray(e)?e:void 0;if(!b)if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){b=[];var c=!0,d=!1,f=void 0;try{for(var g=e[Symbol.iterator](),h;!(c=(h=g.next()).done)&&(b.push(h.value),2!==b.length);c=!0);}catch(k){d=!0,f=k}finally{try{if(!c&&null!=g["return"])g["return"]()}finally{if(d)throw f;}}}else b=void 0;if(!(e=b||ta(e,2)))throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
return e}function O(e){var b=Array.isArray(e)?ua(e):void 0;b||(b="undefined"!==typeof Symbol&&Symbol.iterator in Object(e)?Array.from(e):void 0);if(!(e=b||ta(e)))throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");return e}
function ta(e,b){if(e){if("string"===typeof e)return ua(e,b);var c=Object.prototype.toString.call(e).slice(8,-1);"Object"===c&&e.constructor&&(c=e.constructor.name);if("Map"===c||"Set"===c)return Array.from(e);if("Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return ua(e,b)}}function ua(e,b){if(null==b||b>e.length)b=e.length;for(var c=0,d=Array(b);c<b;c++)d[c]=e[c];return d}function P(e,b){if(!(e instanceof b))throw new TypeError("Cannot call a class as a function");}
function va(e,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(e,d.key,d)}}function Q(e,b,c){b&&va(e.prototype,b);c&&va(e,c)}function R(e,b,c){b in e?Object.defineProperty(e,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):e[b]=c}var S=Object.create(null);S.browser=Object.create(null);S.feature=Object.create(null);
["proxy","symbol","worker","promise"].forEach(function(e){e=e[0].toUpperCase()+e.substring(1);S.feature[e]=window[e]?!0:!1});Object.freeze(S);var T=Object.create(null);Object.defineProperty(T,"clickMask",{enumerable:!0,value:function(){void this.remove()}});Object.defineProperty(T,"interaction",{enumerable:!0,value:{ok:null,no:null,cancel:function(){void this.remove()}}});
Object.defineProperty(T,"active",{enumerable:!0,value:function(e){var b;var c=0;var d=this.variable.nodes;e=null!==(b=e)&&void 0!==b?b:window.event;U._instance.forEach(function(g){g.status===U._enum.STATUS.SHOW&&c++});if(2<=c){var f=U._assistant.element.maxZIndex();d.container.style.zIndex!=f&&(Object.keys(d).forEach(function(g){d[g].style.zIndex=f+1}),d.container.style.zIndex=parseInt(d.container.style.zIndex)+1)}}});
Object.defineProperty(T,"drag",{enumerable:!0,value:function(e){function b(v){var t;var w=[];v=null!==(t=v)&&void 0!==t?t:window.event;switch(v.code){case "ArrowUp":w[1]=-1;break;case "ArrowDown":w[1]=1;break;case "ArrowLeft":w[0]=-1;break;case "ArrowRight":w[0]=1;break;default:return}v.preventDefault();d(w[0],w[1])}function c(v){var t;v=h=null!==(t=v)&&void 0!==t?t:window.event;d(v.movementX,v.movementY)}function d(v,t){1!==h.buttons?r():(g.option.drag.overflow||(m.x+v<p[0]&&(m.x=p[0]-v),m.right+
v>p[1]&&(m.x=p[1]-m.width-v),m.y+t<p[2]&&(m.y=p[2]-t),m.bottom+t>p[3]&&(m.y=p[3]-m.height-t)),m.x+=v,m.y+=t,g.option.resize.enable&&g.option.content.fullContainer&&(v=[5,p[1]-m.width-5],t=[5,p[3]-m.height-5],m.x<=v[0]?m.x=v[0]:m.x>=v[1]&&(m.x=v[1]),m.y<=t[0]?m.y=t[0]:m.y>=t[1]&&(m.y=t[1])),l.style.marginLeft=m.x+"px",l.style.marginTop=m.y+"px",g.setStatus("drag"))}var f,g=this,h;var k=this.status;e=null!==(f=e)&&void 0!==f?f:window.event;var l=this.variable.nodes.container;var m=l.getBoundingClientRect();
e=window.document.documentElement.getBoundingClientRect();var p=[e.x,e.x+e.width,e.x,e.y+e.height];window.getSelection().empty();var r=function t(){document.removeEventListener("keyup",b,!0);document.removeEventListener("mousemove",c);document.removeEventListener("mouseup",t);g.setStatus(k)};document.addEventListener("mouseup",r);document.addEventListener("mousemove",c);document.addEventListener("keyup",b,!0)}});
Object.defineProperty(T,"resize",{enumerable:!0,value:function(e){function b(v){var t;if(1!==v.buttons)r();else{d.setStatus("resize");v=null!==(t=v)&&void 0!==t?t:window.event;t=v.screenX-l[0];var w=v.screenY-l[1];v=g.getAttribute("position-resize-bar");var q=[h.x,h.y,m[0],m[1]];v.includes("top")&&(q[1]+=w,q[3]-=w,q[1]<p.y&&(q[3]-=p.y-q[1]),q[3]<k[1]&&(q[1]+=q[3]-k[1],q[3]=k[1]));v.includes("bottom")&&(q[3]+=w,q[3]<k[1]&&(q[3]=k[1]));v.includes("left")&&(q[0]+=t,q[2]-=t,q[0]<p.x&&(q[2]-=p.x-q[0]),
q[2]<k[0]&&(q[0]+=q[2]-k[0],q[2]=k[0]));v.includes("right")&&(q[2]+=t,q[2]<k[0]&&(q[2]=k[0]));d.resizeByXYWH(Number(q[0]),Number(q[1]),Number(q[2]),Number(q[3]))}}var c,d=this;var f=this.status;e=null!==(c=e)&&void 0!==c?c:window.event;var g=e.target;var h=this.variable.nodes.container.getBoundingClientRect();var k=this.variable.defaultArea;var l=[e.screenX,e.screenY];var m=[h.width,h.height];var p=document.documentElement.getBoundingClientRect();window.getSelection().empty();var r=function t(){document.removeEventListener("mousemove",
b);document.removeEventListener("mouseup",t);d.setStatus(f)};document.addEventListener("mouseup",r);document.addEventListener("mousemove",b)}});Object.defineProperty(T,"minimizeRevert",{enumerable:!0,value:function(){if("1"!=this.getAttribute("clicked")){this.setAttribute("clicked",1);var e=Number(this.getAttribute("modal-layer-index"));delete U._minimizeQueue[U._minimizeQueue.indexOf(U._instance[e])]}}});
Object.defineProperty(T,"autoShutdown",{enumerable:!0,value:function(){var e=this;var b=1E3*this.option.popupTime;var c=setInterval(function(){if(e.variable.nodes.container.classList.contains("modal-layer-show")){if(e.option.progress.enable){var d=e.variable.nodes.container.querySelector(".modal-layer-progress-bar-progress");switch(e.option.progress.position){case "top":case "bottom":var f="widthFull";break;case "left":case "right":f="heightFull"}d.style.animation=f+" "+e.option.popupTime+"s linear forwards"}e.variable.timeout.auto_shutdown=
setTimeout(function(){return void e.remove()},b);window.clearInterval(c)}},10)}});
Object.defineProperty(T,"action",{enumerable:!0,value:{close:function(){void this.remove()},expand:function(){var e=this;var b=this.status;var c=this.variable.nodes.container.querySelector("iframe[name="+this.option.layer.name+this.option.index+"]");var d=function(g){g.target===c?e.setStatus(U._enum.STATUS.EXPAND):!1===g.target&&e.setStatus(b);window.removeEventListener("fullscreenerror",f);window.removeEventListener("fullscreenchange",d)};var f=function(g){U.K({J:!1,L:5,title:"\u9519\u8bef",H:!0,
I:"bottom",content:'<i class="fas fa-window-close" style="color: red"></i> \u5168\u5c4f\u5931\u8d25, \u9519\u8bef\u539f\u56e0: '+g});window.removeEventListener("fullscreenerror",f);window.removeEventListener("fullscreenchange",d)};window.addEventListener("fullscreenerror",f);window.addEventListener("fullscreenchange",d);U._assistant.element.launchFullscreen(c)},minimize:function(){var e=U._minimizeQueue.indexOf(this);0>e?U._minimizeQueue.push(this):U._minimizeQueue.splice(e,1)}}});
Object.defineProperty(T,"imageTools",{enumerable:!0,value:{crop:function(){this.variable.image.status===U._enum.LOAD_STATUS.LOADED&&this.crop()},spin:function(){this.variable.image.status===U._enum.LOAD_STATUS.LOADED&&this.spin()},filter:function(e){this.variable.image.status===U._enum.LOAD_STATUS.LOADED&&this.filter((null!==e&&void 0!==e?e:window.event).target)},revert:function(){this.variable.image.status===U._enum.LOAD_STATUS.LOADED&&this.revert()},download:function(){this.variable.image.status===
U._enum.LOAD_STATUS.LOADED&&this.download()}}});Object.freeze(T);var V=Object.create(null);Object.defineProperty(V,"page",{value:{src:null,srcdoc:null,frameborder:0,scrolling:"no",area:[800,600],allowfullscreen:!0,name:"modal-layer-page-"}});Object.defineProperty(V,"loading",{value:{icon:0,size:48,rate:null,duration:2,area:[48,48],color:"white",background:"transparent",position:["center","center"]}});
Object.defineProperty(V,"image",{value:{image:[],size:null,sizeRange:{min:[.15625,.160257],max:[.9,.9]},toolbar:{enable:!1,config:{crop:{enable:!1,title:"crop",grid:"quarter",icon:"fas fa-crop-alt"},spin:{enable:!1,title:"spin",icon:"fas fa-redo-alt"},filter:{enable:!1,config:{blur:{enable:!1,title:"blur",icon:null,textIcon:"\u6a21"},gray:{enable:!1,title:"gray",icon:null,textIcon:"\u7070"},mirror:{enable:!1,title:"mirror",icon:null,textIcon:"\u955c"}},title:"filter",icon:"fas fa-filter"},revert:{enable:!1,
title:"revert",icon:"fas fa-sync-alt"},download:{enable:!1,title:"download",icon:"fas fa-download"}}}}});
Object.defineProperty(V,"common",{value:{index:0,ui:"modal-layer-ui",title:null,window:null,popupTime:5,skin:"default",parentModalLayer:null,areaProportion:[.18,.21],content:{value:null,fullContainer:!1},text:{action:{close:"\u5173\u95ed",expand:"\u5168\u5c4f",minimize:"\u6700\u5c0f\u5316"},interaction:{ok:"\u786e\u5b9a",no:"\u62d2\u7edd",cancel:"\u53d6\u6d88"}},transition:{time:.2,opacity:0,scale:[.45,.45]},mask:{enable:!0,clickRemove:!0},drag:{enable:!0,overflow:!1},resize:{enable:!0},progress:{enable:!1,
position:"bottom",color:"deepskyblue",background:"#cecece"},layer:{},hook:{initStart:null,initEnded:null}}});Object.freeze(V);var W=Object.create(null);Object.defineProperty(W,"mask",{get:function(){return JSON.parse(JSON.stringify({nodeType:"div","class":"modal-layer-mask"}))},enumerable:!0,configurable:!1});Object.defineProperty(W,"container",{get:function(){return JSON.parse(JSON.stringify({innerHTML:[],nodeType:"div","class":"modal-layer-container"}))},enumerable:!0,configurable:!1});
Object.defineProperty(W,"action",{get:function(){return JSON.parse(JSON.stringify({innerHTML:[],nodeType:"div","class":"modal-layer-action"}))},enumerable:!0,configurable:!1});
Object.defineProperty(W,"action_button",{get:function(){return JSON.parse(JSON.stringify({minimize:{nodeType:"span","data-fa-transform":"up-4 shrink-2","class":"fas fa-window-minimize modal-layer-action-btn modal-layer-action-btn-minimize"},expand:{nodeType:"span","data-fa-transform":"shrink-2","class":"fas fa-expand-arrows-alt modal-layer-action-btn modal-layer-action-btn-expand"},close:{nodeType:"span","data-fa-transform":"rotate-45 grow-1","class":"fas fa-plus modal-layer-action-btn modal-layer-action-btn-close"}}))},
enumerable:!0,configurable:!1});Object.defineProperty(W,"title",{get:function(){return JSON.parse(JSON.stringify({nodeType:"div","class":"modal-layer-title",innerHTML:[{nodeType:"h4","class":"modal-layer-title-content"}]}))},enumerable:!0,configurable:!1});Object.defineProperty(W,"content",{get:function(){return JSON.parse(JSON.stringify({innerHTML:[],nodeType:"div","class":"modal-layer-content"}))},enumerable:!0,configurable:!1});
Object.defineProperty(W,"content_text",{get:function(){return JSON.parse(JSON.stringify({nodeType:"div","class":"modal-layer-text-content"}))},enumerable:!0,configurable:!1});Object.defineProperty(W,"content_page",{get:function(){return JSON.parse(JSON.stringify({name:"",frameborder:0,scrolling:"no",nodeType:"iframe","class":"modal-layer-page-content"}))},enumerable:!0,configurable:!1});
Object.defineProperty(W,"content_image",{get:function(){return JSON.parse(JSON.stringify({"load-status":2,nodeType:"canvas","class":"modal-layer-image-canvas"}))},enumerable:!0,configurable:!1});Object.defineProperty(W,"content_loading",{get:function(){return JSON.parse(JSON.stringify({nodeType:"div","class":"modal-layer-loading-box",innerHTML:[{nodeType:"span","class":"modal-layer-loading-icon"}]}))},enumerable:!0,configurable:!1});
Object.defineProperty(W,"content_loading_icon",{get:function(){return JSON.parse(JSON.stringify([{nodeType:"span","class":"modal-layer-loading-icon fas fa-spinner fa-spin fa-fw"},{nodeType:"span","class":"modal-layer-loading-icon fas fa-circle-notch fa-spin fa-fw"},{nodeType:"span","class":"modal-layer-loading-icon fas fa-sync fa-spin fa-fw"},{nodeType:"span","class":"modal-layer-loading-icon fas fa-cog fa-spin fa-fw"}]))},enumerable:!0,configurable:!1});
Object.defineProperty(W,"toolbar",{get:function(){return JSON.parse(JSON.stringify({innerHTML:[],nodeType:"div","class":"modal-layer-toolbar"}))},enumerable:!0,configurable:!1});Object.defineProperty(W,"interaction",{get:function(){return JSON.parse(JSON.stringify({innerHTML:[],nodeType:"div","class":"modal-layer-interaction"}))},enumerable:!0,configurable:!1});
Object.defineProperty(W,"interaction_button",{get:function(){return JSON.parse(JSON.stringify({ok:{nodeType:"span","class":"modal-layer-interaction-btn modal-layer-interaction-btn-ok"},no:{nodeType:"span","class":"modal-layer-interaction-btn modal-layer-interaction-btn-no"},cancel:{nodeType:"span","class":"modal-layer-interaction-btn modal-layer-interaction-btn-cancel"}}))},enumerable:!0,configurable:!1});
Object.defineProperty(W,"progress_bar",{get:function(){return JSON.parse(JSON.stringify({nodeType:"div","class":"modal-layer-progress-bar",innerHTML:[{nodeType:"div","class":"modal-layer-progress-bar-background",innerHTML:[{nodeType:"span","class":"modal-layer-progress-bar-progress"}]}]}))},enumerable:!0,configurable:!1});
Object.defineProperty(W,"resize_box",{get:function(){return JSON.parse(JSON.stringify({nodeType:"div","class":"modal-layer-resize-box",innerHTML:[{nodeType:"div","class":"modal-layer-resize-bar","position-resize-bar":"top"},{nodeType:"div","class":"modal-layer-resize-bar","position-resize-bar":"left"},{nodeType:"div","class":"modal-layer-resize-bar","position-resize-bar":"right"},{nodeType:"div","class":"modal-layer-resize-bar","position-resize-bar":"bottom"},{nodeType:"div","class":"modal-layer-resize-bar",
"position-resize-bar":"left-top"},{nodeType:"div","class":"modal-layer-resize-bar","position-resize-bar":"right-top"},{nodeType:"div","class":"modal-layer-resize-bar","position-resize-bar":"left-bottom"},{nodeType:"div","class":"modal-layer-resize-bar","position-resize-bar":"right-bottom"}]}))},enumerable:!0,configurable:!1});Object.defineProperty(W,"minimize_queue",{get:function(){return JSON.parse(JSON.stringify({innerHTML:[],nodeType:"div",id:"modal-layer-minimize-queue"}))},enumerable:!0,configurable:!1});
Object.defineProperty(W,"minimize_queue_item",{get:function(){return JSON.parse(JSON.stringify({nodeType:"div","class":"modal-layer-minimize-queue-item",innerHTML:[{nodeType:"h4","class":"modal-layer-minimize-queue-item-title"}]}))},enumerable:!0,configurable:!1});
Object.defineProperty(W,"image_tools",{get:function(){return JSON.parse(JSON.stringify({crop:{title:"crop",nodeType:"div","tool-type":"crop",innerHTML:[{nodeType:"span","class":"modal-layer-toolbar-item-icon"}],"class":"modal-layer-toolbar-item"},spin:{title:"spin",nodeType:"div","tool-type":"spin",innerHTML:[{nodeType:"span","class":"modal-layer-toolbar-item-icon"}],"class":"modal-layer-toolbar-item"},revert:{title:"revert",nodeType:"div","tool-type":"revert",innerHTML:[{nodeType:"span","class":"modal-layer-toolbar-item-icon"}],
"class":"modal-layer-toolbar-item"},filter:{title:"filter",nodeType:"div","tool-type":"filter",innerHTML:[{nodeType:"span","class":"modal-layer-toolbar-item-icon"},{innerHTML:[],nodeType:"div","class":"modal-layer-toolbar-item-child-list"}],"class":"modal-layer-toolbar-item"},download:{title:"save",nodeType:"div","tool-type":"download",innerHTML:[{nodeType:"span","class":"modal-layer-toolbar-item-icon"}],"class":"modal-layer-toolbar-item"}}))},enumerable:!0,configurable:!1});
Object.defineProperty(W,"image_tools_child",{get:function(){return JSON.parse(JSON.stringify({filter:{mirror:{title:"\u955c\u50cf",innerText:"\u955c",nodeType:"span","filter-type":"mirror","class":"modal-layer-toolbar-filter-icon"},blur:{"data-radius":3,"data-sigma":1.5,innerText:"\u6a21",title:"\u9ad8\u65af\u6a21\u7cca",nodeType:"span","filter-type":"blur","class":"modal-layer-toolbar-filter-icon"},gray:{title:"\u7070\u5ea6\u5316",innerText:"\u7070",nodeType:"span","filter-type":"gray","class":"modal-layer-toolbar-filter-icon"}}}))},
enumerable:!0,configurable:!1});Object.freeze(W);var X=Object.create(null);Object.defineProperty(X,"ARROW",{enumerable:!0,value:{LEFT:37,UP:38,RIGHT:39,DOWN:40}});Object.defineProperty(X,"POSITION",{enumerable:!0,value:{EAST:"e",WEST:"w",SOUTH:"s",NORTH:"n"}});Object.defineProperty(X,"TYPE",{enumerable:!0,value:{MSG:0,MESSAGE:0,ALERT:1,PROMPT:2,CONFIRM:3,PAGE:4,LOADING:5,IMAGE:6,VIDEO:7,AUTDIO:8}});
Object.defineProperty(X,"STATUS",{enumerable:!0,value:{HIDE:0,SHOW:1,EXPAND:2,MINIMIZE:3,REMOVING:4,REMOVED:5,DRAG:6,RESIZE:7}});Object.defineProperty(X,"LOAD_STATUS",{enumerable:!0,value:{FAILED:0,LOADED:1,LOADING:2}});Object.freeze(X);
var U=function(){function e(b,c){P(this,e);R(this,"type",null);R(this,"status",null);R(this,"event",null);R(this,"option",null);R(this,"variable",{});try{var d,f,g,h,k,l;null===(d=b.hook)||void 0===d?void 0:null===(f=d.initStart)||void 0===f?void 0:null===(g=f.call)||void 0===g?void 0:g.call(f,b);this.type=b.type;this.status=e._enum.STATUS.HIDE;this.compatibleOption(b);this.initOption(b);this.checkOption();this.linkageOption();this.initVariable();this.initStruct();this.initNode();this.initNodeFinally();
this.initEvent();this.bindEvent();null===(h=this.option.hook)||void 0===h?void 0:null===(k=h.initEnded)||void 0===k?void 0:null===(l=k.call)||void 0===l?void 0:l.call(k,this);this.insertNode()}catch(m){null===c||void 0===c?void 0:c.call(null,m)}}Q(e,[{key:"initOption",value:function(b){var c;b.index=e._instance.length;b.window=null!==(c=b.window)&&void 0!==c?c:window.document.body;this.option=e._assistant.object.merge(b,e._option.common)}},{key:"compatibleOption",value:function(b){var c,d;if("boolean"===
typeof b.mask||["true","false"].includes(b.mask))b.mask={enable:!!b.mask,clickRemove:!0};if(!b.content||e._assistant.object.isEmpty(b.content.value))b.content={value:b.content,fullContainer:null!==(c=null===(d=b.content)||void 0===d?void 0:d.fullContainer)&&void 0!==c?c:!1}}},{key:"linkageOption",value:function(){0>=this.option.popupTime&&(this.option.progress.enable=!1);!1===this.option.title&&(this.option.drag.enable=!1)}},{key:"checkOption",value:function(){}},{key:"initVariable",value:function(){this.variable.struct=
Object.create(null);this.variable.timeout=Object.create(null);this.variable.interval=Object.create(null);this.variable.eventSymbol=Object.create(null);this.variable.animationName=Object.create(null);this.variable.struct._build=Object.create(null);this.variable.struct._backup=Object.create(null)}},{key:"initStruct",value:function(){var b;if(null===(b=this.option.mask)||void 0===b?0:b.enable)this.variable.struct._build.mask=e._struct.mask;this.variable.struct._build.container=e._struct.container}},
{key:"initNode",value:function(){this.variable.nodes=e._assistant.element.objectToNode(this.variable.struct._build);var b=this.variable.nodes.container;var c=b.querySelector(".modal-layer-interaction-btn-ok");var d=b.querySelector(".modal-layer-interaction-btn-no");var f=b.querySelector(".modal-layer-interaction-btn-cancel");b.setAttribute("modal-layer-popup-time",this.option.popupTime);b.setAttribute("content-full-container",Number(this.option.content.fullContainer));b.setAttribute("modal-layer-type",
e._assistant.object.getKeyByValue(e._enum.TYPE,this.type).toLowerCase());b.setAttribute("allow-drag",Number(this.option.drag.enable));b.setAttribute("allow-resize",Number(this.option.resize.enable));if(this.option.progress.enable){var g=["top","left","right","bottom"];var h=b.querySelector(".modal-layer-progress-bar");g.includes(this.option.progress.position)||(this.option.progress.position=g[3]);h.setAttribute("progress-bar-position",this.option.progress.position);h.querySelector(".modal-layer-progress-bar-progress").style.cssText+=
"background: "+this.option.progress.color;h.querySelector(".modal-layer-progress-bar-background").style.cssText+="background: "+this.option.progress.background}if(!1!==this.option.title){var k=b.querySelector(".modal-layer-title-content");if(this.option.title instanceof Object){var l=e._assistant.element.objectToNode(this.option.title);Object.keys(l).forEach(function(m){k.appendChild(l[m])})}else k.innerHTML=this.option.title}c&&(c.innerText=this.option.text.interaction.ok);d&&(d.innerText=this.option.text.interaction.no);
f&&(f.innerText=this.option.text.interaction.cancel)}},{key:"initNodeFinally",value:function(){var b=this.option.ui;var c="modal-layer-skin-"+this.option.skin;var d="modal-layer-index-"+this.option.index;var f="transition-opacity-"+100*this.option.transition.opacity+"-animation";var g="transition-scale-"+100*this.option.transition.scale[0]+"-"+100*this.option.transition.scale[1]+"-animation";this.variable.animationName.transition_opacity=f;this.variable.animationName.transition_scale=g;if(!e._assistant.css.hasCss(f)){var h=
{from:"opacity: "+this.option.transition.opacity,to:"opacity: 1"};var k=e._assistant.css.createAnimation(f,h);e._assistant.css.addCss(f,k);e._assistant.css.addCss(f+"-reverse",e._assistant.css.createAnimation(f+"-reverse",{from:h.to,to:h.from}))}e._assistant.css.hasCss(g)||(f={from:"transform: scale("+this.option.transition.scale[0]+", "+this.option.transition.scale[1]+")",to:"transform: scale(1, 1)"},k=e._assistant.css.createAnimation(g,f),e._assistant.css.addCss(g,k),e._assistant.css.addCss(g+"-reverse",
e._assistant.css.createAnimation(g+"-reverse",{from:f.M,to:f.from})));Object.keys(this.variable.nodes).forEach(function(l){for(var m=e._assistant.element.getAllElement(this.variable.nodes[l]),p=0;p<m.length;p++)m[p].classList.add(b);this.variable.nodes[l].className=b+" "+c+" "+d+" "+this.variable.nodes[l].className.trim()+" modal-layer-hide"},this);e._instance[this.option.index]=this}},{key:"initEvent",value:function(){var b;this.event=e._assistant.object.merge(null!==(b=this.option.event)&&void 0!==
b?b:{},e._event)}},{key:"bindEvent",value:function(){var b={once:!1,capture:!1,passive:!1,mozSystemGroup:!1};this.option.mask.enable&&this.option.mask.clickRemove&&(this.variable.eventSymbol.maskClickRemove=e._assistant.event.add(this.variable.nodes.mask,"click",null,this.event.clickMask,this,null,b));this.option.drag.enable&&(this.variable.eventSymbol.drag=e._assistant.event.add(this.variable.nodes.container.querySelector(".modal-layer-title"),"mousedown",null,this.event.drag,this,null,b));this.option.resize.enable&&
(this.variable.eventSymbol.resize=e._assistant.event.add(this.variable.nodes.container,"mousedown",".modal-layer-resize-bar",this.event.resize,this,null,b));this.variable.eventSymbol.active=e._assistant.event.add(this.variable.nodes.container,"mousedown",null,this.event.active,this,null,b);this.event.action.close instanceof Function&&(this.variable.eventSymbol.actionClose=e._assistant.event.add(this.variable.nodes.container,"click",".modal-layer-action-btn-close",this.event.action.close,this,null,
b));this.event.action.expand instanceof Function&&(this.variable.eventSymbol.actionExpand=e._assistant.event.add(this.variable.nodes.container,"click",".modal-layer-action-btn-expand",this.event.action.expand,this,null,b));this.event.action.minimize instanceof Function&&(this.variable.eventSymbol.actionMinimize=e._assistant.event.add(this.variable.nodes.container,"click",".modal-layer-action-btn-minimize",this.event.action.minimize,this,null,b));var c=this.variable.nodes.container.querySelector(".modal-layer-interaction-btn-ok");
var d=this.variable.nodes.container.querySelector(".modal-layer-interaction-btn-no");var f=this.variable.nodes.container.querySelector(".modal-layer-interaction-btn-cancel");this.event.interaction.ok&&c&&(this.variable.eventSymbol.interactionOk=e._assistant.event.add(c,"click",null,this.event.interaction.ok,this,null,b));this.event.interaction.no&&d&&(this.variable.eventSymbol.interactionNo=e._assistant.event.add(d,"click",null,this.event.interaction.no,this,null,b));f&&(this.variable.eventSymbol.interactionCancel=
e._assistant.event.add(f,"click",null,this.event.interaction.cancel,this,null,b))}},{key:"insertNode",value:function(){var b=this;Object.keys(this.variable.nodes).forEach(function(c){var d,f=b.option.window;if(f instanceof String||"string"===typeof f)f=b.option.window=null!==(d=document.querySelector(f))&&void 0!==d?d:window.a.body;f.insertAdjacentElement||(f=b.option.window=window.document.body);f.insertAdjacentElement("beforeend",b.variable.nodes[c])},this)}}]);Q(e,[{key:"setStatus",value:function(b){if(Object.values(e._enum.STATUS).includes(b))this.status=
b,this.variable.nodes.container.setAttribute("modal-layer-status",e._assistant.object.getKeyByValue(e._enum.STATUS,b));else{b=b.toUpperCase();if(void 0===e._enum.STATUS[b])throw Error("Illegal value");this.status=e._enum.STATUS[b];this.variable.nodes.container.setAttribute("modal-layer-status",b.toLowerCase())}}},{key:"resize",value:function(){var b=window.innerWidth;var c=0;var d=this.variable.nodes.container;var f=d.children;var g=this.option.areaProportion[0].toString().length-(this.option.areaProportion[0].toString().indexOf(".")+
1);g=10*b*g*this.option.areaProportion[0]/(10*g);d.style.width=g+"px";for(b=0;b<f.length;b++)c="absolute"==getComputedStyle(f[b],null).position?c:Math.max(e._assistant.element.getNodeHeight(f[b]),c);d.style.height=c+"px";this.variable.defaultArea=[g,c]}},{key:"resizeByXYWH",value:function(b,c,d,f){var g=this.variable.nodes.container;var h=document.documentElement.getBoundingClientRect();b<h.x&&(b=h.x);b+d>h.right&&(d=h.right-b);c<h.y&&(c=h.y);c+f>h.bottom&&(f=h.bottom-c);g.style.marginLeft=b+"px";
g.style.marginTop=c+"px";g.style.width=d+"px";g.style.height=f+"px";[e._enum.TYPE.PAGE,e._enum.TYPE.VIDEO,e._enum.TYPE.AUDIO].includes(this.type)&&(b=g.querySelector("iframe[name="+this.option.layer.name+this.option.index+"]"),b.style.width=this.option.layer.area[0]+d-this.variable.defaultArea[0]+"px",b.style.height=this.option.layer.area[1]+f-this.variable.defaultArea[1]+"px")}},{key:"show",value:function(){var b=this;var c=this.variable.nodes;var d=e._assistant.element.maxZIndex();if(0===Object.keys(c).length||
this.status===e._enum.STATUS.SHOW)return Promise.resolve();var f=this.variable.animationName.transition_opacity+" "+this.option.transition.time+"s ease forwards";var g=this.variable.animationName.transition_scale+" "+this.option.transition.time+"s ease forwards";Object.keys(c).forEach(function(k){c[k].style.zIndex=d+1});var h=new Promise(function(k){c.container.onanimationend=function(){0<b.option.popupTime&&b.event.autoShutdown.call(b);c.container.onanimationend=null;k()}});c.mask&&(c.mask.style.animation=
f);c.container.style.animation=f+", "+g;Object.keys(c).forEach(function(k){c[k].classList.contains("modal-layer-hide")&&c[k].classList.replace("modal-layer-hide","modal-layer-show")},this);this.setStatus("show");return h}},{key:"hide",value:function(){var b=this;var c=this.variable.nodes;if(0===Object.keys(c).length||this.status===e._enum.STATUS.HIDE)return Promise.resolve();Number.isInteger(this.variable.timeout.auto_shutdown)&&window.clearTimeout(this.variable.timeout.auto_shutdown);var d=this.variable.animationName.transition_opacity+
"-reverse "+this.option.transition.time+"s ease forwards";var f=this.variable.animationName.transition_scale+"-reverse "+this.option.transition.time+"s ease forwards";var g=new Promise(function(h){c.container.onanimationend=function(){Object.keys(c).forEach(function(k){c[k].classList.contains("modal-layer-show")&&c[k].classList.replace("modal-layer-show","modal-layer-hide")});b.setStatus("hide");c.container.onanimationend=null;null!==b.option.parentModalLayer&&b.option.parentModalLayer.show();h()}});
c.mask&&(c.mask.style.animation=d);c.container.style.animation=d+", "+f;return g}},{key:"minimize",value:function(){var b=this;if(this.status!==e._enum.STATUS.MINIMIZE){var c=document.querySelector("#modal-layer-minimize-queue");c||(c=e._assistant.element.objectToNode([e._struct.minimize_queue])[0],c.classList.add(this.option.ui,"modal-layer-skin-".concat(this.option.skin)),e._variable.minimizeQueueEvent=e._assistant.event.add(c,"click",".modal-layer-minimize-queue-item",this.event.minimizeRevert,
null,null,!1),document.body.insertAdjacentElement("beforeend",c));var d=this.variable.nodes.container.querySelector(".modal-layer-title-content").innerHTML;var f=e._assistant.element.objectToNode([e._struct.minimize_queue_item])[0];f.classList.add(this.option.ui);f.setAttribute("modal-layer-index",this.option.index);f.querySelector(".modal-layer-minimize-queue-item-title").innerHTML=d;c.insertAdjacentElement("beforeend",f);var g=setInterval(function(){f.parentNode&&(f.style.animation="opacity 0.3s ease forwards, "+
b.variable.animationName.minimize_queue_transition_scale+" 0.3s ease forwards",clearInterval(g))},10);this.hide().then(function(){return void b.setStatus("minimize")})}}},{key:"revert",value:function(){var b=this;var c=document.querySelector("#modal-layer-minimize-queue");var d=c.querySelector('.modal-layer-minimize-queue-item[modal-layer-index="'+this.option.index+'"]');if([e._enum.STATUS.MINIMIZE].includes(this.status)){d.onanimationstart=function(){setTimeout(function(){b.show();d.onanimationstart=
null},150)};var f=new Promise(function(g){d.onanimationend=function(){d.remove();0>=e._minimizeQueue.length&&(c.remove(),e._assistant.event.remove(e._variable.minimizeQueueEvent));g()}});d.style.animation="opacity-reverse 0.3s ease forwards, "+this.variable.animationName.minimize_queue_transition_scale+"-reverse 0.3s ease forwards";return f}}},{key:"remove",value:function(){var b=this;var c=this.variable.nodes;if(0===Object.keys(c).length||[e._enum.STATUS.REMOVING,e._enum.STATUS.REMOVED].includes(this.status))return Promise.resolve();
this.status===e._enum.STATUS.MINIMIZE&&delete e._minimizeQueue[e._minimizeQueue.indexOf(this)];this.setStatus("removing");return this.hide().then(function(){b.removeAllEvent();Object.keys(c).forEach(function(d){c[d].remove()});b.setStatus("removed")})}},{key:"delete",value:function(){var b=this;this.remove().then(function(){e.a.splice(b.option.index,1);e._assistant.object.dereference(b.event);e._assistant.object.dereference(b.option);e._assistant.object.dereference(b.variable);b.event=b.option=b.variable=
null})}},{key:"removeAllEvent",value:function(){var b;if(0!==Object.keys(b=this.variable.nodes).length){Object.values(this.variable.eventSymbol).forEach(function(g){return e._assistant.event.remove(g)});var c=b.container.querySelector(".modal-layer-interaction-btn-ok");var d=b.container.querySelector(".modal-layer-interaction-btn-no");var f=b.container.querySelector(".modal-layer-interaction-btn-cancel");b.container.removeEventListener("mousedown",this.event.active);b.container.removeEventListener("click",
this.event.action.close);b.container.removeEventListener("click",this.event.action.expand);b.container.removeEventListener("click",this.event.action.minimize);c&&c.removeEventListener("click",this.event.interaction_ok);d&&d.removeEventListener("click",this.event.interaction_no);f&&f.removeEventListener("click",this.event.interaction_cancel);document.removeEventListener("click",this.event.minimizeRevert)}}}],[{key:"removeAll",value:function(){for(var b=0;b<e._instance.length;b++)e._instance[b].remove()}},
{key:"msg",value:function(b,c){e.message(b,c)}},{key:"message",value:function(b,c){"string"===typeof b?b={content:b,type:e._enum.TYPE.MESSAGE}:b.type=e._enum.TYPE.MESSAGE;b=new (e._achieve.get("message"))(b,c);b.resize();b.show();return b}},{key:"alert",value:function(b,c){b.type=e._enum.TYPE.ALERT;b=new (e._achieve.get("alert"))(b,c);b.resize();b.show();return b}},{key:"confirm",value:function(b,c){b.type=e._enum.TYPE.CONFIRM;b=new (e._achieve.get("confirm"))(b,c);b.resize();b.show();return b}},
{key:"prompt",value:function(b,c){b.type=e._enum.TYPE.PROMPT;b=new (e._achieve.get("prompt"))(b,c);b.resize();b.show();return b}},{key:"page",value:function(b,c){b.type=e._enum.TYPE.PAGE;b=new (e._achieve.get("page"))(b,c);b.resize();b.show();return b}},{key:"image",value:function(b,c){var d=null;b.type=e._enum.TYPE.IMAGE;d=new (e._achieve.get("image"))(b,c);d.variable.image.finish.then(function(){return d.resize()}).then(function(){return d.show()});return d}},{key:"loading",value:function(b,c){b.type=
e._enum.TYPE.LOADING;b=new (e._achieve.get("loading"))(b,c);b.resize();b.show();return b}}]);return e}();R(U,"_env",S);R(U,"_enum",X);R(U,"_struct",W);R(U,"_option",V);R(U,"_variable",new Map);R(U,"_worker",window.Worker?new Map:void 0);R(U,"_event",T);R(U,"_version",1);R(U,"_achieve",new Map);R(U,"_assistant",new Map);R(U,"_instance",new Proxy([],{set:function(e,b,c){if(c instanceof U||"length"===b)return e[b]=c,!0;throw new TypeError("Must be of type ModalLayer");}}));
R(U,"_minimizeQueue",new Proxy([],{set:function(e,b,c){if(c instanceof U){var d=e.indexOf(c);c.minimize();0>d?e[b]=c:e[d]=c;return!0}return"length"===b?(e[b]=c,!0):!1},deleteProperty:function(e,b){b=parseInt(b);if(Number.isInteger(b)&&e[b]instanceof U){e[b].revert();if(e[b+1])for(;b<e.length-1;b++)e[b]=e[b+1];delete e[e.length-1];e.length--;return!0}}}));Object.seal(U);
Object.is(window.ModalLayer,U)?(console.group("ModalLayer already exists"),console.log("Already version ".concat(window.ModalLayer._version)),console.log("Try to introduce version: ".concat(U._version)),console.groupEnd()):(Object.preventExtensions(U),Object.defineProperty(window,"ModalLayer",{value:U}));
var wa=function(){function e(){P(this,e)}Q(e,null,[{key:"createAnimation",value:function(b,c){var d="@keyframes "+b+" {";Object.keys(c).forEach(function(f){d+=f+"{"+c[f]+"}"});return d+"}"}},{key:"hasCss",value:function(b){return e.cssList.has(b)}},{key:"addCss",value:function(b,c){if(e.hasCss(b))return!1;e.styleNode||(e.styleNode=document.createElement("style"),document.head.appendChild(e.styleNode));c=c.trim();e.cssList.set(b,c);e.styleNode.innerHTML+=e.delimiter+c}},{key:"delCss",value:function(b){e.hasCss(b)&&
(b=new RegExp(e.delimiter+e.cssList.get(b),"g"),e.styleNode.innerHTML=e.styleNode.innerHTML.replace(b,""))}}]);return e}();R(wa,"cssList",new Map);R(wa,"delimiter","\n");R(wa,"styleNode",null);Object.defineProperty(U._assistant,"css",{value:wa});
var xa=function(){function e(){P(this,e)}Q(e,null,[{key:"getFileBinary",value:function(b){return fetch(b,{mode:"cors",method:"get",cache:"no-cache",redirect:"follow",referrer:"no-referrer",credentials:"same-origin",headers:{"content-type":"text/plain"}})}},{key:"getFileBlob",value:function(b){var c=null;b instanceof Blob?c=Promise.resolve(b):b instanceof Image||b instanceof Element&&"IMAGE"===b.nodeName?c=this.u(b.src).then(function(d){return d.blob()}):"string"===typeof b||b instanceof String?c=
this.u(b).then(function(d){return d.blob()}):c=Promise.reject(!1);return c}},{key:"getImage",value:function(b){var c=null;"string"===typeof b||b instanceof String?c=b:b instanceof Image||b instanceof Element&&"IMAGE"===b.nodeName?c=b.src:b instanceof Blob||b instanceof MediaSource?c=URL.createObjectURL(b):c=!1;return c}},{key:"getImageSize",value:function(b){var c=new Image,d=new Promise(function(f,g){c.onload=function(){f([c.width,c.height])};c.onerror=function(){g(!1)}});c.src=b;return d}}]);return e}();
Object.defineProperty(U._assistant,"file",{value:xa});
var Y=function(){function e(){P(this,e)}Q(e,null,[{key:"has",value:function(b){var c,d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;d=null!==(c=d)&&void 0!==c?c:e;return(c=e._symbol.get(d))?d[c].has(b):!1}},{key:"get",value:function(b){var c,d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;d=null!==(c=d)&&void 0!==c?c:e;return(c=e._symbol.get(d))?d[c].get(b):void 0}},{key:"set",value:function(b,c){var d,f=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;f=null!==
(d=f)&&void 0!==d?d:e;e._symbol.has(f)?d=e._symbol.get(f):(d=Symbol("cache"),e._symbol.set(f,d));f.hasOwnProperty(d)||Object.defineProperty(f,d,{value:new Map,writable:!1,enumerable:!1,configurable:!1});f[d].set(b,c)}},{key:"delete",value:function(){var b,c=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;d=null!==(b=d)&&void 0!==b?b:e;var f=e._symbol.get(d);if(c)d[f]["delete"](c);else d[f].forEach(function(g,h){d[f]["delete"](h)})}},
{key:"clear",value:function(){e._symbol.forEach(function(b,c){e["delete"](null,c)})}}]);return e}();R(Y,"_symbol",new Map);Object.defineProperty(U._assistant,"cache",{value:Y});
var ya=function(){function e(){P(this,e)}Q(e,null,[{key:"add",value:function(b,c,d,f,g,h,k){var l,m=7<arguments.length&&void 0!==arguments[7]?arguments[7]:!1;var p=!1;var r=Symbol();if(!(b instanceof EventTarget||(b=document.querySelector(b))))throw Error("Is not a valid element.");if(!Z.isString(c))throw Error("Event type not allowed to be empty");d instanceof EventTarget&&(b=d,d=null);f instanceof Function||(p=!0);Z.isEmpty(g)&&(g=null!==(l=d)&&void 0!==l?l:b);Z.isEmpty(h)||Array.isArray(h)||(h=
[h]);Z.isEmpty(k)&&(k=!1);if(p){var v;h=[{target:g,symbol:r,parameter:null!==(v=h)&&void 0!==v?v:[]}]}else{var t;h=null!==(t=h)&&void 0!==t?t:[]}l=d?new Promise(function(w){function q(x){var z=(null!==x&&void 0!==x?x:window.event).target;var u=b.querySelectorAll(d);if(z.contains(b)||0===u.length)return!1;for(var K=0;K<u.length;K++){var I=u[K];if(I.contains(z)){z=I===z?z:I;p?(h[0].event=x,h[0].target=g===d?z:g):0<h.length&&h[h.length-1]instanceof Event?h[h.length-1]=x:h.push(x);(p?w:f).apply(g===d?
z:g,h);break}}}e._event.set(r,{type:c,element:b,options:k,selector:d,callback:q,wantsUntrusted:m});b.addEventListener(c,q,k,m)}):new Promise(function(w){var q;f=(q=p?w:f).bind.apply(q,[g].concat(O(h)));e._event.set(r,{type:c,element:b,options:k,selector:d,callback:f,wantsUntrusted:m});b.addEventListener(c,f,k,m)});return p?l:r}},{key:"remove",value:function(b){var c=e._event.get(b);c&&(c.element.removeEventListener(c.type,c.callback,c.options),e._event["delete"](b),Z.dereference(c))}},{key:"removeBy",
value:function(b,c){if(!["element","selector","callback"].includes)throw Error("key value is invalid");e._event.forEach(function(d,f){d[b]===c&&(d.element.removeEventListener(d.type,d.callback,d.options,d.wantsUntrusted),e._event["delete"](f))})}},{key:"removeAll",value:function(){e._event.forEach(function(b,c){b.element.removeEventListener(b.type,b.callback,b.options,b.wantsUntrusted);e._event["delete"](c)})}}]);return e}();R(ya,"_event",new Map);Object.defineProperty(U._assistant,"event",{value:ya});
var za=function(){function e(){P(this,e)}Q(e,null,[{key:"has",value:function(b){return e.list.has(b)}},{key:"add",value:function(b,c){if(!(c instanceof Worker))throw new TypeError("Not a Worker instance.");if(e.has(b))throw Error("The key already exists.");e.list.set(b,c)}},{key:"get",value:function(b){return e.list.get(b)}},{key:"create",value:function(b,c){try{var d=new Worker(c);e.list.set(b,d)}catch(f){throw f;}return d}},{key:"close",value:function(b){var c;b instanceof Worker||(b=e.get(b),e.list["delete"](b));
null===(c=b)||void 0===c?void 0:c.terminate()}},{key:"listener",value:function(b){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:void 0;if(!(b instanceof Worker)&&(b=e.get(b),void 0===b))throw Error("Worker not found.");return new Promise(function(d,f){b.C=f;b.onmessage=function(g){null===c||void 0===c?void 0:c(g);d(g)}})}},{key:"addListener",value:function(b){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:void 0;if(!(b instanceof Worker)&&(b=e.get(b),void 0===b))throw Error("Worker not found.");
return new Promise(function(d,f){b.addEventListener("messageerror",f);b.addEventListener("message",function(g){null===c||void 0===c?void 0:c(g);d(g)})})}}]);return e}();R(za,"list",new Map);Object.defineProperty(U._assistant,"worker",{value:za});
var Z=function(){function e(){P(this,e)}Q(e,null,[{key:"dereference",value:function(b){Object.keys(b).forEach(function(c){var d=b[c];if(e.isCollection(d))if(e.dereference(d),d instanceof Map)b["delete"](c);else if(d instanceof Set)b["delete"](d);else b[c]=null})}},{key:"get",value:function(b,c){c=Array.isArray(c)?c:c.split(".");for(var d=0;d<c.length&&!e.isEmpty(b);d++)b=b[c[d]];return b}},{key:"set",value:function(b,c,d){c=Array.isArray(c)?c:c.split(".");for(var f=0;f<c.length;b=b[c[f]],f++)f===
c.length-1?Object.defineProperty(b,c[f],{value:d,writable:!0,enumerable:!0,configurable:!0}):e.isEmpty(b[c[f]])&&b[c[f]].constructor===Object||(b[c[f]]={})}},{key:"isEmpty",value:function(b){return null===b||void 0===b}},{key:"isString",value:function(b){return"string"===typeof b||b instanceof String}},{key:"isCollection",value:function(b){return!e.isEmpty(b)&&(Array.isArray(b)||b instanceof Map||b instanceof Set||e.isOnlyObject(b))}},{key:"isEnumerableCollection",value:function(b){return e.isCollection(b)&&
!(b instanceof WeakMap||b instanceof WeakSet)}},{key:"isOnlyObject",value:function(b){return b&&(b.constructor===Object||void 0===b.constructor)}},{key:"getMethod",value:function(b,c,d){for(;!e.isEmpty(b);){if(Object.is(b.constructor,c))return b[d];b=b.__proto__}return null}},{key:"getKeyByValue",value:function(b,c){b=Object.entries(b);for(var d=0;d<b.length;d++)if(b[d][1]===c)return b[d][0];return null}},{key:"deepCopy",value:function(b){var c,d;if(e.isEmpty(b))return b;var f=null!==(c=null===(d=
b.constructor)||void 0===d?void 0:d.call(b))&&void 0!==c?c:Object.create(null);c=[f];d=[[Object.keys(b),Object.values(b)]];do{b=c.shift();var g=d.shift();var h=L(g);g=h[0];var k=h[1];for(var l=0;l<g.length;l++){h=g[l];var m=k[l];if(e.isCollection(m)){var p,r,v;b[h]=null!==(p=null===(r=(v=m).constructor)||void 0===r?void 0:r.call(v))&&void 0!==p?p:Object.create(null);d.push([Object.keys(m),Object.values(m)]);c.push(b[h])}else b[h]=m}}while(0<d.length);return f}},{key:"merge",value:function(b,c){var d,
f;if(e.isEmpty(b))return c;if(e.isEmpty(c))return b;var g=null!==(d=null===(f=c.constructor)||void 0===f?void 0:f.call(c))&&void 0!==d?d:Object.create(null);d=[g];c=[[[Object.keys(b),Object.values(b)],[Object.keys(c),Object.values(c)]]];do{b=d.shift();f=c.shift();var h=L(f);var k=L(h[0]);f=k[0];k=k[1];var l=L(h[1]);h=l[0];var m=l[1];h=O(new Set(h.concat(f)));for(var p=0;p<h.length;p++){var r=[h[p],m[p]];l=r[0];var v=r[1];r=k[f.indexOf(l)];var t=e.isEmpty(r);if((e.isEmpty(r)||e.isCollection(r))&&e.isCollection(v)){var w,
q,x=[];b[l]=null!==(w=null===(q=t?v.constructor:r.constructor)||void 0===q?void 0:q())&&void 0!==w?w:Object.create(null);x[1]=[Object.keys(v),Object.values(v)];x[0]=t?[[],[]]:[Object.keys(r),Object.values(r)];d.push(b[l]);c.push(x)}else!e.isCollection(r)&&e.isCollection(v)?b[l]=r:Object.defineProperty(b,l,{writable:!0,enumerable:!0,value:t?v:r})}}while(0<c.length);return g}}]);return e}();Object.defineProperty(U._assistant,"object",{value:Z});
var Ba=function(){function e(){P(this,e)}Q(e,null,[{key:"mul",value:function(b,c){var d,f;b=[b.toString().split("."),c.toString().split(".")];c=Math.pow(10,Math.max(null!==(d=b[0][1].length)&&void 0!==d?d:0,null!==(f=b[1][1].length)&&void 0!==f?f:0));b=[[Number(b[0][0]),Number("0."+b[0][1])*c],[Number(b[1][0]),Number("0."+b[1][1])*c]];return(0!==b[0][0]?b[0][0]:1)*(0!==b[1][0]?b[1][0]:1)+b[0][1]*b[1][1]/c}},{key:"div",value:function(b,c){var d,f,g,h;var k=Math.pow(10,Math.max(null!==(d=null===(f=
b.toString().split(".")[1])||void 0===f?void 0:f.length)&&void 0!==d?d:0,null!==(g=null===(h=c.toString().split(".")[1])||void 0===h?void 0:h.length)&&void 0!==g?g:0));return b*k/(c*k)}},{key:"getMedian",value:function(b){b=b.map(function(d){return d}).sort(function(d,f){return d-f});if(1===b.length%2){var c=window.parseInt(b.length/2);b=b[c]}else c=window.parseInt(b.length/2),b=(b[c-1]+b[c])/2;return b}},{key:"getMode",value:function(b){var c,d;var f=0;var g=[];var h=new Map;b.forEach(function(k){var l;
d=null!==(l=h.get(k))&&void 0!==l?l:0;h.set(k,d+1)});f=(c=Math).max.apply(c,O(h.values()));h.forEach(function(k,l){k===f&&g.push(l)});return g}},{key:"isFloat",value:function(b){var c;if(window.isNaN(c=window.parseFloat(b))||Math.floor(c)==c)return!1;if(b.endsWith("%")){if(100<c)return!1}else if(b.endsWith("\u2030")){if(1E3<c)return!1}else return!1;return!0}},{key:"getMinLegalSize",value:function(b,c){var d=[];var f=b[0]/b[1];var g=1>f?0:1;var h=Number(!g);b[g]<c[g]?(d[g]=c[g],d[h]=0===g?c[g]/f:c[g]*
f):d=b;return d}},{key:"getMaxLegalSize",value:function(b,c){if(!b||!c||b[0]<=c[0]&&b[1]<=c[1])return b;var d=[];var f=b[0]/b[1];var g=1<=c[0]/c[1]?1:0;var h=Number(!g);b[g]>c[g]?(d[g]=c[g],d[h]=0===g?c[g]/f:c[g]*f):d=b;return d}},{key:"intervalJudgment",value:function(b,c){c=c.replace(/ /g,"").toLowerCase();var d={"(":">",")":"<","[":">=","]":"<="};var f=c[0];var g=c.slice(-1);var h=Object.keys(d);c=c.slice(1,-1).split(",");c[0]=Number(c[0]);c[1]=Number(c[1]);return h.includes(f)||h.includes(g)?
(new Function('"use strict"; return '+(b+d[f]+c[0]+"&&"+b+d[g]+c[1])))():!1}},{key:"insideRect",value:function(b,c){var d=c[0];c=c[1];return b[0]<d[0]||b[1]<d[1]||b[0]>c[0]||b[1]>c[1]?!1:!0}}]);return e}();window.math&&(Ba.__proto__=window.math);Object.defineProperty(U._assistant,"number",{value:Ba});
var Ca=function(){function e(){P(this,e)}Q(e,null,[{key:"base64Encode",value:function(b){return window.btoa(window.unescape(window.encodeURIComponent(b)))}},{key:"base64Decode",value:function(b){return window.decodeURIComponent(window.escape(window.atob(b)))}},{key:"ucfirst",value:function(b){return b[0].toUpperCase()+b.substring(1)}},{key:"replace",value:function(b,c,d){var f=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,g,h,k;var l=Array.isArray(b);var m=Array.isArray(c);var p=Array.isArray(d);
if(m&&p&&c.length!==d.length)throw Error("The number of search strings does not match the number of replacement strings.");var r=[];b=l?b:[b];c=m?c:[c];d=p?d:[d];var v=g=h=k=0;do{var t=c[k];var w=d[p?k:0];var q=0===k?b[h]:r[h];var x=g;var z=q.indexOf(t,g);-1===z?m&&k<c.length-1?(g=0,k++):l&&h<b.length-1?(h++,g=k=0):g=!1:(g=z+t.length,r[h]=q.substring(x,z)+w+q.substring(g))}while(!1!==g||0!==f&&v<f);return l?r:r.shift()}},{key:"colorConvert",value:function(b){b=b.toLowerCase();var c=Error("Not a legal color.");
if(0===b.indexOf("#")){var d="rgba(";b=b.substring(1);3===b.length&&(b=b.split("").reduce(function(g,h){return g+h+h},""));if(6===b.length)for(c=0;3>c;c++)d+=Number("0x"+b[2*c]+b[2*c+1])+", ";else throw c;d+="255)"}else if(0===b.indexOf("rgb")){d="#";b=b.replace(/(rgb\(|rgba\(|\)| )/g,"").split(",");for(var f=0;3>f;f++)c=Number(b[f]).toString(16),d+=1===c.length?c+c:c}else throw c;return d}}]);return e}();Object.defineProperty(U._assistant,"string",{value:Ca});
var Da=function(){function e(){P(this,e)}Q(e,null,[{key:"isOverflow",value:function(b,c){b=b.getBoundingClientRect();c=c.getBoundingClientRect();return b.x<c.x||b.x+b.width>c.x+c.width||b.y<c.y||b.y+b.height>c.y+c.height?!0:!1}},{key:"getAllElement",value:function(b){var c=[];b=b.children;if(0!==b.length)for(var d=0;d<b.length;d++)c.push(b[d]),c=c.concat(e.getAllElement(b[d]));return c}},{key:"getNodeHeight",value:function(b){return b.offsetTop+b.offsetHeight+parseInt(getComputedStyle(b,null).marginBottom)}},
{key:"getBeforeElementHeight",value:function(b){var c;for(c=0;(b=b.previousElementSibling)&&!["absolute","fixed"].includes(getComputedStyle(b,null).position);)c+=b.offsetHeight;return c}},{key:"getNodeOriginalSize",value:function(b){var c=[0,0];e.getAllElement(b).forEach(function(d){"absolute"!=getComputedStyle(d,null).position&&(c[0]=d.offsetWidth>c[0]?d.offsetWidth:c[0],d.parentNode===b&&(c[1]+=d.offsetHeight))});return c}},{key:"maxZIndex",value:function(){var b=Array.from(document.all);return parseInt(b.reduce(function(c,
d){d=getComputedStyle(d,null).zIndex;return Math.max(c,isNaN(d)?0:d)},0))}},{key:"objectToNode",value:function(b){var c={},d;for(d in b){var f=document.createElement(b[d].nodeType);if("undefined"!=typeof b[d].nodeType){for(var g in b[d])if("nodeType"!=g)if("innerhtml"==g.toLocaleLowerCase()){var h=e.objectToNode(b[d][g]),k;for(k in h)f.insertAdjacentElement("beforeend",h[k])}else"innertext"==g.toLocaleLowerCase()?f.insertAdjacentText("beforeend",b[d][g]):f.setAttribute(g,b[d][g]);c[d]=f}}return c}},
{key:"launchFullscreen",value:function(b){return b.requestFullscreen(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{navigationUI:"show"})}},{key:"exitFullscreen",value:function(){document.exitFullscreen()}},{key:"getFullscreenNode",value:function(){return document.fullscreenElement}},{key:"createScript",value:function(b){var c=document.createElement("script");"src type async defer charset innerHTML".split(" ").forEach(function(d){b[d]&&(c[d]=b[d])});return c}}]);return e}();
Object.defineProperty(U._assistant,"element",{value:Da});
var Ea=function(){function e(){P(this,e)}Q(e,null,[{key:"getDistribution",value:function(b,c){var d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:2,f,g;(g=Y.get("gaussian",e))||(g=new Map,Y.set("gaussian",g,e));(f=g.get(c))||(f=Object.create(null),f.square=c*c,f.multiplier=[1/(c*Math.sqrt(2*Math.PI)),1/(2*Math.PI*f.square)],g.set(c,f));switch(d){case 1:var h=Math.exp(-(b*b)/(2*f.square));break;case 2:h=Math.exp(-(Math.pow(b[0],2)+Math.pow(b[1],2))/(2*f.square))}return f.multiplier[d-1]*h}}]);
return e}();Object.defineProperty(U._assistant,"formula",{value:Ea});
var Fa=function(){function e(){P(this,e)}Q(e,null,[{key:"drawText",value:function(b,c){c=Z.o(c,{text:null,fill:!0,color:"black",direction:"ltr",textAlign:"center",textBaseline:"middle",font:"normal 16px Microsoft YaHei, serif",point:[b.canvas.width/2,b.canvas.height/2]});c.text&&(b.save(),b.font=c.font,b.fillStyle=c.color,b.direction=c.direction,b.textAlign=c.textAlign,b.textBaseline=c.textBaseline,c.point[1]+=b.measureText(c.text).G/2,!0===c.fill?b.fillText.apply(b,[c.text].concat(O(c.point),[c.maxWidth])):
b.strokeText.apply(b,[c.text].concat(O(c.point),[c.maxWidth])),b.restore())}},{key:"drawRound",value:function(b,c){c=Z.o(c,{step:[],radius:5,fill:!0,borderWidth:5,borderColor:"black",fillColor:"transparent",point:[b.canvas.width/2,b.canvas.height/2]});b.save();b.fillStyle=c.fillColor;b.lineWidth=c.borderWidth;b.strokeStyle=c.borderColor;b.beginPath();b.setLineDash(c.step);b.arc.apply(b,O(c.point).concat([c.radius,0,2*Math.PI]));b.stroke();!0===c.fill&&b.fill();b.restore()}},{key:"drawRect",value:function(b){var c=
1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,f=3<arguments.length?arguments[3]:void 0,g=4<arguments.length?arguments[4]:void 0,h=5<arguments.length&&void 0!==arguments[5]?arguments[5]:1,k=6<arguments.length&&void 0!==arguments[6]?arguments[6]:"white",l=7<arguments.length&&void 0!==arguments[7]?arguments[7]:!1;b.save();b.lineWidth=h;Array.isArray(l)?(b.strokeStyle=k,b.setLineDash(l),b.strokeRect(c,d,f,g)):(b.fillStyle=k,b.fillRect(c,
d,f,g));b.restore()}},{key:"drawLBorder",value:function(b){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,f=3<arguments.length?arguments[3]:void 0,g=4<arguments.length?arguments[4]:void 0,h=5<arguments.length&&void 0!==arguments[5]?arguments[5]:25,k=6<arguments.length&&void 0!==arguments[6]?arguments[6]:5,l=7<arguments.length&&void 0!==arguments[7]?arguments[7]:"#0eb0f1",m=8<arguments.length&&void 0!==arguments[8]?arguments[8]:
!1;b.save();Array.isArray(m)?b.strokeStyle=l:(b.fillStyle=l,b.fillRect(c,d,h,k),b.fillRect(c,d,k,h),b.fillRect(c+f,d,-h,k),b.fillRect(c+f,d,-k,h),b.fillRect(c+f,d+g,-h,-k),b.fillRect(c+f,d+g,-k,-h),b.fillRect(c,d+g,h,-k),b.fillRect(c,d+g,k,-h));b.restore()}},{key:"drawGrid",value:function(b){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,f=3<arguments.length?arguments[3]:void 0,g=4<arguments.length?arguments[4]:void 0,h=5<
arguments.length&&void 0!==arguments[5]?arguments[5]:1,k=6<arguments.length&&void 0!==arguments[6]?arguments[6]:"black",l=7<arguments.length&&void 0!==arguments[7]?arguments[7]:"quarter",m=8<arguments.length&&void 0!==arguments[8]?arguments[8]:!1;if(e["drawGrid"+Ca.ucfirst(l)]instanceof Function)e["drawGrid"+Ca.ucfirst(l)](b,c,d,null!==f&&void 0!==f?f:b.canvas.width,null!==g&&void 0!==g?g:b.canvas.height,h,k,m);else throw Error(l+" grid not detected");}},{key:"drawGridQuarter",value:function(b){var c=
1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,f=3<arguments.length?arguments[3]:void 0,g=4<arguments.length?arguments[4]:void 0,h=5<arguments.length&&void 0!==arguments[5]?arguments[5]:1,k=6<arguments.length&&void 0!==arguments[6]?arguments[6]:"black",l=7<arguments.length&&void 0!==arguments[7]?arguments[7]:!1;var m=[Ba.divide(f,4),Ba.divide(g,4)];b.save();b.beginPath();b.lineWidth=h;b.strokeStyle=k;Array.isArray(l)&&b.setLineDash(l);
for(h=1;4>h;h++)b.moveTo(m[0]*h+c,d),b.lineTo(m[0]*h+c,d+g),b.moveTo(c,m[1]*h+d),b.lineTo(c+f,m[1]*h+d);b.stroke();b.restore()}},{key:"layerMerge",value:function(b,c,d,f,g){var h=5<arguments.length&&void 0!==arguments[5]?arguments[5]:"source-over",k;(k=Y.get("mergeCas",e))||(k=new OffscreenCanvas(b.canvas.width,b.canvas.height),Y.set("mergeCas",k,e));var l=k.getContext("2d");l.save();l.drawImage.apply(l,[c].concat(O(d)));l.globalCompositeOperation=h;l.drawImage.apply(l,[f].concat(O(g)));b.clearRect(0,
0,b.canvas.width,b.canvas.height);b.drawImage(k,0,0);l.restore();l.clearRect(0,0,k.width,k.height)}},{key:"download",value:function(b){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"canvas",d=2<arguments.length?arguments[2]:void 0;if(Y.has("downloadNode",e))var f=Y.get("downloadNode",e);else f=document.createElement("a"),Y.set("downloadNode",f,e);f.download=c;f.href=b.toDataURL(d);f.click()}}]);return e}();Object.defineProperty(U._assistant,"canvas",{value:Fa});
var Ga=function(){function e(){P(this,e)}Q(e,null,[{key:"getImagedata",value:function(b){if(b instanceof Image){var c=document.createElement("canvas");var d=c.getContext("2d");d.drawImage(b,0,0);b=d.getImageData(0,0,c.width,c.height)}else if(!(b instanceof ImageData))throw Error("can not parse image");return b}},{key:"grayscale",value:function(b){try{var c=e.getImagedata(b);var d=c.width*c.height*4;var f=new Uint8ClampedArray(c.data.length);for(b=0;b<d;b+=4){var g=c.data[b];var h=c.data[b+1];var k=
c.data[b+2];var l=c.data[b+3];var m=.299*g+.587*h+.114*k;f[b]=m;f[b+1]=m;f[b+2]=m;f[b+3]=l}}catch(p){throw p;}return new ImageData(f,c.width,c.height)}},{key:"gaussianBlur",value:function(b){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:3,d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,f,g,h,k,l,m,p;try{var r=e.getImagedata(b);var v=r.width;var t=r.height;var w=0;(g=Y.get("gaussianMask",e))||(g=new Map,Y.set("gaussianMask",g,e));if(!(f=g.get("".concat(c,",").concat(d)))){f=
[];for(p=-c;p<=c;p++){var q=Ea.getDistribution(p,d,1);f.push(q);w+=q}for(q=0;q<f.length;q++)f[q]/=w;g.set("".concat(c,",").concat(d),f)}var x=new Uint8ClampedArray(r.data.length);for(m=0;m<t;m++)for(l=0;l<v;l++){var z=h=k=w=0;var u=4*(m*v+l);for(d=-c;d<=c;d++){var K=l+d;p=d+c;if(0<=K&&K<v){var I=4*(m*v+K);z+=r.data[I]*f[p];h+=r.data[I+1]*f[p];k+=r.data[I+2]*f[p];w+=f[p]}}x[u]=z/w;x[u+1]=h/w;x[u+2]=k/w;x[u+3]=r.data[u+3]}for(l=0;l<v;l++)for(m=0;m<t;m++){z=h=k=w=0;u=4*(m*v+l);for(r=-c;r<=c;r++)K=m+
r,p=r+c,0<=K&&K<t&&(I=4*(K*v+l),z+=x[I]*f[p],h+=x[I+1]*f[p],k+=x[I+2]*f[p],w+=f[p]);x[u]=z/w;x[u+1]=h/w;x[u+2]=k/w}}catch(da){throw da;}return new ImageData(x,v,t)}},{key:"mirror",value:function(b){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,d,f;try{var g=e.getImagedata(b);var h=g.width;var k=g.height;var l=new Uint8ClampedArray(g.data.length);for(f=0;f<k;f++)for(d=0;d<h;d++){var m=4*(f*h+d);if(0==c)var p=4*(f*h+h-d);else if(1==c)p=4*((k-f)*h+d);else throw Error("not give axis");
l[m]=g.data[p];l[m+1]=g.data[p+1];l[m+2]=g.data[p+2];l[m+3]=g.data[p+3];l[p]=g.data[m];l[p+1]=g.data[m+1];l[p+2]=g.data[m+2];l[p+3]=g.data[m+3]}}catch(r){throw r;}return new ImageData(l,h,k)}}]);return e}();R(Ga,"__gaussianMask",{});Object.defineProperty(U._assistant,"canvasFilter",{value:Ga});
var Ha=function(){function e(){P(this,e)}Q(e,null,[{key:"loadFailedFade",value:function(b,c){var d,f,g,h;if(!(b instanceof CanvasRenderingContext2D))throw Error('Requires a value of type "CanvasRenderingContext2D"');Z.isEmpty(c)&&(c=Object.create(null));var k="animation-loadFailedFade-"+Date.now()+"-"+performance.now()+(c.sign?"-"+c.sign:"");c=Z.o(c,{duration:4,speed:null,icon:{size:72,"char":["!","?"],color:"rgba(220, 53, 69)",font:"bold 72px Microsoft YaHei, serif"},text:{size:16,color:"black",
text:"Load Failed",font:"normal 16px Microsoft YaHei, serif"},round:{step:[5],radius:48,fill:!1,borderWidth:5,fillColor:"#ddd",borderColor:"#ddd"}});var l=JSON.stringify(c.icon);var m=JSON.stringify(c.text);var p=JSON.stringify(c.round);c.speed=null!==(d=c.speed)&&void 0!==d?d:c.duration/(2*c.icon["char"].length);(d=Y.get("loadFailedFade",e))||(d=new Map,Y.set("loadFailedFade",d,e));if(!(g=d.get(l))){g=[];for(var r=0;r<c.icon["char"].length;r++){g[r]=new OffscreenCanvas(c.icon.size,c.icon.size);var v=
g[r].getContext("2d");c.icon.text=c.icon["char"][r];Fa.drawText(v,c.icon)}d.set(l,g)}(h=d.get(m))||(h=new OffscreenCanvas(c.text.size*c.text.text.length,2*c.text.size),l=h.getContext("2d"),Fa.drawText(l,c.text),d.set(m,h));(m=d.get(p))||(m=l=2*(c.round.radius+c.round.borderWidth),m=new OffscreenCanvas(m,l),l=m.getContext("2d"),Fa.drawRound(l,c.round),d.set(p,m));var t=1;var w=f=0;var q=[b.canvas.width/2,b.canvas.height/2];d=[m.width/2,(m.height+h.height)/2];p=[h.width/2,(m.height-h.height)/2];var x=
1/(c.duration/g.length/2*1E3/(1E3/60));var z=function(){var u=x*t,K=Number(b.canvas.getAttribute(k)),I=[g[w].width/2,(g[w].height+h.height)/2];void 0!==K&&0!==K&&(b.clearRect(q[0]-I[0],q[1]-I[1],g[w].width,g[w].height),1<f+u?(f=1,t=-t):0>f+u?(f=0,t=-t,w=w+1<g.length?w+1:0):f+=u,b.globalAlpha=f,b.drawImage(g[w],q[0]-I[0],q[1]-I[1]),window.requestAnimationFrame(z))};b.globalAlpha=1;b.drawImage(m,q[0]-d[0],q[1]-d[1]);b.drawImage(h,q[0]-p[0],q[1]+p[1]);b.canvas.setAttribute(k,1);window.requestAnimationFrame(z);
return k}}]);return e}();Object.defineProperty(U._assistant,"canvasAnimation",{value:Ha});
var Ia=function(e){function b(){P(this,b);return c.apply(this,arguments)}H(b,e);var c=J(b);Q(b,[{key:"initOption",value:function(d){F(G(b.prototype),"initOption",this).call(this,d);this.option.layer=U._assistant.object.merge(this.option.layer,U._option.page)}},{key:"linkageOption",value:function(){F(G(b.prototype),"linkageOption",this).call(this);null!==this.option.layer.src&&null!==this.option.layer.srcdoc&&(this.option.layer.srcdoc=null)}},{key:"initStruct",value:function(){F(G(b.prototype),"initStruct",
this).call(this);var d=this.variable.struct._build.container;var f=this.variable.struct._backup.title=U._struct.title;var g=this.variable.struct._backup.action=U._struct.action;var h=this.variable.struct._backup.content=U._struct.content;var k=this.variable.struct._backup.content_page=U._struct.content_page;var l=this.variable.struct._backup.action_button=U._struct.action_button;g.innerHTML.push(l.minimize,l.expand,l.close);f.innerHTML.push(g);!1!==this.option.title&&d.innerHTML.push(f);h.innerHTML.push(k);
d.innerHTML.push(h);this.option.resize.enable&&(k=this.variable.struct._backup.resize_box=U._struct.resize_box,d.innerHTML.push(k));this.option.progress.enable&&(k=this.variable.struct._backup.progress_bar=U._struct.progress_bar,d.innerHTML.push(k))}},{key:"initNode",value:function(){var d=this;F(G(b.prototype),"initNode",this).call(this);var f=this.variable.nodes.container.querySelector(".modal-layer-page-content");var g="display: block; width: "+this.option.layer.area[0]+"px; height: "+this.option.layer.area[1]+
"px";Object.keys(this.option.layer).forEach(function(k){U._assistant.object.isEmpty(d.option.layer[k])||("name"===k?f.setAttribute("name",d.option.layer.name+d.option.index):f.setAttribute(k,d.option.layer[k]))});f.style=g;this.variable.animationName.minimize_queue_transition_scale="transition-scale-50-50-animation";if(!U._assistant.css.hasCss("transition-scale-50-50-animation")){var h={from:"transform: scale(0.5, 0.5)",to:"transform: scale(1, 1)"};g=U._assistant.css.createAnimation("transition-scale-50-50-animation",
h);U._assistant.css.addCss("transition-scale-50-50-animation",g);U._assistant.css.addCss("transition-scale-50-50-animation-reverse",U._assistant.css.createAnimation("transition-scale-50-50-animation-reverse",{from:h.to,to:h.from}))}}},{key:"resize",value:function(){var d=0;var f=this.variable.nodes.container;var g=f.children;var h=f.querySelector("iframe[name="+this.option.layer.name+this.option.index+"]");h=h.offsetWidth+2*h.parentNode.offsetLeft;for(var k=0;k<g.length;k++)d="absolute"==getComputedStyle(g[k],
null).position?d:Math.max(U._assistant.element.getNodeHeight(g[k]),d);f.style.width=h+"px";f.style.height=d+"px";this.variable.defaultArea=[h,d]}}]);return b}(U);U._achieve.set("page",Ia);
var Ja=function(e){function b(){P(this,b);return c.apply(this,arguments)}H(b,e);var c=J(b);Q(b,[{key:"initStruct",value:function(){F(G(b.prototype),"initStruct",this).call(this);var d=this.variable.struct._build.container;var f=this.variable.struct._backup.title=U._struct.title;var g=this.variable.struct._backup.action=U._struct.action;var h=this.variable.struct._backup.content=U._struct.content;var k=this.variable.struct._backup.interaction=U._struct.interaction;var l=this.variable.struct._backup.action_button=
U._struct.action_button;var m=this.variable.struct._backup.interaction_button=U._struct.interaction_button;g.innerHTML.push(l.close);f.innerHTML.push(g);!1!==this.option.title&&d.innerHTML.push(f);d.innerHTML.push(h);this.option.resize.enable&&(g=this.variable.struct._backup.resize_box=U._struct.resize_box,d.innerHTML.push(g));this.option.progress.enable&&(g=this.variable.struct._backup.progress_bar=U._struct.progress_bar,d.innerHTML.push(g));k.innerHTML.push(m.ok);d.innerHTML.push(k)}},{key:"initNode",
value:function(){F(G(b.prototype),"initNode",this).call(this);var d=this.variable.nodes.container.querySelector(".modal-layer-content");if(Array.isArray(this.option.content.value)){var f=U._assistant.element.objectToNode(this.option.content.value);Object.keys(f).forEach(function(g){d.appendChild(f[g])})}else d.innerHTML=this.option.content.value}}]);return b}(U);U._achieve.set("alert",Ja);
var La=function(e){function b(){P(this,b);return c.apply(this,arguments)}H(b,e);var c=J(b);Q(b,[{key:"initOption",value:function(d){var f=this,g;F(G(b.prototype),"initOption",this).call(this,d);this.option.layer=U._assistant.object.merge(this.option.layer,U._option.image);var h=[window.innerWidth,window.innerHeight];Object.values(this.option.layer.sizeRange).forEach(function(k){k.forEach(function(l,m){if((""+l).endsWith("%"))g=100;else if((""+l).endsWith("\u2030"))g=1E3;else if((""+l).includes("0."))g=
1;else return l;k[m]=h[m]*window.parseFloat(l)/g})});this.option.layer.sizeRange.min[0]>this.option.layer.sizeRange.max[0]&&(this.option.layer.sizeRange.min[0]=this.option.layer.sizeRange.max[0]);this.option.layer.sizeRange.min[1]>this.option.layer.sizeRange.max[1]&&(this.option.layer.sizeRange.min[1]=this.option.layer.sizeRange.max[1]);Object.keys(this.option.layer.toolbar.config).forEach(function(k,l){l=f.option.layer.toolbar.config[k];"boolean"==typeof l&&(f.option.layer.toolbar.config[k]={enable:l,
title:U._option.image.toolbar.config[k].title,icon:U._option.image.toolbar.config[k].icon});U._assistant.object.isOnlyObject(l.config)?Object.keys(l.config).forEach(function(m,p){p=l.config[m];"boolean"==typeof p&&(f.option.layer.toolbar.config[k].config[m]={enable:p,title:U._option.image.toolbar.config[k].config[m].title,icon:U._option.image.toolbar.config[k].config[m].icon})}):U._option.image.toolbar.config[k].config&&(f.option.layer.toolbar.config[k].config=JSON.parse(JSON.stringify(U._option.image.toolbar.config[k].config)))})}},
{key:"compatibleOption",value:function(d){var f,g;F(G(b.prototype),"compatibleOption",this).call(this,d);var h=U._assistant.object.get(d,"layer.image");h instanceof FileList&&(d.layer.image=Object.values(h));Array.isArray(d.layer.image)||(d.layer.image=[d.layer.image]);var k=null!==(f=U._assistant.object.get(d,"layer.toolbar.config"))&&void 0!==f?f:[];Object.keys(k).forEach(function(m){k[m]="boolean"===typeof k[m]?{enable:k[m]}:k[m]});var l=null!==(g=U._assistant.object.get(d,"layer.toolbar.config.filter.config"))&&
void 0!==g?g:[];Object.keys(l).forEach(function(m){l[m]="boolean"===typeof l[m]?{enable:l[m]}:l[m]})}},{key:"linkageOption",value:function(){var d;F(G(b.prototype),"linkageOption",this).call(this);var f=d=!1;var g=Object.entries(this.option.layer.toolbar.config);var h=Object.entries(this.option.layer.toolbar.config.filter.config);for(var k=0;k<h.length;k++)if(!0===h[k][1].enable){d=!0;break}this.option.layer.toolbar.config.filter.enable=d;for(d=0;d<g.length;d++)if(!0===g[d][1].enable){f=!0;break}this.option.layer.toolbar.enable=
f;!1===this.option.layer.toolbar.config.crop.enable&&(this.option.layer.toolbar.config.crop.grid=!1)}},{key:"checkOption",value:function(){F(G(b.prototype),"checkOption",this).call(this);if(U._assistant.object.isEmpty(this.option.layer.image))throw Error("layer.image can not be empty!");if(this.option.layer.size&&!Array.isArray(this.option.layer.size))throw Error("layer.size does not meet expectations.");if(!this.option.layer.size&&(window.isNaN(parseInt(this.option.layer.sizeRange.min[0]))||window.isNaN(parseInt(this.option.layer.sizeRange.min[1]))||
window.isNaN(parseInt(this.option.layer.sizeRange.max[0]))||window.isNaN(parseInt(this.option.layer.sizeRange.max[1]))))throw Error("layer.sizeRange does not meet expectations.");}},{key:"initVariable",value:function(){F(G(b.prototype),"initVariable",this).call(this);this.variable.image={spin:{scale:1,angle:90},"default":{size:null,imageData:null},reload:0,link:null,history:[],finish:null,status:U._enum.LOAD_STATUS.LOADING}}},{key:"initStruct",value:function(){var d=this;F(G(b.prototype),"initStruct",
this).call(this);var f=this.variable.struct._build.container;var g=this.variable.struct._backup.title=U._struct.title;var h=this.variable.struct._backup.action=U._struct.action;var k=this.variable.struct._backup.toolbar=U._struct.toolbar;var l=this.variable.struct._backup.tools=U._struct.image_tools;var m=this.variable.struct._backup.content=U._struct.content;var p=this.variable.struct._backup.action_button=U._struct.action_button;var r=this.variable.struct._backup.content_image=U._struct.content_image;
var v=this.variable.struct._backup.image_tools_child=U._struct.image_tools_child;h.innerHTML.push(p.close);g.innerHTML.push(h);!1!==this.option.title&&f.innerHTML.push(g);Object.keys(this.option.layer.toolbar.config).forEach(function(t){d.option.layer.toolbar.config[t].enable&&k.innerHTML.push(l[t]);d.option.layer.toolbar.config[t].config instanceof Object&&d.option.layer.toolbar.config[t].enable&&Object.keys(d.option.layer.toolbar.config[t].config).forEach(function(w){l[t].innerHTML[1].innerHTML.push(v[t][w])})});
this.option.layer.toolbar.enable&&f.innerHTML.push(k);m.innerHTML.push(r);f.innerHTML.push(m);this.option.resize.enable&&(h=this.variable.struct._backup.resize_box=U._struct.resize_box,f.innerHTML.push(h));this.option.progress.enable&&(h=this.variable.struct._backup.progress_bar=U._struct.progress_bar,f.innerHTML.push(h))}},{key:"initNode",value:function(){var d=this;F(G(b.prototype),"initNode",this).call(this);var f=this.variable.nodes.container.querySelector(".modal-layer-toolbar");this.option.layer.toolbar.enable&&
Object.keys(this.option.layer.toolbar.config).forEach(function(g,h){h=d.option.layer.toolbar.config[g];if(h.enable){var k;var l=f.querySelector('.modal-layer-toolbar-item[tool-type="'+g+'"]');var m=l.querySelector(".modal-layer-toolbar-item-icon");l.setAttribute("title",h.title);(k=m.classList).add.apply(k,O(h.icon.split(" ")));h.config instanceof Object&&Object.entries(h.config).forEach(function(p,r){r=p[0];p=p[1];if(p.enable){var v=l.querySelector(".modal-layer-toolbar-item-child-list");r=l.querySelector(".modal-layer-toolbar-"+
g+"-icon["+g+'-type="'+r+'"]');v.setAttribute("title",p.title);p.icon?r.classList.add(p.icon):r.innerText=p.textIcon}})}});this.variable.image.finish=this.load().then(function(g){return d.loaded(g)})["catch"](function(){return d.failed()})}},{key:"bindEvent",value:function(){var d=this;F(G(b.prototype),"bindEvent",this).call(this);var f={once:!1,capture:!1,passive:!1,mozSystemGroup:!1};var g=this.variable.nodes.container;var h=U._assistant.object.getKeyByValue(U._enum.LOAD_STATUS,U._enum.LOAD_STATUS.FAILED);
this.variable.eventSymbol.imageReload=U._assistant.event.add(g,"click",'.modal-layer-image-canvas[load-status="'+h+'"]',this.reload,this,null,f);Object.keys(this.event.imageTools).forEach(function(k){d.event.imageTools[k]&&d.event.imageTools[k]instanceof Function&&(d.variable.eventSymbol["imageTool".concat(k)]=U._assistant.event.add(g,"click",'.modal-layer-toolbar-item[tool-type="'.concat(k,'"]'),d.event.imageTools[k],d,null,f))})}},{key:"resize",value:function(){var d;var f=this.variable.nodes.container;
var g=f.querySelector(".modal-layer-content");var h=g.querySelector(".modal-layer-image-canvas").getBoundingClientRect();var k=f.querySelector(".modal-layer-toolbar");var l=k.getBoundingClientRect().height;var m=window.getComputedStyle(g,null);var p=U._assistant.element.getBeforeElementHeight(g);g=g.offsetTop-p;p+=this.option.content.fullContainer?0:2*g;this.option.layer.size?d=O(this.option.layer.size):this.variable.image.status!==U._enum.LOAD_STATUS.LOADING?d=[h.width,h.height]:d=O(this.option.layer.sizeRange.min);
d[0]+=parseFloat(m.marginLeft)+parseFloat(m.marginRight);d[1]+=p;f.style.width=d[0]+"px";this.option.layer.toolbar.enable&&(h=k.getBoundingClientRect().height,d[1]=d[1]-l+h);f.style.height=d[1]+"px";this.variable.defaultArea=d;!this.option.drag.overflow&&U._assistant.element.isOverflow(f,this.option.window)&&(f.style.cssText+="margin-top: auto; margin-left: auto")}},{key:"load",value:function(){var d=this,f=this.variable.nodes.container.querySelector(".modal-layer-image-canvas");this.variable.image.status=
U._enum.LOAD_STATUS.LOADING;f.setAttribute("load-status",U._assistant.object.getKeyByValue(U._enum.LOAD_STATUS,U._enum.LOAD_STATUS.LOADING));this.variable.image.fadeAttr&&f.removeAttribute(this.variable.image.fadeAttr);this.variable.image.layer instanceof Ka?this.variable.image.layer.show():this.variable.image.layer=U.loading({mask:!1,popupTime:0,layer:{icon:1,duration:1,color:"deepskyblue"},window:this.variable.nodes.container},function(g){throw g;});return this.variable.image.finish=new Promise(function(g,
h){for(var k=new Image;!d.variable.image.link&&d.variable.image.reload<d.option.layer.image.length;){var l;(null===(l=d.variable.image.link)||void 0===l?0:l.startsWith("blob:"))&&URL.revokeObjectURL(d.variable.image.link);d.variable.image.link=U._assistant.file.getImage(d.option.layer.image[d.variable.image.reload++])}k.onload=function(){return g(k)};k.onerror=h;k.src=d.variable.image.link})}},{key:"reload",value:function(){var d=this;this.variable.image.finish=this.load().then(function(f){return d.loaded(f)})["catch"](function(){return d.failed()})["finally"](function(){return d.resize()})}},
{key:"loaded",value:function(d){var f=this;var g=this.variable.nodes.container.querySelector(".modal-layer-image-canvas");this.variable.image.status=U._enum.LOAD_STATUS.LOADED;this.variable.image["default"].size=this.option.layer.size?this.option.layer.size:d.naturalWidth>this.option.layer.sizeRange.max[0]||d.naturalHeight>this.option.layer.sizeRange.max[1]?U._assistant.number.getMaxLegalSize([d.naturalWidth,d.naturalHeight],this.option.layer.sizeRange.max):d.naturalWidth<this.option.layer.sizeRange.min[0]||
d.naturalHeight<this.option.layer.sizeRange.min[1]?U._assistant.number.getMinLegalSize([d.naturalWidth,d.naturalHeight],this.option.layer.sizeRange.min):[d.naturalWidth,d.naturalHeight];g.width=this.variable.image["default"].size[0];g.height=this.variable.image["default"].size[1];g.setAttribute("load-status",U._assistant.object.getKeyByValue(U._enum.LOAD_STATUS,U._enum.LOAD_STATUS.LOADED));window.requestAnimationFrame(function(){var h,k;f.variable.image.layer&&f.variable.image.layer instanceof Ka&&
f.variable.image.layer.hide();(h=g.getContext("2d")).drawImage.apply(h,[d,0,0,d.width,d.height,0,0].concat(O(f.variable.image["default"].size)));f.variable.image["default"].imageData=(k=g.getContext("2d")).getImageData.apply(k,[0,0].concat(O(f.variable.image["default"].size)))})}},{key:"failed",value:function(){var d,f;var g=this.variable.nodes.container.querySelector(".modal-layer-image-canvas");this.variable.image.status=U._enum.LOAD_STATUS.FAILED;g.setAttribute("load-status",U._assistant.object.getKeyByValue(U._enum.LOAD_STATUS,
U._enum.LOAD_STATUS.FAILED));this.variable.image.reload<this.option.layer.image.length?f={duration:4,sign:"load-failed",icon:{size:72,"char":"!?",color:"rgba(220, 53, 69)",font:"bold 72px Microsoft YaHei, serif"},round:{step:[4],radius:50,borderWidth:5,borderColor:"rgb(230, 230, 230)"},text:{color:"rgba(220, 53, 69)",text:"\u56fe\u7247\u52a0\u8f7d\u5931\u8d25, \u8bf7\u70b9\u51fb\u91cd\u8bd5",font:"lighter 16px Microsoft YaHei, serif"}}:f={duration:4,sign:"finally-load-failed",icon:{size:80,"char":"\u00d7",
font:"bold 80px Microsoft YaHei, serif"},round:{step:[5],radius:50,borderWidth:5,borderColor:"rgb(230, 230, 230)"},text:{color:"rgba(220, 53, 69)",text:"\u56fe\u7247\u52a0\u8f7d\u5931\u8d25, \u8bf7\u8054\u7cfb\u7ba1\u7406\u5458",font:"lighter 16px Microsoft YaHei, serif"}};this.variable.image.fadeAttr=U._assistant.canvasAnimation.loadFailedFade(g.getContext("2d"),f);(null===(d=this.variable.image.link)||void 0===d?0:d.startsWith("blob:"))&&URL.revokeObjectURL(this.variable.image.link);this.variable.image.link=
null;this.variable.image.layer instanceof Ka&&this.variable.image.layer.hide()}},{key:"removeAllEvent",value:function(){var d=this,f=this.variable.nodes.container;F(G(b.prototype),"removeAllEvent",this).call(this);Object.keys(this.event.imageTools).forEach(function(g){d.event.imageTools[g]&&d.event.imageTools[g]instanceof Function&&f.removeEventListener("click",d.event.imageTools[g])})}},{key:"crop",value:function(){var d=this,f,g;var h=!0;var k=null;var l=[];var m=U._assistant.number.divide(5,2);
l[2]=U._assistant.number.multiply(5,2);l[4]=U._assistant.number.multiply(5,4);l[6]=U._assistant.number.multiply(5,6);var p=this.variable.nodes.container.querySelector(".modal-layer-image-canvas");var r=p.width;var v=p.height;var t=U._assistant.number.floor(.1*r);var w=U._assistant.number.floor(.1*v);var q=p.cloneNode();var x=q.getContext("2d");q.width=window.innerWidth;q.height=window.innerHeight;q.style="display: block; position: fixed; top: 0px; bottom: 0px; left: 0px; right: 0px; visibility: visible; opacity: 1; border: 0px; margin: 0px; z-index: "+
U._assistant.element.maxZIndex()+";";var z=[U._assistant.number.chain(q.width).subtract(r).divide(2).round().done(),U._assistant.number.chain(q.height).subtract(v).divide(2).round().done()];var u=[].concat(O(z),[r,v]);var K=function(){var y;x.save();x.clearRect(0,0,q.width,q.height);x.fillStyle="rgba(0, 0, 0, 0.4)";x.fillRect(0,0,q.width,q.height);x.globalCompositeOperation="destination-out";x.fillStyle="white";x.fillRect.apply(x,O(u));x.globalCompositeOperation="source-over";(y=U._assistant.canvas).drawGrid.apply(y,
[x].concat(O(u),[2,"white","quarter"]));U._assistant.canvas.drawRect(x,u[0]-m,u[1]-m,u[2]+5,u[3]+5,5,"white",[0]);U._assistant.canvas.drawLBorder(x,u[0]-l[2],u[1]-l[2],u[2]+l[4],u[3]+l[4],l[6],5,"white");x.globalCompositeOperation="destination-over";x.drawImage.apply(x,[p].concat(O(z)));x.restore();h?k=window.requestAnimationFrame(K):window.cancelAnimationFrame(k)};var I=function(){document.removeEventListener("keyup",da);q.removeEventListener("mousemove",Aa);q.removeEventListener("dbclick",pa);h=
!1;q.remove()};var da=function(y){var D;y=null!==(D=y)&&void 0!==D?D:window.event;switch(y.code){case "Enter":pa();y.preventDefault();break;case "Escape":d.show(),I(),y.preventDefault()}};var pa=function(y){var D;I();y=null!==(D=y)&&void 0!==D?D:window.event;y=new OffscreenCanvas(p.width,p.height);y.getContext("2d").drawImage(p,0,0);p.width=u[2];p.height=u[3];p.getContext("2d").drawImage(y,u[0]-z[0],u[1]-z[1],u[2],u[3],0,0,p.width,p.height);d.show().then(function(){return d.resize()})};var Aa=function(y){var D;
y=null!==(D=y)&&void 0!==D?D:window.event;if(f&&1===y.buttons)if("drag"===f)u[0]+y.movementX>z[0]&&u[0]+u[2]+y.movementX<z[0]+r&&(u[0]+=y.movementX),u[1]+y.movementY>z[1]&&u[1]+u[3]+y.movementY<z[1]+v&&(u[1]+=y.movementY);else{if("resize"===f){D=O(u);g.includes(U._enum.POSITION.WEST)&&(u[0]+=y.movementX,u[2]-=y.movementX);g.includes(U._enum.POSITION.EAST)&&(u[2]+=y.movementX);g.includes(U._enum.POSITION.NORTH)&&(u[1]+=y.movementY,u[3]-=y.movementY);g.includes(U._enum.POSITION.SOUTH)&&(u[3]+=y.movementY);
if(u[0]<z[0]||u[0]+u[2]>z[0]+r)u[0]=D[0],u[2]=D[2];if(u[1]<z[1]||u[1]+u[3]>z[1]+v)u[1]=D[1],u[3]=D[3];u[2]<t&&(u[2]=D[2],u[0]+u[2]>z[0]+r&&(u[0]=z[0]+r-u[2]));u[3]<w&&(u[3]=D[3],u[1]+u[3]>z[1]+v&&(u[1]=z[1]+v-u[3]))}}else{y=[y.x,y.y];var M=[u[0]-l[2],u[1]-l[2],u[2]+l[4],u[3]+l[4]];var N=[u[0]-m,u[1]-m,u[2]+5,u[3]+5];y[0]>N[0]&&y[0]<N[0]+N[2]&&y[1]>N[1]&&y[1]<N[1]+N[3]?(D="move",f="drag"):y[0]>M[0]&&y[0]<M[0]+M[2]&&y[1]>M[1]&&y[1]<M[1]+M[3]?(f="resize",D=g="",y[1]>M[1]&&y[1]<N[1]&&(D=g+=U._enum.POSITION.NORTH),
y[1]>N[1]+N[3]&&y[1]<M[1]+M[3]&&(D=g+=U._enum.POSITION.SOUTH),y[0]>M[0]&&y[0]<N[0]&&(D=g+=U._enum.POSITION.WEST),y[0]>N[0]+N[2]&&y[0]<M[0]+M[2]&&(D=g+=U._enum.POSITION.EAST),D+="-resize"):(f=null,D="default");q.style.cssText+="cursor: "+D}};this.hide();K();document.addEventListener("keyup",da);q.addEventListener("mousemove",Aa);q.addEventListener("dblclick",pa);document.body.appendChild(q)}},{key:"spin",value:function(){var d=this,f=0<arguments.length&&void 0!==arguments[0]?arguments[0]:void 0,g,
h,k,l;var m=this.variable.nodes.container.querySelector(".modal-layer-image-canvas");var p=m.getContext("2d");var r=new OffscreenCanvas(m.width,m.height);r.getContext("2d").drawImage(m,0,0,m.width,m.height);this.variable.image.finish.then(function(){var v;f=null!==(v=f)&&void 0!==v?v:d.variable.image.spin.angle;m.style.transform="rotate("+f+"deg)";g=m.getBoundingClientRect();m.style.transform="scale(".concat(d.variable.image.spin.scale,")");d.option.layer.size||d.option.layer.sizeRange.max[0]>=g.width&&
d.option.layer.sizeRange.max[1]>=g.height?k=d.variable.image.spin.scale:(l=U._assistant.number.getMaxLegalSize([g.width,g.height],d.option.layer.sizeRange.max),k=l[0]/g.width);m.width=g.width;m.height=g.height;m.style.transform="scale(".concat(k,")");h=f*Math.PI/180;p.save();p.translate(m.width/2,m.height/2);p.rotate(h);p.drawImage(r,-r.width/2,-r.height/2);p.restore();d.resize()})}},{key:"filter",value:function(d){var f=this,g,h;var k=d.getAttribute("filter-type");var l=this.variable.nodes.container.querySelector(".modal-layer-image-canvas");
if(l.getAttribute("load-status")!=U._enum.LOAD_STATUS.FAILED&&k){var m=l.getContext("2d");var p=m.getImageData(0,0,l.width,l.height);this.variable.image.layer.show();if(U._env.feature.worker){var r="image-layer-worker-"+Date.now();var v="!"+U._worker.get("canvasFilter").toString()+"()";v=URL.createObjectURL(new Blob(v.split(""),{type:"text/javascript"}));U._assistant.worker.has(r)||U._assistant.worker.create(r,v);U._assistant.worker.listener(r).then(function(t){0==t.data.error?m.putImageData(new ImageData(new Uint8ClampedArray(t.data.buffer),
l.width,l.height),0,0):console.error(Error(t.data.message));f.variable.image.layer.hide();U._assistant.worker.close(r)})}null===(g=(h={blur:function(){var t,w;var q=null!==(t=Number(d.getAttribute("data-sigma")))&&void 0!==t?t:1;t=null!==(w=Number(d.getAttribute("data-radius")))&&void 0!==w?w:3;if(U._env.feature.worker){var x;if(U._assistant.canvasFilter.__gaussianMask[["".concat(t,",").concat(q)]])var z=U._assistant.canvasFilter.__gaussianMask[["".concat(t,",").concat(q)]];else{w=0;z=[];for(x=-t;x<=
t;x++){var u=U._assistant.formula.getDistribution(x,q,1);z.push(u);w+=u}for(x=0;x<z.length;x++)z[x]/=w;U._assistant.canvasFilter.__gaussianMask[["".concat(t,",").concat(q)]]=z}U._assistant.worker.get(r).postMessage({sigma:q,radius:t,type:k,gaussianMask:z,buffer:p.data.buffer,size:[l.width,l.height]},[p.data.buffer])}else p=U._assistant.canvasFilter.gaussianBlur(p,t,q),m.putImageData(p,0,0),f.variable.image.layer.hide()},gray:function(){U._env.feature.worker?U._assistant.worker.get(r).postMessage({type:k,
buffer:p.data.buffer},[p.data.buffer]):(p=U._assistant.canvasFilter.grayscale(m.getImageData(0,0,l.width,l.height)),m.putImageData(p,0,0),f.variable.image.layer.hide())},mirror:function(){var t,w=null!==(t=Number(d.getAttribute("mirror-axis")))&&void 0!==t?t:0;U._env.feature.worker?U._assistant.worker.get(r).postMessage({axis:w,type:k,buffer:p.data.buffer,size:[l.width,l.height]},[p.data.buffer]):(p=U._assistant.canvasFilter.mirror(m.getImageData(0,0,l.width,l.height),w),m.putImageData(p,0,0),f.variable.image.layer.hide())}})[k])||
void 0===g?void 0:g.call(h)}}},{key:"revert",value:function(){var d=this.variable.nodes.container.querySelector(".modal-layer-image-canvas");var f=d.getContext("2d");this.variable.image.spin.scale=1;d.width=this.variable.image["default"].size[0];d.height=this.variable.image["default"].size[1];d.removeAttribute("style");f.putImageData(this.variable.image["default"].imageData,0,0);this.resize()}},{key:"download",value:function(){U._assistant.canvas.download(this.variable.nodes.container.querySelector(".modal-layer-image-canvas"),
this.option.title,"image/png")}}]);return b}(U);U._achieve.set("image",La);var Ma=function(e){function b(){P(this,b);return c.apply(this,arguments)}H(b,e);var c=J(b);Q(b,[{key:"initStruct",value:function(){F(G(b.prototype),"initStruct",this).call(this);this.variable.struct._backup.interaction.innerHTML.push(this.variable.struct._backup.interaction_button.cancel)}}]);return b}(Ja);U._achieve.set("prompt",Ma);
var Na=function(e){function b(){P(this,b);return c.apply(this,arguments)}H(b,e);var c=J(b);Q(b,[{key:"initStruct",value:function(){F(G(b.prototype),"initStruct",this).call(this);this.variable.struct._backup.interaction.innerHTML.push(this.variable.struct._backup.interaction_button.no)}}]);return b}(Ja);U._achieve.set("confirm",Na);
var Ka=function(e){function b(){P(this,b);return c.apply(this,arguments)}H(b,e);var c=J(b);Q(b,[{key:"initOption",value:function(d){F(G(b.prototype),"initOption",this).call(this,d);this.option.layer=U._assistant.object.merge(this.option.layer,U._option.loading);this.option.title=!1;this.option.drag.enable=!1;this.option.resize.enable=!1;this.option.progress.enable=!1}},{key:"compatibleOption",value:function(d){var f={center:"center",right:"flex-end",left:"flex-start"};F(G(b.prototype),"compatibleOption",
this).call(this,d);if(!U._assistant.object.isEmpty(d.layer.position)){Array.isArray(d.layer.position)||(d.layer.position=[d.layer.position,d.layer.position]);for(var g=0;2>g;g++)d.layer.position[g]=f[d.layer.position[g]]}}},{key:"checkOption",value:function(){F(G(b.prototype),"checkOption",this).call(this);if(!Array.isArray(this.option.layer.position)&&!["left","center","right"].includes(this.option.layer.position))throw Error("layer.position does not meet expectations");}},{key:"initStruct",value:function(){F(G(b.prototype),
"initStruct",this).call(this);var d=this.variable.struct._build.container;var f=this.variable.struct._backup.content=U._struct.content;var g=this.variable.struct._backup.content_loading=U._struct.content_loading;var h=this.variable.struct._backup.content_loading_icon=U._struct.content_loading_icon;window.isNaN(Number(this.option.layer.icon))?g.innerHTML[0]["class"]+=" "+this.option.layer.icon:g.innerHTML[0]=h[this.option.layer.icon];f.innerHTML.push(g);d.innerHTML.push(f)}},{key:"initNodeFinally",
value:function(){F(G(b.prototype),"initNodeFinally",this).call(this);var d=this.variable.nodes.container;var f=d.querySelector(".modal-layer-content");var g=f.querySelector(".modal-layer-loading-icon");var h=f.querySelector(".modal-layer-loading-box");d.style.cssText+="background: transparent; box-shadow: none;";f.style.cssText+="background: "+this.option.layer.background;h.style.cssText="justify-content: "+this.option.layer.position[0]+"; align-items: "+this.option.layer.position[1];g.style.cssText+=
"font-size: "+this.option.layer.size+"px; width: "+this.option.layer.area[0]+"px; height: "+this.option.layer.area[1]+"px; color: "+this.option.layer.color+"; animation-duration: "+this.option.layer.duration+"s;";U._assistant.object.isEmpty(this.option.layer.rate)||(g.style.animationTimingFunction=this.option.layer.rate)}}]);return b}(U);U._achieve.set("loading",Ka);
var Oa=function(e){function b(){P(this,b);return c.apply(this,arguments)}H(b,e);var c=J(b);Q(b,[{key:"initOption",value:function(d){F(G(b.prototype),"initOption",this).call(this,d);this.option.title=!1;this.option.drag.enable=!1;this.option.drag.overflow=!1}},{key:"initStruct",value:function(){F(G(b.prototype),"initStruct",this).call(this);var d=this.variable.struct._build.container;var f=this.variable.struct._backup.content=U._struct.content;d.innerHTML.push(f);this.option.resize.enable&&(f=this.variable.struct._backup.resize_box=
U._struct.resize_box,d.innerHTML.push(f));this.option.progress.enable&&(f=this.variable.struct._backup.progress_bar=U._struct.progress_bar,d.innerHTML.push(f))}},{key:"initNode",value:function(){F(G(b.prototype),"initNode",this).call(this);var d=this.variable.nodes.container.querySelector(".modal-layer-content");if(this.option.content.value instanceof Object){var f=U._assistant.element.objectToNode(this.option.content.value);Object.keys(f).forEach(function(g){d.appendChild(f[g])})}else d.innerHTML=
this.option.content.value}}]);return b}(U);U._achieve.set("msg",Oa);U._achieve.set("message",Oa);window.Worker&&U._worker.set("canvasFilter",function(){this.onmessage=function(e){var b,c;e=null===(b=(c=e.data).type)||void 0===b?void 0:b.call(c,e.data);this.postMessage({error:0,buffer:e?e.buffer:void 0},[e.buffer])};this.C=function(){this.postMessage({error:1,message:"Failed to send message."})}});}(window);
