!function(window){"use strict";var aa="function"==typeof Object.defineProperties?Object.defineProperty:function(e,b,c){if(e==Array.prototype||e==Object.prototype)return e;e[b]=c.value;return e};function ba(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<e.length;++b){var c=e[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");}var ca=ba(this);
function n(e,b){if(b)a:{var c=ca;e=e.split(".");for(var d=0;d<e.length-1;d++){var f=e[d];if(!(f in c))break a;c=c[f]}e=e[e.length-1];d=c[e];b=b(d);b!=d&&null!=b&&aa(c,e,{configurable:!0,writable:!0,value:b})}}n("Reflect",function(e){return e?e:{}});
var da="function"==typeof Object.create?Object.create:function(e){function b(){}b.prototype=e;return new b},ea=function(){function e(){function c(){}new c;Reflect.construct(c,[],function(){});return new c instanceof c}if("undefined"!=typeof Reflect&&Reflect.construct){if(e())return Reflect.construct;var b=Reflect.construct;return function(c,d,f){c=b(c,d);f&&Reflect.setPrototypeOf(c,f.prototype);return c}}return function(c,d,f){void 0===f&&(f=c);f=da(f.prototype||Object.prototype);return Function.prototype.apply.call(c,
f,d)||f}}();n("Reflect.construct",function(){return ea});var fa;if("function"==typeof Object.setPrototypeOf)fa=Object.setPrototypeOf;else{var ha;a:{var ia={s:!0},ja={};try{ja.__proto__=ia;ha=ja.s;break a}catch(e){}ha=!1}fa=ha?function(e,b){e.__proto__=b;if(e.__proto__!==b)throw new TypeError(e+" is not extensible");return e}:null}var ka=fa;n("Object.setPrototypeOf",function(e){return e||ka});function la(e){var b=0;return function(){return b<e.length?{done:!1,value:e[b++]}:{done:!0}}}
n("Symbol",function(e){function b(f){if(this instanceof b)throw new TypeError("Symbol is not a constructor");return new c("jscomp_symbol_"+(f||"")+"_"+d++,f)}function c(f,g){this.a=f;aa(this,"description",{configurable:!0,writable:!0,value:g})}if(e)return e;c.prototype.toString=function(){return this.a};var d=0;return b});
n("Symbol.iterator",function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var b="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),c=0;c<b.length;c++){var d=ca[b[c]];"function"===typeof d&&"function"!=typeof d.prototype[e]&&aa(d.prototype,e,{configurable:!0,writable:!0,value:function(){return ma(la(this))}})}return e});function ma(e){e={next:e};e[Symbol.iterator]=function(){return this};return e}
n("Array.from",function(e){return e?e:function(b,c,d){c=null!=c?c:function(k){return k};var f=[],g="undefined"!=typeof Symbol&&Symbol.iterator&&b[Symbol.iterator];if("function"==typeof g){b=g.call(b);for(var h=0;!(g=b.next()).done;)f.push(c.call(d,g.value,h++))}else for(g=b.length,h=0;h<g;h++)f.push(c.call(d,b[h],h));return f}});
function na(e,b){e instanceof String&&(e+="");var c=0,d=!1,f={next:function(){if(!d&&c<e.length){var g=c++;return{value:b(g,e[g]),done:!1}}d=!0;return{done:!0,value:void 0}}};f[Symbol.iterator]=function(){return f};return f}n("Array.prototype.keys",function(e){return e?e:function(){return na(this,function(b){return b})}});n("Object.is",function(e){return e?e:function(b,c){return b===c?0!==b||1/b===1/c:b!==b&&c!==c}});
n("Array.prototype.includes",function(e){return e?e:function(b,c){var d=this;d instanceof String&&(d=String(d));var f=d.length;c=c||0;for(0>c&&(c=Math.max(c+f,0));c<f;c++){var g=d[c];if(g===b||Object.is(g,b))return!0}return!1}});function oa(e,b,c){if(null==e)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return e+""}
n("String.prototype.includes",function(e){return e?e:function(b,c){return-1!==oa(this,b,"includes").indexOf(b,c||0)}});function A(e,b){return Object.prototype.hasOwnProperty.call(e,b)}n("Object.values",function(e){return e?e:function(b){var c=[],d;for(d in b)A(b,d)&&c.push(b[d]);return c}});function B(e){var b="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];return b?b.call(e):{next:la(e)}}
n("Promise",function(e){function b(h){this.c=0;this.i=void 0;this.a=[];var k=this.g();try{h(k.resolve,k.reject)}catch(l){k.reject(l)}}function c(){this.a=null}function d(h){return h instanceof b?h:new b(function(k){k(h)})}if(e)return e;c.prototype.c=function(h){if(null==this.a){this.a=[];var k=this;this.g(function(){k.i()})}this.a.push(h)};var f=ca.setTimeout;c.prototype.g=function(h){f(h,0)};c.prototype.i=function(){for(;this.a&&this.a.length;){var h=this.a;this.a=[];for(var k=0;k<h.length;++k){var l=
h[k];h[k]=null;try{l()}catch(m){this.h(m)}}}this.a=null};c.prototype.h=function(h){this.g(function(){throw h;})};b.prototype.g=function(){function h(m){return function(p){l||(l=!0,m.call(k,p))}}var k=this,l=!1;return{resolve:h(this.B),reject:h(this.h)}};b.prototype.B=function(h){if(h===this)this.h(new TypeError("A Promise cannot resolve to itself"));else if(h instanceof b)this.D(h);else{a:switch(typeof h){case "object":var k=null!=h;break a;case "function":k=!0;break a;default:k=!1}k?this.A(h):this.l(h)}};
b.prototype.A=function(h){var k=void 0;try{k=h.then}catch(l){this.h(l);return}"function"==typeof k?this.F(k,h):this.l(h)};b.prototype.h=function(h){this.m(2,h)};b.prototype.l=function(h){this.m(1,h)};b.prototype.m=function(h,k){if(0!=this.c)throw Error("Cannot settle("+h+", "+k+"): Promise already settled in state"+this.c);this.c=h;this.i=k;this.v()};b.prototype.v=function(){if(null!=this.a){for(var h=0;h<this.a.length;++h)g.c(this.a[h]);this.a=null}};var g=new c;b.prototype.D=function(h){var k=this.g();
h.j(k.resolve,k.reject)};b.prototype.F=function(h,k){var l=this.g();try{h.call(k,l.resolve,l.reject)}catch(m){l.reject(m)}};b.prototype.then=function(h,k){function l(q,v){return"function"==typeof q?function(w){try{m(q(w))}catch(r){p(r)}}:v}var m,p,t=new b(function(q,v){m=q;p=v});this.j(l(h,m),l(k,p));return t};b.prototype.catch=function(h){return this.then(void 0,h)};b.prototype.j=function(h,k){function l(){switch(m.c){case 1:h(m.i);break;case 2:k(m.i);break;default:throw Error("Unexpected state: "+
m.c);}}var m=this;null==this.a?g.c(l):this.a.push(l)};b.resolve=d;b.reject=function(h){return new b(function(k,l){l(h)})};b.race=function(h){return new b(function(k,l){for(var m=B(h),p=m.next();!p.done;p=m.next())d(p.value).j(k,l)})};b.all=function(h){var k=B(h),l=k.next();return l.done?d([]):new b(function(m,p){function t(w){return function(r){q[w]=r;v--;0==v&&m(q)}}var q=[],v=0;do q.push(void 0),v++,d(l.value).j(t(q.length-1),p),l=k.next();while(!l.done)})};return b});
n("Number.isFinite",function(e){return e?e:function(b){return"number"!==typeof b?!1:!isNaN(b)&&Infinity!==b&&-Infinity!==b}});n("Number.isInteger",function(e){return e?e:function(b){return Number.isFinite(b)?b===Math.floor(b):!1}});
n("WeakMap",function(e){function b(l){this.a=(k+=Math.random()+1).toString();if(l){l=B(l);for(var m;!(m=l.next()).done;)m=m.value,this.set(m[0],m[1])}}function c(){}function d(l){var m=typeof l;return"object"===m&&null!==l||"function"===m}function f(l){if(!A(l,h)){var m=new c;aa(l,h,{value:m})}}function g(l){var m=Object[l];m&&(Object[l]=function(p){if(p instanceof c)return p;Object.isExtensible(p)&&f(p);return m(p)})}if(function(){if(!e||!Object.seal)return!1;try{var l=Object.seal({}),m=Object.seal({}),
p=new e([[l,2],[m,3]]);if(2!=p.get(l)||3!=p.get(m))return!1;p.delete(l);p.set(m,4);return!p.has(l)&&4==p.get(m)}catch(t){return!1}}())return e;var h="$jscomp_hidden_"+Math.random();g("freeze");g("preventExtensions");g("seal");var k=0;b.prototype.set=function(l,m){if(!d(l))throw Error("Invalid WeakMap key");f(l);if(!A(l,h))throw Error("WeakMap key fail: "+l);l[h][this.a]=m;return this};b.prototype.get=function(l){return d(l)&&A(l,h)?l[h][this.a]:void 0};b.prototype.has=function(l){return d(l)&&A(l,
h)&&A(l[h],this.a)};b.prototype.delete=function(l){return d(l)&&A(l,h)&&A(l[h],this.a)?delete l[h][this.a]:!1};return b});
n("Map",function(e){function b(){var k={};return k.f=k.next=k.head=k}function c(k,l){var m=k.a;return ma(function(){if(m){for(;m.head!=k.a;)m=m.f;for(;m.next!=m.head;)return m=m.next,{done:!1,value:l(m)};m=null}return{done:!0,value:void 0}})}function d(k,l){var m=l&&typeof l;"object"==m||"function"==m?g.has(l)?m=g.get(l):(m=""+ ++h,g.set(l,m)):m="p_"+l;var p=k.c[m];if(p&&A(k.c,m))for(k=0;k<p.length;k++){var t=p[k];if(l!==l&&t.key!==t.key||l===t.key)return{id:m,list:p,index:k,b:t}}return{id:m,list:p,
index:-1,b:void 0}}function f(k){this.c={};this.a=b();this.size=0;if(k){k=B(k);for(var l;!(l=k.next()).done;)l=l.value,this.set(l[0],l[1])}}if(function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var k=Object.seal({x:4}),l=new e(B([[k,"s"]]));if("s"!=l.get(k)||1!=l.size||l.get({x:4})||l.set({x:4},"t")!=l||2!=l.size)return!1;var m=l.entries(),p=m.next();if(p.done||p.value[0]!=k||"s"!=p.value[1])return!1;p=m.next();return p.done||4!=p.value[0].x||
"t"!=p.value[1]||!m.next().done?!1:!0}catch(t){return!1}}())return e;var g=new WeakMap;f.prototype.set=function(k,l){k=0===k?0:k;var m=d(this,k);m.list||(m.list=this.c[m.id]=[]);m.b?m.b.value=l:(m.b={next:this.a,f:this.a.f,head:this.a,key:k,value:l},m.list.push(m.b),this.a.f.next=m.b,this.a.f=m.b,this.size++);return this};f.prototype.delete=function(k){k=d(this,k);return k.b&&k.list?(k.list.splice(k.index,1),k.list.length||delete this.c[k.id],k.b.f.next=k.b.next,k.b.next.f=k.b.f,k.b.head=null,this.size--,
!0):!1};f.prototype.clear=function(){this.c={};this.a=this.a.f=b();this.size=0};f.prototype.has=function(k){return!!d(this,k).b};f.prototype.get=function(k){return(k=d(this,k).b)&&k.value};f.prototype.entries=function(){return c(this,function(k){return[k.key,k.value]})};f.prototype.keys=function(){return c(this,function(k){return k.key})};f.prototype.values=function(){return c(this,function(k){return k.value})};f.prototype.forEach=function(k,l){for(var m=this.entries(),p;!(p=m.next()).done;)p=p.value,
k.call(l,p[1],p[0],this)};f.prototype[Symbol.iterator]=f.prototype.entries;var h=0;return f});
n("Set",function(e){function b(c){this.a=new Map;if(c){c=B(c);for(var d;!(d=c.next()).done;)this.add(d.value)}this.size=this.a.size}if(function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var c=Object.seal({x:4}),d=new e(B([c]));if(!d.has(c)||1!=d.size||d.add(c)!=d||1!=d.size||d.add({x:4})!=d||2!=d.size)return!1;var f=d.entries(),g=f.next();if(g.done||g.value[0]!=c||g.value[1]!=c)return!1;g=f.next();return g.done||g.value[0]==c||4!=g.value[0].x||
g.value[1]!=g.value[0]?!1:f.next().done}catch(h){return!1}}())return e;b.prototype.add=function(c){c=0===c?0:c;this.a.set(c,c);this.size=this.a.size;return this};b.prototype.delete=function(c){c=this.a.delete(c);this.size=this.a.size;return c};b.prototype.clear=function(){this.a.clear();this.size=0};b.prototype.has=function(c){return this.a.has(c)};b.prototype.entries=function(){return this.a.entries()};b.prototype.values=function(){return this.a.values()};b.prototype.keys=b.prototype.values;b.prototype[Symbol.iterator]=
b.prototype.values;b.prototype.forEach=function(c,d){var f=this;this.a.forEach(function(g){return c.call(d,g,g,f)})};return b});
n("WeakSet",function(e){function b(c){this.a=new WeakMap;if(c){c=B(c);for(var d;!(d=c.next()).done;)this.add(d.value)}}if(function(){if(!e||!Object.seal)return!1;try{var c=Object.seal({}),d=Object.seal({}),f=new e([c]);if(!f.has(c)||f.has(d))return!1;f.delete(c);f.add(d);return!f.has(c)&&f.has(d)}catch(g){return!1}}())return e;b.prototype.add=function(c){this.a.set(c,!0);return this};b.prototype.has=function(c){return this.a.has(c)};b.prototype.delete=function(c){return this.a.delete(c)};return b});
n("Object.entries",function(e){return e?e:function(b){var c=[],d;for(d in b)A(b,d)&&c.push([d,b[d]]);return c}});n("Array.prototype.values",function(e){return e?e:function(){return na(this,function(b,c){return c})}});n("String.prototype.endsWith",function(e){return e?e:function(b,c){var d=oa(this,b,"endsWith");void 0===c&&(c=d.length);c=Math.max(0,Math.min(c|0,d.length));for(var f=b.length;0<f&&0<c;)if(d[--c]!=b[--f])return!1;return 0>=f}});
var pa="function"==typeof Object.assign?Object.assign:function(e,b){for(var c=1;c<arguments.length;c++){var d=arguments[c];if(d)for(var f in d)A(d,f)&&(e[f]=d[f])}return e};n("Object.assign",function(e){return e||pa});n("Array.prototype.fill",function(e){return e?e:function(b,c,d){var f=this.length||0;0>c&&(c=Math.max(0,f+c));if(null==d||d>f)d=f;d=Number(d);0>d&&(d=Math.max(0,f+d));for(c=Number(c||0);c<d;c++)this[c]=b;return this}});function C(e){return e?e:Array.prototype.fill}
n("Int8Array.prototype.fill",C);n("Uint8Array.prototype.fill",C);n("Uint8ClampedArray.prototype.fill",C);n("Int16Array.prototype.fill",C);n("Uint16Array.prototype.fill",C);n("Int32Array.prototype.fill",C);n("Uint32Array.prototype.fill",C);n("Float32Array.prototype.fill",C);n("Float64Array.prototype.fill",C);
n("String.prototype.startsWith",function(e){return e?e:function(b,c){var d=oa(this,b,"startsWith"),f=d.length,g=b.length;c=Math.max(0,Math.min(c|0,d.length));for(var h=0;h<g&&c<f;)if(d[c++]!=b[h++])return!1;return h>=g}});function qa(e){"@babel/helpers - typeof";qa="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(b){return typeof b}:function(b){return b&&"function"===typeof Symbol&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b};return qa(e)}
function E(e,b,c){"undefined"!==typeof Reflect&&Reflect.get?E=Reflect.get:E=function(d,f,g){for(;!Object.prototype.hasOwnProperty.call(d,f)&&(d=F(d),null!==d););if(d)return f=Object.getOwnPropertyDescriptor(d,f),f.get?f.get.call(g):f.value};return E(e,b,c||e)}function G(e,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(b&&b.prototype,{constructor:{value:e,writable:!0,configurable:!0}});b&&sa(e,b)}
function H(e){var b=ta();return function(){var c=F(e);if(b){var d=F(this).constructor;c=Reflect.construct(c,arguments,d)}else c=c.apply(this,arguments);if(!c||"object"!==qa(c)&&"function"!==typeof c){if(void 0===this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");c=this}return c}}function F(e){F=Object.setPrototypeOf?Object.getPrototypeOf:function(b){return b.__proto__||Object.getPrototypeOf(b)};return F(e)}
function ua(e,b,c){ta()?ua=Reflect.construct:ua=function(d,f,g){var h=[null];h.push.apply(h,f);d=new (Function.bind.apply(d,h));g&&sa(d,g.prototype);return d};return ua.apply(null,arguments)}function ta(){if("undefined"===typeof Reflect||!Reflect.construct||Reflect.construct.a)return!1;if("function"===typeof Proxy)return!0;try{return Reflect.construct(Date,[],function(){}),!0}catch(e){return!1}}function sa(e,b){sa=Object.setPrototypeOf||function(c,d){c.__proto__=d;return c};return sa(e,b)}
function va(e){var b=Array.isArray(e)?e:void 0;if(!b)if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){b=[];var c=!0,d=!1,f=void 0;try{for(var g=e[Symbol.iterator](),h;!(c=(h=g.next()).done)&&(b.push(h.value),2!==b.length);c=!0);}catch(k){d=!0,f=k}finally{try{if(!c&&null!=g["return"])g["return"]()}finally{if(d)throw f;}}}else b=void 0;if(!(e=b||wa(e,2)))throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
return e}function I(e,b){if(!(e instanceof b))throw new TypeError("Cannot call a class as a function");}function xa(e,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(e,d.key,d)}}function J(e,b,c){b&&xa(e.prototype,b);c&&xa(e,c)}function O(e,b,c){b in e?Object.defineProperty(e,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):e[b]=c}
function P(e){var b=Array.isArray(e)?ya(e):void 0;b||(b="undefined"!==typeof Symbol&&Symbol.iterator in Object(e)?Array.from(e):void 0);if(!(e=b||wa(e)))throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");return e}
function wa(e,b){if(e){if("string"===typeof e)return ya(e,b);var c=Object.prototype.toString.call(e).slice(8,-1);"Object"===c&&e.constructor&&(c=e.constructor.name);if("Map"===c||"Set"===c)return Array.from(e);if("Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return ya(e,b)}}function ya(e,b){if(null==b||b>e.length)b=e.length;for(var c=0,d=Array(b);c<b;c++)d[c]=e[c];return d}var Q=Object.create(null);Q.browser=Object.create(null);Q.feature=Object.create(null);
["proxy","symbol","worker","promise"].forEach(function(e){e=e[0].toUpperCase()+e.substring(1);Q.feature[e]=window[e]?!0:!1});Object.freeze(Q);var R=Object.create(null);Object.defineProperty(R,"clickMask",{enumerable:!0,value:function(){void this.remove()}});Object.defineProperty(R,"interaction",{enumerable:!0,value:{ok:null,no:null,cancel:function(){void this.remove()}}});
Object.defineProperty(R,"active",{enumerable:!0,value:function(e){var b;var c=0;var d=this.variable.nodes;e=null!==(b=e)&&void 0!==b?b:window.event;S._instance.forEach(function(g){g.status===S._enum.STATUS.SHOW&&c++});if(2<=c){var f=S._assistant.element.maxZIndex();d.container.style.zIndex!=f&&(Object.keys(d).forEach(function(g){d[g].style.zIndex=f+1}),d.container.style.zIndex=parseInt(d.container.style.zIndex)+1)}}});
Object.defineProperty(R,"drag",{enumerable:!0,value:function(e){var b,c=this,d;var f=this.status;e=null!==(b=e)&&void 0!==b?b:window.event;var g=this.variable.nodes.container;var h=g.getBoundingClientRect();if(null===this.option.window)var k=[0,window.innerWidth,0,window.innerHeight];else e=this.option.window.getBoundingClientRect(),k=[0,e.width,0,e.height];window.getSelection().empty();var l=function(q,v){c.option.drag.overflow||(h.x+q<k[0]&&(h.x=k[0]-q),h.right+q>k[1]&&(h.x=k[1]-h.width-q),h.y+
v<k[2]&&(h.y=k[2]-v),h.bottom+v>k[3]&&(h.y=k[3]-h.height-v));h.x+=q;h.y+=v;c.option.resize.enable&&c.option.content.fullContainer&&(q=[5,k[1]-h.width-5],v=[5,k[3]-h.height-5],h.x<=q[0]?h.x=q[0]:h.x>=q[1]&&(h.x=q[1]),h.y<=v[0]?h.y=v[0]:h.y>=v[1]&&(h.y=v[1]));g.style.marginLeft=h.x+"px";g.style.marginTop=h.y+"px";c.setStatus(S._enum.STATUS.DRAG)};var m=function(q){d=null!==q&&void 0!==q?q:window.event;1===d.buttons&&l(d.movementX,d.movementY)};var p=function(q){var v;var w=[0,0];q=null!==(v=q)&&void 0!==
v?v:window.event;"ArrowLeft"===q.code&&(w[0]=-1);"ArrowRight"===q.code&&(w[0]=1);"ArrowUp"===q.code&&(w[1]=-1);"ArrowDown"===q.code&&(w[1]=1);q.preventDefault();l.apply(void 0,P(w))};var t=function(){document.removeEventListener("keydown",p,!0);document.removeEventListener("mousemove",m);document.removeEventListener("mouseup",t);c.setStatus(f)};document.addEventListener("mouseup",t);document.addEventListener("mousemove",m);document.addEventListener("keydown",p,!0)}});
Object.defineProperty(R,"resize",{enumerable:!0,value:function(e){function b(q){var v;if(1!==q.buttons)t();else{d.setStatus("resize");q=null!==(v=q)&&void 0!==v?v:window.event;v=q.screenX-m[0];var w=q.screenY-m[1];q=h.getAttribute("position-resize-bar");var r=[k.x,k.y,p[0],p[1]];q.includes("top")&&(r[1]+=w,r[3]-=w,r[1]<f.y&&(r[3]-=f.y-r[1]),r[3]<l[1]&&(r[1]+=r[3]-l[1],r[3]=l[1]));q.includes("bottom")&&(r[3]+=w,r[3]<l[1]&&(r[3]=l[1]));q.includes("left")&&(r[0]+=v,r[2]-=v,r[0]<f.x&&(r[2]-=f.x-r[0]),
r[2]<l[0]&&(r[0]+=r[2]-l[0],r[2]=l[0]));q.includes("right")&&(r[2]+=v,r[2]<l[0]&&(r[2]=l[0]));d.resizeByXYWH(Number(r[0]),Number(r[1]),Number(r[2]),Number(r[3]))}}var c,d=this,f;var g=this.status;e=null!==(c=e)&&void 0!==c?c:window.event;var h=e.target;var k=this.variable.nodes.container.getBoundingClientRect();var l=this.variable.defaultArea;var m=[e.screenX,e.screenY];var p=[k.width,k.height];null===this.option.window?f={x:0,y:0}:f=this.option.window.getBoundingClientRect();window.getSelection().empty();
var t=function v(){document.removeEventListener("mousemove",b);document.removeEventListener("mouseup",v);d.setStatus(g)};document.addEventListener("mouseup",t);document.addEventListener("mousemove",b)}});Object.defineProperty(R,"minimizeRevert",{enumerable:!0,value:function(){if("1"!=this.getAttribute("clicked")){this.setAttribute("clicked",1);var e=Number(this.getAttribute("modal-layer-index"));delete S._minimizeQueue[S._minimizeQueue.indexOf(S._instance[e])]}}});
Object.defineProperty(R,"autoShutdown",{enumerable:!0,value:function(){var e=this;var b=1E3*this.option.popupTime;var c=setInterval(function(){if(e.variable.nodes.container.classList.contains("modal-layer-show")){if(e.option.progress.enable){var d=e.variable.nodes.container.querySelector(".modal-layer-progress-bar-progress");switch(e.option.progress.position){case "top":case "bottom":var f="widthFull";break;case "left":case "right":f="heightFull"}d.style.animation=f+" "+e.option.popupTime+"s linear forwards"}e.variable.timeout.auto_shutdown=
setTimeout(function(){return void e.remove()},b);window.clearInterval(c)}},10)}});
Object.defineProperty(R,"action",{enumerable:!0,value:{close:function(){void this.remove()},expand:function(){var e=this;var b=this.status;var c=this.variable.nodes.container.querySelector("iframe[name="+this.option.layer.name+this.option.index+"]");var d=function(g){g.target===c?e.setStatus(S._enum.STATUS.EXPAND):!1===g.target&&e.setStatus(b);window.removeEventListener("fullscreenerror",f);window.removeEventListener("fullscreenchange",d)};var f=function(g){S.K({J:!1,L:5,title:"\u9519\u8bef",H:!0,
I:"bottom",content:'<i class="fas fa-window-close" style="color: red"></i> \u5168\u5c4f\u5931\u8d25, \u9519\u8bef\u539f\u56e0: '+g});window.removeEventListener("fullscreenerror",f);window.removeEventListener("fullscreenchange",d)};window.addEventListener("fullscreenerror",f);window.addEventListener("fullscreenchange",d);S._assistant.element.launchFullscreen(c)},minimize:function(){var e=S._minimizeQueue.indexOf(this);0>e?S._minimizeQueue.push(this):S._minimizeQueue.splice(e,1)}}});
Object.defineProperty(R,"imageTools",{enumerable:!0,value:{crop:function(){this.variable.image.status===S._enum.LOAD_STATUS.LOADED&&this.crop()},spin:function(){this.variable.image.status===S._enum.LOAD_STATUS.LOADED&&this.spin()},filter:function(e){this.variable.image.status===S._enum.LOAD_STATUS.LOADED&&this.filter((null!==e&&void 0!==e?e:window.event).target)},revert:function(){this.variable.image.status===S._enum.LOAD_STATUS.LOADED&&this.revert()},download:function(){this.variable.image.status===
S._enum.LOAD_STATUS.LOADED&&this.download()}}});Object.freeze(R);var T=Object.create(null);Object.defineProperty(T,"page",{value:{src:null,srcdoc:null,frameborder:0,scrolling:"no",area:[800,600],allowfullscreen:!0,name:"modal-layer-page-"}});Object.defineProperty(T,"loading",{value:{icon:0,size:48,rate:null,duration:2,area:[48,48],color:"white",background:"transparent",position:["center","center"]}});
Object.defineProperty(T,"image",{value:{image:[],size:null,sizeRange:{min:[.15625,.160257],max:[.9,.9]},toolbar:{enable:!1,config:{crop:{enable:!1,title:"crop",grid:"quarter",icon:"fas fa-crop-alt"},spin:{enable:!1,title:"spin",icon:"fas fa-redo-alt"},filter:{enable:!1,config:{blur:{enable:!1,title:"blur",icon:null,textIcon:"\u6a21"},gray:{enable:!1,title:"gray",icon:null,textIcon:"\u7070"},mirror:{enable:!1,title:"mirror",icon:null,textIcon:"\u955c"}},title:"filter",icon:"fas fa-filter"},revert:{enable:!1,
title:"revert",icon:"fas fa-sync-alt"},download:{enable:!1,title:"download",icon:"fas fa-download"}}}}});
Object.defineProperty(T,"common",{value:{index:0,ui:"modal-layer-ui",title:null,window:null,popupTime:5,skin:"default",parentModalLayer:null,areaProportion:[.18,.21],content:{value:null,fullContainer:!1},text:{action:{close:"\u5173\u95ed",expand:"\u5168\u5c4f",minimize:"\u6700\u5c0f\u5316"},interaction:{ok:"\u786e\u5b9a",no:"\u62d2\u7edd",cancel:"\u53d6\u6d88"}},transition:{time:.2,opacity:0,scale:[.45,.45]},mask:{enable:!0,clickRemove:!0},drag:{enable:!0,overflow:!1},resize:{enable:!0},progress:{enable:!1,
position:"bottom",color:"deepskyblue",background:"#cecece"},layer:{},hook:{initStart:null,initEnded:null}}});Object.freeze(T);var U=Object.create(null);Object.defineProperty(U,"mask",{get:function(){return JSON.parse(JSON.stringify({nodeType:"div","class":"modal-layer-mask"}))},enumerable:!0,configurable:!1});Object.defineProperty(U,"container",{get:function(){return JSON.parse(JSON.stringify({innerHTML:[],nodeType:"div","class":"modal-layer-container"}))},enumerable:!0,configurable:!1});
Object.defineProperty(U,"action",{get:function(){return JSON.parse(JSON.stringify({innerHTML:[],nodeType:"div","class":"modal-layer-action"}))},enumerable:!0,configurable:!1});
Object.defineProperty(U,"action_button",{get:function(){return JSON.parse(JSON.stringify({minimize:{nodeType:"span","data-fa-transform":"up-4 shrink-2","class":"fas fa-window-minimize modal-layer-action-btn modal-layer-action-btn-minimize"},expand:{nodeType:"span","data-fa-transform":"shrink-2","class":"fas fa-expand-arrows-alt modal-layer-action-btn modal-layer-action-btn-expand"},close:{nodeType:"span","data-fa-transform":"rotate-45 grow-1","class":"fas fa-plus modal-layer-action-btn modal-layer-action-btn-close"}}))},
enumerable:!0,configurable:!1});Object.defineProperty(U,"title",{get:function(){return JSON.parse(JSON.stringify({nodeType:"div","class":"modal-layer-title",innerHTML:[{nodeType:"h4","class":"modal-layer-title-content"}]}))},enumerable:!0,configurable:!1});Object.defineProperty(U,"content",{get:function(){return JSON.parse(JSON.stringify({innerHTML:[],nodeType:"div","class":"modal-layer-content"}))},enumerable:!0,configurable:!1});
Object.defineProperty(U,"content_text",{get:function(){return JSON.parse(JSON.stringify({nodeType:"div","class":"modal-layer-text-content"}))},enumerable:!0,configurable:!1});Object.defineProperty(U,"content_page",{get:function(){return JSON.parse(JSON.stringify({name:"",frameborder:0,scrolling:"no",nodeType:"iframe","class":"modal-layer-page-content"}))},enumerable:!0,configurable:!1});
Object.defineProperty(U,"content_image",{get:function(){return JSON.parse(JSON.stringify({"load-status":2,nodeType:"canvas","class":"modal-layer-image-canvas"}))},enumerable:!0,configurable:!1});Object.defineProperty(U,"content_loading",{get:function(){return JSON.parse(JSON.stringify({nodeType:"div","class":"modal-layer-loading-box",innerHTML:[{nodeType:"span","class":"modal-layer-loading-icon"}]}))},enumerable:!0,configurable:!1});
Object.defineProperty(U,"content_loading_icon",{get:function(){return JSON.parse(JSON.stringify([{nodeType:"span","class":"modal-layer-loading-icon fas fa-spinner fa-spin fa-fw"},{nodeType:"span","class":"modal-layer-loading-icon fas fa-circle-notch fa-spin fa-fw"},{nodeType:"span","class":"modal-layer-loading-icon fas fa-sync fa-spin fa-fw"},{nodeType:"span","class":"modal-layer-loading-icon fas fa-cog fa-spin fa-fw"}]))},enumerable:!0,configurable:!1});
Object.defineProperty(U,"toolbar",{get:function(){return JSON.parse(JSON.stringify({innerHTML:[],nodeType:"div","class":"modal-layer-toolbar"}))},enumerable:!0,configurable:!1});Object.defineProperty(U,"interaction",{get:function(){return JSON.parse(JSON.stringify({innerHTML:[],nodeType:"div","class":"modal-layer-interaction"}))},enumerable:!0,configurable:!1});
Object.defineProperty(U,"interaction_button",{get:function(){return JSON.parse(JSON.stringify({ok:{nodeType:"span","class":"modal-layer-interaction-btn modal-layer-interaction-btn-ok"},no:{nodeType:"span","class":"modal-layer-interaction-btn modal-layer-interaction-btn-no"},cancel:{nodeType:"span","class":"modal-layer-interaction-btn modal-layer-interaction-btn-cancel"}}))},enumerable:!0,configurable:!1});
Object.defineProperty(U,"progress_bar",{get:function(){return JSON.parse(JSON.stringify({nodeType:"div","class":"modal-layer-progress-bar",innerHTML:[{nodeType:"div","class":"modal-layer-progress-bar-background",innerHTML:[{nodeType:"span","class":"modal-layer-progress-bar-progress"}]}]}))},enumerable:!0,configurable:!1});
Object.defineProperty(U,"resize_box",{get:function(){return JSON.parse(JSON.stringify({nodeType:"div","class":"modal-layer-resize-box",innerHTML:[{nodeType:"div","class":"modal-layer-resize-bar","position-resize-bar":"top"},{nodeType:"div","class":"modal-layer-resize-bar","position-resize-bar":"left"},{nodeType:"div","class":"modal-layer-resize-bar","position-resize-bar":"right"},{nodeType:"div","class":"modal-layer-resize-bar","position-resize-bar":"bottom"},{nodeType:"div","class":"modal-layer-resize-bar",
"position-resize-bar":"left-top"},{nodeType:"div","class":"modal-layer-resize-bar","position-resize-bar":"right-top"},{nodeType:"div","class":"modal-layer-resize-bar","position-resize-bar":"left-bottom"},{nodeType:"div","class":"modal-layer-resize-bar","position-resize-bar":"right-bottom"}]}))},enumerable:!0,configurable:!1});Object.defineProperty(U,"minimize_queue",{get:function(){return JSON.parse(JSON.stringify({innerHTML:[],nodeType:"div",id:"modal-layer-minimize-queue"}))},enumerable:!0,configurable:!1});
Object.defineProperty(U,"minimize_queue_item",{get:function(){return JSON.parse(JSON.stringify({nodeType:"div","class":"modal-layer-minimize-queue-item",innerHTML:[{nodeType:"h4","class":"modal-layer-minimize-queue-item-title"}]}))},enumerable:!0,configurable:!1});
Object.defineProperty(U,"image_tools",{get:function(){return JSON.parse(JSON.stringify({crop:{title:"crop",nodeType:"div","tool-type":"crop",innerHTML:[{nodeType:"span","class":"modal-layer-toolbar-item-icon"}],"class":"modal-layer-toolbar-item"},spin:{title:"spin",nodeType:"div","tool-type":"spin",innerHTML:[{nodeType:"span","class":"modal-layer-toolbar-item-icon"}],"class":"modal-layer-toolbar-item"},revert:{title:"revert",nodeType:"div","tool-type":"revert",innerHTML:[{nodeType:"span","class":"modal-layer-toolbar-item-icon"}],
"class":"modal-layer-toolbar-item"},filter:{title:"filter",nodeType:"div","tool-type":"filter",innerHTML:[{nodeType:"span","class":"modal-layer-toolbar-item-icon"},{innerHTML:[],nodeType:"div","class":"modal-layer-toolbar-item-child-list"}],"class":"modal-layer-toolbar-item"},download:{title:"save",nodeType:"div","tool-type":"download",innerHTML:[{nodeType:"span","class":"modal-layer-toolbar-item-icon"}],"class":"modal-layer-toolbar-item"}}))},enumerable:!0,configurable:!1});
Object.defineProperty(U,"image_tools_child",{get:function(){return JSON.parse(JSON.stringify({filter:{mirror:{title:"\u955c\u50cf",innerText:"\u955c",nodeType:"span","filter-type":"mirror","class":"modal-layer-toolbar-filter-icon"},blur:{"data-radius":3,"data-sigma":1.5,innerText:"\u6a21",title:"\u9ad8\u65af\u6a21\u7cca",nodeType:"span","filter-type":"blur","class":"modal-layer-toolbar-filter-icon"},gray:{title:"\u7070\u5ea6\u5316",innerText:"\u7070",nodeType:"span","filter-type":"gray","class":"modal-layer-toolbar-filter-icon"}}}))},
enumerable:!0,configurable:!1});Object.freeze(U);var V=Object.create(null);Object.defineProperty(V,"ARROW",{enumerable:!0,value:{LEFT:37,UP:38,RIGHT:39,DOWN:40}});Object.defineProperty(V,"POSITION",{enumerable:!0,value:{EAST:"e",WEST:"w",SOUTH:"s",NORTH:"n"}});Object.defineProperty(V,"TYPE",{enumerable:!0,value:{MSG:0,MESSAGE:0,ALERT:1,PROMPT:2,CONFIRM:3,PAGE:4,LOADING:5,IMAGE:6,VIDEO:7,AUTDIO:8}});
Object.defineProperty(V,"STATUS",{enumerable:!0,value:{HIDE:0,SHOW:1,EXPAND:2,MINIMIZE:3,REMOVING:4,REMOVED:5,DRAG:6,RESIZE:7}});Object.defineProperty(V,"LOAD_STATUS",{enumerable:!0,value:{FAILED:0,LOADED:1,LOADING:2}});Object.defineProperty(V,"BROWSER_STORAGE",{enumerable:!0,value:{WEBSQL:"webSQL",INDEXDB:"indexedDB",LOCALSTORAGE:"localStorage",SESSIONSTORAGE:"sessionStorage"}});Object.freeze(V);
var S=function(){function e(b,c){I(this,e);O(this,"type",null);O(this,"status",null);O(this,"event",null);O(this,"option",null);O(this,"variable",{});try{var d,f,g,h,k,l;null===(d=b.hook)||void 0===d?void 0:null===(f=d.initStart)||void 0===f?void 0:null===(g=f.call)||void 0===g?void 0:g.call(f,b);this.type=b.type;this.status=e._enum.STATUS.HIDE;this.compatibleOption(b);this.initOption(b);this.checkOption();this.linkageOption();this.initVariable();this.initStruct();this.initNode();this.initNodeFinally();
this.initEvent();this.bindEvent();null===(h=this.option.hook)||void 0===h?void 0:null===(k=h.initEnded)||void 0===k?void 0:null===(l=k.call)||void 0===l?void 0:l.call(k,this);this.insertNode()}catch(m){null===c||void 0===c?void 0:c.call(null,m)}}J(e,[{key:"initOption",value:function(b){b.index=e._instance.length;this.option=e._assistant.object.merge(b,e._option.common)}},{key:"compatibleOption",value:function(b){var c,d;if("boolean"===typeof b.mask||["true","false"].includes(b.mask))b.mask={enable:!!b.mask,
clickRemove:!0};if(!b.content||e._assistant.object.isEmpty(b.content.value))b.content={value:b.content,fullContainer:null!==(c=null===(d=b.content)||void 0===d?void 0:d.fullContainer)&&void 0!==c?c:!1}}},{key:"linkageOption",value:function(){0>=this.option.popupTime&&(this.option.progress.enable=!1);!1===this.option.title&&(this.option.drag.enable=!1)}},{key:"checkOption",value:function(){}},{key:"initVariable",value:function(){this.variable.struct=Object.create(null);this.variable.timeout=Object.create(null);
this.variable.interval=Object.create(null);this.variable.eventSymbol=Object.create(null);this.variable.animationName=Object.create(null);this.variable.struct._build=Object.create(null);this.variable.struct._backup=Object.create(null)}},{key:"initStruct",value:function(){var b;if(null===(b=this.option.mask)||void 0===b?0:b.enable)this.variable.struct._build.mask=e._struct.mask;this.variable.struct._build.container=e._struct.container}},{key:"initNode",value:function(){this.variable.nodes=e._assistant.element.objectToNode(this.variable.struct._build);
var b=this.variable.nodes.mask;var c=this.variable.nodes.container;var d=c.querySelector(".modal-layer-interaction-btn-ok");var f=c.querySelector(".modal-layer-interaction-btn-no");var g=c.querySelector(".modal-layer-interaction-btn-cancel");null!==this.option.window&&(null===b||void 0===b?void 0:b.setAttribute("has-window",""),c.setAttribute("has-window",""));c.setAttribute("modal-layer-popup-time",this.option.popupTime);c.setAttribute("content-full-container",Number(this.option.content.fullContainer));
c.setAttribute("modal-layer-type",e._assistant.object.getKeyByValue(e._enum.TYPE,this.type).toLowerCase());c.setAttribute("allow-drag",Number(this.option.drag.enable));c.setAttribute("allow-resize",Number(this.option.resize.enable));if(this.option.progress.enable){b=["top","left","right","bottom"];var h=c.querySelector(".modal-layer-progress-bar");b.includes(this.option.progress.position)||(this.option.progress.position=b[3]);h.setAttribute("progress-bar-position",this.option.progress.position);h.querySelector(".modal-layer-progress-bar-progress").style.cssText+=
"background: "+this.option.progress.color;h.querySelector(".modal-layer-progress-bar-background").style.cssText+="background: "+this.option.progress.background}if(!1!==this.option.title){var k=c.querySelector(".modal-layer-title-content");if(this.option.title instanceof Object){var l=e._assistant.element.objectToNode(this.option.title);Object.keys(l).forEach(function(m){k.appendChild(l[m])})}else k.innerHTML=this.option.title}d&&(d.innerText=this.option.text.interaction.ok);f&&(f.innerText=this.option.text.interaction.no);
g&&(g.innerText=this.option.text.interaction.cancel)}},{key:"initNodeFinally",value:function(){var b=this.option.ui;var c="modal-layer-skin-"+this.option.skin;var d="modal-layer-index-"+this.option.index;var f="transition-opacity-"+100*this.option.transition.opacity+"-animation";var g="transition-scale-"+100*this.option.transition.scale[0]+"-"+100*this.option.transition.scale[1]+"-animation";this.variable.animationName.transition_opacity=f;this.variable.animationName.transition_scale=g;if(!e._assistant.css.hasCss(f)){var h=
{from:"opacity: "+this.option.transition.opacity,to:"opacity: 1"};var k=e._assistant.css.createAnimation(f,h);e._assistant.css.addCss(f,k);e._assistant.css.addCss(f+"-reverse",e._assistant.css.createAnimation(f+"-reverse",{from:h.to,to:h.from}))}e._assistant.css.hasCss(g)||(f={from:"transform: scale("+this.option.transition.scale[0]+", "+this.option.transition.scale[1]+")",to:"transform: scale(1, 1)"},k=e._assistant.css.createAnimation(g,f),e._assistant.css.addCss(g,k),e._assistant.css.addCss(g+"-reverse",
e._assistant.css.createAnimation(g+"-reverse",{from:f.M,to:f.from})));Object.keys(this.variable.nodes).forEach(function(l){for(var m=e._assistant.element.getAllElement(this.variable.nodes[l]),p=0;p<m.length;p++)m[p].classList.add(b);this.variable.nodes[l].className=b+" "+c+" "+d+" "+this.variable.nodes[l].className.trim()+" modal-layer-hide"},this);e._instance[this.option.index]=this}},{key:"initEvent",value:function(){var b;this.event=e._assistant.object.merge(null!==(b=this.option.event)&&void 0!==
b?b:{},e._event)}},{key:"bindEvent",value:function(){var b={once:!1,capture:!1,passive:!1,mozSystemGroup:!1};this.option.mask.enable&&this.option.mask.clickRemove&&(this.variable.eventSymbol.maskClickRemove=e._assistant.event.add(this.variable.nodes.mask,"click",null,this.event.clickMask,this,null,b));this.option.drag.enable&&(this.variable.eventSymbol.drag=e._assistant.event.add(this.variable.nodes.container.querySelector(".modal-layer-title"),"mousedown",null,this.event.drag,this,null,b));this.option.resize.enable&&
(this.variable.eventSymbol.resize=e._assistant.event.add(this.variable.nodes.container,"mousedown",".modal-layer-resize-bar",this.event.resize,this,null,b));this.variable.eventSymbol.active=e._assistant.event.add(this.variable.nodes.container,"mousedown",null,this.event.active,this,null,b);this.event.action.close instanceof Function&&(this.variable.eventSymbol.actionClose=e._assistant.event.add(this.variable.nodes.container,"click",".modal-layer-action-btn-close",this.event.action.close,this,null,
b));this.event.action.expand instanceof Function&&(this.variable.eventSymbol.actionExpand=e._assistant.event.add(this.variable.nodes.container,"click",".modal-layer-action-btn-expand",this.event.action.expand,this,null,b));this.event.action.minimize instanceof Function&&(this.variable.eventSymbol.actionMinimize=e._assistant.event.add(this.variable.nodes.container,"click",".modal-layer-action-btn-minimize",this.event.action.minimize,this,null,b));var c=this.variable.nodes.container.querySelector(".modal-layer-interaction-btn-ok");
var d=this.variable.nodes.container.querySelector(".modal-layer-interaction-btn-no");var f=this.variable.nodes.container.querySelector(".modal-layer-interaction-btn-cancel");this.event.interaction.ok&&c&&(this.variable.eventSymbol.interactionOk=e._assistant.event.add(c,"click",null,this.event.interaction.ok,this,null,b));this.event.interaction.no&&d&&(this.variable.eventSymbol.interactionNo=e._assistant.event.add(d,"click",null,this.event.interaction.no,this,null,b));f&&(this.variable.eventSymbol.interactionCancel=
e._assistant.event.add(f,"click",null,this.event.interaction.cancel,this,null,b))}},{key:"insertNode",value:function(){var b,c,d=this,f=document.createDocumentFragment(),g=null!==(b=this.option.window)&&void 0!==b?b:window.document.body;if(g instanceof String||"string"===typeof g)g=null!==(c=document.querySelector(g))&&void 0!==c?c:window.a.body;Object.keys(this.variable.nodes).forEach(function(h){f.appendChild(d.variable.nodes[h])},this);g.appendChild(f)}}]);J(e,[{key:"setStatus",value:function(b){if(Object.values(e._enum.STATUS).includes(b))var c=
e._assistant.object.getKeyByValue(e._enum.STATUS,b);else if(c=b.toUpperCase(),void 0===(b=e._enum.STATUS[c]))throw Error("Illegal value");this.status=b;this.variable.nodes.container.setAttribute("modal-layer-status",c.toLowerCase())}},{key:"resize",value:function(){var b=[0,0];var c=this.variable.nodes.container;var d=c.children;b[0]=e._assistant.number.multiply(window.innerWidth,this.option.areaProportion[0]);c.style.width=b[0]+"px";for(var f=0;f<d.length;f++)b[1]="absolute"==getComputedStyle(d[f],
null).position?b[1]:Math.max(e._assistant.element.getNodeHeight(d[f]),b[1]);c.style.height=b[1]+"px";this.variable.defaultArea=b}},{key:"resizeByXYWH",value:function(b,c,d,f){var g;var h=this.variable.nodes.container;null===this.option.window?g={x:0,y:0,top:0,left:0,right:window.innerWidth,width:window.innerWidth,bottom:window.innerHeight,height:window.innerHeight}:g=this.option.window.getBoundingClientRect();b<g.x&&(b=g.x);b+d>g.right&&(d=g.right-b);c<g.y&&(c=g.y);c+f>g.bottom&&(f=g.bottom-c);h.style.marginLeft=
b+"px";h.style.marginTop=c+"px";h.style.width=d+"px";h.style.height=f+"px";[e._enum.TYPE.PAGE,e._enum.TYPE.VIDEO,e._enum.TYPE.AUDIO].includes(this.type)&&(b=h.querySelector("iframe[name="+this.option.layer.name+this.option.index+"]"),b.style.width=this.option.layer.area[0]+d-this.variable.defaultArea[0]+"px",b.style.height=this.option.layer.area[1]+f-this.variable.defaultArea[1]+"px")}},{key:"show",value:function(){var b=this;var c=this.variable.nodes;var d=e._assistant.element.maxZIndex();if(0===
Object.keys(c).length||this.status===e._enum.STATUS.SHOW)return Promise.resolve();var f=this.variable.animationName.transition_opacity+" "+this.option.transition.time+"s ease forwards";var g=this.variable.animationName.transition_scale+" "+this.option.transition.time+"s ease forwards";Object.keys(c).forEach(function(k){c[k].style.zIndex=d+1});var h=new Promise(function(k){c.container.onanimationend=function(){0<b.option.popupTime&&b.event.autoShutdown.call(b);c.container.onanimationend=null;k()}});
c.mask&&(c.mask.style.animation=f);c.container.style.animation=f+", "+g;Object.keys(c).forEach(function(k){c[k].classList.contains("modal-layer-hide")&&c[k].classList.replace("modal-layer-hide","modal-layer-show")},this);this.setStatus("show");return h}},{key:"hide",value:function(){var b=this;var c=this.variable.nodes;if(0===Object.keys(c).length||this.status===e._enum.STATUS.HIDE)return Promise.resolve();Number.isInteger(this.variable.timeout.auto_shutdown)&&window.clearTimeout(this.variable.timeout.auto_shutdown);
var d=this.variable.animationName.transition_opacity+"-reverse "+this.option.transition.time+"s ease forwards";var f=this.variable.animationName.transition_scale+"-reverse "+this.option.transition.time+"s ease forwards";var g=new Promise(function(h){c.container.onanimationend=function(){Object.keys(c).forEach(function(k){c[k].classList.contains("modal-layer-show")&&c[k].classList.replace("modal-layer-show","modal-layer-hide")});b.setStatus("hide");c.container.onanimationend=null;null!==b.option.parentModalLayer&&
b.option.parentModalLayer.show();h()}});c.mask&&(c.mask.style.animation=d);c.container.style.animation=d+", "+f;return g}},{key:"minimize",value:function(){var b=this;if(this.status!==e._enum.STATUS.MINIMIZE){var c=document.querySelector("#modal-layer-minimize-queue");c||(c=e._assistant.element.objectToNode([e._struct.minimize_queue])[0],c.classList.add(this.option.ui,"modal-layer-skin-".concat(this.option.skin)),e._variable.minimizeQueueEvent=e._assistant.event.add(c,"click",".modal-layer-minimize-queue-item",
this.event.minimizeRevert,null,null,!1),document.body.insertAdjacentElement("beforeend",c));var d=this.variable.nodes.container.querySelector(".modal-layer-title-content").innerHTML;var f=e._assistant.element.objectToNode([e._struct.minimize_queue_item])[0];f.classList.add(this.option.ui);f.setAttribute("modal-layer-index",this.option.index);f.querySelector(".modal-layer-minimize-queue-item-title").innerHTML=d;c.insertAdjacentElement("beforeend",f);var g=setInterval(function(){f.parentNode&&(f.style.animation=
"opacity 0.3s ease forwards, "+b.variable.animationName.minimize_queue_transition_scale+" 0.3s ease forwards",clearInterval(g))},10);this.hide().then(function(){return void b.setStatus("minimize")})}}},{key:"revert",value:function(){var b=this;var c=document.querySelector("#modal-layer-minimize-queue");var d=c.querySelector('.modal-layer-minimize-queue-item[modal-layer-index="'+this.option.index+'"]');if([e._enum.STATUS.MINIMIZE].includes(this.status)){d.onanimationstart=function(){setTimeout(function(){b.show();
d.onanimationstart=null},150)};var f=new Promise(function(g){d.onanimationend=function(){d.remove();0>=e._minimizeQueue.length&&(c.remove(),e._assistant.event.remove(e._variable.minimizeQueueEvent));g()}});d.style.animation="opacity-reverse 0.3s ease forwards, "+this.variable.animationName.minimize_queue_transition_scale+"-reverse 0.3s ease forwards";return f}}},{key:"remove",value:function(){var b=this;var c=this.variable.nodes;if(0===Object.keys(c).length||[e._enum.STATUS.REMOVING,e._enum.STATUS.REMOVED].includes(this.status))return Promise.resolve();
this.status===e._enum.STATUS.MINIMIZE&&delete e._minimizeQueue[e._minimizeQueue.indexOf(this)];this.setStatus("removing");return this.hide().then(function(){b.removeAllEvent();Object.keys(c).forEach(function(d){c[d].remove()});b.setStatus("removed")})}},{key:"delete",value:function(){var b=this;this.remove().then(function(){e.a.splice(b.option.index,1);e._assistant.object.dereference(b.event);e._assistant.object.dereference(b.option);e._assistant.object.dereference(b.variable);b.event=b.option=b.variable=
null})}},{key:"removeAllEvent",value:function(){var b;if(0!==Object.keys(b=this.variable.nodes).length){Object.values(this.variable.eventSymbol).forEach(function(g){return e._assistant.event.remove(g)});var c=b.container.querySelector(".modal-layer-interaction-btn-ok");var d=b.container.querySelector(".modal-layer-interaction-btn-no");var f=b.container.querySelector(".modal-layer-interaction-btn-cancel");b.container.removeEventListener("mousedown",this.event.active);b.container.removeEventListener("click",
this.event.action.close);b.container.removeEventListener("click",this.event.action.expand);b.container.removeEventListener("click",this.event.action.minimize);c&&c.removeEventListener("click",this.event.interaction_ok);d&&d.removeEventListener("click",this.event.interaction_no);f&&f.removeEventListener("click",this.event.interaction_cancel);document.removeEventListener("click",this.event.minimizeRevert)}}}],[{key:"removeAll",value:function(){for(var b=0;b<e._instance.length;b++)e._instance[b].remove()}},
{key:"msg",value:function(b,c){e.message(b,c)}},{key:"message",value:function(b,c){"string"===typeof b?b={content:b,type:e._enum.TYPE.MESSAGE}:b.type=e._enum.TYPE.MESSAGE;b=new (e._achieve.get("message"))(b,c);b.resize();b.show();return b}},{key:"alert",value:function(b,c){b.type=e._enum.TYPE.ALERT;b=new (e._achieve.get("alert"))(b,c);b.resize();b.show();return b}},{key:"confirm",value:function(b,c){b.type=e._enum.TYPE.CONFIRM;b=new (e._achieve.get("confirm"))(b,c);b.resize();b.show();return b}},
{key:"prompt",value:function(b,c){b.type=e._enum.TYPE.PROMPT;b=new (e._achieve.get("prompt"))(b,c);b.resize();b.show();return b}},{key:"page",value:function(b,c){b.type=e._enum.TYPE.PAGE;b=new (e._achieve.get("page"))(b,c);b.resize();b.show();return b}},{key:"image",value:function(b,c){var d=null;b.type=e._enum.TYPE.IMAGE;d=new (e._achieve.get("image"))(b,c);d.variable.image.finish.then(function(){return d.resize()}).then(function(){return d.show()});return d}},{key:"loading",value:function(b,c){b.type=
e._enum.TYPE.LOADING;b=new (e._achieve.get("loading"))(b,c);b.resize();b.show();return b}}]);return e}();O(S,"_env",Q);O(S,"_enum",V);O(S,"_struct",U);O(S,"_option",T);O(S,"_variable",new Map);O(S,"_worker",window.Worker?new Map:void 0);O(S,"_event",R);O(S,"_version",1);O(S,"_achieve",new Map);O(S,"_assistant",Object.create(null));O(S,"_instance",new Proxy([],{set:function(e,b,c){if(c instanceof S||"length"===b)return e[b]=c,!0;throw new TypeError("Must be of type ModalLayer");}}));
O(S,"_minimizeQueue",new Proxy([],{set:function(e,b,c){if(c instanceof S){var d=e.indexOf(c);c.minimize();0>d?e[b]=c:e[d]=c;return!0}return"length"===b?(e[b]=c,!0):!1},deleteProperty:function(e,b){b=parseInt(b);if(Number.isInteger(b)&&e[b]instanceof S){e[b].revert();if(e[b+1])for(;b<e.length-1;b++)e[b]=e[b+1];delete e[e.length-1];e.length--;return!0}}}));Object.seal(S);
Object.is(window.ModalLayer,S)?(console.group("ModalLayer already exists"),console.log("Already version ".concat(window.ModalLayer._version)),console.log("Try to introduce version: ".concat(S._version)),console.groupEnd()):(Object.preventExtensions(S),Object.defineProperty(window,"ModalLayer",{value:S}));
var za=function(){function e(){I(this,e)}J(e,null,[{key:"createAnimation",value:function(b,c){var d="@keyframes "+b+" {";Object.keys(c).forEach(function(f){d+=f+"{"+c[f]+"}"});return d+"}"}},{key:"hasCss",value:function(b){return e.cssList.has(b)}},{key:"addCss",value:function(b,c){if(e.hasCss(b))return!1;e.styleNode||(e.styleNode=document.createElement("style"),document.head.appendChild(e.styleNode));c=c.trim();e.cssList.set(b,c);e.styleNode.innerHTML+=e.delimiter+c}},{key:"delCss",value:function(b){e.hasCss(b)&&
(b=new RegExp(e.delimiter+e.cssList.get(b),"g"),e.styleNode.innerHTML=e.styleNode.innerHTML.replace(b,""))}}]);return e}();O(za,"cssList",new Map);O(za,"delimiter","\n");O(za,"styleNode",null);Object.defineProperty(S._assistant,"css",{value:za});
var Aa=function(){function e(){I(this,e)}J(e,null,[{key:"getFileBinary",value:function(b,c){var d;c=null!==(d=c)&&void 0!==d?d:{};c=X.merge(c,{mode:"cors",method:"get",cache:"no-cache",redirect:"follow",credentials:"include",referrer:"no-referrer",headers:{"content-type":"text/plain"}});return fetch(b,c)}},{key:"getFileBlob",value:function(b){var c=null;b instanceof Blob?c=Promise.resolve(b):b instanceof Image||b instanceof Element&&"IMAGE"===b.nodeName?c=this.u(b.src).then(function(d){return d.blob()}):
"string"===typeof b||b instanceof String?c=this.u(b).then(function(d){return d.blob()}):c=Promise.reject(!1);return c}},{key:"getImage",value:function(b){var c=null;"string"===typeof b||b instanceof String?c=b:b instanceof Image||b instanceof Element&&"IMAGE"===b.nodeName?c=b.src:b instanceof Blob||b instanceof MediaSource?c=URL.createObjectURL(b):c=!1;return c}}]);return e}();Object.defineProperty(S._assistant,"file",{value:Aa});
var Y=function(){function e(){I(this,e)}J(e,null,[{key:"has",value:function(b){var c,d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;d=null!==(c=d)&&void 0!==c?c:e;return(c=e._symbol.get(d))?d[c].has(b):!1}},{key:"get",value:function(b){var c,d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;d=null!==(c=d)&&void 0!==c?c:e;return(c=e._symbol.get(d))?d[c].get(b):void 0}},{key:"set",value:function(b,c){var d,f=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;f=null!==
(d=f)&&void 0!==d?d:e;e._symbol.has(f)?d=e._symbol.get(f):(d=Symbol("cache"),e._symbol.set(f,d));Object.hasOwnProperty.call(f,d)||Object.defineProperty(f,d,{value:new Map,writable:!1,enumerable:!1,configurable:!1});f[d].set(b,c)}},{key:"delete",value:function(){var b,c=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;d=null!==(b=d)&&void 0!==b?b:e;var f=e._symbol.get(d);if(c)d[f]["delete"](c);else d[f].forEach(function(g,h){d[f]["delete"](h)})}},
{key:"clear",value:function(){e._symbol.forEach(function(b,c){e["delete"](null,c)})}}]);return e}();O(Y,"_symbol",new Map);Object.defineProperty(S._assistant,"cache",{value:Y});
var Ca=function(){function e(){I(this,e)}J(e,null,[{key:"add",value:function(b,c,d,f,g,h,k){var l,m=7<arguments.length&&void 0!==arguments[7]?arguments[7]:!1,p;var t=!1;var q=Symbol();(p=Y.get("cache",e))||(p=new Map,Y.set("cache",p,e));if(!(b instanceof EventTarget||(b=document.querySelector(b))))throw Error("Is not a valid element.");if(!X.isString(c))throw Error("Event type not allowed to be empty");d instanceof EventTarget&&(b=d,d=null);f instanceof Function||(t=!0);X.isEmpty(g)&&(g=null!==(l=
d)&&void 0!==l?l:b);X.isEmpty(h)||Array.isArray(h)||(h=[h]);X.isEmpty(k)&&(k=!1);if(t){var v;h=[{target:g,symbol:q,parameter:null!==(v=h)&&void 0!==v?v:[]}]}else{var w;h=null!==(w=h)&&void 0!==w?w:[]}l=d?new Promise(function(r){function x(z){var u=(null!==z&&void 0!==z?z:window.event).target;var L=b.querySelectorAll(d);if(u.contains(b)||0===L.length)return!1;for(var K=0;K<L.length;K++){var W=L[K];if(W.contains(u)){u=W===u?u:W;t?(h[0].event=z,h[0].target=g===d?u:g):0<h.length&&h[h.length-1]instanceof
Event?h[h.length-1]=z:h.push(z);(t?r:f).apply(g===d?u:g,h);break}}}p.set(q,{type:c,element:b,options:k,selector:d,callback:x,wantsUntrusted:m});b.addEventListener(c,x,k,m)}):new Promise(function(r){var x;f=(x=t?r:f).bind.apply(x,[g].concat(P(h)));p.set(q,{type:c,element:b,options:k,selector:d,callback:f,wantsUntrusted:m});b.addEventListener(c,f,k,m)});return t?l:q}},{key:"remove",value:function(b){var c;var d=Y.get("cache",e);if(c=null===d||void 0===d?void 0:d.get(b))c.element.removeEventListener(c.type,
c.callback,c.options),d["delete"](b),X.dereference(c)}},{key:"removeBy",value:function(b,c){var d=Y.get("cache",e);if(!["element","selector","callback"].includes(b))throw Error("key value is invalid");null===d||void 0===d?void 0:d.forEach(function(f,g){f[b]===c&&(f.element.removeEventListener(f.type,f.callback,f.options,f.wantsUntrusted),d["delete"](g))})}},{key:"removeAll",value:function(){var b=Y.get("cache",e);null===b||void 0===b?void 0:b.forEach(function(c,d){c.element.removeEventListener(c.type,
c.callback,c.options,c.wantsUntrusted);b["delete"](d)})}}]);return e}();Object.defineProperty(S._assistant,"event",{value:Ca});
var Da=function(){function e(){I(this,e)}J(e,null,[{key:"has",value:function(b){var c,d;return null!==(c=null===(d=Y.get("list",e))||void 0===d?void 0:d.has(b))&&void 0!==c?c:!1}},{key:"add",value:function(b,c){var d=Y.get("list",e);if(!(c instanceof Worker))throw new TypeError("Not a Worker instance.");if(e.has(b))throw Error("The key already exists.");d||(d=new Map);d.set(b,c)}},{key:"get",value:function(b){var c;return null===(c=Y.get("list",e))||void 0===c?void 0:c.get(b)}},{key:"create",value:function(b,
c){var d;(d=Y.get("list",e))||(d=new Map);try{var f=new Worker(c);d.set(b,f)}catch(g){throw g;}return f}},{key:"close",value:function(b){var c;b instanceof Worker||(b=e.get(b),e.list["delete"](b));null===(c=b)||void 0===c?void 0:c.terminate()}},{key:"listener",value:function(b){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:void 0;if(!(b instanceof Worker)&&(b=e.get(b),void 0===b))throw Error("Worker not found.");return new Promise(function(d,f){b.C=f;b.onmessage=function(g){null===
c||void 0===c?void 0:c(g);d(g)}})}},{key:"addListener",value:function(b){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:void 0;if(!(b instanceof Worker)&&(b=e.get(b),void 0===b))throw Error("Worker not found.");return new Promise(function(d,f){b.addEventListener("messageerror",f);b.addEventListener("message",function(g){null===c||void 0===c?void 0:c(g);d(g)})})}}]);return e}();Object.defineProperty(S._assistant,"worker",{value:Da});
var X=function(){function e(){I(this,e)}J(e,null,[{key:"dereference",value:function(b){Object.keys(b).forEach(function(c){var d=b[c];if(e.isCollection(d))if(e.dereference(d),d instanceof Map)b["delete"](c);else if(d instanceof Set)b["delete"](d);else b[c]=null;else b[c]=null})}},{key:"get",value:function(b,c){c=Array.isArray(c)?c:c.split(".");for(var d=0;d<c.length&&!e.isEmpty(b);d++)b=b[c[d]];return b}},{key:"set",value:function(b,c,d){c=Array.isArray(c)?c:c.split(".");for(var f=0;f<c.length;b=b[c[f]],
f++)e.isEmpty(b[c[f]])&&(b[c[f]]={}),f===c.length-1&&(b instanceof Map?b.set(c[f],d):Object.defineProperty(b,c[f],{value:d,writable:!0,enumerable:!0,configurable:!0}))}},{key:"isEmpty",value:function(b){return null===b||void 0===b}},{key:"isString",value:function(b){return"string"===typeof b||b instanceof String}},{key:"isCollection",value:function(b){var c=[Map,Set,Array,WeakMap,WeakSet,Int8Array,Uint8Array,Int16Array,Int32Array,Uint16Array,Uint32Array,Float32Array,Float64Array,Uint8ClampedArray];
return!e.isEmpty(b)&&(e.isOnlyObject(b)||c.includes(b.constructor))}},{key:"isOnlyObject",value:function(b){return b&&(b.constructor===Object||void 0===b.constructor)}},{key:"getKeyByValue",value:function(b,c){b=Object.entries(b);for(var d=0;d<b.length;d++)if(b[d][1]===c)return b[d][0];return null}},{key:"deepCopy",value:function(b){var c,d;if(e.isEmpty(b))return b;var f=null!==(c=null===(d=b.constructor)||void 0===d?void 0:d.call(b))&&void 0!==c?c:Object.create(null);c=[f];d=[[Object.keys(b),Object.values(b)]];
do{b=c.shift();var g=d.shift();var h=va(g);g=h[0];var k=h[1];for(var l=0;l<g.length;l++){h=g[l];var m=k[l];if(e.isCollection(m)){var p,t,q;b[h]=null!==(p=null===(t=(q=m).constructor)||void 0===t?void 0:t.call(q))&&void 0!==p?p:Object.create(null);d.push([Object.keys(m),Object.values(m)]);c.push(b[h])}else b[h]=m}}while(0<d.length);return f}},{key:"merge",value:function(b,c){var d,f;if(e.isEmpty(b))return c;if(e.isEmpty(c))return b;var g=null!==(d=null===(f=c.constructor)||void 0===f?void 0:f.call(c))&&
void 0!==d?d:Object.create(null);d=[g];c=[[[Object.keys(b),Object.values(b)],[Object.keys(c),Object.values(c)]]];do{b=d.shift();f=c.shift();var h=va(f);var k=va(h[0]);f=k[0];k=k[1];var l=va(h[1]);h=l[0];var m=l[1];h=P(new Set(h.concat(f)));for(var p=0;p<h.length;p++){var t=[h[p],m[p]];l=t[0];var q=t[1];t=k[f.indexOf(l)];var v=e.isEmpty(t);if((e.isEmpty(t)||e.isCollection(t))&&e.isCollection(q)){var w,r,x=[];b[l]=null!==(w=null===(r=v?q.constructor:t.constructor)||void 0===r?void 0:r())&&void 0!==
w?w:Object.create(null);x[1]=[Object.keys(q),Object.values(q)];x[0]=v?[[],[]]:[Object.keys(t),Object.values(t)];d.push(b[l]);c.push(x)}else!e.isCollection(t)&&e.isCollection(q)?b[l]=t:Object.defineProperty(b,l,{writable:!0,enumerable:!0,value:v?q:t})}}while(0<c.length);return g}}]);return e}();Object.defineProperty(S._assistant,"object",{value:X});
var Z=function(){function e(){I(this,e)}J(e,null,[{key:"multiply",value:function(b,c){var d,f;b=b.toString();c=c.toString();var g=null!==(d=null===(f=c.split(".")[1])||void 0===f?void 0:f.length)&&void 0!==d?d:0;d=Math.pow(10,g);return Number(b.replace(".",""))*Number(c.replace(".",""))/d}},{key:"divide",value:function(b,c){var d,f,g,h;var k=Math.pow(10,Math.max(null!==(d=null===(f=b.toString().split(".")[1])||void 0===f?void 0:f.length)&&void 0!==d?d:0,null!==(g=null===(h=c.toString().split(".")[1])||
void 0===h?void 0:h.length)&&void 0!==g?g:0));return b*k/(c*k)}},{key:"getMedian",value:function(b){b=b.map(function(d){return d}).sort(function(d,f){return d-f});if(1===b.length%2){var c=window.parseInt(b.length/2);b=b[c]}else c=window.parseInt(b.length/2),b=(b[c-1]+b[c])/2;return b}},{key:"getMode",value:function(b){var c,d;var f=0;var g=[];var h=new Map;b.forEach(function(k){var l;d=null!==(l=h.get(k))&&void 0!==l?l:0;h.set(k,d+1)});f=(c=Math).max.apply(c,P(h.values()));h.forEach(function(k,l){k===
f&&g.push(l)});return g}},{key:"isFloat",value:function(b){var c;if(window.isNaN(c=window.parseFloat(b))||Math.floor(c)==c)return!1;if(b.endsWith("%")){if(100<c)return!1}else if(b.endsWith("\u2030")){if(1E3<c)return!1}else return!1;return!0}},{key:"getMinLegalSize",value:function(b,c){var d=[];var f=b[0]/b[1];var g=1>f?0:1;var h=Number(!g);b[g]<c[g]?(d[g]=c[g],d[h]=0===g?c[g]/f:c[g]*f):d=b;return d}},{key:"getMaxLegalSize",value:function(b,c){if(!b||!c||b[0]<=c[0]&&b[1]<=c[1])return b;var d=[];var f=
b[0]/b[1];var g=1<=c[0]/c[1]?1:0;var h=Number(!g);b[g]>c[g]?(d[g]=c[g],d[h]=0===g?c[g]/f:c[g]*f):d=b;return d}},{key:"intervalJudgment",value:function(b,c){c=c.replace(/ /g,"").toLowerCase();var d={"(":">",")":"<","[":">=","]":"<="};var f=c[0];var g=c.slice(-1);var h=Object.keys(d);c=c.slice(1,-1).split(",");c[0]=Number(c[0]);c[1]=Number(c[1]);return h.includes(f)||h.includes(g)?(new Function('"use strict"; return '+(b+d[f]+c[0]+"&&"+b+d[g]+c[1])))():!1}},{key:"insideRect",value:function(b,c){var d=
c[0];c=c[1];return b[0]<d[0]||b[1]<d[1]||b[0]>c[0]||b[1]>c[1]?!1:!0}}]);return e}();window.math&&(Z=Object.assign(Z,window.math));Object.defineProperty(S._assistant,"number",{value:Z});
var Ea=function(){function e(){I(this,e)}J(e,null,[{key:"base64Encode",value:function(b){return window.btoa(window.unescape(window.encodeURIComponent(b)))}},{key:"base64Decode",value:function(b){return window.decodeURIComponent(window.escape(window.atob(b)))}},{key:"ucfirst",value:function(b){return b[0].toUpperCase()+b.substring(1)}},{key:"replace",value:function(b,c,d){var f,g,h,k,l,m=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,p,t;c=Array.isArray(c)?c:[c];d=Array.isArray(d)?d:[d];
Array.isArray(b)?p=!0:(b=[b],p=!1);if(1<d.length&&c.length!==d.length)throw Error("The number of search strings does not match the number of replacement strings.");var q=[];for(l=0;l<b.length;l++){q[l]="";var v=b[l];for(t=f=h=k=0;h<c.length;h++,k+=1<d.length?1:0){var w=[];var r=c[h];var x=d[k];for(g=0;0<=g&&(0===m||0<m&&t<m);)g=v.indexOf(r,0===g&&0===t?0:g+1),t+=0<=g?1:0,w.push(g);-1!==w[w.length-1]&&w.push(-1);for(var z=0;0<w.length;z++)g=w.shift(),q[l]+=0<=g?v.substring(f,g)+x:v.substring(f),f=
g+r.length;f=0;v=q[l];q[l]=""}q[l]=v}return p?q:q.shift()}},{key:"colorConvert",value:function(b){b=b.toLowerCase();var c=Error("Not a legal color.");if(0===b.indexOf("#")){var d="rgba(";b=b.substring(1);3===b.length&&(b=b.split("").reduce(function(g,h){return g+h+h},""));if(6===b.length)for(c=0;3>c;c++)d+=Number("0x"+b[2*c]+b[2*c+1])+", ";else throw c;d+="255)"}else if(0===b.indexOf("rgb")){d="#";b=b.replace(/(rgb\(|rgba\(|\)| )/g,"").split(",");for(var f=0;3>f;f++)c=Number(b[f]).toString(16),d+=
1===c.length?c+c:c}else throw c;return d}}]);return e}();Object.defineProperty(S._assistant,"string",{value:Ea});
var Fa=function(){function e(){I(this,e)}J(e,null,[{key:"isOverflow",value:function(b,c){b=b.getBoundingClientRect();c=c?c.getBoundingClientRect():{x:0,y:0,width:window.innerWidth,height:window.innerHeight};return b.x<c.x||b.x+b.width>c.x+c.width||b.y<c.y||b.y+b.height>c.y+c.height?!0:!1}},{key:"getAllElement",value:function(b){var c=[];b=b.children;if(0!==b.length)for(var d=0;d<b.length;d++)c.push(b[d]),c=c.concat(e.getAllElement(b[d]));return c}},{key:"getNodeHeight",value:function(b){return b.offsetTop+
b.offsetHeight+parseInt(getComputedStyle(b,null).marginBottom)}},{key:"getBeforeElementHeight",value:function(b){var c;for(c=0;(b=b.previousElementSibling)&&!["absolute","fixed"].includes(getComputedStyle(b,null).position);)c+=b.offsetHeight;return c}},{key:"getNodeOriginalSize",value:function(b){var c=[0,0];e.getAllElement(b).forEach(function(d){"absolute"!=getComputedStyle(d,null).position&&(c[0]=d.offsetWidth>c[0]?d.offsetWidth:c[0],d.parentNode===b&&(c[1]+=d.offsetHeight))});return c}},{key:"maxZIndex",
value:function(){var b=Array.from(document.all);return parseInt(b.reduce(function(c,d){d=getComputedStyle(d,null).zIndex;return Math.max(c,isNaN(d)?0:d)},0))}},{key:"objectToNode",value:function(b){var c={},d;for(d in b){var f=document.createElement(b[d].nodeType);if("undefined"!=typeof b[d].nodeType){for(var g in b[d])if("nodeType"!=g)if("innerhtml"==g.toLocaleLowerCase()){var h=e.objectToNode(b[d][g]),k;for(k in h)f.insertAdjacentElement("beforeend",h[k])}else"innertext"==g.toLocaleLowerCase()?
f.insertAdjacentText("beforeend",b[d][g]):f.setAttribute(g,b[d][g]);c[d]=f}}return c}},{key:"launchFullscreen",value:function(b){return b.requestFullscreen(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{navigationUI:"show"})}},{key:"exitFullscreen",value:function(){document.exitFullscreen()}},{key:"getFullscreenNode",value:function(){return document.fullscreenElement}},{key:"createScript",value:function(b){var c=document.createElement("script");"src type async defer charset innerHTML".split(" ").forEach(function(d){b[d]&&
(c[d]=b[d])});return c}}]);return e}();Object.defineProperty(S._assistant,"element",{value:Fa});
var Ga=function(){function e(){I(this,e)}J(e,null,[{key:"getDistribution",value:function(b,c){var d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:2,f,g;if(1===d&&Array.isArray(b))throw Error("One-dimensional operation position value cannot be an array");if(2===d&&!Array.isArray(b))throw Error("Two-dimensional operation position value must be an array");(g=Y.get("gaussian",e))||(g=new Map,Y.set("gaussian",g,e));(f=g.get(c))||(f=Object.create(null),f.square=c*c,f.multiplier=[1/(c*Math.sqrt(2*
Math.PI)),1/(2*Math.PI*f.square)],g.set(c,f));switch(d){case 1:var h=Math.exp(-(b*b)/(2*f.square));break;case 2:h=Math.exp(-(Math.pow(b[0],2)+Math.pow(b[1],2))/(2*f.square))}return f.multiplier[d-1]*h}}]);return e}();Object.defineProperty(S._assistant,"formula",{value:Ga});
var Ha=function(){function e(){I(this,e)}J(e,null,[{key:"getStorage",value:function(b){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];if(!e._achieve[b])throw Error("The specified storage ".concat(b," was not found."));return ua(e._achieve[b],P(c))}}]);return e}();O(Ha,"_achieve",Object.create(null));Object.defineProperty(S._assistant,"storage",{value:Ha});
var Ia=function(){function e(){I(this,e)}J(e,null,[{key:"drawText",value:function(b,c){c=X.o(c,{text:null,fill:!0,color:"black",direction:"ltr",textAlign:"center",textBaseline:"middle",font:"normal 16px Microsoft YaHei, serif",point:[b.canvas.width/2,b.canvas.height/2]});c.text&&(b.save(),b.font=c.font,b.fillStyle=c.color,b.direction=c.direction,b.textAlign=c.textAlign,b.textBaseline=c.textBaseline,c.point[1]+=b.measureText(c.text).G/2,!0===c.fill?b.fillText.apply(b,[c.text].concat(P(c.point),[c.maxWidth])):
b.strokeText.apply(b,[c.text].concat(P(c.point),[c.maxWidth])),b.restore())}},{key:"drawRound",value:function(b,c){c=X.o(c,{step:[],radius:5,fill:!0,borderWidth:5,borderColor:"black",fillColor:"transparent",point:[b.canvas.width/2,b.canvas.height/2]});b.save();b.fillStyle=c.fillColor;b.lineWidth=c.borderWidth;b.strokeStyle=c.borderColor;b.beginPath();b.setLineDash(c.step);b.arc.apply(b,P(c.point).concat([c.radius,0,2*Math.PI]));b.stroke();!0===c.fill&&b.fill();b.restore()}},{key:"drawRect",value:function(b){var c=
1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,f=3<arguments.length?arguments[3]:void 0,g=4<arguments.length?arguments[4]:void 0,h=5<arguments.length&&void 0!==arguments[5]?arguments[5]:1,k=6<arguments.length&&void 0!==arguments[6]?arguments[6]:"white",l=7<arguments.length&&void 0!==arguments[7]?arguments[7]:!1;b.save();b.lineWidth=h;Array.isArray(l)?(b.strokeStyle=k,b.setLineDash(l),b.strokeRect(c,d,f,g)):(b.fillStyle=k,b.fillRect(c,
d,f,g));b.restore()}},{key:"drawLBorder",value:function(b){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,f=3<arguments.length?arguments[3]:void 0,g=4<arguments.length?arguments[4]:void 0,h=5<arguments.length&&void 0!==arguments[5]?arguments[5]:25,k=6<arguments.length&&void 0!==arguments[6]?arguments[6]:5,l=7<arguments.length&&void 0!==arguments[7]?arguments[7]:"#0eb0f1",m=8<arguments.length&&void 0!==arguments[8]?arguments[8]:
!1;b.save();Array.isArray(m)?b.strokeStyle=l:(b.fillStyle=l,b.fillRect(c,d,h,k),b.fillRect(c,d,k,h),b.fillRect(c+f,d,-h,k),b.fillRect(c+f,d,-k,h),b.fillRect(c+f,d+g,-h,-k),b.fillRect(c+f,d+g,-k,-h),b.fillRect(c,d+g,h,-k),b.fillRect(c,d+g,k,-h));b.restore()}},{key:"drawGrid",value:function(b){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,f=3<arguments.length?arguments[3]:void 0,g=4<arguments.length?arguments[4]:void 0,h=5<
arguments.length&&void 0!==arguments[5]?arguments[5]:1,k=6<arguments.length&&void 0!==arguments[6]?arguments[6]:"black",l=7<arguments.length&&void 0!==arguments[7]?arguments[7]:"quarter",m=8<arguments.length&&void 0!==arguments[8]?arguments[8]:!1;if(e["drawGrid"+Ea.ucfirst(l)]instanceof Function)e["drawGrid"+Ea.ucfirst(l)](b,c,d,null!==f&&void 0!==f?f:b.canvas.width,null!==g&&void 0!==g?g:b.canvas.height,h,k,m);else throw Error(l+" grid not detected");}},{key:"drawGridQuarter",value:function(b){var c=
1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,f=3<arguments.length?arguments[3]:void 0,g=4<arguments.length?arguments[4]:void 0,h=5<arguments.length&&void 0!==arguments[5]?arguments[5]:1,k=6<arguments.length&&void 0!==arguments[6]?arguments[6]:"black",l=7<arguments.length&&void 0!==arguments[7]?arguments[7]:!1;var m=[Z.divide(f,4),Z.divide(g,4)];b.save();b.beginPath();b.lineWidth=h;b.strokeStyle=k;Array.isArray(l)&&b.setLineDash(l);
for(h=1;4>h;h++)b.moveTo(m[0]*h+c,d),b.lineTo(m[0]*h+c,d+g),b.moveTo(c,m[1]*h+d),b.lineTo(c+f,m[1]*h+d);b.stroke();b.restore()}},{key:"layerMerge",value:function(b,c,d,f,g){var h=5<arguments.length&&void 0!==arguments[5]?arguments[5]:"source-over",k;(k=Y.get("mergeCas",e))||(k=new OffscreenCanvas(b.canvas.width,b.canvas.height),Y.set("mergeCas",k,e));var l=k.getContext("2d");l.save();l.drawImage.apply(l,[c].concat(P(d)));l.globalCompositeOperation=h;l.drawImage.apply(l,[f].concat(P(g)));b.clearRect(0,
0,b.canvas.width,b.canvas.height);b.drawImage(k,0,0);l.restore();l.clearRect(0,0,k.width,k.height)}},{key:"download",value:function(b){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"canvas",d=2<arguments.length?arguments[2]:void 0;if(Y.has("downloadNode",e))var f=Y.get("downloadNode",e);else f=document.createElement("a"),Y.set("downloadNode",f,e);f.download=c;f.href=b.toDataURL(d);f.click()}}]);return e}();Object.defineProperty(S._assistant,"canvas",{value:Ia});
var Ja=function(){function e(){I(this,e)}J(e,null,[{key:"getImagedata",value:function(b){if(b instanceof Image){var c=document.createElement("canvas");var d=c.getContext("2d");d.drawImage(b,0,0);b=d.getImageData(0,0,c.width,c.height)}else if(!(b instanceof ImageData))throw Error("can not parse image");return b}},{key:"grayscale",value:function(b){try{var c=e.getImagedata(b);var d=c.width*c.height*4;var f=new Uint8ClampedArray(c.data.length);for(b=0;b<d;b+=4){var g=c.data[b];var h=c.data[b+1];var k=
c.data[b+2];var l=c.data[b+3];var m=.299*g+.587*h+.114*k;f[b]=m;f[b+1]=m;f[b+2]=m;f[b+3]=l}}catch(p){throw p;}return new ImageData(f,c.width,c.height)}},{key:"gaussianBlur",value:function(b){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:3,d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,f,g,h,k,l,m,p;try{var t=e.getImagedata(b);var q=t.width;var v=t.height;var w=0;(g=Y.get("gaussianMask",e))||(g=new Map,Y.set("gaussianMask",g,e));if(!(f=g.get("".concat(c,",").concat(d)))){f=
[];for(p=-c;p<=c;p++){var r=Ga.getDistribution(p,d,1);f.push(r);w+=r}for(r=0;r<f.length;r++)f[r]/=w;g.set("".concat(c,",").concat(d),f)}var x=new Uint8ClampedArray(t.data.length);for(m=0;m<v;m++)for(l=0;l<q;l++){var z=h=k=w=0;var u=4*(m*q+l);for(d=-c;d<=c;d++){var L=l+d;p=d+c;if(0<=L&&L<q){var K=4*(m*q+L);z+=t.data[K]*f[p];h+=t.data[K+1]*f[p];k+=t.data[K+2]*f[p];w+=f[p]}}x[u]=z/w;x[u+1]=h/w;x[u+2]=k/w;x[u+3]=t.data[u+3]}for(l=0;l<q;l++)for(m=0;m<v;m++){z=h=k=w=0;u=4*(m*q+l);for(t=-c;t<=c;t++)L=m+
t,p=t+c,0<=L&&L<v&&(K=4*(L*q+l),z+=x[K]*f[p],h+=x[K+1]*f[p],k+=x[K+2]*f[p],w+=f[p]);x[u]=z/w;x[u+1]=h/w;x[u+2]=k/w}}catch(W){throw W;}return new ImageData(x,q,v)}},{key:"mirror",value:function(b){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,d,f;try{var g=e.getImagedata(b);var h=g.width;var k=g.height;var l=new Uint8ClampedArray(g.data.length);for(f=0;f<k;f++)for(d=0;d<h;d++){var m=4*(f*h+d);if(0==c)var p=4*(f*h+h-d);else if(1==c)p=4*((k-f)*h+d);else throw Error("not give axis");
l[m]=g.data[p];l[m+1]=g.data[p+1];l[m+2]=g.data[p+2];l[m+3]=g.data[p+3];l[p]=g.data[m];l[p+1]=g.data[m+1];l[p+2]=g.data[m+2];l[p+3]=g.data[m+3]}}catch(t){throw t;}return new ImageData(l,h,k)}}]);return e}();O(Ja,"__gaussianMask",{});Object.defineProperty(S._assistant,"canvasFilter",{value:Ja});
var Ka=function(){function e(){I(this,e)}J(e,null,[{key:"loadFailedFade",value:function(b,c){var d,f,g,h;if(!(b instanceof CanvasRenderingContext2D))throw Error('Requires a value of type "CanvasRenderingContext2D"');X.isEmpty(c)&&(c=Object.create(null));var k="animation-loadFailedFade-"+Date.now()+"-"+performance.now()+(c.sign?"-"+c.sign:"");c=X.o(c,{duration:4,speed:null,icon:{size:72,"char":["!","?"],color:"rgba(220, 53, 69)",font:"bold 72px Microsoft YaHei, serif"},text:{size:16,color:"black",
text:"Load Failed",font:"normal 16px Microsoft YaHei, serif"},round:{step:[5],radius:48,fill:!1,borderWidth:5,fillColor:"#ddd",borderColor:"#ddd"}});var l=JSON.stringify(c.icon);var m=JSON.stringify(c.text);var p=JSON.stringify(c.round);c.speed=null!==(d=c.speed)&&void 0!==d?d:c.duration/(2*c.icon["char"].length);(d=Y.get("loadFailedFade",e))||(d=new Map,Y.set("loadFailedFade",d,e));if(!(g=d.get(l))){g=[];for(var t=0;t<c.icon["char"].length;t++){g[t]=new OffscreenCanvas(c.icon.size,c.icon.size);var q=
g[t].getContext("2d");c.icon.text=c.icon["char"][t];Ia.drawText(q,c.icon)}d.set(l,g)}(h=d.get(m))||(h=new OffscreenCanvas(c.text.size*c.text.text.length,2*c.text.size),l=h.getContext("2d"),Ia.drawText(l,c.text),d.set(m,h));(m=d.get(p))||(m=l=2*(c.round.radius+c.round.borderWidth),m=new OffscreenCanvas(m,l),l=m.getContext("2d"),Ia.drawRound(l,c.round),d.set(p,m));var v=1;var w=f=0;var r=[b.canvas.width/2,b.canvas.height/2];d=[m.width/2,(m.height+h.height)/2];p=[h.width/2,(m.height-h.height)/2];var x=
1/(c.duration/g.length/2*1E3/(1E3/60));var z=function(){var u=x*v,L=Number(b.canvas.getAttribute(k)),K=[g[w].width/2,(g[w].height+h.height)/2];void 0!==L&&0!==L&&(b.clearRect(r[0]-K[0],r[1]-K[1],g[w].width,g[w].height),1<f+u?(f=1,v=-v):0>f+u?(f=0,v=-v,w=w+1<g.length?w+1:0):f+=u,b.globalAlpha=f,b.drawImage(g[w],r[0]-K[0],r[1]-K[1]),window.requestAnimationFrame(z))};b.globalAlpha=1;b.drawImage(m,r[0]-d[0],r[1]-d[1]);b.drawImage(h,r[0]-p[0],r[1]+p[1]);b.canvas.setAttribute(k,1);window.requestAnimationFrame(z);
return k}}]);return e}();Object.defineProperty(S._assistant,"canvasAnimation",{value:Ka});
var La=function(e){function b(){I(this,b);return c.apply(this,arguments)}G(b,e);var c=H(b);J(b,[{key:"initOption",value:function(d){E(F(b.prototype),"initOption",this).call(this,d);this.option.layer=S._assistant.object.merge(this.option.layer,S._option.page)}},{key:"linkageOption",value:function(){E(F(b.prototype),"linkageOption",this).call(this);null!==this.option.layer.src&&null!==this.option.layer.srcdoc&&(this.option.layer.srcdoc=null)}},{key:"initStruct",value:function(){E(F(b.prototype),"initStruct",
this).call(this);var d=this.variable.struct._build.container;var f=this.variable.struct._backup.title=S._struct.title;var g=this.variable.struct._backup.action=S._struct.action;var h=this.variable.struct._backup.content=S._struct.content;var k=this.variable.struct._backup.content_page=S._struct.content_page;var l=this.variable.struct._backup.action_button=S._struct.action_button;g.innerHTML.push(l.minimize,l.expand,l.close);f.innerHTML.push(g);!1!==this.option.title&&d.innerHTML.push(f);h.innerHTML.push(k);
d.innerHTML.push(h);this.option.resize.enable&&(k=this.variable.struct._backup.resize_box=S._struct.resize_box,d.innerHTML.push(k));this.option.progress.enable&&(k=this.variable.struct._backup.progress_bar=S._struct.progress_bar,d.innerHTML.push(k))}},{key:"initNode",value:function(){var d=this;E(F(b.prototype),"initNode",this).call(this);var f=this.variable.nodes.container.querySelector(".modal-layer-page-content");var g="display: block; width: "+this.option.layer.area[0]+"px; height: "+this.option.layer.area[1]+
"px";Object.keys(this.option.layer).forEach(function(k){S._assistant.object.isEmpty(d.option.layer[k])||("name"===k?f.setAttribute("name",d.option.layer.name+d.option.index):f.setAttribute(k,d.option.layer[k]))});f.style=g;this.variable.animationName.minimize_queue_transition_scale="transition-scale-50-50-animation";if(!S._assistant.css.hasCss("transition-scale-50-50-animation")){var h={from:"transform: scale(0.5, 0.5)",to:"transform: scale(1, 1)"};g=S._assistant.css.createAnimation("transition-scale-50-50-animation",
h);S._assistant.css.addCss("transition-scale-50-50-animation",g);S._assistant.css.addCss("transition-scale-50-50-animation-reverse",S._assistant.css.createAnimation("transition-scale-50-50-animation-reverse",{from:h.to,to:h.from}))}}},{key:"resize",value:function(){var d=0;var f=this.variable.nodes.container;var g=f.children;var h=f.querySelector("iframe[name="+this.option.layer.name+this.option.index+"]");h=h.offsetWidth+2*h.parentNode.offsetLeft;for(var k=0;k<g.length;k++)d="absolute"==getComputedStyle(g[k],
null).position?d:Math.max(S._assistant.element.getNodeHeight(g[k]),d);f.style.width=h+"px";f.style.height=d+"px";this.variable.defaultArea=[h,d]}}]);return b}(S);S._achieve.set("page",La);
var Ma=function(e){function b(){I(this,b);return c.apply(this,arguments)}G(b,e);var c=H(b);J(b,[{key:"initStruct",value:function(){E(F(b.prototype),"initStruct",this).call(this);var d=this.variable.struct._build.container;var f=this.variable.struct._backup.title=S._struct.title;var g=this.variable.struct._backup.action=S._struct.action;var h=this.variable.struct._backup.content=S._struct.content;var k=this.variable.struct._backup.interaction=S._struct.interaction;var l=this.variable.struct._backup.action_button=
S._struct.action_button;var m=this.variable.struct._backup.interaction_button=S._struct.interaction_button;g.innerHTML.push(l.close);f.innerHTML.push(g);!1!==this.option.title&&d.innerHTML.push(f);d.innerHTML.push(h);this.option.resize.enable&&(g=this.variable.struct._backup.resize_box=S._struct.resize_box,d.innerHTML.push(g));this.option.progress.enable&&(g=this.variable.struct._backup.progress_bar=S._struct.progress_bar,d.innerHTML.push(g));k.innerHTML.push(m.ok);d.innerHTML.push(k)}},{key:"initNode",
value:function(){E(F(b.prototype),"initNode",this).call(this);var d=this.variable.nodes.container.querySelector(".modal-layer-content");if(Array.isArray(this.option.content.value)){var f=S._assistant.element.objectToNode(this.option.content.value);Object.keys(f).forEach(function(g){d.appendChild(f[g])})}else d.innerHTML=this.option.content.value}}]);return b}(S);S._achieve.set("alert",Ma);
var Oa=function(e){function b(){I(this,b);return c.apply(this,arguments)}G(b,e);var c=H(b);J(b,[{key:"initOption",value:function(d){var f=this,g;E(F(b.prototype),"initOption",this).call(this,d);this.option.layer=S._assistant.object.merge(this.option.layer,S._option.image);var h=[window.innerWidth,window.innerHeight];Object.values(this.option.layer.sizeRange).forEach(function(k){k.forEach(function(l,m){if((""+l).endsWith("%"))g=100;else if((""+l).endsWith("\u2030"))g=1E3;else if((""+l).includes("0."))g=
1;else return l;k[m]=h[m]*window.parseFloat(l)/g})});this.option.layer.sizeRange.min[0]>this.option.layer.sizeRange.max[0]&&(this.option.layer.sizeRange.min[0]=this.option.layer.sizeRange.max[0]);this.option.layer.sizeRange.min[1]>this.option.layer.sizeRange.max[1]&&(this.option.layer.sizeRange.min[1]=this.option.layer.sizeRange.max[1]);Object.keys(this.option.layer.toolbar.config).forEach(function(k,l){l=f.option.layer.toolbar.config[k];"boolean"==typeof l&&(f.option.layer.toolbar.config[k]={enable:l,
title:S._option.image.toolbar.config[k].title,icon:S._option.image.toolbar.config[k].icon});S._assistant.object.isOnlyObject(l.config)?Object.keys(l.config).forEach(function(m,p){p=l.config[m];"boolean"==typeof p&&(f.option.layer.toolbar.config[k].config[m]={enable:p,title:S._option.image.toolbar.config[k].config[m].title,icon:S._option.image.toolbar.config[k].config[m].icon})}):S._option.image.toolbar.config[k].config&&(f.option.layer.toolbar.config[k].config=JSON.parse(JSON.stringify(S._option.image.toolbar.config[k].config)))})}},
{key:"compatibleOption",value:function(d){var f,g;E(F(b.prototype),"compatibleOption",this).call(this,d);var h=S._assistant.object.get(d,"layer.image");h instanceof FileList&&(d.layer.image=Object.values(h));Array.isArray(d.layer.image)||(d.layer.image=[d.layer.image]);var k=null!==(f=S._assistant.object.get(d,"layer.toolbar.config"))&&void 0!==f?f:[];Object.keys(k).forEach(function(m){k[m]="boolean"===typeof k[m]?{enable:k[m]}:k[m]});var l=null!==(g=S._assistant.object.get(d,"layer.toolbar.config.filter.config"))&&
void 0!==g?g:[];Object.keys(l).forEach(function(m){l[m]="boolean"===typeof l[m]?{enable:l[m]}:l[m]})}},{key:"linkageOption",value:function(){var d;E(F(b.prototype),"linkageOption",this).call(this);var f=d=!1;var g=Object.entries(this.option.layer.toolbar.config);var h=Object.entries(this.option.layer.toolbar.config.filter.config);for(var k=0;k<h.length;k++)if(!0===h[k][1].enable){d=!0;break}this.option.layer.toolbar.config.filter.enable=d;for(d=0;d<g.length;d++)if(!0===g[d][1].enable){f=!0;break}this.option.layer.toolbar.enable=
f;!1===this.option.layer.toolbar.config.crop.enable&&(this.option.layer.toolbar.config.crop.grid=!1)}},{key:"checkOption",value:function(){E(F(b.prototype),"checkOption",this).call(this);if(S._assistant.object.isEmpty(this.option.layer.image))throw Error("layer.image can not be empty!");if(this.option.layer.size&&!Array.isArray(this.option.layer.size))throw Error("layer.size does not meet expectations.");if(!this.option.layer.size&&(window.isNaN(parseInt(this.option.layer.sizeRange.min[0]))||window.isNaN(parseInt(this.option.layer.sizeRange.min[1]))||
window.isNaN(parseInt(this.option.layer.sizeRange.max[0]))||window.isNaN(parseInt(this.option.layer.sizeRange.max[1]))))throw Error("layer.sizeRange does not meet expectations.");}},{key:"initVariable",value:function(){E(F(b.prototype),"initVariable",this).call(this);this.variable.image={spin:{scale:1,angle:90},"default":{size:null,imageData:null},reload:0,link:null,history:[],finish:null,status:S._enum.LOAD_STATUS.LOADING}}},{key:"initStruct",value:function(){var d=this;E(F(b.prototype),"initStruct",
this).call(this);var f=this.variable.struct._build.container;var g=this.variable.struct._backup.title=S._struct.title;var h=this.variable.struct._backup.action=S._struct.action;var k=this.variable.struct._backup.toolbar=S._struct.toolbar;var l=this.variable.struct._backup.tools=S._struct.image_tools;var m=this.variable.struct._backup.content=S._struct.content;var p=this.variable.struct._backup.action_button=S._struct.action_button;var t=this.variable.struct._backup.content_image=S._struct.content_image;
var q=this.variable.struct._backup.image_tools_child=S._struct.image_tools_child;h.innerHTML.push(p.close);g.innerHTML.push(h);!1!==this.option.title&&f.innerHTML.push(g);Object.keys(this.option.layer.toolbar.config).forEach(function(v){d.option.layer.toolbar.config[v].enable&&k.innerHTML.push(l[v]);d.option.layer.toolbar.config[v].config instanceof Object&&d.option.layer.toolbar.config[v].enable&&Object.keys(d.option.layer.toolbar.config[v].config).forEach(function(w){l[v].innerHTML[1].innerHTML.push(q[v][w])})});
this.option.layer.toolbar.enable&&f.innerHTML.push(k);m.innerHTML.push(t);f.innerHTML.push(m);this.option.resize.enable&&(h=this.variable.struct._backup.resize_box=S._struct.resize_box,f.innerHTML.push(h));this.option.progress.enable&&(h=this.variable.struct._backup.progress_bar=S._struct.progress_bar,f.innerHTML.push(h))}},{key:"initNode",value:function(){var d=this;E(F(b.prototype),"initNode",this).call(this);var f=this.variable.nodes.container.querySelector(".modal-layer-toolbar");this.option.layer.toolbar.enable&&
Object.keys(this.option.layer.toolbar.config).forEach(function(g,h){h=d.option.layer.toolbar.config[g];if(h.enable){var k;var l=f.querySelector('.modal-layer-toolbar-item[tool-type="'+g+'"]');var m=l.querySelector(".modal-layer-toolbar-item-icon");l.setAttribute("title",h.title);(k=m.classList).add.apply(k,P(h.icon.split(" ")));h.config instanceof Object&&Object.entries(h.config).forEach(function(p,t){t=p[0];p=p[1];if(p.enable){var q=l.querySelector(".modal-layer-toolbar-item-child-list");t=l.querySelector(".modal-layer-toolbar-"+
g+"-icon["+g+'-type="'+t+'"]');q.setAttribute("title",p.title);p.icon?t.classList.add(p.icon):t.innerText=p.textIcon}})}});this.variable.image.finish=this.load().then(function(g){return d.loaded(g)})["catch"](function(){return d.failed()})}},{key:"bindEvent",value:function(){var d=this;E(F(b.prototype),"bindEvent",this).call(this);var f={once:!1,capture:!1,passive:!1,mozSystemGroup:!1};var g=this.variable.nodes.container;var h=S._assistant.object.getKeyByValue(S._enum.LOAD_STATUS,S._enum.LOAD_STATUS.FAILED);
this.variable.eventSymbol.imageReload=S._assistant.event.add(g,"click",'.modal-layer-image-canvas[load-status="'+h+'"]',this.reload,this,null,f);Object.keys(this.event.imageTools).forEach(function(k){d.event.imageTools[k]&&d.event.imageTools[k]instanceof Function&&(d.variable.eventSymbol["imageTool".concat(k)]=S._assistant.event.add(g,"click",'.modal-layer-toolbar-item[tool-type="'.concat(k,'"]'),d.event.imageTools[k],d,null,f))})}},{key:"resize",value:function(){var d;var f=this.variable.nodes.container;
var g=f.querySelector(".modal-layer-content");var h=g.querySelector(".modal-layer-image-canvas").getBoundingClientRect();var k=f.querySelector(".modal-layer-toolbar");var l=k.getBoundingClientRect().height;var m=window.getComputedStyle(g,null);var p=S._assistant.element.getBeforeElementHeight(g);g=g.offsetTop-p;p+=this.option.content.fullContainer?0:2*g;this.option.layer.size?d=P(this.option.layer.size):this.variable.image.status!==S._enum.LOAD_STATUS.LOADING?d=[h.width,h.height]:d=P(this.option.layer.sizeRange.min);
d[0]+=parseFloat(m.marginLeft)+parseFloat(m.marginRight);d[1]+=p;f.style.width=d[0]+"px";this.option.layer.toolbar.enable&&(h=k.getBoundingClientRect().height,d[1]=d[1]-l+h);f.style.height=d[1]+"px";this.variable.defaultArea=d;!this.option.drag.overflow&&S._assistant.element.isOverflow(f,this.option.window)&&(f.style.cssText+="margin-top: auto; margin-left: auto")}},{key:"load",value:function(){var d=this,f=this.variable.nodes.container.querySelector(".modal-layer-image-canvas");this.variable.image.status=
S._enum.LOAD_STATUS.LOADING;f.setAttribute("load-status",S._assistant.object.getKeyByValue(S._enum.LOAD_STATUS,S._enum.LOAD_STATUS.LOADING));this.variable.image.fadeAttr&&f.removeAttribute(this.variable.image.fadeAttr);this.variable.image.layer instanceof Na?this.variable.image.layer.show():this.variable.image.layer=S.loading({mask:!1,popupTime:0,layer:{icon:1,duration:1,color:"deepskyblue"},window:this.variable.nodes.container},function(g){throw g;});return this.variable.image.finish=new Promise(function(g,
h){for(var k=new Image;!d.variable.image.link&&d.variable.image.reload<d.option.layer.image.length;){var l;(null===(l=d.variable.image.link)||void 0===l?0:l.startsWith("blob:"))&&URL.revokeObjectURL(d.variable.image.link);d.variable.image.link=S._assistant.file.getImage(d.option.layer.image[d.variable.image.reload++])}k.onload=function(){return g(k)};k.onerror=h;k.src=d.variable.image.link})}},{key:"reload",value:function(){var d=this;this.variable.image.finish=this.load().then(function(f){return d.loaded(f)})["catch"](function(){return d.failed()})["finally"](function(){return d.resize()})}},
{key:"loaded",value:function(d){var f=this;var g=this.variable.nodes.container.querySelector(".modal-layer-image-canvas");this.variable.image.status=S._enum.LOAD_STATUS.LOADED;this.variable.image["default"].size=this.option.layer.size?this.option.layer.size:d.naturalWidth>this.option.layer.sizeRange.max[0]||d.naturalHeight>this.option.layer.sizeRange.max[1]?S._assistant.number.getMaxLegalSize([d.naturalWidth,d.naturalHeight],this.option.layer.sizeRange.max):d.naturalWidth<this.option.layer.sizeRange.min[0]||
d.naturalHeight<this.option.layer.sizeRange.min[1]?S._assistant.number.getMinLegalSize([d.naturalWidth,d.naturalHeight],this.option.layer.sizeRange.min):[d.naturalWidth,d.naturalHeight];g.width=this.variable.image["default"].size[0];g.height=this.variable.image["default"].size[1];g.setAttribute("load-status",S._assistant.object.getKeyByValue(S._enum.LOAD_STATUS,S._enum.LOAD_STATUS.LOADED));window.requestAnimationFrame(function(){var h,k;f.variable.image.layer&&f.variable.image.layer instanceof Na&&
f.variable.image.layer.hide();(h=g.getContext("2d")).drawImage.apply(h,[d,0,0,d.width,d.height,0,0].concat(P(f.variable.image["default"].size)));f.variable.image["default"].imageData=(k=g.getContext("2d")).getImageData.apply(k,[0,0].concat(P(f.variable.image["default"].size)))})}},{key:"failed",value:function(){var d,f;var g=this.variable.nodes.container.querySelector(".modal-layer-image-canvas");this.variable.image.status=S._enum.LOAD_STATUS.FAILED;g.setAttribute("load-status",S._assistant.object.getKeyByValue(S._enum.LOAD_STATUS,
S._enum.LOAD_STATUS.FAILED));this.variable.image.reload<this.option.layer.image.length?f={duration:4,sign:"load-failed",icon:{size:72,"char":"!?",color:"rgba(220, 53, 69)",font:"bold 72px Microsoft YaHei, serif"},round:{step:[4],radius:50,borderWidth:5,borderColor:"rgb(230, 230, 230)"},text:{color:"rgba(220, 53, 69)",text:"\u56fe\u7247\u52a0\u8f7d\u5931\u8d25, \u8bf7\u70b9\u51fb\u91cd\u8bd5",font:"lighter 16px Microsoft YaHei, serif"}}:f={duration:4,sign:"finally-load-failed",icon:{size:80,"char":"\u00d7",
font:"bold 80px Microsoft YaHei, serif"},round:{step:[5],radius:50,borderWidth:5,borderColor:"rgb(230, 230, 230)"},text:{color:"rgba(220, 53, 69)",text:"\u56fe\u7247\u52a0\u8f7d\u5931\u8d25, \u8bf7\u8054\u7cfb\u7ba1\u7406\u5458",font:"lighter 16px Microsoft YaHei, serif"}};this.variable.image.fadeAttr=S._assistant.canvasAnimation.loadFailedFade(g.getContext("2d"),f);(null===(d=this.variable.image.link)||void 0===d?0:d.startsWith("blob:"))&&URL.revokeObjectURL(this.variable.image.link);this.variable.image.link=
null;this.variable.image.layer instanceof Na&&this.variable.image.layer.hide()}},{key:"removeAllEvent",value:function(){var d=this,f=this.variable.nodes.container;E(F(b.prototype),"removeAllEvent",this).call(this);Object.keys(this.event.imageTools).forEach(function(g){d.event.imageTools[g]&&d.event.imageTools[g]instanceof Function&&f.removeEventListener("click",d.event.imageTools[g])})}},{key:"crop",value:function(){var d=this,f,g;var h=!0;var k=null;var l=[];var m=S._assistant.number.divide(5,2);
l[2]=S._assistant.number.multiply(5,2);l[4]=S._assistant.number.multiply(5,4);l[6]=S._assistant.number.multiply(5,6);var p=this.variable.nodes.container.querySelector(".modal-layer-image-canvas");var t=p.width;var q=p.height;var v=S._assistant.number.floor(.1*t);var w=S._assistant.number.floor(.1*q);var r=p.cloneNode();var x=r.getContext("2d");r.width=window.innerWidth;r.height=window.innerHeight;r.style="display: block; position: fixed; top: 0px; bottom: 0px; left: 0px; right: 0px; visibility: visible; opacity: 1; border: 0px; margin: 0px; z-index: "+
S._assistant.element.maxZIndex()+";";var z=[S._assistant.number.chain(r.width).subtract(t).divide(2).round().done(),S._assistant.number.chain(r.height).subtract(q).divide(2).round().done()];var u=[].concat(P(z),[t,q]);var L=function(){var y;x.save();x.clearRect(0,0,r.width,r.height);x.fillStyle="rgba(0, 0, 0, 0.4)";x.fillRect(0,0,r.width,r.height);x.globalCompositeOperation="destination-out";x.fillStyle="white";x.fillRect.apply(x,P(u));x.globalCompositeOperation="source-over";(y=S._assistant.canvas).drawGrid.apply(y,
[x].concat(P(u),[2,"white","quarter"]));S._assistant.canvas.drawRect(x,u[0]-m,u[1]-m,u[2]+5,u[3]+5,5,"white",[0]);S._assistant.canvas.drawLBorder(x,u[0]-l[2],u[1]-l[2],u[2]+l[4],u[3]+l[4],l[6],5,"white");x.globalCompositeOperation="destination-over";x.drawImage.apply(x,[p].concat(P(z)));x.restore();h?k=window.requestAnimationFrame(L):window.cancelAnimationFrame(k)};var K=function(){document.removeEventListener("keyup",W);r.removeEventListener("mousemove",Ba);r.removeEventListener("dbclick",ra);h=
!1;r.remove()};var W=function(y){var D;y=null!==(D=y)&&void 0!==D?D:window.event;switch(y.code){case "Enter":ra();y.preventDefault();break;case "Escape":d.show(),K(),y.preventDefault()}};var ra=function(y){var D;K();y=null!==(D=y)&&void 0!==D?D:window.event;y=new OffscreenCanvas(p.width,p.height);y.getContext("2d").drawImage(p,0,0);p.width=u[2];p.height=u[3];p.getContext("2d").drawImage(y,u[0]-z[0],u[1]-z[1],u[2],u[3],0,0,p.width,p.height);d.show().then(function(){return d.resize()})};var Ba=function(y){var D;
y=null!==(D=y)&&void 0!==D?D:window.event;if(f&&1===y.buttons)if("drag"===f)u[0]+y.movementX>z[0]&&u[0]+u[2]+y.movementX<z[0]+t&&(u[0]+=y.movementX),u[1]+y.movementY>z[1]&&u[1]+u[3]+y.movementY<z[1]+q&&(u[1]+=y.movementY);else{if("resize"===f){D=P(u);g.includes(S._enum.POSITION.WEST)&&(u[0]+=y.movementX,u[2]-=y.movementX);g.includes(S._enum.POSITION.EAST)&&(u[2]+=y.movementX);g.includes(S._enum.POSITION.NORTH)&&(u[1]+=y.movementY,u[3]-=y.movementY);g.includes(S._enum.POSITION.SOUTH)&&(u[3]+=y.movementY);
if(u[0]<z[0]||u[0]+u[2]>z[0]+t)u[0]=D[0],u[2]=D[2];if(u[1]<z[1]||u[1]+u[3]>z[1]+q)u[1]=D[1],u[3]=D[3];u[2]<v&&(u[2]=D[2],u[0]+u[2]>z[0]+t&&(u[0]=z[0]+t-u[2]));u[3]<w&&(u[3]=D[3],u[1]+u[3]>z[1]+q&&(u[1]=z[1]+q-u[3]))}}else{y=[y.x,y.y];var M=[u[0]-l[2],u[1]-l[2],u[2]+l[4],u[3]+l[4]];var N=[u[0]-m,u[1]-m,u[2]+5,u[3]+5];y[0]>N[0]&&y[0]<N[0]+N[2]&&y[1]>N[1]&&y[1]<N[1]+N[3]?(D="move",f="drag"):y[0]>M[0]&&y[0]<M[0]+M[2]&&y[1]>M[1]&&y[1]<M[1]+M[3]?(f="resize",D=g="",y[1]>M[1]&&y[1]<N[1]&&(D=g+=S._enum.POSITION.NORTH),
y[1]>N[1]+N[3]&&y[1]<M[1]+M[3]&&(D=g+=S._enum.POSITION.SOUTH),y[0]>M[0]&&y[0]<N[0]&&(D=g+=S._enum.POSITION.WEST),y[0]>N[0]+N[2]&&y[0]<M[0]+M[2]&&(D=g+=S._enum.POSITION.EAST),D+="-resize"):(f=null,D="default");r.style.cssText+="cursor: "+D}};this.hide();L();document.addEventListener("keyup",W);r.addEventListener("mousemove",Ba);r.addEventListener("dblclick",ra);document.body.appendChild(r)}},{key:"spin",value:function(){var d=this,f=0<arguments.length&&void 0!==arguments[0]?arguments[0]:void 0,g,h,
k,l;var m=this.variable.nodes.container.querySelector(".modal-layer-image-canvas");var p=m.getContext("2d");var t=new OffscreenCanvas(m.width,m.height);t.getContext("2d").drawImage(m,0,0,m.width,m.height);this.variable.image.finish.then(function(){var q;f=null!==(q=f)&&void 0!==q?q:d.variable.image.spin.angle;m.style.transform="rotate("+f+"deg)";g=m.getBoundingClientRect();m.style.transform="scale(".concat(d.variable.image.spin.scale,")");d.option.layer.size||d.option.layer.sizeRange.max[0]>=g.width&&
d.option.layer.sizeRange.max[1]>=g.height?k=d.variable.image.spin.scale:(l=S._assistant.number.getMaxLegalSize([g.width,g.height],d.option.layer.sizeRange.max),k=l[0]/g.width);m.width=g.width;m.height=g.height;m.style.transform="scale(".concat(k,")");h=f*Math.PI/180;p.save();p.translate(m.width/2,m.height/2);p.rotate(h);p.drawImage(t,-t.width/2,-t.height/2);p.restore();d.resize()})}},{key:"filter",value:function(d){var f=this,g,h;var k=d.getAttribute("filter-type");var l=this.variable.nodes.container.querySelector(".modal-layer-image-canvas");
if(l.getAttribute("load-status")!=S._enum.LOAD_STATUS.FAILED&&k){var m=l.getContext("2d");var p=m.getImageData(0,0,l.width,l.height);this.variable.image.layer.show();if(S._env.feature.worker){var t="image-layer-worker-"+Date.now();var q="!"+S._worker.get("canvasFilter").toString()+"()";q=URL.createObjectURL(new Blob(q.split(""),{type:"text/javascript"}));S._assistant.worker.has(t)||S._assistant.worker.create(t,q);S._assistant.worker.listener(t).then(function(v){0==v.data.error?m.putImageData(new ImageData(new Uint8ClampedArray(v.data.buffer),
l.width,l.height),0,0):console.error(Error(v.data.message));f.variable.image.layer.hide();S._assistant.worker.close(t)})}null===(g=(h={blur:function(){var v,w;var r=null!==(v=Number(d.getAttribute("data-sigma")))&&void 0!==v?v:1;v=null!==(w=Number(d.getAttribute("data-radius")))&&void 0!==w?w:3;if(S._env.feature.worker){var x;if(S._assistant.canvasFilter.__gaussianMask[["".concat(v,",").concat(r)]])var z=S._assistant.canvasFilter.__gaussianMask[["".concat(v,",").concat(r)]];else{w=0;z=[];for(x=-v;x<=
v;x++){var u=S._assistant.formula.getDistribution(x,r,1);z.push(u);w+=u}for(x=0;x<z.length;x++)z[x]/=w;S._assistant.canvasFilter.__gaussianMask[["".concat(v,",").concat(r)]]=z}S._assistant.worker.get(t).postMessage({sigma:r,radius:v,type:k,gaussianMask:z,buffer:p.data.buffer,size:[l.width,l.height]},[p.data.buffer])}else p=S._assistant.canvasFilter.gaussianBlur(p,v,r),m.putImageData(p,0,0),f.variable.image.layer.hide()},gray:function(){S._env.feature.worker?S._assistant.worker.get(t).postMessage({type:k,
buffer:p.data.buffer},[p.data.buffer]):(p=S._assistant.canvasFilter.grayscale(m.getImageData(0,0,l.width,l.height)),m.putImageData(p,0,0),f.variable.image.layer.hide())},mirror:function(){var v,w=null!==(v=Number(d.getAttribute("mirror-axis")))&&void 0!==v?v:0;S._env.feature.worker?S._assistant.worker.get(t).postMessage({axis:w,type:k,buffer:p.data.buffer,size:[l.width,l.height]},[p.data.buffer]):(p=S._assistant.canvasFilter.mirror(m.getImageData(0,0,l.width,l.height),w),m.putImageData(p,0,0),f.variable.image.layer.hide())}})[k])||
void 0===g?void 0:g.call(h)}}},{key:"revert",value:function(){var d=this.variable.nodes.container.querySelector(".modal-layer-image-canvas");var f=d.getContext("2d");this.variable.image.spin.scale=1;d.width=this.variable.image["default"].size[0];d.height=this.variable.image["default"].size[1];d.removeAttribute("style");f.putImageData(this.variable.image["default"].imageData,0,0);this.resize()}},{key:"download",value:function(){S._assistant.canvas.download(this.variable.nodes.container.querySelector(".modal-layer-image-canvas"),
this.option.title,"image/png")}}]);return b}(S);S._achieve.set("image",Oa);var Pa=function(e){function b(){I(this,b);return c.apply(this,arguments)}G(b,e);var c=H(b);J(b,[{key:"initStruct",value:function(){E(F(b.prototype),"initStruct",this).call(this);this.variable.struct._backup.interaction.innerHTML.push(this.variable.struct._backup.interaction_button.cancel)}}]);return b}(Ma);S._achieve.set("prompt",Pa);
var Qa=function(e){function b(){I(this,b);return c.apply(this,arguments)}G(b,e);var c=H(b);J(b,[{key:"initStruct",value:function(){E(F(b.prototype),"initStruct",this).call(this);this.variable.struct._backup.interaction.innerHTML.push(this.variable.struct._backup.interaction_button.no)}}]);return b}(Ma);S._achieve.set("confirm",Qa);
var Na=function(e){function b(){I(this,b);return c.apply(this,arguments)}G(b,e);var c=H(b);J(b,[{key:"initOption",value:function(d){E(F(b.prototype),"initOption",this).call(this,d);this.option.layer=S._assistant.object.merge(this.option.layer,S._option.loading);this.option.title=!1;this.option.drag.enable=!1;this.option.resize.enable=!1;this.option.progress.enable=!1}},{key:"compatibleOption",value:function(d){var f={center:"center",right:"flex-end",left:"flex-start"};E(F(b.prototype),"compatibleOption",
this).call(this,d);if(!S._assistant.object.isEmpty(d.layer.position)){Array.isArray(d.layer.position)||(d.layer.position=[d.layer.position,d.layer.position]);for(var g=0;2>g;g++)d.layer.position[g]=f[d.layer.position[g]]}}},{key:"checkOption",value:function(){E(F(b.prototype),"checkOption",this).call(this);if(!Array.isArray(this.option.layer.position)&&!["left","center","right"].includes(this.option.layer.position))throw Error("layer.position does not meet expectations");}},{key:"initStruct",value:function(){E(F(b.prototype),
"initStruct",this).call(this);var d=this.variable.struct._build.container;var f=this.variable.struct._backup.content=S._struct.content;var g=this.variable.struct._backup.content_loading=S._struct.content_loading;var h=this.variable.struct._backup.content_loading_icon=S._struct.content_loading_icon;window.isNaN(Number(this.option.layer.icon))?g.innerHTML[0]["class"]+=" "+this.option.layer.icon:g.innerHTML[0]=h[this.option.layer.icon];f.innerHTML.push(g);d.innerHTML.push(f)}},{key:"initNodeFinally",
value:function(){E(F(b.prototype),"initNodeFinally",this).call(this);var d=this.variable.nodes.container;var f=d.querySelector(".modal-layer-content");var g=f.querySelector(".modal-layer-loading-icon");var h=f.querySelector(".modal-layer-loading-box");d.style.cssText+="background: transparent; box-shadow: none;";f.style.cssText+="background: "+this.option.layer.background;h.style.cssText="justify-content: "+this.option.layer.position[0]+"; align-items: "+this.option.layer.position[1];g.style.cssText+=
"font-size: "+this.option.layer.size+"px; width: "+this.option.layer.area[0]+"px; height: "+this.option.layer.area[1]+"px; color: "+this.option.layer.color+"; animation-duration: "+this.option.layer.duration+"s;";S._assistant.object.isEmpty(this.option.layer.rate)||(g.style.animationTimingFunction=this.option.layer.rate)}}]);return b}(S);S._achieve.set("loading",Na);
var Ra=function(e){function b(){I(this,b);return c.apply(this,arguments)}G(b,e);var c=H(b);J(b,[{key:"initOption",value:function(d){E(F(b.prototype),"initOption",this).call(this,d);this.option.title=!1;this.option.drag.enable=!1;this.option.drag.overflow=!1}},{key:"initStruct",value:function(){E(F(b.prototype),"initStruct",this).call(this);var d=this.variable.struct._build.container;var f=this.variable.struct._backup.content=S._struct.content;d.innerHTML.push(f);this.option.resize.enable&&(f=this.variable.struct._backup.resize_box=
S._struct.resize_box,d.innerHTML.push(f));this.option.progress.enable&&(f=this.variable.struct._backup.progress_bar=S._struct.progress_bar,d.innerHTML.push(f))}},{key:"initNode",value:function(){E(F(b.prototype),"initNode",this).call(this);var d=this.variable.nodes.container.querySelector(".modal-layer-content");if(this.option.content.value instanceof Object){var f=S._assistant.element.objectToNode(this.option.content.value);Object.keys(f).forEach(function(g){d.appendChild(f[g])})}else d.innerHTML=
this.option.content.value}}]);return b}(S);S._achieve.set("msg",Ra);S._achieve.set("message",Ra);window.Worker&&S._worker.set("canvasFilter",function(){this.onmessage=function(e){var b,c;e=null===(b=(c=e.data).type)||void 0===b?void 0:b.call(c,e.data);this.postMessage({error:0,buffer:e?e.buffer:void 0},[e.buffer])};this.C=function(){this.postMessage({error:1,message:"Failed to send message."})}});
var Sa=function(e){function b(){var d=0<arguments.length&&void 0!==arguments[0]?arguments[0]:S._enum.BROWSER_STORAGE.SESSIONSTORAGE;I(this,b);if(!window[d])throw Error("The current browser does not support ".concat(d," function"));var f=c.call(this);f._record=[];f._type=d;f._storage=window[d];return f}G(b,e);var c=H(b);J(b,[{key:"has",value:function(d){return null!==this._storage.getItem(d)?!0:!1}},{key:"get",value:function(d){var f;return null!==(f=this._storage.getItem(d))&&void 0!==f?f:!1}},{key:"set",
value:function(d){this._storage.setItem(d,1<arguments.length&&void 0!==arguments[1]?arguments[1]:"");this._record.push(d);return!0}},{key:"del",value:function(d){var f=this._record.indexOf(d);if(!(1<arguments.length&&void 0!==arguments[1]&&arguments[1])&&0>f)return!1;0<=f&&this._record.splice(f,1);this._storage.removeItem(d);return!0}},{key:"clear",value:function(){for(;0<this._record.length;)this._storage.removeItem(this._record.shift());return!0}}]);return b}(function(){function e(){I(this,e);O(this,
"_type",null);O(this,"_record",null);O(this,"_storage",null)}J(e,[{key:"has",value:function(){}},{key:"get",value:function(){}},{key:"set",value:function(){}},{key:"del",value:function(){}},{key:"clear",value:function(){}}]);return e}());Ha&&(Object.defineProperty(Ha._achieve,S._enum.BROWSER_STORAGE.LOCALSTORAGE,{value:Sa}),Object.defineProperty(Ha._achieve,S._enum.BROWSER_STORAGE.SESSIONSTORAGE,{value:Sa}));}(window);
