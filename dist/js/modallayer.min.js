!function(window){"use strict";var n="function"==typeof Object.defineProperties?Object.defineProperty:function(e,b,c){if(e==Array.prototype||e==Object.prototype)return e;e[b]=c.value;return e};function aa(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<e.length;++b){var c=e[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");}var ba=aa(this);
function B(e,b){if(b)a:{var c=ba;e=e.split(".");for(var d=0;d<e.length-1;d++){var f=e[d];if(!(f in c))break a;c=c[f]}e=e[e.length-1];d=c[e];b=b(d);b!=d&&null!=b&&n(c,e,{configurable:!0,writable:!0,value:b})}}var ca;if("function"==typeof Object.setPrototypeOf)ca=Object.setPrototypeOf;else{var da;a:{var ea={u:!0},fa={};try{fa.__proto__=ea;da=fa.u;break a}catch(e){}da=!1}ca=da?function(e,b){e.__proto__=b;if(e.__proto__!==b)throw new TypeError(e+" is not extensible");return e}:null}var ha=ca;
B("Object.setPrototypeOf",function(e){return e||ha});B("Reflect",function(e){return e?e:{}});
var ia="function"==typeof Object.create?Object.create:function(e){function b(){}b.prototype=e;return new b},ja=function(){function e(){function c(){}new c;Reflect.construct(c,[],function(){});return new c instanceof c}if("undefined"!=typeof Reflect&&Reflect.construct){if(e())return Reflect.construct;var b=Reflect.construct;return function(c,d,f){c=b(c,d);f&&Reflect.setPrototypeOf(c,f.prototype);return c}}return function(c,d,f){void 0===f&&(f=c);f=ia(f.prototype||Object.prototype);return Function.prototype.apply.call(c,
f,d)||f}}();B("Reflect.construct",function(){return ja});function ka(e){var b=0;return function(){return b<e.length?{done:!1,value:e[b++]}:{done:!0}}}B("Symbol",function(e){function b(f){if(this instanceof b)throw new TypeError("Symbol is not a constructor");return new c("jscomp_symbol_"+(f||"")+"_"+d++,f)}function c(f,h){this.a=f;n(this,"description",{configurable:!0,writable:!0,value:h})}if(e)return e;c.prototype.toString=function(){return this.a};var d=0;return b});
B("Symbol.iterator",function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var b="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),c=0;c<b.length;c++){var d=ba[b[c]];"function"===typeof d&&"function"!=typeof d.prototype[e]&&n(d.prototype,e,{configurable:!0,writable:!0,value:function(){return la(ka(this))}})}return e});function la(e){e={next:e};e[Symbol.iterator]=function(){return this};return e}
B("Array.from",function(e){return e?e:function(b,c,d){c=null!=c?c:function(g){return g};var f=[],h="undefined"!=typeof Symbol&&Symbol.iterator&&b[Symbol.iterator];if("function"==typeof h){b=h.call(b);for(var k=0;!(h=b.next()).done;)f.push(c.call(d,h.value,k++))}else for(h=b.length,k=0;k<h;k++)f.push(c.call(d,b[k],k));return f}});
function ma(e,b){e instanceof String&&(e+="");var c=0,d=!1,f={next:function(){if(!d&&c<e.length){var h=c++;return{value:b(h,e[h]),done:!1}}d=!0;return{done:!0,value:void 0}}};f[Symbol.iterator]=function(){return f};return f}B("Array.prototype.keys",function(e){return e?e:function(){return ma(this,function(b){return b})}});B("Object.is",function(e){return e?e:function(b,c){return b===c?0!==b||1/b===1/c:b!==b&&c!==c}});
B("Array.prototype.includes",function(e){return e?e:function(b,c){var d=this;d instanceof String&&(d=String(d));var f=d.length;c=c||0;for(0>c&&(c=Math.max(c+f,0));c<f;c++){var h=d[c];if(h===b||Object.is(h,b))return!0}return!1}});function na(e,b,c){if(null==e)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return e+""}
B("String.prototype.includes",function(e){return e?e:function(b,c){return-1!==na(this,b,"includes").indexOf(b,c||0)}});function D(e,b){return Object.prototype.hasOwnProperty.call(e,b)}B("Object.values",function(e){return e?e:function(b){var c=[],d;for(d in b)D(b,d)&&c.push(b[d]);return c}});function E(e){var b="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];return b?b.call(e):{next:ka(e)}}
B("Promise",function(e){function b(k){this.c=0;this.i=void 0;this.a=[];var g=this.g();try{k(g.resolve,g.reject)}catch(l){g.reject(l)}}function c(){this.a=null}function d(k){return k instanceof b?k:new b(function(g){g(k)})}if(e)return e;c.prototype.c=function(k){if(null==this.a){this.a=[];var g=this;this.g(function(){g.i()})}this.a.push(k)};var f=ba.setTimeout;c.prototype.g=function(k){f(k,0)};c.prototype.i=function(){for(;this.a&&this.a.length;){var k=this.a;this.a=[];for(var g=0;g<k.length;++g){var l=
k[g];k[g]=null;try{l()}catch(m){this.h(m)}}}this.a=null};c.prototype.h=function(k){this.g(function(){throw k;})};b.prototype.g=function(){function k(m){return function(p){l||(l=!0,m.call(g,p))}}var g=this,l=!1;return{resolve:k(this.D),reject:k(this.h)}};b.prototype.D=function(k){if(k===this)this.h(new TypeError("A Promise cannot resolve to itself"));else if(k instanceof b)this.H(k);else{a:switch(typeof k){case "object":var g=null!=k;break a;case "function":g=!0;break a;default:g=!1}g?this.C(k):this.o(k)}};
b.prototype.C=function(k){var g=void 0;try{g=k.then}catch(l){this.h(l);return}"function"==typeof g?this.J(g,k):this.o(k)};b.prototype.h=function(k){this.s(2,k)};b.prototype.o=function(k){this.s(1,k)};b.prototype.s=function(k,g){if(0!=this.c)throw Error("Cannot settle("+k+", "+g+"): Promise already settled in state"+this.c);this.c=k;this.i=g;this.B()};b.prototype.B=function(){if(null!=this.a){for(var k=0;k<this.a.length;++k)h.c(this.a[k]);this.a=null}};var h=new c;b.prototype.H=function(k){var g=this.g();
k.j(g.resolve,g.reject)};b.prototype.J=function(k,g){var l=this.g();try{k.call(g,l.resolve,l.reject)}catch(m){l.reject(m)}};b.prototype.then=function(k,g){function l(u,q){return"function"==typeof u?function(r){try{m(u(r))}catch(t){p(t)}}:q}var m,p,v=new b(function(u,q){m=u;p=q});this.j(l(k,m),l(g,p));return v};b.prototype.catch=function(k){return this.then(void 0,k)};b.prototype.j=function(k,g){function l(){switch(m.c){case 1:k(m.i);break;case 2:g(m.i);break;default:throw Error("Unexpected state: "+
m.c);}}var m=this;null==this.a?h.c(l):this.a.push(l)};b.resolve=d;b.reject=function(k){return new b(function(g,l){l(k)})};b.race=function(k){return new b(function(g,l){for(var m=E(k),p=m.next();!p.done;p=m.next())d(p.value).j(g,l)})};b.all=function(k){var g=E(k),l=g.next();return l.done?d([]):new b(function(m,p){function v(r){return function(t){u[r]=t;q--;0==q&&m(u)}}var u=[],q=0;do u.push(void 0),q++,d(l.value).j(v(u.length-1),p),l=g.next();while(!l.done)})};return b});
B("Number.isFinite",function(e){return e?e:function(b){return"number"!==typeof b?!1:!isNaN(b)&&Infinity!==b&&-Infinity!==b}});B("Number.isInteger",function(e){return e?e:function(b){return Number.isFinite(b)?b===Math.floor(b):!1}});
B("WeakMap",function(e){function b(l){this.a=(g+=Math.random()+1).toString();if(l){l=E(l);for(var m;!(m=l.next()).done;)m=m.value,this.set(m[0],m[1])}}function c(){}function d(l){var m=typeof l;return"object"===m&&null!==l||"function"===m}function f(l){if(!D(l,k)){var m=new c;n(l,k,{value:m})}}function h(l){var m=Object[l];m&&(Object[l]=function(p){if(p instanceof c)return p;Object.isExtensible(p)&&f(p);return m(p)})}if(function(){if(!e||!Object.seal)return!1;try{var l=Object.seal({}),m=Object.seal({}),
p=new e([[l,2],[m,3]]);if(2!=p.get(l)||3!=p.get(m))return!1;p.delete(l);p.set(m,4);return!p.has(l)&&4==p.get(m)}catch(v){return!1}}())return e;var k="$jscomp_hidden_"+Math.random();h("freeze");h("preventExtensions");h("seal");var g=0;b.prototype.set=function(l,m){if(!d(l))throw Error("Invalid WeakMap key");f(l);if(!D(l,k))throw Error("WeakMap key fail: "+l);l[k][this.a]=m;return this};b.prototype.get=function(l){return d(l)&&D(l,k)?l[k][this.a]:void 0};b.prototype.has=function(l){return d(l)&&D(l,
k)&&D(l[k],this.a)};b.prototype.delete=function(l){return d(l)&&D(l,k)&&D(l[k],this.a)?delete l[k][this.a]:!1};return b});
B("Map",function(e){function b(){var g={};return g.f=g.next=g.head=g}function c(g,l){var m=g.a;return la(function(){if(m){for(;m.head!=g.a;)m=m.f;for(;m.next!=m.head;)return m=m.next,{done:!1,value:l(m)};m=null}return{done:!0,value:void 0}})}function d(g,l){var m=l&&typeof l;"object"==m||"function"==m?h.has(l)?m=h.get(l):(m=""+ ++k,h.set(l,m)):m="p_"+l;var p=g.c[m];if(p&&D(g.c,m))for(g=0;g<p.length;g++){var v=p[g];if(l!==l&&v.key!==v.key||l===v.key)return{id:m,list:p,index:g,b:v}}return{id:m,list:p,
index:-1,b:void 0}}function f(g){this.c={};this.a=b();this.size=0;if(g){g=E(g);for(var l;!(l=g.next()).done;)l=l.value,this.set(l[0],l[1])}}if(function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var g=Object.seal({x:4}),l=new e(E([[g,"s"]]));if("s"!=l.get(g)||1!=l.size||l.get({x:4})||l.set({x:4},"t")!=l||2!=l.size)return!1;var m=l.entries(),p=m.next();if(p.done||p.value[0]!=g||"s"!=p.value[1])return!1;p=m.next();return p.done||4!=p.value[0].x||
"t"!=p.value[1]||!m.next().done?!1:!0}catch(v){return!1}}())return e;var h=new WeakMap;f.prototype.set=function(g,l){g=0===g?0:g;var m=d(this,g);m.list||(m.list=this.c[m.id]=[]);m.b?m.b.value=l:(m.b={next:this.a,f:this.a.f,head:this.a,key:g,value:l},m.list.push(m.b),this.a.f.next=m.b,this.a.f=m.b,this.size++);return this};f.prototype.delete=function(g){g=d(this,g);return g.b&&g.list?(g.list.splice(g.index,1),g.list.length||delete this.c[g.id],g.b.f.next=g.b.next,g.b.next.f=g.b.f,g.b.head=null,this.size--,
!0):!1};f.prototype.clear=function(){this.c={};this.a=this.a.f=b();this.size=0};f.prototype.has=function(g){return!!d(this,g).b};f.prototype.get=function(g){return(g=d(this,g).b)&&g.value};f.prototype.entries=function(){return c(this,function(g){return[g.key,g.value]})};f.prototype.keys=function(){return c(this,function(g){return g.key})};f.prototype.values=function(){return c(this,function(g){return g.value})};f.prototype.forEach=function(g,l){for(var m=this.entries(),p;!(p=m.next()).done;)p=p.value,
g.call(l,p[1],p[0],this)};f.prototype[Symbol.iterator]=f.prototype.entries;var k=0;return f});B("Object.entries",function(e){return e?e:function(b){var c=[],d;for(d in b)D(b,d)&&c.push([d,b[d]]);return c}});
B("Set",function(e){function b(c){this.a=new Map;if(c){c=E(c);for(var d;!(d=c.next()).done;)this.add(d.value)}this.size=this.a.size}if(function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var c=Object.seal({x:4}),d=new e(E([c]));if(!d.has(c)||1!=d.size||d.add(c)!=d||1!=d.size||d.add({x:4})!=d||2!=d.size)return!1;var f=d.entries(),h=f.next();if(h.done||h.value[0]!=c||h.value[1]!=c)return!1;h=f.next();return h.done||h.value[0]==c||4!=h.value[0].x||
h.value[1]!=h.value[0]?!1:f.next().done}catch(k){return!1}}())return e;b.prototype.add=function(c){c=0===c?0:c;this.a.set(c,c);this.size=this.a.size;return this};b.prototype.delete=function(c){c=this.a.delete(c);this.size=this.a.size;return c};b.prototype.clear=function(){this.a.clear();this.size=0};b.prototype.has=function(c){return this.a.has(c)};b.prototype.entries=function(){return this.a.entries()};b.prototype.values=function(){return this.a.values()};b.prototype.keys=b.prototype.values;b.prototype[Symbol.iterator]=
b.prototype.values;b.prototype.forEach=function(c,d){var f=this;this.a.forEach(function(h){return c.call(d,h,h,f)})};return b});B("Array.prototype.values",function(e){return e?e:function(){return ma(this,function(b,c){return c})}});B("String.prototype.endsWith",function(e){return e?e:function(b,c){var d=na(this,b,"endsWith");void 0===c&&(c=d.length);c=Math.max(0,Math.min(c|0,d.length));for(var f=b.length;0<f&&0<c;)if(d[--c]!=b[--f])return!1;return 0>=f}});
B("String.prototype.startsWith",function(e){return e?e:function(b,c){var d=na(this,b,"startsWith"),f=d.length,h=b.length;c=Math.max(0,Math.min(c|0,d.length));for(var k=0;k<h&&c<f;)if(d[c++]!=b[k++])return!1;return k>=h}});function pa(e){"@babel/helpers - typeof";pa="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(b){return typeof b}:function(b){return b&&"function"===typeof Symbol&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b};return pa(e)}
function G(e,b,c){"undefined"!==typeof Reflect&&Reflect.get?G=Reflect.get:G=function(d,f,h){for(;!Object.prototype.hasOwnProperty.call(d,f)&&(d=I(d),null!==d););if(d)return f=Object.getOwnPropertyDescriptor(d,f),f.get?f.get.call(h):f.value};return G(e,b,c||e)}function J(e,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(b&&b.prototype,{constructor:{value:e,writable:!0,configurable:!0}});b&&qa(e,b)}
function qa(e,b){qa=Object.setPrototypeOf||function(c,d){c.__proto__=d;return c};return qa(e,b)}function K(e){var b=ra();return function(){var c=I(e);if(b){var d=I(this).constructor;c=Reflect.construct(c,arguments,d)}else c=c.apply(this,arguments);if(!c||"object"!==pa(c)&&"function"!==typeof c){if(void 0===this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");c=this}return c}}
function ra(){if("undefined"===typeof Reflect||!Reflect.construct||Reflect.construct.a)return!1;if("function"===typeof Proxy)return!0;try{return Reflect.construct(Date,[],function(){}),!0}catch(e){return!1}}function I(e){I=Object.setPrototypeOf?Object.getPrototypeOf:function(b){return b.__proto__||Object.getPrototypeOf(b)};return I(e)}
function N(e){var b=Array.isArray(e)?sa(e):void 0;b||(b="undefined"!==typeof Symbol&&Symbol.iterator in Object(e)?Array.from(e):void 0);if(!(e=b||ta(e)))throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");return e}
function O(e){var b=Array.isArray(e)?e:void 0;if(!b)if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){b=[];var c=!0,d=!1,f=void 0;try{for(var h=e[Symbol.iterator](),k;!(c=(k=h.next()).done)&&(b.push(k.value),2!==b.length);c=!0);}catch(g){d=!0,f=g}finally{try{if(!c&&null!=h["return"])h["return"]()}finally{if(d)throw f;}}}else b=void 0;if(!(e=b||ta(e,2)))throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
return e}function ta(e,b){if(e){if("string"===typeof e)return sa(e,b);var c=Object.prototype.toString.call(e).slice(8,-1);"Object"===c&&e.constructor&&(c=e.constructor.name);if("Map"===c||"Set"===c)return Array.from(e);if("Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return sa(e,b)}}function sa(e,b){if(null==b||b>e.length)b=e.length;for(var c=0,d=Array(b);c<b;c++)d[c]=e[c];return d}
function P(e,b){if(!(e instanceof b))throw new TypeError("Cannot call a class as a function");}function ua(e,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(e,d.key,d)}}function Q(e,b,c){b&&ua(e.prototype,b);c&&ua(e,c)}function R(e,b,c){b in e?Object.defineProperty(e,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):e[b]=c}var va=Object.create(null);va.browser=Object.create(null);va.feature=Object.create(null);
["proxy","symbol","worker","promise"].forEach(function(e){e=e[0].toUpperCase()+e.substring(1);va.feature[e]=window[e]?!0:!1});var S=Object.create(null);Object.defineProperty(S,"clickMask",{enumerable:!0,value:function(){void this.remove()}});Object.defineProperty(S,"interaction",{enumerable:!0,value:{ok:null,no:null,cancel:function(e){void e.remove()}}});
Object.defineProperty(S,"active",{enumerable:!0,value:function(e){var b;var c=0;var d=this.variable.nodes;e=null!==(b=e)&&void 0!==b?b:window.event;U._instance.forEach(function(h){h.status===U._enum.STATUS.SHOW&&c++});if(2<=c){var f=U._assistant.element.maxZIndex();d.container.style.zIndex!=f&&(Object.keys(d).forEach(function(h){d[h].style.zIndex=f+1}),d.container.style.zIndex=parseInt(d.container.style.zIndex)+1)}}});
Object.defineProperty(S,"drag",{enumerable:!0,value:function(e){function b(u){var q;var r=[];u=null!==(q=u)&&void 0!==q?q:window.event;switch(u.code){case "ArrowUp":r[1]=-1;break;case "ArrowDown":r[1]=1;break;case "ArrowLeft":r[0]=-1;break;case "ArrowRight":r[0]=1;break;default:return}u.preventDefault();d(r[0],r[1])}function c(u){var q;u=k=null!==(q=u)&&void 0!==q?q:window.event;d(u.movementX,u.movementY)}function d(u,q){1!==k.buttons?v():(h.option.drag.overflow||(m.x+u<p[0]&&(m.x=p[0]-u),m.right+
u>p[1]&&(m.x=p[1]-m.width-u),m.y+q<p[2]&&(m.y=p[2]-q),m.bottom+q>p[3]&&(m.y=p[3]-m.height-q)),m.x+=u,m.y+=q,h.option.resize.enable&&h.option.content.fullContainer&&(u=[5,p[1]-m.width-5],q=[5,p[3]-m.height-5],m.x<=u[0]?m.x=u[0]:m.x>=u[1]&&(m.x=u[1]),m.y<=q[0]?m.y=q[0]:m.y>=q[1]&&(m.y=q[1])),l.style.marginLeft=m.x+"px",l.style.marginTop=m.y+"px",h.setStatus("drag"))}var f,h=this,k;var g=this.status;e=null!==(f=e)&&void 0!==f?f:window.event;var l=this.variable.nodes.container;var m=l.getBoundingClientRect();
e=window.document.documentElement.getBoundingClientRect();var p=[e.x,e.x+e.width,e.x,e.y+e.height];window.getSelection().empty();var v=function q(){document.removeEventListener("keyup",b,!0);document.removeEventListener("mousemove",c);document.removeEventListener("mouseup",q);h.setStatus(g)};document.addEventListener("mouseup",v);document.addEventListener("mousemove",c);document.addEventListener("keyup",b,!0)}});
Object.defineProperty(S,"resize",{enumerable:!0,value:function(e){function b(u){var q;if(1!==u.buttons)v();else{d.setStatus("resize");u=null!==(q=u)&&void 0!==q?q:window.event;q=u.screenX-l[0];var r=u.screenY-l[1];u=h.getAttribute("position-resize-bar");var t=[k.x,k.y,m[0],m[1]];u.includes("top")&&(t[1]+=r,t[3]-=r,t[1]<p.y&&(t[3]-=p.y-t[1]),t[3]<g[1]&&(t[1]+=t[3]-g[1],t[3]=g[1]));u.includes("bottom")&&(t[3]+=r,t[3]<g[1]&&(t[3]=g[1]));u.includes("left")&&(t[0]+=q,t[2]-=q,t[0]<p.x&&(t[2]-=p.x-t[0]),
t[2]<g[0]&&(t[0]+=t[2]-g[0],t[2]=g[0]));u.includes("right")&&(t[2]+=q,t[2]<g[0]&&(t[2]=g[0]));d.resizeByXYWH(Number(t[0]),Number(t[1]),Number(t[2]),Number(t[3]))}}var c,d=this;var f=this.status;e=null!==(c=e)&&void 0!==c?c:window.event;var h=e.target;var k=this.variable.nodes.container.getBoundingClientRect();var g=this.variable.defaultArea;var l=[e.screenX,e.screenY];var m=[k.width,k.height];var p=document.documentElement.getBoundingClientRect();window.getSelection().empty();var v=function q(){document.removeEventListener("mousemove",
b);document.removeEventListener("mouseup",q);d.setStatus(f)};document.addEventListener("mouseup",v);document.addEventListener("mousemove",b)}});Object.defineProperty(S,"minimizeRevert",{enumerable:!0,value:function(){if("1"!=this.getAttribute("clicked")){this.setAttribute("clicked",1);var e=Number(this.getAttribute("modal-layer-index"));delete U._minimizeQueue[U._minimizeQueue.indexOf(U._instance[e])]}}});
Object.defineProperty(S,"autoShutdown",{enumerable:!0,value:function(){var e=this;var b=1E3*this.option.popupTime;var c=setInterval(function(){if(e.variable.nodes.container.classList.contains("modal-layer-show")){if(e.option.progress.enable){var d=e.variable.nodes.container.querySelector(".modal-layer-progress-bar-progress");switch(e.option.progress.position){case "top":case "bottom":var f="widthFull";break;case "left":case "right":f="heightFull"}d.style.animation=f+" "+e.option.popupTime+"s linear forwards"}e.variable.timeout.auto_shutdown=
setTimeout(function(){return void e.remove()},b);window.clearInterval(c)}},10)}});
Object.defineProperty(S,"action",{enumerable:!0,value:{close:function(e){void e.remove()},expand:function(e){var b=e.status;var c=e.X.U.M.querySelector("iframe[name="+e.l.R.name+e.l.index+"]");var d=function(h){h.target===c?e.I(U._enum.STATUS.L):!1===h.target&&(window.removeEventListener("fullscreenchange",d),e.I(b))};var f=function(h){U.T({S:!1,V:5,title:"\u9519\u8bef",N:!0,O:"bottom",content:'<i class="fas fa-window-close" style="color: red"></i> \u5168\u5c4f\u5931\u8d25, \u9519\u8bef\u539f\u56e0: '+h});
window.removeEventListener("fullscreenerror",f)};window.addEventListener("fullscreenerror",f);window.addEventListener("fullscreenchange",d);U._assistant.element.P(c)},minimize:function(e){var b=U._minimizeQueue.indexOf(e);0>b?U._minimizeQueue.push(e):U._minimizeQueue.splice(b,1)}}});
Object.defineProperty(S,"imageTools",{enumerable:!0,value:{crop:function(e){e.variable.image.status===U._enum.LOAD_STATUS.LOADED&&e.crop()},spin:function(e){e.variable.image.status===U._enum.LOAD_STATUS.LOADED&&e.spin()},filter:function(e){e.variable.image.status===U._enum.LOAD_STATUS.LOADED&&e.filter(window.event.target)},revert:function(e){e.variable.image.status===U._enum.LOAD_STATUS.LOADED&&e.revert()},download:function(e){e.variable.image.status===U._enum.LOAD_STATUS.LOADED&&e.download()}}});
var V=Object.create(null);Object.defineProperty(V,"page",{value:{src:null,srcdoc:null,frameborder:0,scrolling:"no",area:[800,600],allowfullscreen:!0,name:"modal-layer-page-"}});Object.defineProperty(V,"loading",{value:{icon:0,size:48,rate:null,duration:2,area:[48,48],color:"white",background:"transparent",position:["center","center"]}});
Object.defineProperty(V,"image",{value:{image:[],size:null,sizeRange:{min:[.15625,.160257],max:[.9,.9]},toolbar:{enable:!1,config:{crop:{enable:!1,title:"crop",icon:"fas fa-crop-alt"},spin:{enable:!1,title:"spin",icon:"fas fa-redo-alt"},filter:{enable:!1,config:{blur:{enable:!1,title:"blur",icon:null,text:"\u6a21"},gray:{enable:!1,title:"gray",icon:null,text:"\u7070"},mirror:{enable:!1,title:"mirror",icon:null,text:"\u955c"}},title:"filter",icon:"fas fa-filter"},revert:{enable:!1,title:"revert",icon:"fas fa-sync-alt"},
download:{enable:!1,title:"download",icon:"fas fa-download"}}}}});
Object.defineProperty(V,"common",{value:{index:0,ui:"modal-layer-ui",title:null,window:null,popupTime:5,skin:"default",parentModalLayer:null,areaProportion:[.18,.21],content:{value:null,fullContainer:!1},text:{action:{close:"\u5173\u95ed",expand:"\u5168\u5c4f",minimize:"\u6700\u5c0f\u5316"},interaction:{ok:"\u786e\u5b9a",no:"\u62d2\u7edd",cancel:"\u53d6\u6d88"}},transition:{time:.2,opacity:0,scale:[.45,.45]},mask:{enable:!0,clickRemove:!0},drag:{enable:!0,overflow:!1},resize:{enable:!0},progress:{enable:!1,
position:"bottom",color:"deepskyblue",background:"#cecece"},layer:{},hook:{initStart:null,initEnded:null}}});var Y=Object.create(null);Object.defineProperty(Y,"mask",{get:function(){return JSON.parse(JSON.stringify({nodeType:"div","class":"modal-layer-mask"}))},enumerable:!0,configurable:!1});Object.defineProperty(Y,"container",{get:function(){return JSON.parse(JSON.stringify({innerHTML:[],nodeType:"div","class":"modal-layer-container"}))},enumerable:!0,configurable:!1});
Object.defineProperty(Y,"action",{get:function(){return JSON.parse(JSON.stringify({innerHTML:[],nodeType:"div","class":"modal-layer-action"}))},enumerable:!0,configurable:!1});
Object.defineProperty(Y,"action_button",{get:function(){return JSON.parse(JSON.stringify({minimize:{nodeType:"span","data-fa-transform":"up-4 shrink-2","class":"fas fa-window-minimize modal-layer-action-btn modal-layer-action-btn-minimize"},expand:{nodeType:"span","data-fa-transform":"shrink-2","class":"fas fa-expand-arrows-alt modal-layer-action-btn modal-layer-action-btn-expand"},close:{nodeType:"span","data-fa-transform":"rotate-45 grow-1","class":"fas fa-plus modal-layer-action-btn modal-layer-action-btn-close"}}))},
enumerable:!0,configurable:!1});Object.defineProperty(Y,"title",{get:function(){return JSON.parse(JSON.stringify({nodeType:"div","class":"modal-layer-title",innerHTML:[{nodeType:"h4","class":"modal-layer-title-content"}]}))},enumerable:!0,configurable:!1});Object.defineProperty(Y,"content",{get:function(){return JSON.parse(JSON.stringify({innerHTML:[],nodeType:"div","class":"modal-layer-content"}))},enumerable:!0,configurable:!1});
Object.defineProperty(Y,"content_text",{get:function(){return JSON.parse(JSON.stringify({nodeType:"div","class":"modal-layer-text-content"}))},enumerable:!0,configurable:!1});Object.defineProperty(Y,"content_page",{get:function(){return JSON.parse(JSON.stringify({name:"",frameborder:0,scrolling:"no",nodeType:"iframe","class":"modal-layer-page-content"}))},enumerable:!0,configurable:!1});
Object.defineProperty(Y,"content_image",{get:function(){return JSON.parse(JSON.stringify({"load-status":2,nodeType:"canvas","class":"modal-layer-image-canvas"}))},enumerable:!0,configurable:!1});Object.defineProperty(Y,"content_image_hidden",{get:function(){return JSON.parse(JSON.stringify({nodeType:"div","class":"modal-layer-image-hidden",style:"width: 0; height: 0; overflow: hidden;"}))},enumerable:!0,configurable:!1});
Object.defineProperty(Y,"content_loading",{get:function(){return JSON.parse(JSON.stringify({nodeType:"div","class":"modal-layer-loading-box",innerHTML:[{nodeType:"span","class":"modal-layer-loading-icon"}]}))},enumerable:!0,configurable:!1});
Object.defineProperty(Y,"content_loading_icon",{get:function(){return JSON.parse(JSON.stringify([{nodeType:"span","class":"modal-layer-loading-icon fas fa-spinner fa-spin fa-fw"},{nodeType:"span","class":"modal-layer-loading-icon fas fa-circle-notch fa-spin fa-fw"},{nodeType:"span","class":"modal-layer-loading-icon fas fa-sync fa-spin fa-fw"},{nodeType:"span","class":"modal-layer-loading-icon fas fa-cog fa-spin fa-fw"}]))},enumerable:!0,configurable:!1});
Object.defineProperty(Y,"toolbar",{get:function(){return JSON.parse(JSON.stringify({innerHTML:[],nodeType:"div","class":"modal-layer-toolbar"}))},enumerable:!0,configurable:!1});Object.defineProperty(Y,"interaction",{get:function(){return JSON.parse(JSON.stringify({innerHTML:[],nodeType:"div","class":"modal-layer-interaction"}))},enumerable:!0,configurable:!1});
Object.defineProperty(Y,"interaction_button",{get:function(){return JSON.parse(JSON.stringify({ok:{nodeType:"span","class":"modal-layer-interaction-btn modal-layer-interaction-btn-ok"},no:{nodeType:"span","class":"modal-layer-interaction-btn modal-layer-interaction-btn-no"},cancel:{nodeType:"span","class":"modal-layer-interaction-btn modal-layer-interaction-btn-cancel"}}))},enumerable:!0,configurable:!1});
Object.defineProperty(Y,"progress_bar",{get:function(){return JSON.parse(JSON.stringify({nodeType:"div","class":"modal-layer-progress-bar",innerHTML:[{nodeType:"div","class":"modal-layer-progress-bar-background",innerHTML:[{nodeType:"span","class":"modal-layer-progress-bar-progress"}]}]}))},enumerable:!0,configurable:!1});
Object.defineProperty(Y,"resize_box",{get:function(){return JSON.parse(JSON.stringify({nodeType:"div","class":"modal-layer-resize-box",innerHTML:[{nodeType:"div","class":"modal-layer-resize-bar","position-resize-bar":"top"},{nodeType:"div","class":"modal-layer-resize-bar","position-resize-bar":"left"},{nodeType:"div","class":"modal-layer-resize-bar","position-resize-bar":"right"},{nodeType:"div","class":"modal-layer-resize-bar","position-resize-bar":"bottom"},{nodeType:"div","class":"modal-layer-resize-bar",
"position-resize-bar":"left-top"},{nodeType:"div","class":"modal-layer-resize-bar","position-resize-bar":"right-top"},{nodeType:"div","class":"modal-layer-resize-bar","position-resize-bar":"left-bottom"},{nodeType:"div","class":"modal-layer-resize-bar","position-resize-bar":"right-bottom"}]}))},enumerable:!0,configurable:!1});Object.defineProperty(Y,"minimize_queue",{get:function(){return JSON.parse(JSON.stringify({innerHTML:[],nodeType:"div",id:"modal-layer-minimize-queue"}))},enumerable:!0,configurable:!1});
Object.defineProperty(Y,"minimize_queue_item",{get:function(){return JSON.parse(JSON.stringify({nodeType:"div","class":"modal-layer-minimize-queue-item",innerHTML:[{nodeType:"h4","class":"modal-layer-minimize-queue-item-title"}]}))},enumerable:!0,configurable:!1});
Object.defineProperty(Y,"image_tools",{get:function(){return JSON.parse(JSON.stringify({crop:{title:"crop",nodeType:"div","tool-type":"crop",innerHTML:[{nodeType:"span","class":"modal-layer-toolbar-item-icon"}],"class":"modal-layer-toolbar-item"},spin:{title:"spin",nodeType:"div","tool-type":"spin",innerHTML:[{nodeType:"span","class":"modal-layer-toolbar-item-icon"}],"class":"modal-layer-toolbar-item"},revert:{title:"revert",nodeType:"div","tool-type":"revert",innerHTML:[{nodeType:"span","class":"modal-layer-toolbar-item-icon"}],
"class":"modal-layer-toolbar-item"},filter:{title:"filter",nodeType:"div","tool-type":"filter",innerHTML:[{nodeType:"span","class":"modal-layer-toolbar-item-icon"},{innerHTML:[],nodeType:"div","class":"modal-layer-toolbar-item-child-list"}],"class":"modal-layer-toolbar-item"},download:{title:"save",nodeType:"div","tool-type":"download",innerHTML:[{nodeType:"span","class":"modal-layer-toolbar-item-icon"}],"class":"modal-layer-toolbar-item"}}))},enumerable:!0,configurable:!1});
Object.defineProperty(Y,"image_tools_child",{get:function(){return JSON.parse(JSON.stringify({filter:{mirror:{title:"\u955c\u50cf",innerText:"\u955c",nodeType:"span","filter-type":"mirror","class":"modal-layer-toolbar-filter-icon"},blur:{"data-radius":3,"data-sigma":1.5,innerText:"\u6a21",title:"\u9ad8\u65af\u6a21\u7cca",nodeType:"span","filter-type":"blur","class":"modal-layer-toolbar-filter-icon"},gray:{title:"\u7070\u5ea6\u5316",innerText:"\u7070",nodeType:"span","filter-type":"gray","class":"modal-layer-toolbar-filter-icon"}}}))},
enumerable:!0,configurable:!1});var Z=Object.create(null);Object.defineProperty(Z,"ARROW",{enumerable:!0,value:{LEFT:37,UP:38,RIGHT:39,DOWN:40}});Object.defineProperty(Z,"TYPE",{enumerable:!0,value:{MSG:0,MESSAGE:0,ALERT:1,PROMPT:2,CONFIRM:3,PAGE:4,LOADING:5,IMAGE:6,VIDEO:7,AUTDIO:8}});Object.defineProperty(Z,"STATUS",{enumerable:!0,value:{HIDE:0,SHOW:1,EXPAND:2,MINIMIZE:3,REMOVING:4,REMOVED:5,DRAG:6,RESIZE:7}});Object.defineProperty(Z,"LOAD_STATUS",{enumerable:!0,value:{FAILED:0,LOADED:1,LOADING:2}});
var U=function(){function e(b,c){P(this,e);R(this,"type",null);R(this,"status",null);R(this,"option",null);R(this,"variable",{});try{var d,f,h,k,g,l;null===(d=b.hook)||void 0===d?void 0:null===(f=d.initStart)||void 0===f?void 0:null===(h=f.call)||void 0===h?void 0:h.call(f,b);this.type=b.type;this.status=e._enum.STATUS.HIDE;this.compatibleOption(b);this.initOption(b);this.checkOption();this.linkageOption();this.initVariable();this.initStruct();this.initNode();this.initNodeFinally();this.initEvent();
this.bindEvent();null===(k=this.option.hook)||void 0===k?void 0:null===(g=k.initEnded)||void 0===g?void 0:null===(l=g.call)||void 0===l?void 0:l.call(g,this);this.insertNode()}catch(m){null===c||void 0===c?void 0:c.call(null,m)}}Q(e,[{key:"initOption",value:function(b){var c;b.index=e._instance.length;b.window=null!==(c=b.window)&&void 0!==c?c:window.document.body;this.option=e._assistant.object.merge(b,e._option.common)}},{key:"compatibleOption",value:function(b){var c,d;if("boolean"===typeof b.mask||
["true","false"].includes(b.mask))b.mask={enable:!!b.mask,clickRemove:!0};if(!b.content||e._assistant.object.isEmpty(b.content.value))b.content={value:b.content,fullContainer:null!==(c=null===(d=b.content)||void 0===d?void 0:d.fullContainer)&&void 0!==c?c:!1}}},{key:"linkageOption",value:function(){0>=this.option.popupTime&&(this.option.progress.enable=!1);!1===this.option.title&&(this.option.drag.enable=!1)}},{key:"checkOption",value:function(){}},{key:"initVariable",value:function(){this.event=
{};this.variable.timeout={};this.variable.struct={_build:{},_backup:{}};this.variable.interval={};this.variable.animationName={}}},{key:"initStruct",value:function(){var b;if(null===(b=this.option.mask)||void 0===b?0:b.enable)this.variable.struct._build.mask=e._struct.mask;this.variable.struct._build.container=e._struct.container}},{key:"initNode",value:function(){this.variable.nodes=e._assistant.element.objectToNode(this.variable.struct._build);var b=this.variable.nodes.container;var c=b.querySelector(".modal-layer-interaction-btn-ok");
var d=b.querySelector(".modal-layer-interaction-btn-no");var f=b.querySelector(".modal-layer-interaction-btn-cancel");b.setAttribute("modal-layer-popup-time",this.option.popupTime);b.setAttribute("content-full-container",Number(this.option.content.fullContainer));b.setAttribute("modal-layer-type",e._assistant.object.getKeyByValue(e._enum.TYPE,this.type).toLowerCase());b.setAttribute("allow-drag",Number(this.option.drag.enable));b.setAttribute("allow-resize",Number(this.option.resize.enable));if(this.option.progress.enable){var h=
["top","left","right","bottom"];var k=b.querySelector(".modal-layer-progress-bar");h.includes(this.option.progress.position)||(this.option.progress.position=h[3]);k.setAttribute("progress-bar-position",this.option.progress.position);k.querySelector(".modal-layer-progress-bar-progress").style.cssText+="background: "+this.option.progress.color;k.querySelector(".modal-layer-progress-bar-background").style.cssText+="background: "+this.option.progress.background}if(!1!==this.option.title){var g=b.querySelector(".modal-layer-title-content");
if(this.option.title instanceof Object){var l=e._assistant.element.objectToNode(this.option.title);Object.keys(l).forEach(function(m){g.appendChild(l[m])})}else g.innerHTML=this.option.title}c&&(c.innerText=this.option.text.interaction.ok);d&&(d.innerText=this.option.text.interaction.no);f&&(f.innerText=this.option.text.interaction.cancel)}},{key:"initNodeFinally",value:function(){var b=this.option.ui;var c="modal-layer-skin-"+this.option.skin;var d="modal-layer-index-"+this.option.index;var f="transition-opacity-"+
100*this.option.transition.opacity+"-animation";var h="transition-scale-"+100*this.option.transition.scale[0]+"-"+100*this.option.transition.scale[1]+"-animation";this.variable.animationName.transition_opacity=f;this.variable.animationName.transition_scale=h;if(!e._assistant.css.hasCss(f)){var k={from:"opacity: "+this.option.transition.opacity,to:"opacity: 1"};var g=e._assistant.css.createAnimation(f,k);e._assistant.css.addCss(f,g);e._assistant.css.addCss(f+"-reverse",e._assistant.css.createAnimation(f+
"-reverse",{from:k.m,to:k.from}))}e._assistant.css.hasCss(h)||(f={from:"transform: scale("+this.option.transition.scale[0]+", "+this.option.transition.scale[1]+")",to:"transform: scale(1, 1)"},g=e._assistant.css.createAnimation(h,f),e._assistant.css.addCss(h,g),e._assistant.css.addCss(h+"-reverse",e._assistant.css.createAnimation(h+"-reverse",{from:f.m,to:f.from})));Object.keys(this.variable.nodes).forEach(function(l){for(var m=e._assistant.element.getAllElement(this.variable.nodes[l]),p=0;p<m.length;p++)m[p].classList.add(b);
this.variable.nodes[l].className=b+" "+c+" "+d+" "+this.variable.nodes[l].className.trim()+" modal-layer-hide"},this);e._instance.push(this)}},{key:"initEvent",value:function(){var b;this.event=e._assistant.object.merge(null!==(b=this.option.event)&&void 0!==b?b:{},e._event)}},{key:"bindEvent",value:function(){this.option.mask.enable&&this.option.mask.clickRemove&&this.variable.nodes.mask.addEventListener("click",this.event.clickMask=this.event.clickMask.bind(this));this.option.drag.enable&&this.variable.nodes.container.querySelector(".modal-layer-title").addEventListener("mousedown",
this.event.drag=this.event.drag.bind(this));this.option.resize.enable&&e._assistant.element.eventTarget(this.variable.nodes.container,".modal-layer-resize-bar","mousedown",this.event.resize=this.event.resize.bind(this));this.variable.nodes.container.addEventListener("mousedown",this.event.active=this.event.active.bind(this));this.event.action.close&&e._assistant.element.eventTarget(this.variable.nodes.container,".modal-layer-action-btn-close","click",this.event.action.close,this);this.event.action.expand&&
e._assistant.element.eventTarget(this.variable.nodes.container,".modal-layer-action-btn-expand","click",this.event.action.expand,this);this.event.action.minimize&&e._assistant.element.eventTarget(this.variable.nodes.container,".modal-layer-action-btn-minimize","click",this.event.action.minimize,this);var b=this.variable.nodes.container.querySelector(".modal-layer-interaction-btn-ok");var c=this.variable.nodes.container.querySelector(".modal-layer-interaction-btn-no");var d=this.variable.nodes.container.querySelector(".modal-layer-interaction-btn-cancel");
this.event.interaction.ok&&b&&b.addEventListener("click",this.event.interaction_ok=this.event.interaction.ok.bind(b,this));this.event.interaction.no&&c&&c.addEventListener("click",this.event.interaction_no=this.event.interaction.no.bind(c,this));d&&d.addEventListener("click",this.event.interaction_cancel=this.event.interaction.cancel.bind(d,this));e._assistant.element.eventTarget(document,"#modal-layer-minimize-queue .modal-layer-minimize-queue-item","click",this.event.minimizeRevert)}},{key:"insertNode",
value:function(){var b=this;Object.keys(this.variable.nodes).forEach(function(c){var d,f=b.option.window;if(f instanceof String||"string"===typeof f)f=b.option.window=null!==(d=document.querySelector(f))&&void 0!==d?d:window.a.body;f.insertAdjacentElement||(f=b.option.window=window.document.body);f.insertAdjacentElement("beforeend",b.variable.nodes[c])},this)}}]);Q(e,[{key:"setStatus",value:function(b){if(Object.values(e._enum.STATUS).includes(b))this.status=b,this.variable.nodes.container.setAttribute("modal-layer-status",
e._assistant.object.getKeyByValue(e._enum.STATUS,b));else{b=b.toUpperCase();if(void 0===e._enum.STATUS[b])throw Error("Illegal value");this.status=e._enum.STATUS[b];this.variable.nodes.container.setAttribute("modal-layer-status",b.toLowerCase())}}},{key:"resize",value:function(){var b=window.innerWidth;var c=0;var d=this.variable.nodes.container;var f=d.children;var h=this.option.areaProportion[0].toString().length-(this.option.areaProportion[0].toString().indexOf(".")+1);h=10*b*h*this.option.areaProportion[0]/
(10*h);d.style.width=h+"px";for(b=0;b<f.length;b++)c="absolute"==getComputedStyle(f[b],null).position?c:Math.max(e._assistant.element.getNodeHeight(f[b]),c);d.style.height=c+"px";this.variable.defaultArea=[h,c]}},{key:"resizeByXYWH",value:function(b,c,d,f){var h=this.variable.nodes.container;var k=document.documentElement.getBoundingClientRect();b<k.x&&(b=k.x);b+d>k.right&&(d=k.right-b);c<k.y&&(c=k.y);c+f>k.bottom&&(f=k.bottom-c);h.style.marginLeft=b+"px";h.style.marginTop=c+"px";h.style.width=d+
"px";h.style.height=f+"px";[e._enum.TYPE.PAGE,e._enum.TYPE.VIDEO,e._enum.TYPE.AUDIO].includes(this.type)&&(b=h.querySelector("iframe[name="+this.option.layer.name+this.option.index+"]"),b.style.width=this.option.layer.area[0]+d-this.variable.defaultArea[0]+"px",b.style.height=this.option.layer.area[1]+f-this.variable.defaultArea[1]+"px")}},{key:"show",value:function(){var b=this;var c=this.variable.nodes;var d=e._assistant.element.maxZIndex();if(0===Object.keys(c).length||this.status===e._enum.STATUS.SHOW)return!1;
var f=this.variable.animationName.transition_opacity+" "+this.option.transition.time+"s ease forwards";var h=this.variable.animationName.transition_scale+" "+this.option.transition.time+"s ease forwards";Object.keys(c).forEach(function(g){c[g].style.zIndex=d+1});var k=new Promise(function(g){c.container.onanimationend=function(){0<b.option.popupTime&&b.event.autoShutdown.call(b);c.container.onanimationend=null;g()}});c.mask&&(c.mask.style.animation=f);c.container.style.animation=f+", "+h;Object.keys(c).forEach(function(g){c[g].classList.contains("modal-layer-hide")&&
c[g].classList.replace("modal-layer-hide","modal-layer-show")},this);this.setStatus("show");return k}},{key:"hide",value:function(){var b=this;var c=this.variable.nodes;if(0===Object.keys(c).length||this.status===e._enum.STATUS.HIDE)return!1;Number.isInteger(this.variable.timeout.auto_shutdown)&&window.clearTimeout(this.variable.timeout.auto_shutdown);var d=this.variable.animationName.transition_opacity+"-reverse "+this.option.transition.time+"s ease forwards";var f=this.variable.animationName.transition_scale+
"-reverse "+this.option.transition.time+"s ease forwards";var h=new Promise(function(k){c.container.onanimationend=function(){Object.keys(c).forEach(function(g){c[g].classList.contains("modal-layer-show")&&c[g].classList.replace("modal-layer-show","modal-layer-hide")});b.setStatus("hide");c.container.onanimationend=null;null!==b.option.parentModalLayer&&b.option.parentModalLayer.show();k()}});c.mask&&(c.mask.style.animation=d);c.container.style.animation=d+", "+f;return h}},{key:"minimize",value:function(){var b=
this;if(this.status!==e._enum.STATUS.MINIMIZE){var c=.3;var d=document.querySelector("#modal-layer-minimize-queue");d||(d=e._assistant.element.objectToNode([e._struct.minimize_queue])[0],d.classList.add(this.l.K,"modal-layer-skin-".concat(this.l.W)),document.body.insertAdjacentElement("beforeend",d));c=.3;var f=this.variable.nodes.container.querySelector(".modal-layer-title-content").innerHTML;var h=e._assistant.element.objectToNode([e._struct.minimize_queue_item])[0];h.classList.add(this.l.K);h.setAttribute("modal-layer-index",
this.option.index);h.querySelector(".modal-layer-minimize-queue-item-title").innerHTML=f;d.insertAdjacentElement("beforeend",h);var k=setInterval(function(){h.parentNode&&(h.style.animation="opacity "+c+"s ease forwards, "+b.variable.animationName.minimize_queue_transition_scale+" "+c+"s ease forwards",clearInterval(k))},10);this.hide().then(function(){return void b.setStatus("minimize")})}}},{key:"revert",value:function(){var b=this;var c=document.querySelector("#modal-layer-minimize-queue");var d=
c.querySelector('.modal-layer-minimize-queue-item[modal-layer-index="'+this.option.index+'"]');if([e._enum.STATUS.MINIMIZE].includes(this.status)){d.onanimationstart=function(){setTimeout(function(){b.show();d.onanimationstart=null},150)};var f=new Promise(function(h){d.onanimationend=function(){d.remove();0>=e._minimizeQueue.length&&c.remove();h()}});d.style.animation="opacity-reverse 0.3s ease forwards, "+this.variable.animationName.minimize_queue_transition_scale+"-reverse 0.3s ease forwards";
return f}}},{key:"remove",value:function(){var b=this;var c=this.variable.nodes;if(0===Object.keys(c).length||[e._enum.STATUS.REMOVING,e._enum.STATUS.REMOVED].includes(this.status))return!1;this.status===e._enum.STATUS.MINIMIZE&&delete e._minimizeQueue[e._minimizeQueue.indexOf(this)];this.setStatus("removing");this.hide().then(function(){b.removeAllEvent();Object.keys(c).forEach(function(d){c[d].remove()});b.setStatus("removed")})}},{key:"removeAllEvent",value:function(){var b;if(0===Object.keys(b=
this.variable.nodes).length)return!1;var c=b.container.querySelector(".modal-layer-interaction-btn-ok");var d=b.container.querySelector(".modal-layer-interaction-btn-no");var f=b.container.querySelector(".modal-layer-interaction-btn-cancel");this.option.mask.enable&&this.option.mask.clickRemove&&b.mask.removeEventListener("click",this.event.clickMask);this.option.drag.enable&&b.container.querySelector(".modal-layer-title").removeEventListener("mousedown",this.event.drag);this.option.resize.enable&&
b.container.removeEventListener("mousedown",this.event.resize);b.container.removeEventListener("mousedown",this.event.active);b.container.removeEventListener("click",this.event.action.close);b.container.removeEventListener("click",this.event.action.expand);b.container.removeEventListener("click",this.event.action.minimize);c&&c.removeEventListener("click",this.event.interaction_ok);d&&d.removeEventListener("click",this.event.interaction_no);f&&f.removeEventListener("click",this.event.interaction_cancel);
document.removeEventListener("click",this.event.minimizeRevert)}}],[{key:"removeAll",value:function(){for(var b=0;b<e._instance.length;b++)e._instance[b].remove()}},{key:"msg",value:function(b,c){e.message(b,c)}},{key:"message",value:function(b,c){"string"===typeof b?b={content:b,type:e._enum.TYPE.MESSAGE}:b.type=e._enum.TYPE.MESSAGE;b=new (e._achieve.get("message"))(b,c);b.resize();b.show();return b}},{key:"alert",value:function(b,c){b.type=e._enum.TYPE.ALERT;b=new (e._achieve.get("alert"))(b,c);
b.resize();b.show();return b}},{key:"confirm",value:function(b,c){b.type=e._enum.TYPE.CONFIRM;b=new (e._achieve.get("confirm"))(b,c);b.resize();b.show();return b}},{key:"prompt",value:function(b,c){b.type=e._enum.TYPE.PROMPT;b=new (e._achieve.get("prompt"))(b,c);b.resize();b.show();return b}},{key:"page",value:function(b,c){b.type=e._enum.TYPE.PAGE;b=new (e._achieve.get("page"))(b,c);b.resize();b.show();return b}},{key:"image",value:function(b,c){var d=null;b.type=e._enum.TYPE.IMAGE;d=new (e._achieve.get("image"))(b,
c);d.variable.image.finish["catch"](function(f){return null===c||void 0===c?void 0:c(f)}).then(function(){return d.resize()}).then(function(){return d.show()});return d}},{key:"loading",value:function(b,c){b.type=e._enum.TYPE.LOADING;b=new (e._achieve.get("loading"))(b,c);b.resize();b.show();return b}},{key:"console",value:function(b){function c(){return b.apply(this,arguments)}c.toString=function(){return b.toString()};return c}(function(){console.log(e.a)})}]);return e}();R(U,"_env",va);
R(U,"_enum",Z);R(U,"_struct",Y);R(U,"_option",V);R(U,"_event",S);R(U,"_cache",new Map);R(U,"_worker",window.Worker?new Map:void 0);R(U,"_version",1);R(U,"_achieve",new Map);R(U,"_assistant",new Map);R(U,"_instance",new Proxy([],{set:function(e,b,c){if(c instanceof U||"length"===b)return e[b]=c,!0;throw new TypeError("Must be of type ModalLayer");},deleteProperty:function(){throw Error("Illegal operation");}}));
R(U,"_minimizeQueue",new Proxy([],{set:function(e,b,c){if(c instanceof U){var d=e.indexOf(c);c.minimize();0>d?e[b]=c:e[d]=c;return!0}return"length"===b?(e[b]=c,!0):!1},deleteProperty:function(e,b){b=parseInt(b);if(Number.isInteger(b)&&e[b]instanceof U){e[b].revert();if(e[b+1])for(;b<e.length-1;b++)e[b]=e[b+1];delete e[e.length-1];e.length--;return!0}}}));
Object.is(window.ModalLayer,U)?(console.group("ModalLayer already exists"),console.log("Already version ".concat(window.ModalLayer._version)),console.log("Try to introduce version: ".concat(U._version)),console.groupEnd()):(Object.preventExtensions(U),Object.defineProperty(window,"ModalLayer",{value:U}));
var wa=function(){function e(){P(this,e)}Q(e,null,[{key:"createAnimation",value:function(b,c){var d="@keyframes "+b+" {";Object.keys(c).forEach(function(f){d+=f+"{"+c[f]+"}"});return d+"}"}},{key:"hasCss",value:function(b){return e.cssList.has(b)}},{key:"addCss",value:function(b,c){if(e.hasCss(b))return!1;e.styleNode||(e.styleNode=document.createElement("style"),document.head.appendChild(e.styleNode));c=c.trim();e.cssList.set(b,c);e.styleNode.innerHTML+=e.delimiter+c}},{key:"delCss",value:function(b){e.hasCss(b)&&
(b=new RegExp(e.delimiter+e.cssList.get(b),"g"),e.styleNode.innerHTML=e.styleNode.innerHTML.replace(b,""))}}]);return e}();R(wa,"cssList",new Map);R(wa,"delimiter","\n");R(wa,"styleNode",null);Object.defineProperty(U._assistant,"css",{value:wa});
var xa=function(){function e(){P(this,e)}Q(e,null,[{key:"getFileBinary",value:function(b){return fetch(b,{mode:"cors",method:"get",cache:"no-cache",redirect:"follow",referrer:"no-referrer",credentials:"same-origin",headers:{"content-type":"text/plain"}})}},{key:"getFileBlob",value:function(b){var c=null;b instanceof Blob?c=Promise.resolve(b):b instanceof Image||b instanceof Element&&"IMAGE"===b.nodeName?c=this.A(b.src).then(function(d){return d.blob()}):"string"===typeof b||b instanceof String?c=
this.A(b).then(function(d){return d.blob()}):c=Promise.reject(!1);return c}},{key:"getImage",value:function(b){var c=null;"string"===typeof b||b instanceof String?c=b:b instanceof Image||b instanceof Element&&"IMAGE"===b.nodeName?c=b.src:b instanceof Blob||b instanceof MediaSource?c=URL.createObjectURL(b):c=!1;return c}},{key:"getImageSize",value:function(b){var c=new Image,d=new Promise(function(f,h){c.onload=function(){f([c.width,c.height])};c.onerror=function(){h(!1)}});c.src=b;return d}}]);return e}();
Object.defineProperty(U._assistant,"file",{value:xa});
var ya=function(){function e(){P(this,e)}Q(e,null,[{key:"has",value:function(b){return e.list.has(b)}},{key:"add",value:function(b,c){if(!(c instanceof Worker))throw new TypeError("Not a Worker instance.");if(e.has(b))throw Error("The key already exists.");e.list.set(b,c)}},{key:"get",value:function(b){return e.list.get(b)}},{key:"create",value:function(b,c){try{var d=new Worker(c);e.list.set(b,d)}catch(f){throw f;}return d}},{key:"close",value:function(b){var c;b instanceof Worker||(b=e.get(b),e.list["delete"](b));
null===(c=b)||void 0===c?void 0:c.terminate()}},{key:"listener",value:function(b){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:void 0;if(!(b instanceof Worker)&&(b=e.get(b),void 0===b))throw Error("Worker not found.");return new Promise(function(d,f){b.F=f;b.onmessage=function(h){null===c||void 0===c?void 0:c(h);d(h)}})}},{key:"addListener",value:function(b){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:void 0;if(!(b instanceof Worker)&&(b=e.get(b),void 0===b))throw Error("Worker not found.");
return new Promise(function(d,f){b.addEventListener("messageerror",f);b.addEventListener("message",function(h){null===c||void 0===c?void 0:c(h);d(h)})})}}]);return e}();R(ya,"list",new Map);Object.defineProperty(U._assistant,"worker",{value:ya});
var Da=function(){function e(){P(this,e)}Q(e,null,[{key:"get",value:function(b,c){c=Array.isArray(c)?c:c.split(".");for(var d=0;d<c.length&&!e.isEmpty(b);d++)b=b[c[d]];return b}},{key:"set",value:function(b,c,d){c=Array.isArray(c)?c:c.split(".");for(var f=0;f<c.length;b=b[c[f]],f++)f===c.length-1?Object.defineProperty(b,c[f],{value:d,writable:!0,enumerable:!0,configurable:!0}):e.isEmpty(b[c[f]])&&b[c[f]].constructor===Object||(b[c[f]]={})}},{key:"isEmpty",value:function(b){return null===b||void 0===
b}},{key:"isOnlyObject",value:function(b){return b&&(b.constructor===Object||void 0===b.constructor)}},{key:"getMethod",value:function(b,c,d){for(;!e.isEmpty(b);){if(Object.is(b.constructor,c))return b[d];b=b.__proto__}return null}},{key:"getKeyByValue",value:function(b,c){b=Object.entries(b);for(var d=0;d<b.length;d++)if(b[d][1]===c)return b[d][0];return null}},{key:"deepCopy",value:function(b){var c,d;if(e.isEmpty(b))return b;var f=null!==(c=null===(d=b.constructor)||void 0===d?void 0:d.call(b))&&
void 0!==c?c:Object.create(null);c=[f];d=[[Object.keys(b),Object.values(b)]];do{b=c.shift();var h=d.shift();var k=O(h);h=k[0];var g=k[1];for(var l=0;l<h.length;l++){k=h[l];var m=g[l];if(e.isOnlyObject(m)||Array.isArray(m)){var p,v,u;b[k]=null!==(p=null===(v=(u=m).constructor)||void 0===v?void 0:v.call(u))&&void 0!==p?p:Object.create(null);d.push([Object.keys(m),Object.values(m)]);c.push(b[k])}else b[k]=m}}while(0<d.length);return f}},{key:"merge",value:function(b,c){var d,f,h=2<arguments.length&&
void 0!==arguments[2]?arguments[2]:0;if(e.isEmpty(b))return c;if(e.isEmpty(c))return b;var k=null!==(d=null===(f=c.constructor)||void 0===f?void 0:f.call(c))&&void 0!==d?d:Object.create(null);var g=[k];f=[[[Object.keys(b),Object.values(b)],[Object.keys(c),Object.values(c)]]];do{d=g.shift();var l=f.shift();var m=O(l);var p=O(m[0]);l=p[0];p=p[1];var v=O(m[1]);m=v[0];var u=v[1];m=N(new Set(m.concat(l)));for(var q=0;q<m.length;q++){var r=[m[q],u[q]];v=r[0];var t=r[1];r=p[l.indexOf(v)];var x=e.isEmpty(r);
if(e.isOnlyObject(t)||Array.isArray(t)){var z,L,w=[];d[v]=null!==(z=null===(L=x?t.constructor:r.constructor)||void 0===L?void 0:L())&&void 0!==z?z:Object.create(null);w[1]=0===h?[Object.keys(t),Object.values(t)]:[Object.keys(r),[]];w[0]=x?[[],[]]:[Object.keys(r),Object.values(r)];g.push(d[v]);f.push(w)}else Object.defineProperty(d,v,{writable:!0,enumerable:!0,value:x?t:r})}}while(0<f.length);return k}}]);return e}();Object.defineProperty(U._assistant,"object",{value:Da});
var Ea=function(){function e(){P(this,e)}Q(e,null,[{key:"mul",value:function(b,c){var d,f;b=[b.toString().split("."),c.toString().split(".")];c=Math.pow(10,Math.max(null!==(d=b[0][1].length)&&void 0!==d?d:0,null!==(f=b[1][1].length)&&void 0!==f?f:0));b=[[Number(b[0][0]),Number("0."+b[0][1])*c],[Number(b[1][0]),Number("0."+b[1][1])*c]];return(0!==b[0][0]?b[0][0]:1)*(0!==b[1][0]?b[1][0]:1)+b[0][1]*b[1][1]/c}},{key:"div",value:function(b,c){var d,f,h,k;var g=Math.pow(10,Math.max(null!==(d=null===(f=
b.toString().split(".")[1])||void 0===f?void 0:f.length)&&void 0!==d?d:0,null!==(h=null===(k=c.toString().split(".")[1])||void 0===k?void 0:k.length)&&void 0!==h?h:0));return b*g/(c*g)}},{key:"getMedian",value:function(b){b=b.map(function(d){return d}).sort(function(d,f){return d-f});if(1===b.length%2){var c=window.parseInt(b.length/2);b=b[c]}else c=window.parseInt(b.length/2),b=(b[c-1]+b[c])/2;return b}},{key:"getMode",value:function(b){var c,d;var f=0;var h=[];var k=new Map;b.forEach(function(g){var l;
d=null!==(l=k.get(g))&&void 0!==l?l:0;k.set(g,d+1)});f=(c=Math).max.apply(c,N(k.values()));k.forEach(function(g,l){g===f&&h.push(l)});return h}},{key:"isFloat",value:function(b){var c;if(window.isNaN(c=window.parseFloat(b))||Math.floor(c)==c)return!1;if(b.endsWith("%")){if(100<c)return!1}else if(b.endsWith("\u2030")){if(1E3<c)return!1}else return!1;return!0}},{key:"getLegalSize",value:function(b,c){if(!b||!c||b[0]<=c[0]&&b[1]<=c[1])return b;var d=[];var f=b[0]/b[1];var h=1<=c[0]/c[1]?1:0;var k=Number(!h);
b[h]>c[h]?(d[h]=c[h],d[k]=0===h?c[h]/f:c[h]*f):d=b;return d}},{key:"intervalJudgment",value:function(b,c){c=c.replace(/ /g,"").toLowerCase();var d={"(":">",")":"<","[":">=","]":"<="};var f=c[0];var h=c.slice(-1);var k=Object.keys(d);c=c.slice(1,-1).split(",");c[0]=Number(c[0]);c[1]=Number(c[1]);return k.includes(f)||k.includes(h)?(new Function('"use strict"; return '+(b+d[f]+c[0]+"&&"+b+d[h]+c[1])))():!1}},{key:"insideRect",value:function(b,c){var d=c[0];c=c[1];return b[0]<d[0]||b[1]<d[1]||b[0]>c[0]||
b[1]>c[1]?!1:!0}}]);return e}();Object.defineProperty(U._assistant,"number",{value:Ea});
var Fa=function(){function e(){P(this,e)}Q(e,null,[{key:"base64Encode",value:function(b){return window.btoa(window.unescape(window.encodeURIComponent(b)))}},{key:"base64Decode",value:function(b){return window.decodeURIComponent(window.escape(window.atob(b)))}},{key:"replace",value:function(b,c,d){var f=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,h,k,g;var l=Array.isArray(b);var m=Array.isArray(c);var p=Array.isArray(d);if(m&&p&&c.length!==d.length)throw Error("The number of search strings does not match the number of replacement strings.");
var v=[];b=l?b:[b];c=m?c:[c];d=p?d:[d];var u=h=k=g=0;do{var q=c[g];var r=d[p?g:0];var t=0===g?b[k]:v[k];var x=h;var z=t.indexOf(q,h);-1===z?m&&g<c.length-1?(h=0,g++):l&&k<b.length-1?(k++,h=g=0):h=!1:(h=z+q.length,v[k]=t.substring(x,z)+r+t.substring(h))}while(!1!==h||0!==f&&u<f);return l?v:v.shift()}},{key:"colorConvert",value:function(b){b=b.toLowerCase();var c=Error("Not a legal color.");if(0===b.indexOf("#")){var d="rgba(";b=b.substring(1);3===b.length&&(b=b.split("").reduce(function(h,k){return h+
k+k},""));if(6===b.length)for(c=0;3>c;c++)d+=Number("0x"+b[2*c]+b[2*c+1])+", ";else throw c;d+="255)"}else if(0===b.indexOf("rgb")){d="#";b=b.replace(/(rgb\(|rgba\(|\)| )/g,"").split(",");for(var f=0;3>f;f++)c=Number(b[f]).toString(16),d+=1===c.length?c+c:c}else throw c;return d}}]);return e}();Object.defineProperty(U._assistant,"string",{value:Fa});
var Ga=function(){function e(){P(this,e)}Q(e,null,[{key:"isOverflow",value:function(b,c){b=b.getBoundingClientRect();c=c.getBoundingClientRect();return b.x<c.x||b.x+b.width>c.x+c.width||b.y<c.y||b.y+b.height>c.y+c.height?!0:!1}},{key:"getAllElement",value:function(b){var c=[];b=b.children;if(0!==b.length)for(var d=0;d<b.length;d++)c.push(b[d]),c=c.concat(e.getAllElement(b[d]));return c}},{key:"getNodeHeight",value:function(b){return b.offsetTop+b.offsetHeight+parseInt(getComputedStyle(b,null).marginBottom)}},
{key:"getBeforeElementHeight",value:function(b){var c;for(c=0;(b=b.previousElementSibling)&&!["absolute","fixed"].includes(getComputedStyle(b,null).position);)c+=b.offsetHeight;return c}},{key:"getNodeOriginalSize",value:function(b){var c=[0,0];e.getAllElement(b).forEach(function(d){"absolute"!=getComputedStyle(d,null).position&&(c[0]=d.offsetWidth>c[0]?d.offsetWidth:c[0],d.parentNode===b&&(c[1]+=d.offsetHeight))});return c}},{key:"maxZIndex",value:function(){var b=Array.from(document.all);return parseInt(b.reduce(function(c,
d){d=getComputedStyle(d,null).zIndex;return Math.max(c,isNaN(d)?0:d)},0))}},{key:"eventTarget",value:function(b,c,d){var f=3<arguments.length&&void 0!==arguments[3]?arguments[3]:void 0,h=4<arguments.length&&void 0!==arguments[4]?arguments[4]:void 0,k=5<arguments.length&&void 0!==arguments[5]?arguments[5]:!1;Array.isArray(h)||(h=[h]);b.addEventListener(d,function(g){if(g.target===b||g.target.contains(b))return!1;var l=Array.from(b.querySelectorAll(c));if(-1!==l.indexOf(g.target))f.apply(g.target,h);
else for(g=g.target.parentNode;g&&g!==b;)if(-1!==l.indexOf(g)){f.apply(g,h);break}else g=g.parentNode},k)}},{key:"objectToNode",value:function(b){var c={},d;for(d in b){var f=document.createElement(b[d].nodeType);if("undefined"!=typeof b[d].nodeType){for(var h in b[d])if("nodeType"!=h)if("innerhtml"==h.toLocaleLowerCase()){var k=e.objectToNode(b[d][h]),g;for(g in k)f.insertAdjacentElement("beforeend",k[g])}else"innertext"==h.toLocaleLowerCase()?f.insertAdjacentText("beforeend",b[d][h]):f.setAttribute(h,
b[d][h]);c[d]=f}}return c}},{key:"launchFullscreen",value:function(b){return b.requestFullscreen(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{navigationUI:"show"})}},{key:"exitFullscreen",value:function(){document.exitFullscreen()}},{key:"getFullscreenNode",value:function(){return document.fullscreenElement}},{key:"createScript",value:function(b){var c=document.createElement("script");"src type async defer charset innerHTML".split(" ").forEach(function(d){b[d]&&(c[d]=b[d])});return c}}]);
return e}();Object.defineProperty(U._assistant,"element",{value:Ga});var Ia=function Ha(){P(this,Ha)};
R(Ia,"gaussian",{sigma:0,cache:{},setSigma:function(e){this.sigma!=e&&(this.sigma=e,this.cache.sigmaSquare=e*e,this.cache["const"]=[1/(e*Math.sqrt(2*Math.PI)),1/(2*Math.PI*this.cache.sigmaSquare)])},getDistribution:function(e,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:2;b!=this.sigma&&this.setSigma(b);switch(c){case 1:var d=Math.exp(-(e*e)/(2*this.cache.sigmaSquare));break;case 2:d=Math.exp(-(Math.pow(e[0],2)+Math.pow(e[1],2))/(2*this.cache.sigmaSquare))}return this.cache["const"][c-
1]*d}});Object.defineProperty(U._assistant,"formula",{value:Ia});
var Ja=function(){function e(){P(this,e)}Q(e,null,[{key:"download",value:function(b){var c,d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"canvas",f=b.toDataURL(2<arguments.length?arguments[2]:void 0);e.a=null!==(c=e.a)&&void 0!==c?c:document.createElement("a");e.a.href=f;e.a.download=d;e.a.click()}},{key:"drawDashRound",value:function(b,c,d,f){var h=5/180*Math.PI*2;for(var k=0,g=h/2;360>=g;k+=h,g+=h)b.beginPath(),b.arc(c,d,f,k,g),b.stroke()}}]);return e}();R(Ja,"downloadNode",document.createElement("a"));
Object.defineProperty(U._assistant,"canvas",{value:Ja});
var Ka=function(){function e(){P(this,e)}Q(e,null,[{key:"functionMeasure",value:function(b,c){var d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1;var f=[];for(var h=0;h<d;h++)performance.mark("function-start"),b.apply(null,c),performance.mark("function-ended"),performance.measure("function","function-start","function-ended"),f.push(performance.getEntriesByName("function")[0]),performance.clearMarks(),performance.clearMeasures();return f}},{key:"getAnalysis",value:function(b){var c=0;var d=
Object.create(null);d.measures=b;d.duration=[];for(var f=0;f<b.length;f++)c+=b[f].duration,d.duration[f]=b[f].duration;d.totalTime=c;d.avgTime=c/b.length;d.modeTime=Ea.getMode(d.duration);d.medianTime=Ea.getMedian(d.duration);return d}}]);return e}();Object.defineProperty(U._assistant,"performance",{value:Ka});
var La=function(){function e(){P(this,e)}Q(e,null,[{key:"getImagedata",value:function(b){if(b instanceof Image){var c=document.createElement("canvas");var d=c.getContext("2d");d.drawImage(b,0,0);b=d.getImageData(0,0,c.width,c.height)}else if(!(b instanceof ImageData))throw Error("can not parse image");return b}},{key:"grayscale",value:function(b){try{var c=e.getImagedata(b);var d=c.width*c.height*4;var f=new Uint8ClampedArray(c.data.length);for(b=0;b<d;b+=4){var h=c.data[b];var k=c.data[b+1];var g=
c.data[b+2];var l=c.data[b+3];var m=.299*h+.587*k+.114*g;f[b]=m;f[b+1]=m;f[b+2]=m;f[b+3]=l}}catch(p){throw p;}return new ImageData(f,c.width,c.height)}},{key:"gaussianBlur",value:function(b){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:3,d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,f,h,k,g,l;try{var m=e.getImagedata(b);var p=m.width;var v=m.height;var u=0;if(e.__gaussianMask["".concat(c,",").concat(d)])var q=e.__gaussianMask["".concat(c,",").concat(d)];else{q=[];for(l=
-c;l<=c;l++){var r=Ia.gaussian.getDistribution(l,d,1);q.push(r);u+=r}for(r=0;r<q.length;r++)q[r]/=u;e.__gaussianMask["".concat(c,",").concat(d)]=q}var t=new Uint8ClampedArray(m.data.length);for(g=0;g<v;g++)for(k=0;k<p;k++){var x=f=h=u=0;var z=4*(g*p+k);for(d=-c;d<=c;d++){var L=k+d;l=d+c;if(0<=L&&L<p){var w=4*(g*p+L);x+=m.data[w]*q[l];f+=m.data[w+1]*q[l];h+=m.data[w+2]*q[l];u+=q[l]}}t[z]=x/u;t[z+1]=f/u;t[z+2]=h/u;t[z+3]=m.data[z+3]}for(k=0;k<p;k++)for(g=0;g<v;g++){x=f=h=u=0;z=4*(g*p+k);for(m=-c;m<=
c;m++)L=g+m,l=m+c,0<=L&&L<v&&(w=4*(L*p+k),x+=t[w]*q[l],f+=t[w+1]*q[l],h+=t[w+2]*q[l],u+=q[l]);t[z]=x/u;t[z+1]=f/u;t[z+2]=h/u}}catch(y){throw y;}return new ImageData(t,p,v)}},{key:"mirror",value:function(b){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,d,f;try{var h=e.getImagedata(b);var k=h.width;var g=h.height;var l=new Uint8ClampedArray(h.data.length);for(f=0;f<g;f++)for(d=0;d<k;d++){var m=4*(f*k+d);if(0==c)var p=4*(f*k+k-d);else if(1==c)p=4*((g-f)*k+d);else throw Error("not give axis");
l[m]=h.data[p];l[m+1]=h.data[p+1];l[m+2]=h.data[p+2];l[m+3]=h.data[p+3];l[p]=h.data[m];l[p+1]=h.data[m+1];l[p+2]=h.data[m+2];l[p+3]=h.data[m+3]}}catch(v){throw v;}return new ImageData(l,k,g)}}]);return e}();R(La,"__gaussianMask",{});Object.defineProperty(U._assistant,"canvasFilter",{value:La});
var Ma=function(){function e(){P(this,e)}Q(e,null,[{key:"fade",value:function(b){var c,d,f,h,k,g,l,m,p=this,v;if(void 0===this.cache.fade||null===this.cache.fade)this.cache.fade=new Map;var u=v=0;var q="animation-fade-"+Date.now()+"-"+performance.now()+(b.sign?"-"+b.sign:"");var r=b.canvas;var t=[r.width/2,r.height/2];var x=r.getContext("2d");b["char"]=null!==(c=b["char"])&&void 0!==c?c:"!?";b.size=b.size?Array.isArray(b.size)?b.size:[b.size]:t[1];b.color=b.color?Array.isArray(b.color)?b.color:[b.color]:
["rgba(220, 53, 69"];b.speed=b.speed?Array.isArray(b.speed)?b.speed:[b.speed]:[250];b.family=b.family?Array.isArray(b.family)?b.family:[b.family]:["Microsoft YaHei"];b.color.map(function(M){if(0===M.indexOf("rgba"))return M.substring(0,M.lastIndexOf(","));if(0===M.indexOf("rgb"))return"rgba"+M.substring(3,M.lastIndexOf(","))});var z=null!==(d=this.cache.fade.get(JSON.stringify(b)))&&void 0!==d?d:[];var L=z.length?!0:!1;var w={direction:1,text:null!==(f=b.text)&&void 0!==f?f:"",opacity:{value:0,max:1E3},
size:{value:b.size,index:0},"char":{value:b["char"],index:0},color:{value:b.color,index:0},speed:{value:b.speed,index:0},family:{value:b.family,index:0},round:{x:null!==(h=b.round.x)&&void 0!==h?h:t[0],y:null!==(k=b.round.y)&&void 0!==k?k:t[1]-20,radius:null!==(g=b.round.radius)&&void 0!==g?g:48,color:null!==(l=b.round.color)&&void 0!==l?l:"#ddd",lineWidth:null!==(m=b.round.lineWidth)&&void 0!==m?m:5},v:function(){x.save();x.textAlign="center";x.textBaseline="middle";x.lineWidth=this.round.lineWidth;
x.strokeStyle=this.round.color;U._assistant.canvas.drawDashRound(x,this.round.x,this.round.y,this.round.radius);x.font="bold "+this.size.value[this.size.index]+"px "+this.family.value[this.family.index];x.fillStyle=this.color.value[this.color.index]+", "+this.opacity.value/this.opacity.max+")";x.fillText(this["char"].value[this["char"].index],t[0],t[1]-10);x.font="bold 16px "+this.family.value[this.family.index];x.fillStyle=this.color.value[this.color.index]+")";x.fillText(this.text,t[0],t[1]+55);
x.restore()}};var y=function(M){if(L)x.putImageData(z[u++],0,0),u=u>=z.length?0:u;else{w.speed.index=0;var W=(M-v)/1E3;for(var T;w.speed.index<w.speed.value.length-1&&!(T=1/w.speed.value.length,W>=T*w.speed.index&&W<T*(w.speed.index+1));w.speed.index++);w.opacity.value+=w.speed.value[w.speed.index]*w.direction;if(w.opacity.value>=w.opacity.max||0>=w.opacity.value)w.direction=-w.direction;0>w.opacity.value&&(w.opacity.value=0);0==w.opacity.value&&(v=M,++w.size.index===w.size.value.length&&(w.size.index=
0),++w.color.index===w.color.value.length&&(w.color.index=0),++w.family.index===w.family.value.length&&(w.family.index=0),++w["char"].index===w["char"].value.length&&(L=!0,w["char"].index=0,p.cache.fade.set(JSON.stringify(b),z)));x.clearRect(0,0,r.width,r.height);w.v();z.push(x.getImageData(0,0,r.width,r.height))}r&&0!==Number(r.getAttribute(q))?window.requestAnimationFrame(y):r.removeAttribute(q)};r.setAttribute(q,1)||y();return q}}]);return e}();R(Ma,"cache",{});
Object.defineProperty(U._assistant,"canvasAnimation",{value:Ma});
var Na=function(e){function b(){P(this,b);return c.apply(this,arguments)}J(b,e);var c=K(b);Q(b,[{key:"initOption",value:function(d){G(I(b.prototype),"initOption",this).call(this,d);this.option.layer=U._assistant.object.merge(this.option.layer,U._option.page)}},{key:"linkageOption",value:function(){G(I(b.prototype),"linkageOption",this).call(this);null!==this.option.layer.src&&null!==this.option.layer.srcdoc&&(this.option.layer.srcdoc=null)}},{key:"initStruct",value:function(){G(I(b.prototype),"initStruct",
this).call(this);var d=this.variable.struct._build.container;var f=this.variable.struct._backup.title=U._struct.title;var h=this.variable.struct._backup.action=U._struct.action;var k=this.variable.struct._backup.content=U._struct.content;var g=this.variable.struct._backup.content_page=U._struct.content_page;var l=this.variable.struct._backup.action_button=U._struct.action_button;h.innerHTML.push(l.minimize,l.expand,l.close);f.innerHTML.push(h);!1!==this.option.title&&d.innerHTML.push(f);k.innerHTML.push(g);
d.innerHTML.push(k);this.option.resize.enable&&(g=this.variable.struct._backup.resize_box=U._struct.resize_box,d.innerHTML.push(g));this.option.progress.enable&&(g=this.variable.struct._backup.progress_bar=U._struct.progress_bar,d.innerHTML.push(g))}},{key:"initNode",value:function(){var d=this;G(I(b.prototype),"initNode",this).call(this);var f=this.variable.nodes.container.querySelector(".modal-layer-page-content");var h="display: block; width: "+this.option.layer.area[0]+"px; height: "+this.option.layer.area[1]+
"px";Object.keys(this.option.layer).forEach(function(g){U._assistant.object.isEmpty(d.option.layer[g])||("name"===g?f.setAttribute("name",d.option.layer.name+d.option.index):f.setAttribute(g,d.option.layer[g]))});f.style=h;this.variable.animationName.minimize_queue_transition_scale="transition-scale-50-50-animation";if(!U._assistant.css.hasCss("transition-scale-50-50-animation")){var k={from:"transform: scale(0.5, 0.5)",to:"transform: scale(1, 1)"};h=U._assistant.css.createAnimation("transition-scale-50-50-animation",
k);U._assistant.css.addCss("transition-scale-50-50-animation",h);U._assistant.css.addCss("transition-scale-50-50-animation-reverse",U._assistant.css.createAnimation("transition-scale-50-50-animation-reverse",{from:k.m,m:k.from}))}}},{key:"resize",value:function(){var d=0;var f=this.variable.nodes.container;var h=f.children;var k=f.querySelector("iframe[name="+this.option.layer.name+this.option.index+"]");k=k.offsetWidth+2*k.parentNode.offsetLeft;for(var g=0;g<h.length;g++)d="absolute"==getComputedStyle(h[g],
null).position?d:Math.max(U._assistant.element.getNodeHeight(h[g]),d);f.style.width=k+"px";f.style.height=d+"px";this.variable.defaultArea=[k,d]}}]);return b}(U);U._achieve.set("page",Na);
var Oa=function(e){function b(){P(this,b);return c.apply(this,arguments)}J(b,e);var c=K(b);Q(b,[{key:"initStruct",value:function(){G(I(b.prototype),"initStruct",this).call(this);var d=this.variable.struct._build.container;var f=this.variable.struct._backup.title=U._struct.title;var h=this.variable.struct._backup.action=U._struct.action;var k=this.variable.struct._backup.content=U._struct.content;var g=this.variable.struct._backup.interaction=U._struct.interaction;var l=this.variable.struct._backup.action_button=
U._struct.action_button;var m=this.variable.struct._backup.interaction_button=U._struct.interaction_button;h.innerHTML.push(l.close);f.innerHTML.push(h);!1!==this.option.title&&d.innerHTML.push(f);d.innerHTML.push(k);this.option.resize.enable&&(h=this.variable.struct._backup.resize_box=U._struct.resize_box,d.innerHTML.push(h));this.option.progress.enable&&(h=this.variable.struct._backup.progress_bar=U._struct.progress_bar,d.innerHTML.push(h));g.innerHTML.push(m.ok);d.innerHTML.push(g)}},{key:"initNode",
value:function(){G(I(b.prototype),"initNode",this).call(this);var d=this.variable.nodes.container.querySelector(".modal-layer-content");if(Array.isArray(this.option.content.value)){var f=U._assistant.element.objectToNode(this.option.content.value);Object.keys(f).forEach(function(h){d.appendChild(f[h])})}else d.innerHTML=this.option.content.value}}]);return b}(U);U._achieve.set("alert",Oa);
var Qa=function(e){function b(){P(this,b);return c.apply(this,arguments)}J(b,e);var c=K(b);Q(b,[{key:"initOption",value:function(d){var f=this,h;G(I(b.prototype),"initOption",this).call(this,d);this.option.layer=U._assistant.object.merge(this.option.layer,U._option.image);var k=[window.innerWidth,window.innerHeight];Object.values(this.option.layer.sizeRange).forEach(function(g){g.forEach(function(l,m){if((""+l).endsWith("%"))h=100;else if((""+l).endsWith("\u2030"))h=1E3;else if((""+l).includes("0."))h=
1;else return l;g[m]=k[m]*window.parseFloat(l)/h})});this.option.layer.sizeRange.min[0]>this.option.layer.sizeRange.max[0]&&(this.option.layer.sizeRange.min[0]=this.option.layer.sizeRange.max[0]);this.option.layer.sizeRange.min[1]>this.option.layer.sizeRange.max[1]&&(this.option.layer.sizeRange.min[1]=this.option.layer.sizeRange.max[1]);Object.keys(this.option.layer.toolbar.config).forEach(function(g,l){l=f.option.layer.toolbar.config[g];"boolean"==typeof l&&(f.option.layer.toolbar.config[g]={enable:l,
title:U._option.image.toolbar.config[g].title,icon:U._option.image.toolbar.config[g].icon});U._assistant.object.isOnlyObject(l.config)?Object.keys(l.config).forEach(function(m,p){p=l.config[m];"boolean"==typeof p&&(f.option.layer.toolbar.config[g].config[m]={enable:p,title:U._option.image.toolbar.config[g].config[m].title,icon:U._option.image.toolbar.config[g].config[m].icon})}):U._option.image.toolbar.config[g].config&&(f.option.layer.toolbar.config[g].config=JSON.parse(JSON.stringify(U._option.image.toolbar.config[g].config)))})}},
{key:"compatibleOption",value:function(d){var f,h;G(I(b.prototype),"compatibleOption",this).call(this,d);var k=U._assistant.object.get(d,"layer.image");k instanceof FileList&&(d.layer.image=Object.values(k));Array.isArray(d.layer.image)||(d.layer.image=[d.layer.image]);var g=null!==(f=U._assistant.object.get(d,"layer.toolbar.config"))&&void 0!==f?f:[];Object.keys(g).forEach(function(m){g[m]="boolean"===typeof g[m]?{enable:g[m]}:g[m]});var l=null!==(h=U._assistant.object.get(d,"layer.toolbar.config.filter.config"))&&
void 0!==h?h:[];Object.keys(l).forEach(function(m){l[m]="boolean"===typeof l[m]?{enable:l[m]}:l[m]})}},{key:"linkageOption",value:function(){var d;G(I(b.prototype),"linkageOption",this).call(this);var f=d=!1;var h=Object.entries(this.option.layer.toolbar.config);var k=Object.entries(this.option.layer.toolbar.config.filter.config);for(var g=0;g<k.length;g++)if(!0===k[g][1].enable){d=!0;break}this.option.layer.toolbar.config.filter.enable=d;for(d=0;d<h.length;d++)if(!0===h[d][1].enable){f=!0;break}this.option.layer.toolbar.enable=
f}},{key:"checkOption",value:function(){G(I(b.prototype),"checkOption",this).call(this);if(U._assistant.object.isEmpty(this.option.layer.image))throw Error("layer.image can not be empty!");if(this.option.layer.size&&!Array.isArray(this.option.layer.size))throw Error("layer.size does not meet expectations.");if(!this.option.layer.size&&(window.isNaN(parseInt(this.option.layer.sizeRange.min[0]))||window.isNaN(parseInt(this.option.layer.sizeRange.min[1]))||window.isNaN(parseInt(this.option.layer.sizeRange.max[0]))||
window.isNaN(parseInt(this.option.layer.sizeRange.max[1]))))throw Error("layer.sizeRange does not meet expectations.");}},{key:"initVariable",value:function(){G(I(b.prototype),"initVariable",this).call(this);this.variable.image={spin:{total:0,angle:90,backup:null},"default":{size:null,imageData:null},reload:0,link:null,history:[],finish:null,status:U._enum.LOAD_STATUS.LOADING}}},{key:"initStruct",value:function(){var d=this;G(I(b.prototype),"initStruct",this).call(this);var f=this.variable.struct._build.container;
var h=this.variable.struct._backup.title=U._struct.title;var k=this.variable.struct._backup.action=U._struct.action;var g=this.variable.struct._backup.toolbar=U._struct.toolbar;var l=this.variable.struct._backup.tools=U._struct.image_tools;var m=this.variable.struct._backup.content=U._struct.content;var p=this.variable.struct._backup.action_button=U._struct.action_button;var v=this.variable.struct._backup.content_image=U._struct.content_image;var u=this.variable.struct._backup.image_tools_child=U._struct.image_tools_child;
var q=this.variable.struct._backup.content_image_hidden=U._struct.content_image_hidden;k.innerHTML.push(p.close);h.innerHTML.push(k);!1!==this.option.title&&f.innerHTML.push(h);Object.keys(this.option.layer.toolbar.config).forEach(function(r){d.option.layer.toolbar.config[r].enable&&g.innerHTML.push(l[r]);d.option.layer.toolbar.config[r].config instanceof Object&&d.option.layer.toolbar.config[r].enable&&Object.keys(d.option.layer.toolbar.config[r].config).forEach(function(t){l[r].innerHTML[1].innerHTML.push(u[r][t])})});
this.option.layer.toolbar.enable&&f.innerHTML.push(g);m.innerHTML.push(v);m.innerHTML.push(q);f.innerHTML.push(m);this.option.resize.enable&&(k=this.variable.struct._backup.resize_box=U._struct.resize_box,f.innerHTML.push(k));this.option.progress.enable&&(k=this.variable.struct._backup.progress_bar=U._struct.progress_bar,f.innerHTML.push(k))}},{key:"initNode",value:function(){var d=this;G(I(b.prototype),"initNode",this).call(this);var f=this.variable.nodes.container;var h=f.querySelector(".modal-layer-toolbar");
this.option.layer.toolbar.enable&&Object.keys(this.option.layer.toolbar.config).forEach(function(k,g){g=d.option.layer.toolbar.config[k];if(g.enable){var l;var m=h.querySelector('.modal-layer-toolbar-item[tool-type="'+k+'"]');var p=m.querySelector(".modal-layer-toolbar-item-icon");m.setAttribute("title",g.title);(l=p.classList).add.apply(l,N(g.icon.split(" ")));g.config instanceof Object&&Object.entries(g.config).forEach(function(v,u){u=v[0];v=v[1];if(v.enable){var q=m.querySelector(".modal-layer-toolbar-item-child-list");
u=m.querySelector(".modal-layer-toolbar-"+k+"-icon["+k+'-type="'+u+'"]');q.setAttribute("title",v.title);v.icon&&(u.innerText=v.icon)}})}});this.load().then(function(k){return d.loaded(k)})["catch"](function(){var k=f.querySelector(".modal-layer-image-canvas");d.variable.image.status=U._enum.LOAD_STATUS.FAILED;k.setAttribute("load-status",U._assistant.object.getKeyByValue(U._enum.LOAD_STATUS,U._enum.LOAD_STATUS.FAILED));d.variable.image.fadeAttr=U._assistant.canvasAnimation.fade({size:72,"char":"!?",
canvas:k,sign:"load-failed",speed:[25,20,20,25],family:"Microsoft YaHei",text:"\u56fe\u7247\u52a0\u8f7d\u5931\u8d25, \u8bf7\u70b9\u51fb\u91cd\u8bd5.",round:{G:50,lineWidth:5,color:"rgb(230, 230, 230)"}});d.variable.image.link&&d.variable.image.link.startsWith("blob:")&&URL.revokeObjectURL(d.variable.image.link);d.variable.image.layer&&d.variable.image.layer instanceof Pa&&d.variable.image.layer.remove()})}},{key:"bindEvent",value:function(){var d=this;G(I(b.prototype),"bindEvent",this).call(this);
var f=this.variable.nodes.container;var h=U._assistant.object.getKeyByValue(U._enum.LOAD_STATUS,U._enum.LOAD_STATUS.FAILED);U._assistant.element.eventTarget(f,'.modal-layer-image-canvas[load-status="'+h+'"]',"click",this.reload,this);Object.keys(this.event.imageTools).forEach(function(k){d.event.imageTools[k]&&d.event.imageTools[k]instanceof Function&&U._assistant.element.eventTarget(f,'.modal-layer-toolbar-item[tool-type="'+k+'"]',"click",d.event.imageTools[k],d)})}},{key:"resize",value:function(){var d=
this.variable.nodes.container;var f=d.querySelector(".modal-layer-content");var h=f.querySelector(".modal-layer-image-canvas");if(this.option.layer.size)var k=this.option.layer.size;else{var g=window.getComputedStyle(f,null);var l=U._assistant.element.getBeforeElementHeight(f);f=f.offsetTop-l;l+=this.option.content.fullContainer?0:2*f;this.variable.image.status!==U._enum.LOAD_STATUS.LOADING?k=[h.width,h.height]:k=N(this.option.layer.sizeRange.min);k[0]+=parseFloat(g.marginLeft)+parseFloat(g.marginRight);
k[1]+=l}this.variable.defaultArea=k;d.style.width=k[0]+"px";d.style.height=k[1]+"px";!this.option.drag.overflow&&U._assistant.element.isOverflow(d,this.option.window)&&(d.style.cssText+="margin-top: auto; margin-left: auto")}},{key:"load",value:function(){var d=this,f=this.variable.nodes.container.querySelector(".modal-layer-image-canvas");this.variable.image.status=U._enum.LOAD_STATUS.LOADING;f.setAttribute("load-status",U._assistant.object.getKeyByValue(U._enum.LOAD_STATUS,U._enum.LOAD_STATUS.LOADING));
this.variable.image.layer=U.loading({mask:!1,popupTime:0,layer:{icon:1,duration:1,color:"deepskyblue"},window:this.variable.nodes.container},function(h){throw h;});return this.variable.image.finish=new Promise(function(h,k){var g=new Image;d.variable.image.link=U._assistant.file.getImage(d.option.layer.image[d.variable.image.reload++]);g.onload=function(){return h(g)};g.onerror=k;g.src=d.variable.image.link})}},{key:"reload",value:function(){var d=this;this.variable.nodes.container.querySelector(".modal-layer-image-canvas").setAttribute("load-status",
U._assistant.object.getKeyByValue(U._enum.LOAD_STATUS,U._enum.LOAD_STATUS.LOADING));this.variable.image.status=U._enum.LOAD_STATUS.LOADING;return this.variable.image.finish=new Promise(function(f,h){for(var k=new Image;!1===d.variable.image.link&&d.variable.image.reload<d.option.layer.image.length;)d.variable.image.link.startsWith("blob:")&&URL.revokeObjectURL(d.variable.image.link),d.variable.image.link=U._assistant.file.getImage(d.option.layer.image[d.variable.image.reload++]);k.onload=function(){return f(k)};
k.onerror=h;k.src=d.variable.image.link})}},{key:"loaded",value:function(d){var f=this;var h=this.variable.nodes.container;var k=h.querySelector(".modal-layer-image-canvas");h=h.querySelector(".modal-layer-image-hidden");this.variable.image.status=U._enum.LOAD_STATUS.LOADED;this.variable.image["default"].size=this.option.layer.size?this.option.layer.size:d.naturalWidth>this.option.layer.sizeRange.max[0]||d.naturalHeight>this.option.layer.sizeRange.max[1]?U._assistant.number.getLegalSize([d.naturalWidth,
d.naturalHeight],this.option.layer.sizeRange.max):[d.naturalWidth,d.naturalHeight];k.width=this.variable.image["default"].size[0];k.height=this.variable.image["default"].size[1];this.variable.image.fadeAttr&&k.setAttribute(this.variable.image.fadeAttr,0);k.setAttribute("load-status",U._assistant.object.getKeyByValue(U._enum.LOAD_STATUS,U._enum.LOAD_STATUS.LOADED));d.style.cssText="opacity: 0;visibility: hidden;position: relative;z-index: -1;pointer-events: none;";h.appendChild(d);window.requestAnimationFrame(function(){var g,
l;f.variable.image.layer&&f.variable.image.layer instanceof Pa&&f.variable.image.layer.hide();(g=k.getContext("2d")).drawImage.apply(g,[d,0,0,d.width,d.height,0,0].concat(N(f.variable.image["default"].size)));f.variable.image["default"].imageData=(l=k.getContext("2d")).getImageData.apply(l,[0,0].concat(N(f.variable.image["default"].size)))})}},{key:"failed",value:function(){var d=this.variable.nodes.container.querySelector(".modal-layer-image-canvas");d.setAttribute("load-status",U._assistant.object.getKeyByValue(U._enum.LOAD_STATUS,
U._enum.LOAD_STATUS.FAILED));this.variable.image.status=U._enum.LOAD_STATUS.FAILED;U._assistant.canvasAnimation.fade({size:80,"char":"\u00d7",canvas:d,speed:10,family:"Microsoft YaHei",sign:"finally-load-failed",text:"\u56fe\u7247\u52a0\u8f7d\u5931\u8d25, \u8bf7\u8054\u7cfb\u7ba1\u7406\u5458.",round:{G:50,lineWidth:5,y:d.height/2-15,color:"rgb(230, 230, 230)"}});this.variable.image.link&&this.variable.image.link.startsWith("blob:")&&URL.revokeObjectURL(this.variable.image.link);this.variable.image.layer&&
this.variable.image.layer instanceof Pa&&this.variable.image.layer.hide()}},{key:"removeAllEvent",value:function(){var d=this,f=this.variable.nodes.container;G(I(b.prototype),"removeAllEvent",this).call(this);f.removeEventListener("click",this.reload);Object.keys(this.event.imageTools).forEach(function(h){d.event.imageTools[h]&&d.event.imageTools[h]instanceof Function&&f.removeEventListener("click",d.event.imageTools[h])})}},{key:"crop",value:function(){var d=this,f,h,k,g,l,m;var p=!0;var v=this.variable.nodes.container.querySelector(".modal-layer-image-canvas");
var u=v.width;var q=v.height;var r=v.cloneNode();var t=r.getContext("2d");var x=Math.floor(.1*u);var z=Math.floor(.1*q);var L="display: block; position: fixed; top: 0px; bottom: 0px; left: 0px; right: 0px; visibility: visible; opacity: 1; border: 0px; margin: 0px; z-index: "+U._assistant.element.maxZIndex()+";";r.width=window.innerWidth;r.height=window.innerHeight;r.style.cssText=L;var w=[(r.width-u)/2,(r.height-q)/2];var y=[0,0,v.width,v.height].concat(N(w),[v.width,v.height]);var M=[w[0],(r.height+
q)/2+22];var W=function(){t.save();t.clearRect(0,0,r.width,r.height);t.drawImage.apply(t,[v].concat(N(w)));t.fillStyle="rgba(0, 0, 0, 0.35)";t.fillRect(0,0,r.width,r.height);t.fillStyle="white";t.font="22px serif";t.fillText.apply(t,["\u53cc\u51fb\u9f20\u6807\u5de6\u952e\u6216\u6309\u56de\u8f66\u622a\u53d6, ESC\u9000\u51fa."].concat(N(M)));t.drawImage.apply(t,[v].concat(N(y)));t.restore();p?f=window.requestAnimationFrame(W):window.cancelAnimationFrame(f)};var T=function(){document.removeEventListener("keyup",
za);r.removeEventListener("mousemove",Aa);r.removeEventListener("mousedown",Ba);r.removeEventListener("mouseup",Ca);r.removeEventListener("dbclick",oa);p=!1;r.remove()};var oa=function(){T();v.width=y[2];v.height=y[3];v.getContext("2d").drawImage(r,y[4],y[5],v.width,v.height,0,0,v.width,v.height);d.resize()};var za=function(A){switch(A.code){case "Enter":oa();A.preventDefault();break;case "Escape":T(),A.preventDefault()}};var Ca=function(){h=!1;k=g=null};var Ba=function(A){k=[A.x,A.y];h=l||m?!0:!1;
g=[y[4],y[5],y[2],y[3]];k[0]=l?A.x>=y[4]-10&&A.x<=y[4]+10?y[4]:y[2]+y[4]:A.x;k[1]=m?A.y>=y[5]-10&&A.y<=y[5]+10?y[5]:y[3]+y[5]:A.y};var Aa=function(A){var F;A=null!==(F=A)&&void 0!==F?F:window.event;F=[A.x,A.y];if(h&&1===A.buttons){if(l){A=k[0]-F[0];if(k[0]===g[0]){var H=g[0]-A;var C=g[2]+A;A=g[0]-w[0]-A;C<x?C=x:C>u&&(C=u);H<w[0]?(A=0,H=w[0]):H>w[0]+u-x&&(A=u-x,H=w[0]+u-x);y[4]=H;y[0]=A}else C=g[2]-A,C<x?C=x:C>u&&(C=u);y[2]=y[6]=C}m&&(F=k[1]-F[1],k[1]===g[1]?(A=g[1]-F,H=g[3]+F,F=g[1]-w[1]-F,H<z?H=
z:H>q&&(H=q),A<w[1]?(F=0,A=w[1]):A>w[1]+q-z&&(F=q-z,A=w[1]+q-z),y[5]=A,y[1]=F):(H=g[3]-F,H<z?H=z:H>q&&(H=q)),y[3]=y[7]=H)}else{l=m=!1;C=[y[4],y[5]];A=[[C[0]-5,C[1]-5],[C[0]+y[2]+5,C[1]+5]];var X=[[C[0]-5,C[1]-5],[C[0]+5,C[1]+y[3]+5]];H=[[C[0]+y[2]-5,C[1]-5],[C[0]+y[2]+5,C[1]+y[3]+5]];C=[[C[0]-5,C[1]+y[3]-5],[C[0]+y[2]+5,C[1]+y[3]+5]];A=U._assistant.number.insideRect(F,A);X=U._assistant.number.insideRect(F,X);H=U._assistant.number.insideRect(F,H);F=U._assistant.number.insideRect(F,C);X&&A||H&&F?(l=
m=!0,r.style.cssText+="cursor: nwse-resize"):H&&A||X&&F?(l=m=!0,r.style.cssText+="cursor: nesw-resize"):X||H?(l=!0,m=!1,r.style.cssText+="cursor: ew-resize"):A||F?(m=!0,l=!1,r.style.cssText+="cursor: ns-resize"):(l=m=!1,r.style.cssText+="cursor: default")}};W();document.addEventListener("keyup",za);r.addEventListener("mousemove",Aa);r.addEventListener("mousedown",Ba);r.addEventListener("mouseup",Ca);r.addEventListener("dblclick",oa);document.body.appendChild(r)}},{key:"spin",value:function(){this.variable.nodes.container.querySelector(".modal-layer-image-canvas").getContext("2d")}},
{key:"filter",value:function(d){var f=this,h,k;var g=this.variable.nodes.container.querySelector(".modal-layer-image-canvas");if(0!=g.getAttribute("load-status")){var l=g.getContext("2d");var m=d.getAttribute("filter-type");var p=l.getImageData(0,0,g.width,g.height);this.variable.image.layer.show();if(U._env.feature.worker){var v="image-layer-worker-"+Date.now();var u="!"+U._worker.get("canvasFilter").toString()+"()";u=URL.createObjectURL(new Blob(u.split(""),{type:"text/javascript"}));U._assistant.worker.has(v)||
U._assistant.worker.create(v,u);U._assistant.worker.listener(v).then(function(q){0==q.data.error?l.putImageData(new ImageData(new Uint8ClampedArray(q.data.buffer),g.width,g.height),0,0):console.error(Error(q.data.message));f.variable.image.layer.hide();U._assistant.worker.close(v)})}null===(h=(k={blur:function(){var q,r;var t=null!==(q=Number(d.getAttribute("data-sigma")))&&void 0!==q?q:1;q=null!==(r=Number(d.getAttribute("data-radius")))&&void 0!==r?r:3;if(U._env.feature.worker){var x;if(U._assistant.canvasFilter.__gaussianMask[["".concat(q,
",").concat(t)]])var z=U._assistant.canvasFilter.__gaussianMask[["".concat(q,",").concat(t)]];else{r=0;z=[];for(x=-q;x<=q;x++){var L=U._assistant.formula.gaussian.getDistribution(x,t,1);z.push(L);r+=L}for(x=0;x<z.length;x++)z[x]/=r;U._assistant.canvasFilter.__gaussianMask[["".concat(q,",").concat(t)]]=z}U._assistant.worker.get(v).postMessage({sigma:t,radius:q,type:m,gaussianMask:z,buffer:p.data.buffer,size:[g.width,g.height]},[p.data.buffer])}else p=U._assistant.canvasFilter.gaussianBlur(p,q,t),l.putImageData(p,
0,0),f.variable.image.layer.hide()},gray:function(){U._env.feature.worker?U._assistant.worker.get(v).postMessage({type:m,buffer:p.data.buffer},[p.data.buffer]):(p=U._assistant.canvasFilter.grayscale(l.getImageData(0,0,g.width,g.height)),l.putImageData(p,0,0),f.variable.image.layer.hide())},mirror:function(){var q,r=null!==(q=Number(d.getAttribute("mirror-axis")))&&void 0!==q?q:0;U._env.feature.worker?U._assistant.worker.get(v).postMessage({axis:r,type:m,buffer:p.data.buffer,size:[g.width,g.height]},
[p.data.buffer]):(p=U._assistant.canvasFilter.mirror(l.getImageData(0,0,g.width,g.height),r),l.putImageData(p,0,0),f.variable.image.layer.hide())}})[m])||void 0===h?void 0:h.call(k)}}},{key:"revert",value:function(){var d=this;var f=this.variable.nodes.container.querySelector(".modal-layer-image-canvas");var h=f.getContext("2d");this.variable.image.finish.then(function(){d.variable.image.spin.total=0;f.width=d.variable.image["default"].size[0];f.height=d.variable.image["default"].size[1];h.putImageData(d.variable.image["default"].imageData,
0,0);d.resize()})}},{key:"download",value:function(){U._assistant.canvas.download(this.variable.nodes.container.querySelector(".modal-layer-image-canvas"),this.option.title,"image/png")}}]);return b}(U);U._achieve.set("image",Qa);
var Ra=function(e){function b(){P(this,b);return c.apply(this,arguments)}J(b,e);var c=K(b);Q(b,[{key:"initStruct",value:function(){G(I(b.prototype),"initStruct",this).call(this);this.variable.struct._backup.interaction.innerHTML.push(this.variable.struct._backup.interaction_button.cancel)}}]);return b}(Oa);U._achieve.set("prompt",Ra);
var Sa=function(e){function b(){P(this,b);return c.apply(this,arguments)}J(b,e);var c=K(b);Q(b,[{key:"initStruct",value:function(){G(I(b.prototype),"initStruct",this).call(this);this.variable.struct._backup.interaction.innerHTML.push(this.variable.struct._backup.interaction_button.no)}}]);return b}(Oa);U._achieve.set("confirm",Sa);
var Pa=function(e){function b(){P(this,b);return c.apply(this,arguments)}J(b,e);var c=K(b);Q(b,[{key:"initOption",value:function(d){G(I(b.prototype),"initOption",this).call(this,d);this.option.layer=U._assistant.object.merge(this.option.layer,U._option.loading);this.option.title=!1;this.option.drag.enable=!1;this.option.resize.enable=!1;this.option.progress.enable=!1}},{key:"compatibleOption",value:function(d){var f={center:"center",right:"flex-end",left:"flex-start"};G(I(b.prototype),"compatibleOption",
this).call(this,d);if(!U._assistant.object.isEmpty(d.layer.position)){Array.isArray(d.layer.position)||(d.layer.position=[d.layer.position,d.layer.position]);for(var h=0;2>h;h++)d.layer.position[h]=f[d.layer.position[h]]}}},{key:"checkOption",value:function(){G(I(b.prototype),"checkOption",this).call(this);if(!Array.isArray(this.option.layer.position)&&!["left","center","right"].includes(this.option.layer.position))throw Error("layer.position does not meet expectations");}},{key:"initStruct",value:function(){G(I(b.prototype),
"initStruct",this).call(this);var d=this.variable.struct._build.container;var f=this.variable.struct._backup.content=U._struct.content;var h=this.variable.struct._backup.content_loading=U._struct.content_loading;var k=this.variable.struct._backup.content_loading_icon=U._struct.content_loading_icon;window.isNaN(Number(this.option.layer.icon))?h.innerHTML[0]["class"]+=" "+this.option.layer.icon:h.innerHTML[0]=k[this.option.layer.icon];f.innerHTML.push(h);d.innerHTML.push(f)}},{key:"initNodeFinally",
value:function(){G(I(b.prototype),"initNodeFinally",this).call(this);var d=this.variable.nodes.container;var f=d.querySelector(".modal-layer-content");var h=f.querySelector(".modal-layer-loading-icon");var k=f.querySelector(".modal-layer-loading-box");d.style.cssText+="background: transparent; box-shadow: none;";f.style.cssText+="background: "+this.option.layer.background;k.style.cssText="justify-content: "+this.option.layer.position[0]+"; align-items: "+this.option.layer.position[1];h.style.cssText+=
"font-size: "+this.option.layer.size+"px; width: "+this.option.layer.area[0]+"px; height: "+this.option.layer.area[1]+"px; color: "+this.option.layer.color+"; animation-duration: "+this.option.layer.duration+"s;";U._assistant.object.isEmpty(this.option.layer.rate)||(h.style.animationTimingFunction=this.option.layer.rate)}}]);return b}(U);U._achieve.set("loading",Pa);
var Ta=function(e){function b(){P(this,b);return c.apply(this,arguments)}J(b,e);var c=K(b);Q(b,[{key:"initOption",value:function(d){G(I(b.prototype),"initOption",this).call(this,d);this.option.title=!1;this.option.drag.enable=!1;this.option.drag.overflow=!1}},{key:"initStruct",value:function(){G(I(b.prototype),"initStruct",this).call(this);var d=this.variable.struct._build.container;var f=this.variable.struct._backup.content=U._struct.content;d.innerHTML.push(f);this.option.resize.enable&&(f=this.variable.struct._backup.resize_box=
U._struct.resize_box,d.innerHTML.push(f));this.option.progress.enable&&(f=this.variable.struct._backup.progress_bar=U._struct.progress_bar,d.innerHTML.push(f))}},{key:"initNode",value:function(){G(I(b.prototype),"initNode",this).call(this);var d=this.variable.nodes.container.querySelector(".modal-layer-content");if(this.option.content.value instanceof Object){var f=U._assistant.element.objectToNode(this.option.content.value);Object.keys(f).forEach(function(h){d.appendChild(f[h])})}else d.innerHTML=
this.option.content.value}}]);return b}(U);U._achieve.set("msg",Ta);U._achieve.set("message",Ta);window.Worker&&U._worker.set("canvasFilter",function(){this.onmessage=function(e){var b,c;e=null===(b=(c=e.data).type)||void 0===b?void 0:b.call(c,e.data);this.postMessage({error:0,buffer:e?e.buffer:void 0},[e.buffer])};this.F=function(){this.postMessage({error:1,message:"Failed to send message."})}});}(window);
