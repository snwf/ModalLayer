!function(window){"use strict";var aa="function"==typeof Object.defineProperties?Object.defineProperty:function(d,a,b){if(d==Array.prototype||d==Object.prototype)return d;d[a]=b.value;return d};function ba(d){d=["object"==typeof globalThis&&globalThis,d,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var a=0;a<d.length;++a){var b=d[a];if(b&&b.Math==Math)return b}throw Error("Cannot find global object");}var ca=ba(this);
function m(d,a){if(a)a:{var b=ca;d=d.split(".");for(var c=0;c<d.length-1;c++){var e=d[c];if(!(e in b))break a;b=b[e]}d=d[d.length-1];c=b[d];a=a(c);a!=c&&null!=a&&aa(b,d,{configurable:!0,writable:!0,value:a})}}m("Reflect",function(d){return d?d:{}});
var da="function"==typeof Object.create?Object.create:function(d){function a(){}a.prototype=d;return new a},ea=function(){function d(){function b(){}new b;Reflect.construct(b,[],function(){});return new b instanceof b}if("undefined"!=typeof Reflect&&Reflect.construct){if(d())return Reflect.construct;var a=Reflect.construct;return function(b,c,e){b=a(b,c);e&&Reflect.setPrototypeOf(b,e.prototype);return b}}return function(b,c,e){void 0===e&&(e=b);e=da(e.prototype||Object.prototype);return Function.prototype.apply.call(b,
e,c)||e}}();m("Reflect.construct",function(){return ea});var fa;if("function"==typeof Object.setPrototypeOf)fa=Object.setPrototypeOf;else{var ha;a:{var ia={s:!0},ja={};try{ja.__proto__=ia;ha=ja.s;break a}catch(d){}ha=!1}fa=ha?function(d,a){d.__proto__=a;if(d.__proto__!==a)throw new TypeError(d+" is not extensible");return d}:null}var ka=fa;m("Object.setPrototypeOf",function(d){return d||ka});function la(d){var a=0;return function(){return a<d.length?{done:!1,value:d[a++]}:{done:!0}}}
m("Symbol",function(d){function a(e){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new b("jscomp_symbol_"+(e||"")+"_"+c++,e)}function b(e,f){this.a=e;aa(this,"description",{configurable:!0,writable:!0,value:f})}if(d)return d;b.prototype.toString=function(){return this.a};var c=0;return a});
m("Symbol.iterator",function(d){if(d)return d;d=Symbol("Symbol.iterator");for(var a="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),b=0;b<a.length;b++){var c=ca[a[b]];"function"===typeof c&&"function"!=typeof c.prototype[d]&&aa(c.prototype,d,{configurable:!0,writable:!0,value:function(){return ma(la(this))}})}return d});function ma(d){d={next:d};d[Symbol.iterator]=function(){return this};return d}
m("Array.from",function(d){return d?d:function(a,b,c){b=null!=b?b:function(h){return h};var e=[],f="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];if("function"==typeof f){a=f.call(a);for(var g=0;!(f=a.next()).done;)e.push(b.call(c,f.value,g++))}else for(f=a.length,g=0;g<f;g++)e.push(b.call(c,a[g],g));return e}});
function na(d,a){d instanceof String&&(d+="");var b=0,c=!1,e={next:function(){if(!c&&b<d.length){var f=b++;return{value:a(f,d[f]),done:!1}}c=!0;return{done:!0,value:void 0}}};e[Symbol.iterator]=function(){return e};return e}m("Array.prototype.keys",function(d){return d?d:function(){return na(this,function(a){return a})}});m("Object.is",function(d){return d?d:function(a,b){return a===b?0!==a||1/a===1/b:a!==a&&b!==b}});
m("Array.prototype.includes",function(d){return d?d:function(a,b){var c=this;c instanceof String&&(c=String(c));var e=c.length;b=b||0;for(0>b&&(b=Math.max(b+e,0));b<e;b++){var f=c[b];if(f===a||Object.is(f,a))return!0}return!1}});function oa(d,a,b){if(null==d)throw new TypeError("The 'this' value for String.prototype."+b+" must not be null or undefined");if(a instanceof RegExp)throw new TypeError("First argument to String.prototype."+b+" must not be a regular expression");return d+""}
m("String.prototype.includes",function(d){return d?d:function(a,b){return-1!==oa(this,a,"includes").indexOf(a,b||0)}});function z(d,a){return Object.prototype.hasOwnProperty.call(d,a)}m("Object.values",function(d){return d?d:function(a){var b=[],c;for(c in a)z(a,c)&&b.push(a[c]);return b}});function A(d){var a="undefined"!=typeof Symbol&&Symbol.iterator&&d[Symbol.iterator];return a?a.call(d):{next:la(d)}}
m("Promise",function(d){function a(g){this.c=0;this.i=void 0;this.a=[];var h=this.g();try{g(h.resolve,h.reject)}catch(k){h.reject(k)}}function b(){this.a=null}function c(g){return g instanceof a?g:new a(function(h){h(g)})}if(d)return d;b.prototype.c=function(g){if(null==this.a){this.a=[];var h=this;this.g(function(){h.i()})}this.a.push(g)};var e=ca.setTimeout;b.prototype.g=function(g){e(g,0)};b.prototype.i=function(){for(;this.a&&this.a.length;){var g=this.a;this.a=[];for(var h=0;h<g.length;++h){var k=
g[h];g[h]=null;try{k()}catch(l){this.h(l)}}}this.a=null};b.prototype.h=function(g){this.g(function(){throw g;})};a.prototype.g=function(){function g(l){return function(n){k||(k=!0,l.call(h,n))}}var h=this,k=!1;return{resolve:g(this.B),reject:g(this.h)}};a.prototype.B=function(g){if(g===this)this.h(new TypeError("A Promise cannot resolve to itself"));else if(g instanceof a)this.D(g);else{a:switch(typeof g){case "object":var h=null!=g;break a;case "function":h=!0;break a;default:h=!1}h?this.A(g):this.l(g)}};
a.prototype.A=function(g){var h=void 0;try{h=g.then}catch(k){this.h(k);return}"function"==typeof h?this.F(h,g):this.l(g)};a.prototype.h=function(g){this.m(2,g)};a.prototype.l=function(g){this.m(1,g)};a.prototype.m=function(g,h){if(0!=this.c)throw Error("Cannot settle("+g+", "+h+"): Promise already settled in state"+this.c);this.c=g;this.i=h;this.v()};a.prototype.v=function(){if(null!=this.a){for(var g=0;g<this.a.length;++g)f.c(this.a[g]);this.a=null}};var f=new b;a.prototype.D=function(g){var h=this.g();
g.j(h.resolve,h.reject)};a.prototype.F=function(g,h){var k=this.g();try{g.call(h,k.resolve,k.reject)}catch(l){k.reject(l)}};a.prototype.then=function(g,h){function k(p,v){return"function"==typeof p?function(u){try{l(p(u))}catch(q){n(q)}}:v}var l,n,t=new a(function(p,v){l=p;n=v});this.j(k(g,l),k(h,n));return t};a.prototype.catch=function(g){return this.then(void 0,g)};a.prototype.j=function(g,h){function k(){switch(l.c){case 1:g(l.i);break;case 2:h(l.i);break;default:throw Error("Unexpected state: "+
l.c);}}var l=this;null==this.a?f.c(k):this.a.push(k)};a.resolve=c;a.reject=function(g){return new a(function(h,k){k(g)})};a.race=function(g){return new a(function(h,k){for(var l=A(g),n=l.next();!n.done;n=l.next())c(n.value).j(h,k)})};a.all=function(g){var h=A(g),k=h.next();return k.done?c([]):new a(function(l,n){function t(u){return function(q){p[u]=q;v--;0==v&&l(p)}}var p=[],v=0;do p.push(void 0),v++,c(k.value).j(t(p.length-1),n),k=h.next();while(!k.done)})};return a});
m("Number.isFinite",function(d){return d?d:function(a){return"number"!==typeof a?!1:!isNaN(a)&&Infinity!==a&&-Infinity!==a}});m("Number.isInteger",function(d){return d?d:function(a){return Number.isFinite(a)?a===Math.floor(a):!1}});
m("WeakMap",function(d){function a(k){this.a=(h+=Math.random()+1).toString();if(k){k=A(k);for(var l;!(l=k.next()).done;)l=l.value,this.set(l[0],l[1])}}function b(){}function c(k){var l=typeof k;return"object"===l&&null!==k||"function"===l}function e(k){if(!z(k,g)){var l=new b;aa(k,g,{value:l})}}function f(k){var l=Object[k];l&&(Object[k]=function(n){if(n instanceof b)return n;Object.isExtensible(n)&&e(n);return l(n)})}if(function(){if(!d||!Object.seal)return!1;try{var k=Object.seal({}),l=Object.seal({}),
n=new d([[k,2],[l,3]]);if(2!=n.get(k)||3!=n.get(l))return!1;n.delete(k);n.set(l,4);return!n.has(k)&&4==n.get(l)}catch(t){return!1}}())return d;var g="$jscomp_hidden_"+Math.random();f("freeze");f("preventExtensions");f("seal");var h=0;a.prototype.set=function(k,l){if(!c(k))throw Error("Invalid WeakMap key");e(k);if(!z(k,g))throw Error("WeakMap key fail: "+k);k[g][this.a]=l;return this};a.prototype.get=function(k){return c(k)&&z(k,g)?k[g][this.a]:void 0};a.prototype.has=function(k){return c(k)&&z(k,
g)&&z(k[g],this.a)};a.prototype.delete=function(k){return c(k)&&z(k,g)&&z(k[g],this.a)?delete k[g][this.a]:!1};return a});
m("Map",function(d){function a(){var h={};return h.f=h.next=h.head=h}function b(h,k){var l=h.a;return ma(function(){if(l){for(;l.head!=h.a;)l=l.f;for(;l.next!=l.head;)return l=l.next,{done:!1,value:k(l)};l=null}return{done:!0,value:void 0}})}function c(h,k){var l=k&&typeof k;"object"==l||"function"==l?f.has(k)?l=f.get(k):(l=""+ ++g,f.set(k,l)):l="p_"+k;var n=h.c[l];if(n&&z(h.c,l))for(h=0;h<n.length;h++){var t=n[h];if(k!==k&&t.key!==t.key||k===t.key)return{id:l,list:n,index:h,b:t}}return{id:l,list:n,
index:-1,b:void 0}}function e(h){this.c={};this.a=a();this.size=0;if(h){h=A(h);for(var k;!(k=h.next()).done;)k=k.value,this.set(k[0],k[1])}}if(function(){if(!d||"function"!=typeof d||!d.prototype.entries||"function"!=typeof Object.seal)return!1;try{var h=Object.seal({x:4}),k=new d(A([[h,"s"]]));if("s"!=k.get(h)||1!=k.size||k.get({x:4})||k.set({x:4},"t")!=k||2!=k.size)return!1;var l=k.entries(),n=l.next();if(n.done||n.value[0]!=h||"s"!=n.value[1])return!1;n=l.next();return n.done||4!=n.value[0].x||
"t"!=n.value[1]||!l.next().done?!1:!0}catch(t){return!1}}())return d;var f=new WeakMap;e.prototype.set=function(h,k){h=0===h?0:h;var l=c(this,h);l.list||(l.list=this.c[l.id]=[]);l.b?l.b.value=k:(l.b={next:this.a,f:this.a.f,head:this.a,key:h,value:k},l.list.push(l.b),this.a.f.next=l.b,this.a.f=l.b,this.size++);return this};e.prototype.delete=function(h){h=c(this,h);return h.b&&h.list?(h.list.splice(h.index,1),h.list.length||delete this.c[h.id],h.b.f.next=h.b.next,h.b.next.f=h.b.f,h.b.head=null,this.size--,
!0):!1};e.prototype.clear=function(){this.c={};this.a=this.a.f=a();this.size=0};e.prototype.has=function(h){return!!c(this,h).b};e.prototype.get=function(h){return(h=c(this,h).b)&&h.value};e.prototype.entries=function(){return b(this,function(h){return[h.key,h.value]})};e.prototype.keys=function(){return b(this,function(h){return h.key})};e.prototype.values=function(){return b(this,function(h){return h.value})};e.prototype.forEach=function(h,k){for(var l=this.entries(),n;!(n=l.next()).done;)n=n.value,
h.call(k,n[1],n[0],this)};e.prototype[Symbol.iterator]=e.prototype.entries;var g=0;return e});
m("Set",function(d){function a(b){this.a=new Map;if(b){b=A(b);for(var c;!(c=b.next()).done;)this.add(c.value)}this.size=this.a.size}if(function(){if(!d||"function"!=typeof d||!d.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),c=new d(A([b]));if(!c.has(b)||1!=c.size||c.add(b)!=c||1!=c.size||c.add({x:4})!=c||2!=c.size)return!1;var e=c.entries(),f=e.next();if(f.done||f.value[0]!=b||f.value[1]!=b)return!1;f=e.next();return f.done||f.value[0]==b||4!=f.value[0].x||
f.value[1]!=f.value[0]?!1:e.next().done}catch(g){return!1}}())return d;a.prototype.add=function(b){b=0===b?0:b;this.a.set(b,b);this.size=this.a.size;return this};a.prototype.delete=function(b){b=this.a.delete(b);this.size=this.a.size;return b};a.prototype.clear=function(){this.a.clear();this.size=0};a.prototype.has=function(b){return this.a.has(b)};a.prototype.entries=function(){return this.a.entries()};a.prototype.values=function(){return this.a.values()};a.prototype.keys=a.prototype.values;a.prototype[Symbol.iterator]=
a.prototype.values;a.prototype.forEach=function(b,c){var e=this;this.a.forEach(function(f){return b.call(c,f,f,e)})};return a});
m("WeakSet",function(d){function a(b){this.a=new WeakMap;if(b){b=A(b);for(var c;!(c=b.next()).done;)this.add(c.value)}}if(function(){if(!d||!Object.seal)return!1;try{var b=Object.seal({}),c=Object.seal({}),e=new d([b]);if(!e.has(b)||e.has(c))return!1;e.delete(b);e.add(c);return!e.has(b)&&e.has(c)}catch(f){return!1}}())return d;a.prototype.add=function(b){this.a.set(b,!0);return this};a.prototype.has=function(b){return this.a.has(b)};a.prototype.delete=function(b){return this.a.delete(b)};return a});
m("Object.entries",function(d){return d?d:function(a){var b=[],c;for(c in a)z(a,c)&&b.push([c,a[c]]);return b}});m("Array.prototype.values",function(d){return d?d:function(){return na(this,function(a,b){return b})}});m("String.prototype.endsWith",function(d){return d?d:function(a,b){var c=oa(this,a,"endsWith");void 0===b&&(b=c.length);b=Math.max(0,Math.min(b|0,c.length));for(var e=a.length;0<e&&0<b;)if(c[--b]!=a[--e])return!1;return 0>=e}});
var pa="function"==typeof Object.assign?Object.assign:function(d,a){for(var b=1;b<arguments.length;b++){var c=arguments[b];if(c)for(var e in c)z(c,e)&&(d[e]=c[e])}return d};m("Object.assign",function(d){return d||pa});m("Array.prototype.fill",function(d){return d?d:function(a,b,c){var e=this.length||0;0>b&&(b=Math.max(0,e+b));if(null==c||c>e)c=e;c=Number(c);0>c&&(c=Math.max(0,e+c));for(b=Number(b||0);b<c;b++)this[b]=a;return this}});function B(d){return d?d:Array.prototype.fill}
m("Int8Array.prototype.fill",B);m("Uint8Array.prototype.fill",B);m("Uint8ClampedArray.prototype.fill",B);m("Int16Array.prototype.fill",B);m("Uint16Array.prototype.fill",B);m("Int32Array.prototype.fill",B);m("Uint32Array.prototype.fill",B);m("Float32Array.prototype.fill",B);m("Float64Array.prototype.fill",B);
m("String.prototype.startsWith",function(d){return d?d:function(a,b){var c=oa(this,a,"startsWith"),e=c.length,f=a.length;b=Math.max(0,Math.min(b|0,c.length));for(var g=0;g<f&&b<e;)if(c[b++]!=a[g++])return!1;return g>=f}});function ra(d){"@babel/helpers - typeof";ra="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};return ra(d)}
function D(d,a,b){"undefined"!==typeof Reflect&&Reflect.get?D=Reflect.get:D=function(c,e,f){for(;!Object.prototype.hasOwnProperty.call(c,e)&&(c=E(c),null!==c););if(c)return e=Object.getOwnPropertyDescriptor(c,e),e.get?e.get.call(f):e.value};return D(d,a,b||d)}function F(d,a){if("function"!==typeof a&&null!==a)throw new TypeError("Super expression must either be null or a function");d.prototype=Object.create(a&&a.prototype,{constructor:{value:d,writable:!0,configurable:!0}});a&&sa(d,a)}
function G(d){var a=ta();return function(){var b=E(d);if(a){var c=E(this).constructor;b=Reflect.construct(b,arguments,c)}else b=b.apply(this,arguments);if(!b||"object"!==ra(b)&&"function"!==typeof b){if(void 0===this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");b=this}return b}}function E(d){E=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)};return E(d)}
function ua(d,a,b){ta()?ua=Reflect.construct:ua=function(c,e,f){var g=[null];g.push.apply(g,e);c=new (Function.bind.apply(c,g));f&&sa(c,f.prototype);return c};return ua.apply(null,arguments)}function ta(){if("undefined"===typeof Reflect||!Reflect.construct||Reflect.construct.a)return!1;if("function"===typeof Proxy)return!0;try{return Reflect.construct(Date,[],function(){}),!0}catch(d){return!1}}function sa(d,a){sa=Object.setPrototypeOf||function(b,c){b.__proto__=c;return b};return sa(d,a)}
function va(d){var a=Array.isArray(d)?d:void 0;if(!a)if("undefined"!==typeof Symbol&&Symbol.iterator in Object(d)){a=[];var b=!0,c=!1,e=void 0;try{for(var f=d[Symbol.iterator](),g;!(b=(g=f.next()).done)&&(a.push(g.value),2!==a.length);b=!0);}catch(h){c=!0,e=h}finally{try{if(!b&&null!=f["return"])f["return"]()}finally{if(c)throw e;}}}else a=void 0;if(!(d=a||wa(d,2)))throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
return d}function H(d,a){if(!(d instanceof a))throw new TypeError("Cannot call a class as a function");}function xa(d,a){for(var b=0;b<a.length;b++){var c=a[b];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(d,c.key,c)}}function I(d,a,b){a&&xa(d.prototype,a);b&&xa(d,b)}function N(d,a,b){a in d?Object.defineProperty(d,a,{value:b,enumerable:!0,configurable:!0,writable:!0}):d[a]=b}
function O(d){var a=Array.isArray(d)?ya(d):void 0;a||(a="undefined"!==typeof Symbol&&Symbol.iterator in Object(d)?Array.from(d):void 0);if(!(d=a||wa(d)))throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");return d}
function wa(d,a){if(d){if("string"===typeof d)return ya(d,a);var b=Object.prototype.toString.call(d).slice(8,-1);"Object"===b&&d.constructor&&(b=d.constructor.name);if("Map"===b||"Set"===b)return Array.from(d);if("Arguments"===b||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b))return ya(d,a)}}function ya(d,a){if(null==a||a>d.length)a=d.length;for(var b=0,c=Array(a);b<a;b++)c[b]=d[b];return c}var P=Object.create(null);P.browser=Object.create(null);P.feature=Object.create(null);
["proxy","symbol","worker","promise"].forEach(function(d){d=d[0].toUpperCase()+d.substring(1);P.feature[d]=window[d]?!0:!1});Object.freeze(P);var Q=Object.create(null);Object.defineProperty(Q,"clickMask",{enumerable:!0,value:function(){void this.remove()}});Object.defineProperty(Q,"interaction",{enumerable:!0,value:{ok:null,no:null,cancel:function(){void this.remove()}}});
Object.defineProperty(Q,"active",{enumerable:!0,value:function(d){var a;var b=0;var c=this.variable.nodes;d=null!==(a=d)&&void 0!==a?a:window.event;R._instance.forEach(function(f){f.status===R._enum.STATUS.SHOW&&b++});if(2<=b){var e=R._assistant.element.maxZIndex();c.container.style.zIndex!=e&&(Object.keys(c).forEach(function(f){c[f].style.zIndex=e+1}),c.container.style.zIndex=parseInt(c.container.style.zIndex)+1)}}});
Object.defineProperty(Q,"drag",{enumerable:!0,value:function(d){var a,b=this,c;var e=this.status;d=null!==(a=d)&&void 0!==a?a:window.event;var f=this.variable.nodes.container;var g=f.getBoundingClientRect();if(null===this.option.window)var h=[0,window.innerWidth,0,window.innerHeight];else d=this.option.window.getBoundingClientRect(),h=[0,d.width,0,d.height];window.getSelection().empty();var k=function(p,v){b.option.drag.overflow||(g.x+p<h[0]&&(g.x=h[0]-p),g.right+p>h[1]&&(g.x=h[1]-g.width-p),g.y+
v<h[2]&&(g.y=h[2]-v),g.bottom+v>h[3]&&(g.y=h[3]-g.height-v));g.x+=p;g.y+=v;b.option.resize.enable&&b.option.content.fullContainer&&(p=[5,h[1]-g.width-5],v=[5,h[3]-g.height-5],g.x<=p[0]?g.x=p[0]:g.x>=p[1]&&(g.x=p[1]),g.y<=v[0]?g.y=v[0]:g.y>=v[1]&&(g.y=v[1]));f.style.marginLeft=g.x+"px";f.style.marginTop=g.y+"px";b.setStatus(R._enum.STATUS.DRAG)};var l=function(p){c=null!==p&&void 0!==p?p:window.event;1===c.buttons&&k(c.movementX,c.movementY)};var n=function(p){var v;var u=[0,0];p=null!==(v=p)&&void 0!==
v?v:window.event;"ArrowLeft"===p.code&&(u[0]=-1);"ArrowRight"===p.code&&(u[0]=1);"ArrowUp"===p.code&&(u[1]=-1);"ArrowDown"===p.code&&(u[1]=1);p.preventDefault();k.apply(void 0,O(u))};var t=function(){document.removeEventListener("keydown",n,!0);document.removeEventListener("mousemove",l);document.removeEventListener("mouseup",t);b.setStatus(e)};document.addEventListener("mouseup",t);document.addEventListener("mousemove",l);document.addEventListener("keydown",n,!0)}});
Object.defineProperty(Q,"resize",{enumerable:!0,value:function(d){function a(p){var v;if(1!==p.buttons)t();else{c.setStatus("resize");p=null!==(v=p)&&void 0!==v?v:window.event;v=p.screenX-l[0];var u=p.screenY-l[1];p=g.getAttribute("position-resize-bar");var q=[h.x,h.y,n[0],n[1]];p.includes("top")&&(q[1]+=u,q[3]-=u,q[1]<e.y&&(q[3]-=e.y-q[1]),q[3]<k[1]&&(q[1]+=q[3]-k[1],q[3]=k[1]));p.includes("bottom")&&(q[3]+=u,q[3]<k[1]&&(q[3]=k[1]));p.includes("left")&&(q[0]+=v,q[2]-=v,q[0]<e.x&&(q[2]-=e.x-q[0]),
q[2]<k[0]&&(q[0]+=q[2]-k[0],q[2]=k[0]));p.includes("right")&&(q[2]+=v,q[2]<k[0]&&(q[2]=k[0]));c.resizeByXYWH(Number(q[0]),Number(q[1]),Number(q[2]),Number(q[3]))}}var b,c=this,e;var f=this.status;d=null!==(b=d)&&void 0!==b?b:window.event;var g=d.target;var h=this.variable.nodes.container.getBoundingClientRect();var k=this.variable.defaultArea;var l=[d.screenX,d.screenY];var n=[h.width,h.height];null===this.option.window?e={x:0,y:0}:e=this.option.window.getBoundingClientRect();window.getSelection().empty();
var t=function v(){document.removeEventListener("mousemove",a);document.removeEventListener("mouseup",v);c.setStatus(f)};document.addEventListener("mouseup",t);document.addEventListener("mousemove",a)}});Object.defineProperty(Q,"minimizeRevert",{enumerable:!0,value:function(){if("1"!=this.getAttribute("clicked")){this.setAttribute("clicked",1);var d=Number(this.getAttribute("modal-layer-index"));delete R._minimizeQueue[R._minimizeQueue.indexOf(R._instance[d])]}}});
Object.defineProperty(Q,"autoShutdown",{enumerable:!0,value:function(){var d=this;var a=1E3*this.option.popupTime;var b=setInterval(function(){if(d.variable.nodes.container.classList.contains("modal-layer-show")){if(d.option.progress.enable){var c=d.variable.nodes.container.querySelector(".modal-layer-progress-bar-progress");switch(d.option.progress.position){case "top":case "bottom":var e="widthFull";break;case "left":case "right":e="heightFull"}c.style.animation=e+" "+d.option.popupTime+"s linear forwards"}d.variable.timeout.auto_shutdown=
setTimeout(function(){return void d.remove()},a);window.clearInterval(b)}},10)}});
Object.defineProperty(Q,"action",{enumerable:!0,value:{close:function(){void this.remove()},expand:function(){var d=this;var a=this.status;var b=this.variable.nodes.container.querySelector("iframe[name="+this.option.layer.name+this.option.index+"]");var c=function(f){f.target===b?d.setStatus(R._enum.STATUS.EXPAND):!1===f.target&&d.setStatus(a);window.removeEventListener("fullscreenerror",e);window.removeEventListener("fullscreenchange",c)};var e=function(f){R.K({J:!1,L:5,title:"\u9519\u8bef",H:!0,
I:"bottom",content:'<i class="fas fa-window-close" style="color: red"></i> \u5168\u5c4f\u5931\u8d25, \u9519\u8bef\u539f\u56e0: '+f});window.removeEventListener("fullscreenerror",e);window.removeEventListener("fullscreenchange",c)};window.addEventListener("fullscreenerror",e);window.addEventListener("fullscreenchange",c);R._assistant.element.launchFullscreen(b)},minimize:function(){var d=R._minimizeQueue.indexOf(this);0>d?R._minimizeQueue.push(this):R._minimizeQueue.splice(d,1)}}});
Object.defineProperty(Q,"imageTools",{enumerable:!0,value:{crop:function(){this.variable.image.status===R._enum.LOAD_STATUS.LOADED&&this.crop()},spin:function(){this.variable.image.status===R._enum.LOAD_STATUS.LOADED&&this.spin()},filter:function(d){this.variable.image.status===R._enum.LOAD_STATUS.LOADED&&this.filter((null!==d&&void 0!==d?d:window.event).target)},revert:function(){this.variable.image.status===R._enum.LOAD_STATUS.LOADED&&this.revert()},download:function(){this.variable.image.status===
R._enum.LOAD_STATUS.LOADED&&this.download()}}});Object.freeze(Q);var S=Object.create(null);Object.defineProperty(S,"page",{value:{src:null,srcdoc:null,frameborder:0,scrolling:"no",area:[800,600],allowfullscreen:!0,name:"modal-layer-page-"}});Object.defineProperty(S,"loading",{value:{icon:0,size:48,rate:null,duration:2,area:[48,48],color:"white",background:"transparent",position:["center","center"]}});
Object.defineProperty(S,"image",{value:{image:[],size:null,sizeRange:{min:[.15625,.160257],max:[.9,.9]},toolbar:{enable:!1,config:{crop:{enable:!1,title:"crop",grid:"quarter",icon:"fas fa-crop-alt"},spin:{enable:!1,title:"spin",icon:"fas fa-redo-alt"},filter:{enable:!1,config:{blur:{enable:!1,title:"blur",icon:null,textIcon:"\u6a21"},gray:{enable:!1,title:"gray",icon:null,textIcon:"\u7070"},mirror:{enable:!1,title:"mirror",icon:null,textIcon:"\u955c"}},title:"filter",icon:"fas fa-filter"},revert:{enable:!1,
title:"revert",icon:"fas fa-sync-alt"},download:{enable:!1,name:"picture-",mime:"image/png",title:"download",icon:"fas fa-download"}}}}});
Object.defineProperty(S,"common",{value:{index:0,ui:"modal-layer-ui",title:null,window:null,popupTime:5,skin:"default",parentModalLayer:null,areaProportion:[.18,.21],content:{value:null,fullContainer:!1},text:{action:{close:"\u5173\u95ed",expand:"\u5168\u5c4f",minimize:"\u6700\u5c0f\u5316"},interaction:{ok:"\u786e\u5b9a",no:"\u62d2\u7edd",cancel:"\u53d6\u6d88"}},transition:{time:.2,opacity:0,scale:[.45,.45]},mask:{enable:!0,clickRemove:!0},drag:{enable:!0,overflow:!1},resize:{enable:!0},progress:{enable:!1,
position:"bottom",color:"deepskyblue",background:"#cecece"},layer:{},hook:{initStart:null,initEnded:null}}});Object.freeze(S);var T=Object.create(null);Object.defineProperty(T,"mask",{get:function(){return JSON.parse(JSON.stringify({nodeType:"div","class":"modal-layer-mask"}))},enumerable:!0,configurable:!1});Object.defineProperty(T,"container",{get:function(){return JSON.parse(JSON.stringify({innerHTML:[],nodeType:"div","class":"modal-layer-container"}))},enumerable:!0,configurable:!1});
Object.defineProperty(T,"action",{get:function(){return JSON.parse(JSON.stringify({innerHTML:[],nodeType:"div","class":"modal-layer-action"}))},enumerable:!0,configurable:!1});
Object.defineProperty(T,"action_button",{get:function(){return JSON.parse(JSON.stringify({minimize:{nodeType:"span","data-fa-transform":"up-4 shrink-2","class":"fas fa-window-minimize modal-layer-action-btn modal-layer-action-btn-minimize"},expand:{nodeType:"span","data-fa-transform":"shrink-2","class":"fas fa-expand-arrows-alt modal-layer-action-btn modal-layer-action-btn-expand"},close:{nodeType:"span","data-fa-transform":"rotate-45 grow-1","class":"fas fa-plus modal-layer-action-btn modal-layer-action-btn-close"}}))},
enumerable:!0,configurable:!1});Object.defineProperty(T,"title",{get:function(){return JSON.parse(JSON.stringify({nodeType:"div","class":"modal-layer-title",innerHTML:[{nodeType:"h4","class":"modal-layer-title-content"}]}))},enumerable:!0,configurable:!1});Object.defineProperty(T,"content",{get:function(){return JSON.parse(JSON.stringify({innerHTML:[],nodeType:"div","class":"modal-layer-content"}))},enumerable:!0,configurable:!1});
Object.defineProperty(T,"content_text",{get:function(){return JSON.parse(JSON.stringify({nodeType:"div","class":"modal-layer-text-content"}))},enumerable:!0,configurable:!1});Object.defineProperty(T,"content_page",{get:function(){return JSON.parse(JSON.stringify({name:"",frameborder:0,scrolling:"no",nodeType:"iframe","class":"modal-layer-page-content"}))},enumerable:!0,configurable:!1});
Object.defineProperty(T,"content_image",{get:function(){return JSON.parse(JSON.stringify({"load-status":2,nodeType:"canvas","class":"modal-layer-image-canvas"}))},enumerable:!0,configurable:!1});Object.defineProperty(T,"content_loading",{get:function(){return JSON.parse(JSON.stringify({nodeType:"div","class":"modal-layer-loading-box",innerHTML:[{nodeType:"span","class":"modal-layer-loading-icon"}]}))},enumerable:!0,configurable:!1});
Object.defineProperty(T,"content_loading_icon",{get:function(){return JSON.parse(JSON.stringify([{nodeType:"span","class":"modal-layer-loading-icon fas fa-spinner fa-spin fa-fw"},{nodeType:"span","class":"modal-layer-loading-icon fas fa-circle-notch fa-spin fa-fw"},{nodeType:"span","class":"modal-layer-loading-icon fas fa-sync fa-spin fa-fw"},{nodeType:"span","class":"modal-layer-loading-icon fas fa-cog fa-spin fa-fw"}]))},enumerable:!0,configurable:!1});
Object.defineProperty(T,"toolbar",{get:function(){return JSON.parse(JSON.stringify({innerHTML:[],nodeType:"div","class":"modal-layer-toolbar"}))},enumerable:!0,configurable:!1});Object.defineProperty(T,"interaction",{get:function(){return JSON.parse(JSON.stringify({innerHTML:[],nodeType:"div","class":"modal-layer-interaction"}))},enumerable:!0,configurable:!1});
Object.defineProperty(T,"interaction_button",{get:function(){return JSON.parse(JSON.stringify({ok:{nodeType:"span","class":"modal-layer-interaction-btn modal-layer-interaction-btn-ok"},no:{nodeType:"span","class":"modal-layer-interaction-btn modal-layer-interaction-btn-no"},cancel:{nodeType:"span","class":"modal-layer-interaction-btn modal-layer-interaction-btn-cancel"}}))},enumerable:!0,configurable:!1});
Object.defineProperty(T,"progress_bar",{get:function(){return JSON.parse(JSON.stringify({nodeType:"div","class":"modal-layer-progress-bar",innerHTML:[{nodeType:"div","class":"modal-layer-progress-bar-background",innerHTML:[{nodeType:"span","class":"modal-layer-progress-bar-progress"}]}]}))},enumerable:!0,configurable:!1});
Object.defineProperty(T,"resize_box",{get:function(){return JSON.parse(JSON.stringify({nodeType:"div","class":"modal-layer-resize-box",innerHTML:[{nodeType:"div","class":"modal-layer-resize-bar","position-resize-bar":"top"},{nodeType:"div","class":"modal-layer-resize-bar","position-resize-bar":"left"},{nodeType:"div","class":"modal-layer-resize-bar","position-resize-bar":"right"},{nodeType:"div","class":"modal-layer-resize-bar","position-resize-bar":"bottom"},{nodeType:"div","class":"modal-layer-resize-bar",
"position-resize-bar":"left-top"},{nodeType:"div","class":"modal-layer-resize-bar","position-resize-bar":"right-top"},{nodeType:"div","class":"modal-layer-resize-bar","position-resize-bar":"left-bottom"},{nodeType:"div","class":"modal-layer-resize-bar","position-resize-bar":"right-bottom"}]}))},enumerable:!0,configurable:!1});Object.defineProperty(T,"minimize_queue",{get:function(){return JSON.parse(JSON.stringify({innerHTML:[],nodeType:"div",id:"modal-layer-minimize-queue"}))},enumerable:!0,configurable:!1});
Object.defineProperty(T,"minimize_queue_item",{get:function(){return JSON.parse(JSON.stringify({nodeType:"div","class":"modal-layer-minimize-queue-item",innerHTML:[{nodeType:"h4","class":"modal-layer-minimize-queue-item-title"}]}))},enumerable:!0,configurable:!1});
Object.defineProperty(T,"image_tools",{get:function(){return JSON.parse(JSON.stringify({crop:{title:"crop",nodeType:"div","tool-type":"crop",innerHTML:[{nodeType:"span","class":"modal-layer-toolbar-item-icon"}],"class":"modal-layer-toolbar-item"},spin:{title:"spin",nodeType:"div","tool-type":"spin",innerHTML:[{nodeType:"span","class":"modal-layer-toolbar-item-icon"}],"class":"modal-layer-toolbar-item"},revert:{title:"revert",nodeType:"div","tool-type":"revert",innerHTML:[{nodeType:"span","class":"modal-layer-toolbar-item-icon"}],
"class":"modal-layer-toolbar-item"},filter:{title:"filter",nodeType:"div","tool-type":"filter",innerHTML:[{nodeType:"span","class":"modal-layer-toolbar-item-icon"},{innerHTML:[],nodeType:"div","class":"modal-layer-toolbar-item-child-list"}],"class":"modal-layer-toolbar-item"},download:{title:"save",nodeType:"div","tool-type":"download",innerHTML:[{nodeType:"span","class":"modal-layer-toolbar-item-icon"}],"class":"modal-layer-toolbar-item"}}))},enumerable:!0,configurable:!1});
Object.defineProperty(T,"image_tools_child",{get:function(){return JSON.parse(JSON.stringify({filter:{mirror:{title:"\u955c\u50cf",innerText:"\u955c",nodeType:"span","filter-type":"mirror","class":"modal-layer-toolbar-filter-icon"},blur:{"data-radius":3,"data-sigma":1.5,innerText:"\u6a21",title:"\u9ad8\u65af\u6a21\u7cca",nodeType:"span","filter-type":"blur","class":"modal-layer-toolbar-filter-icon"},gray:{title:"\u7070\u5ea6\u5316",innerText:"\u7070",nodeType:"span","filter-type":"gray","class":"modal-layer-toolbar-filter-icon"}}}))},
enumerable:!0,configurable:!1});Object.freeze(T);var U=Object.create(null);Object.defineProperty(U,"ARROW",{enumerable:!0,value:{LEFT:37,UP:38,RIGHT:39,DOWN:40}});Object.defineProperty(U,"POSITION",{enumerable:!0,value:{EAST:"e",WEST:"w",SOUTH:"s",NORTH:"n"}});Object.defineProperty(U,"TYPE",{enumerable:!0,value:{MSG:0,MESSAGE:0,ALERT:1,PROMPT:2,CONFIRM:3,PAGE:4,LOADING:5,IMAGE:6,VIDEO:7,AUTDIO:8}});
Object.defineProperty(U,"STATUS",{enumerable:!0,value:{HIDE:0,SHOW:1,EXPAND:2,MINIMIZE:3,REMOVING:4,REMOVED:5,DRAG:6,RESIZE:7}});Object.defineProperty(U,"LOAD_STATUS",{enumerable:!0,value:{FAILED:0,LOADED:1,LOADING:2}});Object.defineProperty(U,"BROWSER_STORAGE",{enumerable:!0,value:{WEBSQL:"webSQL",INDEXDB:"indexedDB",LOCALSTORAGE:"localStorage",SESSIONSTORAGE:"sessionStorage"}});Object.freeze(U);
var R=function(){function d(a,b){H(this,d);N(this,"type",null);N(this,"status",null);N(this,"event",null);N(this,"option",null);N(this,"variable",{});try{var c,e,f,g,h,k;null===(c=a.hook)||void 0===c?void 0:null===(e=c.initStart)||void 0===e?void 0:null===(f=e.call)||void 0===f?void 0:f.call(e,a);this.type=a.type;this.status=d._enum.STATUS.HIDE;this.compatibleOption(a);this.initOption(a);this.checkOption();this.linkageOption();this.initVariable();this.initStruct();this.initNode();this.initNodeFinally();
this.initEvent();this.bindEvent();null===(g=this.option.hook)||void 0===g?void 0:null===(h=g.initEnded)||void 0===h?void 0:null===(k=h.call)||void 0===k?void 0:k.call(h,this);this.insertNode()}catch(l){d._instance.splice(d._instance.indexOf(this),1),null===b||void 0===b?void 0:b.call(null,l)}}I(d,[{key:"initOption",value:function(a){a.index=d._instance.length;d._instance[a.index]=this;this.option=d._assistant.object.merge(a,d._option.common)}},{key:"compatibleOption",value:function(a){var b,c;if("boolean"===
typeof a.mask||["true","false"].includes(a.mask))a.mask={enable:!!a.mask,clickRemove:!0};if(!a.content||d._assistant.object.isEmpty(a.content.value))a.content={value:a.content,fullContainer:null!==(b=null===(c=a.content)||void 0===c?void 0:c.fullContainer)&&void 0!==b?b:!1}}},{key:"linkageOption",value:function(){0>=this.option.popupTime&&(this.option.progress.enable=!1);!1===this.option.title&&(this.option.drag.enable=!1)}},{key:"checkOption",value:function(){}},{key:"initVariable",value:function(){this.variable.struct=
Object.create(null);this.variable.timeout=Object.create(null);this.variable.interval=Object.create(null);this.variable.eventSymbol=Object.create(null);this.variable.animationName=Object.create(null);this.variable.struct._build=Object.create(null);this.variable.struct._backup=Object.create(null)}},{key:"initStruct",value:function(){var a;if(null===(a=this.option.mask)||void 0===a?0:a.enable)this.variable.struct._build.mask=d._struct.mask;this.variable.struct._build.container=d._struct.container}},
{key:"initNode",value:function(){this.variable.nodes=d._assistant.element.objectToNode(this.variable.struct._build);var a=this.variable.nodes.mask;var b=this.variable.nodes.container;var c=b.querySelector(".modal-layer-interaction-btn-ok");var e=b.querySelector(".modal-layer-interaction-btn-no");var f=b.querySelector(".modal-layer-interaction-btn-cancel");null!==this.option.window&&(null===a||void 0===a?void 0:a.setAttribute("has-window",""),b.setAttribute("has-window",""));b.setAttribute("modal-layer-popup-time",
this.option.popupTime);b.setAttribute("content-full-container",Number(this.option.content.fullContainer));b.setAttribute("modal-layer-type",d._assistant.object.getKeyByValue(d._enum.TYPE,this.type).toLowerCase());b.setAttribute("allow-drag",Number(this.option.drag.enable));b.setAttribute("allow-resize",Number(this.option.resize.enable));if(this.option.progress.enable){a=["top","left","right","bottom"];var g=b.querySelector(".modal-layer-progress-bar");a.includes(this.option.progress.position)||(this.option.progress.position=
a[3]);g.setAttribute("progress-bar-position",this.option.progress.position);g.querySelector(".modal-layer-progress-bar-progress").style.cssText+="background: "+this.option.progress.color;g.querySelector(".modal-layer-progress-bar-background").style.cssText+="background: "+this.option.progress.background}if(!1!==this.option.title){var h=b.querySelector(".modal-layer-title-content");if(this.option.title instanceof Object){var k=d._assistant.element.objectToNode(this.option.title);Object.keys(k).forEach(function(l){h.appendChild(k[l])})}else h.innerHTML=
this.option.title}c&&(c.innerText=this.option.text.interaction.ok);e&&(e.innerText=this.option.text.interaction.no);f&&(f.innerText=this.option.text.interaction.cancel)}},{key:"initNodeFinally",value:function(){var a=this.option.ui;var b="modal-layer-skin-"+this.option.skin;var c="modal-layer-index-"+this.option.index;var e="transition-opacity-"+100*this.option.transition.opacity+"-animation";var f="transition-scale-"+100*this.option.transition.scale[0]+"-"+100*this.option.transition.scale[1]+"-animation";
this.variable.animationName.transition_opacity=e;this.variable.animationName.transition_scale=f;if(!d._assistant.css.hasCss(e)){var g={from:"opacity: "+this.option.transition.opacity,to:"opacity: 1"};var h=d._assistant.css.createAnimation(e,g);d._assistant.css.addCss(e,h);d._assistant.css.addCss(e+"-reverse",d._assistant.css.createAnimation(e+"-reverse",{from:g.to,to:g.from}))}d._assistant.css.hasCss(f)||(e={from:"transform: scale("+this.option.transition.scale[0]+", "+this.option.transition.scale[1]+
")",to:"transform: scale(1, 1)"},h=d._assistant.css.createAnimation(f,e),d._assistant.css.addCss(f,h),d._assistant.css.addCss(f+"-reverse",d._assistant.css.createAnimation(f+"-reverse",{from:e.M,to:e.from})));Object.keys(this.variable.nodes).forEach(function(k){for(var l=d._assistant.element.getAllElement(this.variable.nodes[k]),n=0;n<l.length;n++)l[n].classList.add(a);this.variable.nodes[k].className=a+" "+b+" "+c+" "+this.variable.nodes[k].className.trim()+" modal-layer-hide"},this)}},{key:"initEvent",
value:function(){var a;this.event=d._assistant.object.merge(null!==(a=this.option.event)&&void 0!==a?a:{},d._event)}},{key:"bindEvent",value:function(){var a={once:!1,capture:!1,passive:!1,mozSystemGroup:!1};this.option.mask.enable&&this.option.mask.clickRemove&&(this.variable.eventSymbol.maskClickRemove=d._assistant.event.add(this.variable.nodes.mask,"click",null,this.event.clickMask,this,null,a));this.option.drag.enable&&(this.variable.eventSymbol.drag=d._assistant.event.add(this.variable.nodes.container.querySelector(".modal-layer-title"),
"mousedown",null,this.event.drag,this,null,a));this.option.resize.enable&&(this.variable.eventSymbol.resize=d._assistant.event.add(this.variable.nodes.container,"mousedown",".modal-layer-resize-bar",this.event.resize,this,null,a));this.variable.eventSymbol.active=d._assistant.event.add(this.variable.nodes.container,"mousedown",null,this.event.active,this,null,a);this.event.action.close instanceof Function&&(this.variable.eventSymbol.actionClose=d._assistant.event.add(this.variable.nodes.container,
"click",".modal-layer-action-btn-close",this.event.action.close,this,null,a));this.event.action.expand instanceof Function&&(this.variable.eventSymbol.actionExpand=d._assistant.event.add(this.variable.nodes.container,"click",".modal-layer-action-btn-expand",this.event.action.expand,this,null,a));this.event.action.minimize instanceof Function&&(this.variable.eventSymbol.actionMinimize=d._assistant.event.add(this.variable.nodes.container,"click",".modal-layer-action-btn-minimize",this.event.action.minimize,
this,null,a));var b=this.variable.nodes.container.querySelector(".modal-layer-interaction-btn-ok");var c=this.variable.nodes.container.querySelector(".modal-layer-interaction-btn-no");var e=this.variable.nodes.container.querySelector(".modal-layer-interaction-btn-cancel");this.event.interaction.ok&&b&&(this.variable.eventSymbol.interactionOk=d._assistant.event.add(b,"click",null,this.event.interaction.ok,this,null,a));this.event.interaction.no&&c&&(this.variable.eventSymbol.interactionNo=d._assistant.event.add(c,
"click",null,this.event.interaction.no,this,null,a));e&&(this.variable.eventSymbol.interactionCancel=d._assistant.event.add(e,"click",null,this.event.interaction.cancel,this,null,a))}},{key:"insertNode",value:function(){var a,b,c=this,e=document.createDocumentFragment(),f=null!==(a=this.option.window)&&void 0!==a?a:window.document.body;if(f instanceof String||"string"===typeof f)f=null!==(b=document.querySelector(f))&&void 0!==b?b:window.document.body;Object.keys(this.variable.nodes).forEach(function(g){e.appendChild(c.variable.nodes[g])},
this);f.appendChild(e)}}]);I(d,[{key:"setStatus",value:function(a){if(Object.values(d._enum.STATUS).includes(a))var b=d._assistant.object.getKeyByValue(d._enum.STATUS,a);else if(b=a.toUpperCase(),void 0===(a=d._enum.STATUS[b]))throw Error("Illegal value");this.status=a;this.variable.nodes.container.setAttribute("modal-layer-status",b.toLowerCase())}},{key:"resize",value:function(){var a=[0,0];var b=this.variable.nodes.container;var c=b.children;a[0]=d._assistant.number.multiply(window.innerWidth,
this.option.areaProportion[0]);b.style.width=a[0]+"px";for(var e=0;e<c.length;e++)a[1]="absolute"==getComputedStyle(c[e],null).position?a[1]:Math.max(d._assistant.element.getNodeHeight(c[e]),a[1]);b.style.height=a[1]+"px";this.variable.defaultArea=a}},{key:"resizeByXYWH",value:function(a,b,c,e){var f;var g=this.variable.nodes.container;null===this.option.window?f={x:0,y:0,top:0,left:0,right:window.innerWidth,width:window.innerWidth,bottom:window.innerHeight,height:window.innerHeight}:f=this.option.window.getBoundingClientRect();
a<f.x&&(a=f.x);a+c>f.right&&(c=f.right-a);b<f.y&&(b=f.y);b+e>f.bottom&&(e=f.bottom-b);g.style.marginLeft=a+"px";g.style.marginTop=b+"px";g.style.width=c+"px";g.style.height=e+"px";[d._enum.TYPE.PAGE,d._enum.TYPE.VIDEO,d._enum.TYPE.AUDIO].includes(this.type)&&(a=g.querySelector("iframe[name="+this.option.layer.name+this.option.index+"]"),a.style.width=this.option.layer.area[0]+c-this.variable.defaultArea[0]+"px",a.style.height=this.option.layer.area[1]+e-this.variable.defaultArea[1]+"px")}},{key:"show",
value:function(){var a=this;var b=this.variable.nodes;var c=d._assistant.element.maxZIndex();if(0===Object.keys(b).length||this.status===d._enum.STATUS.SHOW)return Promise.resolve();var e=this.variable.animationName.transition_opacity+" "+this.option.transition.time+"s ease forwards";var f=this.variable.animationName.transition_scale+" "+this.option.transition.time+"s ease forwards";Object.keys(b).forEach(function(h){b[h].style.zIndex=c+1});var g=new Promise(function(h){b.container.onanimationend=
function(){0<a.option.popupTime&&a.event.autoShutdown.call(a);b.container.onanimationend=null;h()}});b.mask&&(b.mask.style.animation=e);b.container.style.animation=e+", "+f;Object.keys(b).forEach(function(h){b[h].classList.contains("modal-layer-hide")&&b[h].classList.replace("modal-layer-hide","modal-layer-show")},this);this.setStatus("show");return g}},{key:"hide",value:function(){var a=this;var b=this.variable.nodes;if(0===Object.keys(b).length||this.status===d._enum.STATUS.HIDE)return Promise.resolve();
Number.isInteger(this.variable.timeout.auto_shutdown)&&window.clearTimeout(this.variable.timeout.auto_shutdown);var c=this.variable.animationName.transition_opacity+"-reverse "+this.option.transition.time+"s ease forwards";var e=this.variable.animationName.transition_scale+"-reverse "+this.option.transition.time+"s ease forwards";var f=new Promise(function(g){b.container.onanimationend=function(){Object.keys(b).forEach(function(h){b[h].classList.contains("modal-layer-show")&&b[h].classList.replace("modal-layer-show",
"modal-layer-hide")});a.setStatus("hide");b.container.onanimationend=null;null!==a.option.parentModalLayer&&a.option.parentModalLayer.show();g()}});b.mask&&(b.mask.style.animation=c);b.container.style.animation=c+", "+e;return f}},{key:"minimize",value:function(){var a=this;if(this.status!==d._enum.STATUS.MINIMIZE){var b=document.querySelector("#modal-layer-minimize-queue");b||(b=d._assistant.element.objectToNode([d._struct.minimize_queue])[0],b.classList.add(this.option.ui,"modal-layer-skin-".concat(this.option.skin)),
d._variable.minimizeQueueEvent=d._assistant.event.add(b,"click",".modal-layer-minimize-queue-item",this.event.minimizeRevert,null,null,!1),document.body.insertAdjacentElement("beforeend",b));var c=this.variable.nodes.container.querySelector(".modal-layer-title-content").innerHTML;var e=d._assistant.element.objectToNode([d._struct.minimize_queue_item])[0];e.classList.add(this.option.ui);e.setAttribute("modal-layer-index",this.option.index);e.querySelector(".modal-layer-minimize-queue-item-title").innerHTML=
c;b.insertAdjacentElement("beforeend",e);var f=setInterval(function(){e.parentNode&&(e.style.animation="opacity 0.3s ease forwards, "+a.variable.animationName.minimize_queue_transition_scale+" 0.3s ease forwards",clearInterval(f))},10);this.hide().then(function(){return void a.setStatus("minimize")})}}},{key:"revert",value:function(){var a=this;var b=document.querySelector("#modal-layer-minimize-queue");var c=b.querySelector('.modal-layer-minimize-queue-item[modal-layer-index="'+this.option.index+
'"]');if([d._enum.STATUS.MINIMIZE].includes(this.status)){c.onanimationstart=function(){setTimeout(function(){a.show();c.onanimationstart=null},150)};var e=new Promise(function(f){c.onanimationend=function(){c.remove();0>=d._minimizeQueue.length&&(b.remove(),d._assistant.event.remove(d._variable.minimizeQueueEvent));f()}});c.style.animation="opacity-reverse 0.3s ease forwards, "+this.variable.animationName.minimize_queue_transition_scale+"-reverse 0.3s ease forwards";return e}}},{key:"remove",value:function(){var a=
this;var b=this.status;var c=this.variable.nodes;b===d._enum.STATUS.MINIMIZE&&delete d._minimizeQueue[d._minimizeQueue.indexOf(this)];this.setStatus(d._enum.STATUS.REMOVING);return 0===Object.keys(c).length||[d._enum.STATUS.HIDE,d._enum.STATUS.REMOVING,d._enum.STATUS.REMOVED].includes(b)?Promise.resolve():this.hide().then(function(){a.removeAllEvent();Object.keys(c).forEach(function(e){c[e].remove()});a.setStatus("removed")})}},{key:"delete",value:function(){var a=this;this.remove().then(function(){d.a.splice(d.a.indexOf(a),
1);d._assistant.object.dereference(a.event);d._assistant.object.dereference(a.option);d._assistant.object.dereference(a.variable);a.event=a.option=a.variable=null})}},{key:"removeAllEvent",value:function(){var a;if(0!==Object.keys(a=this.variable.nodes).length){Object.values(this.variable.eventSymbol).forEach(function(f){return d._assistant.event.remove(f)});var b=a.container.querySelector(".modal-layer-interaction-btn-ok");var c=a.container.querySelector(".modal-layer-interaction-btn-no");var e=
a.container.querySelector(".modal-layer-interaction-btn-cancel");a.container.removeEventListener("mousedown",this.event.active);a.container.removeEventListener("click",this.event.action.close);a.container.removeEventListener("click",this.event.action.expand);a.container.removeEventListener("click",this.event.action.minimize);b&&b.removeEventListener("click",this.event.interaction_ok);c&&c.removeEventListener("click",this.event.interaction_no);e&&e.removeEventListener("click",this.event.interaction_cancel);
document.removeEventListener("click",this.event.minimizeRevert)}}}],[{key:"removeAll",value:function(){for(var a=0;a<d._instance.length;a++)d._instance[a].remove()}},{key:"msg",value:function(a,b){d.message(a,b)}},{key:"message",value:function(a,b){"string"===typeof a?a={content:a,type:d._enum.TYPE.MESSAGE}:a.type=d._enum.TYPE.MESSAGE;a=new (d._achieve.get("message"))(a,b);a.resize();a.show();return a}},{key:"alert",value:function(a,b){a.type=d._enum.TYPE.ALERT;a=new (d._achieve.get("alert"))(a,b);
a.resize();a.show();return a}},{key:"confirm",value:function(a,b){a.type=d._enum.TYPE.CONFIRM;a=new (d._achieve.get("confirm"))(a,b);a.resize();a.show();return a}},{key:"prompt",value:function(a,b){a.type=d._enum.TYPE.PROMPT;a=new (d._achieve.get("prompt"))(a,b);a.resize();a.show();return a}},{key:"page",value:function(a,b){a.type=d._enum.TYPE.PAGE;a=new (d._achieve.get("page"))(a,b);a.resize();a.show();return a}},{key:"image",value:function(a,b){var c=null;a.type=d._enum.TYPE.IMAGE;c=new (d._achieve.get("image"))(a,
b);c.variable.image.finish.then(function(){return c.resize()}).then(function(){return c.show()});return c}},{key:"loading",value:function(a,b){a.type=d._enum.TYPE.LOADING;a=new (d._achieve.get("loading"))(a,b);a.resize();a.show();return a}}]);return d}();N(R,"_env",P);N(R,"_enum",U);N(R,"_struct",T);N(R,"_option",S);N(R,"_variable",new Map);N(R,"_worker",window.Worker?new Map:void 0);N(R,"_event",Q);N(R,"_version",1);N(R,"_achieve",new Map);N(R,"_assistant",Object.create(null));
N(R,"_instance",new Proxy([],{set:function(d,a,b){if(b instanceof R||"length"===a)return d[a]=b,!0;throw new TypeError("Must be of type ModalLayer");}}));N(R,"_minimizeQueue",new Proxy([],{set:function(d,a,b){if(b instanceof R){var c=d.indexOf(b);b.minimize();0>c?d[a]=b:d[c]=b;return!0}return"length"===a?(d[a]=b,!0):!1},deleteProperty:function(d,a){a=parseInt(a);if(Number.isInteger(a)&&d[a]instanceof R){d[a].revert();if(d[a+1])for(;a<d.length-1;a++)d[a]=d[a+1];delete d[d.length-1];d.length--;return!0}}}));
Object.seal(R);Object.is(window.ModalLayer,R)?(console.group("ModalLayer already exists"),console.log("Already version ".concat(window.ModalLayer._version)),console.log("Try to introduce version: ".concat(R._version)),console.groupEnd()):(Object.preventExtensions(R),Object.defineProperty(window,"ModalLayer",{value:R}));
var za=function(){function d(){H(this,d)}I(d,null,[{key:"createAnimation",value:function(a,b){var c="@keyframes "+a+" {";Object.keys(b).forEach(function(e){c+=e+"{"+b[e]+"}"});return c+"}"}},{key:"hasCss",value:function(a){return d.cssList.has(a)}},{key:"addCss",value:function(a,b){if(d.hasCss(a))return!1;d.styleNode||(d.styleNode=document.createElement("style"),document.head.appendChild(d.styleNode));b=b.trim();d.cssList.set(a,b);d.styleNode.innerHTML+=d.delimiter+b}},{key:"delCss",value:function(a){d.hasCss(a)&&
(a=new RegExp(d.delimiter+d.cssList.get(a),"g"),d.styleNode.innerHTML=d.styleNode.innerHTML.replace(a,""))}}]);return d}();N(za,"cssList",new Map);N(za,"delimiter","\n");N(za,"styleNode",null);Object.defineProperty(R._assistant,"css",{value:za});
var Ba=function(){function d(){H(this,d)}I(d,null,[{key:"getFileBinary",value:function(a,b){var c;b=null!==(c=b)&&void 0!==c?c:{};b=W.merge(b,{mode:"cors",method:"get",cache:"no-cache",redirect:"follow",credentials:"include",referrer:"no-referrer",headers:{"content-type":"text/plain"}});return fetch(a,b)}},{key:"getFileBlob",value:function(a){var b=null;a instanceof Blob?b=Promise.resolve(a):a instanceof Image||a instanceof Element&&"IMAGE"===a.nodeName?b=this.u(a.src).then(function(c){return c.blob()}):
"string"===typeof a||a instanceof String?b=this.u(a).then(function(c){return c.blob()}):b=Promise.reject(!1);return b}},{key:"getImage",value:function(a){var b=null;"string"===typeof a||a instanceof String?b=a:a instanceof Image||a instanceof Element&&"IMAGE"===a.nodeName?b=a.src:a instanceof Blob||a instanceof MediaSource?b=URL.createObjectURL(a):b=!1;return b}}]);return d}();Object.defineProperty(R._assistant,"file",{value:Ba});
var X=function(){function d(){H(this,d)}I(d,null,[{key:"has",value:function(a){var b,c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;c=null!==(b=c)&&void 0!==b?b:d;return(b=d._symbol.get(c))?c[b].has(a):!1}},{key:"get",value:function(a){var b,c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;c=null!==(b=c)&&void 0!==b?b:d;return(b=d._symbol.get(c))?c[b].get(a):void 0}},{key:"set",value:function(a,b){var c,e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;e=null!==
(c=e)&&void 0!==c?c:d;d._symbol.has(e)?c=d._symbol.get(e):(c=Symbol("cache"),d._symbol.set(e,c));Object.hasOwnProperty.call(e,c)||Object.defineProperty(e,c,{value:new Map,writable:!1,enumerable:!1,configurable:!1});e[c].set(a,b)}},{key:"delete",value:function(){var a,b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;c=null!==(a=c)&&void 0!==a?a:d;var e=d._symbol.get(c);if(b)c[e]["delete"](b);else c[e].forEach(function(f,g){c[e]["delete"](g)})}},
{key:"clear",value:function(){d._symbol.forEach(function(a,b){d["delete"](null,b)})}}]);return d}();N(X,"_symbol",new Map);Object.defineProperty(R._assistant,"cache",{value:X});
var Ca=function(){function d(){H(this,d)}I(d,null,[{key:"add",value:function(a,b,c,e,f,g,h){var k,l=7<arguments.length&&void 0!==arguments[7]?arguments[7]:!1,n;var t=!1;var p=Symbol();(n=X.get("cache",d))||(n=new Map,X.set("cache",n,d));if(!(a instanceof EventTarget||(a=document.querySelector(a))))throw Error("Is not a valid element.");if(!W.isString(b))throw Error("Event type not allowed to be empty");c instanceof EventTarget&&(a=c,c=null);e instanceof Function||(t=!0);W.isEmpty(f)&&(f=null!==(k=
c)&&void 0!==k?k:a);W.isEmpty(g)||Array.isArray(g)||(g=[g]);W.isEmpty(h)&&(h=!1);if(t){var v;g=[{target:f,symbol:p,parameter:null!==(v=g)&&void 0!==v?v:[]}]}else{var u;g=null!==(u=g)&&void 0!==u?u:[]}k=c?new Promise(function(q){function w(y){var r=(null!==y&&void 0!==y?y:window.event).target;var J=a.querySelectorAll(c);if(r.contains(a)||0===J.length)return!1;for(var K=0;K<J.length;K++){var V=J[K];if(V.contains(r)){r=V===r?r:V;t?(g[0].event=y,g[0].target=f===c?r:f):0<g.length&&g[g.length-1]instanceof
Event?g[g.length-1]=y:g.push(y);(t?q:e).apply(f===c?r:f,g);break}}}n.set(p,{type:b,element:a,options:h,selector:c,callback:w,wantsUntrusted:l});a.addEventListener(b,w,h,l)}):new Promise(function(q){var w;e=(w=t?q:e).bind.apply(w,[f].concat(O(g)));n.set(p,{type:b,element:a,options:h,selector:c,callback:e,wantsUntrusted:l});a.addEventListener(b,e,h,l)});return t?k:p}},{key:"remove",value:function(a){var b;var c=X.get("cache",d);if(b=null===c||void 0===c?void 0:c.get(a))b.element.removeEventListener(b.type,
b.callback,b.options),c["delete"](a),W.dereference(b)}},{key:"removeBy",value:function(a,b){var c=X.get("cache",d);if(!["element","selector","callback"].includes(a))throw Error("key value is invalid");null===c||void 0===c?void 0:c.forEach(function(e,f){e[a]===b&&(e.element.removeEventListener(e.type,e.callback,e.options,e.wantsUntrusted),c["delete"](f))})}},{key:"removeAll",value:function(){var a=X.get("cache",d);null===a||void 0===a?void 0:a.forEach(function(b,c){b.element.removeEventListener(b.type,
b.callback,b.options,b.wantsUntrusted);a["delete"](c)})}}]);return d}();Object.defineProperty(R._assistant,"event",{value:Ca});
var Da=function(){function d(){H(this,d)}I(d,null,[{key:"has",value:function(a){var b,c;return null!==(b=null===(c=X.get("list",d))||void 0===c?void 0:c.has(a))&&void 0!==b?b:!1}},{key:"add",value:function(a,b){var c=X.get("list",d);if(!(b instanceof Worker))throw new TypeError("Not a Worker instance.");if(d.has(a))throw Error("The key already exists.");c||(c=new Map);c.set(a,b)}},{key:"get",value:function(a){var b;return null===(b=X.get("list",d))||void 0===b?void 0:b.get(a)}},{key:"create",value:function(a,
b){var c;(c=X.get("list",d))||(c=new Map);try{var e=new Worker(b);c.set(a,e)}catch(f){throw f;}return e}},{key:"close",value:function(a){var b;a instanceof Worker||(a=d.get(a),d.list["delete"](a));null===(b=a)||void 0===b?void 0:b.terminate()}},{key:"listener",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:void 0;if(!(a instanceof Worker)&&(a=d.get(a),void 0===a))throw Error("Worker not found.");return new Promise(function(c,e){a.C=e;a.onmessage=function(f){null===
b||void 0===b?void 0:b(f);c(f)}})}},{key:"addListener",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:void 0;if(!(a instanceof Worker)&&(a=d.get(a),void 0===a))throw Error("Worker not found.");return new Promise(function(c,e){a.addEventListener("messageerror",e);a.addEventListener("message",function(f){null===b||void 0===b?void 0:b(f);c(f)})})}}]);return d}();Object.defineProperty(R._assistant,"worker",{value:Da});
var W=function(){function d(){H(this,d)}I(d,null,[{key:"dereference",value:function(a){Object.keys(a).forEach(function(b){var c=a[b];if(d.isCollection(c))if(d.dereference(c),c instanceof Map)a["delete"](b);else if(c instanceof Set)a["delete"](c);else a[b]=null;else a[b]=null})}},{key:"get",value:function(a,b){b=Array.isArray(b)?b:b.split(".");for(var c=0;c<b.length&&!d.isEmpty(a);c++)a=a[b[c]];return a}},{key:"set",value:function(a,b,c){b=Array.isArray(b)?b:b.split(".");for(var e=0;e<b.length;a=a[b[e]],
e++)d.isEmpty(a[b[e]])&&(a[b[e]]={}),e===b.length-1&&(a instanceof Map?a.set(b[e],c):Object.defineProperty(a,b[e],{value:c,writable:!0,enumerable:!0,configurable:!0}))}},{key:"isEmpty",value:function(a){return null===a||void 0===a}},{key:"isString",value:function(a){return"string"===typeof a||a instanceof String}},{key:"isCollection",value:function(a){var b=[Map,Set,Array,WeakMap,WeakSet,Int8Array,Uint8Array,Int16Array,Int32Array,Uint16Array,Uint32Array,Float32Array,Float64Array,Uint8ClampedArray];
return!d.isEmpty(a)&&(d.isOnlyObject(a)||b.includes(a.constructor))}},{key:"isOnlyObject",value:function(a){return a&&(a.constructor===Object||void 0===a.constructor)}},{key:"getKeyByValue",value:function(a,b){a=Object.entries(a);for(var c=0;c<a.length;c++)if(a[c][1]===b)return a[c][0];return null}},{key:"deepCopy",value:function(a){var b,c;if(d.isEmpty(a))return a;var e=null!==(b=null===(c=a.constructor)||void 0===c?void 0:c.call(a))&&void 0!==b?b:Object.create(null);b=[e];c=[[Object.keys(a),Object.values(a)]];
do{a=b.shift();var f=c.shift();var g=va(f);f=g[0];var h=g[1];for(var k=0;k<f.length;k++){g=f[k];var l=h[k];if(d.isCollection(l)){var n,t,p;a[g]=null!==(n=null===(t=(p=l).constructor)||void 0===t?void 0:t.call(p))&&void 0!==n?n:Object.create(null);c.push([Object.keys(l),Object.values(l)]);b.push(a[g])}else a[g]=l}}while(0<c.length);return e}},{key:"merge",value:function(a,b){var c,e;if(d.isEmpty(a))return b;if(d.isEmpty(b))return a;var f=null!==(c=null===(e=b.constructor)||void 0===e?void 0:e.call(b))&&
void 0!==c?c:Object.create(null);c=[f];b=[[[Object.keys(a),Object.values(a)],[Object.keys(b),Object.values(b)]]];do{a=c.shift();e=b.shift();var g=va(e);var h=va(g[0]);e=h[0];h=h[1];var k=va(g[1]);g=k[0];var l=k[1];g=O(new Set(g.concat(e)));for(var n=0;n<g.length;n++){var t=[g[n],l[n]];k=t[0];var p=t[1];t=h[e.indexOf(k)];var v=d.isEmpty(t);if((d.isEmpty(t)||d.isCollection(t))&&d.isCollection(p)){var u,q,w=[];a[k]=null!==(u=null===(q=v?p.constructor:t.constructor)||void 0===q?void 0:q())&&void 0!==
u?u:Object.create(null);w[1]=[Object.keys(p),Object.values(p)];w[0]=v?[[],[]]:[Object.keys(t),Object.values(t)];c.push(a[k]);b.push(w)}else!d.isCollection(t)&&d.isCollection(p)?a[k]=t:Object.defineProperty(a,k,{writable:!0,enumerable:!0,value:v?p:t})}}while(0<b.length);return f}}]);return d}();Object.defineProperty(R._assistant,"object",{value:W});
var Y=function(){function d(){H(this,d)}I(d,null,[{key:"multiply",value:function(a,b){var c,e;a=a.toString();b=b.toString();var f=null!==(c=null===(e=b.split(".")[1])||void 0===e?void 0:e.length)&&void 0!==c?c:0;c=Math.pow(10,f);return Number(a.replace(".",""))*Number(b.replace(".",""))/c}},{key:"divide",value:function(a,b){var c,e,f,g;var h=Math.pow(10,Math.max(null!==(c=null===(e=a.toString().split(".")[1])||void 0===e?void 0:e.length)&&void 0!==c?c:0,null!==(f=null===(g=b.toString().split(".")[1])||
void 0===g?void 0:g.length)&&void 0!==f?f:0));return a*h/(b*h)}},{key:"getMedian",value:function(a){a=a.map(function(c){return c}).sort(function(c,e){return c-e});if(1===a.length%2){var b=window.parseInt(a.length/2);a=a[b]}else b=window.parseInt(a.length/2),a=(a[b-1]+a[b])/2;return a}},{key:"getMode",value:function(a){var b,c;var e=0;var f=[];var g=new Map;a.forEach(function(h){var k;c=null!==(k=g.get(h))&&void 0!==k?k:0;g.set(h,c+1)});e=(b=Math).max.apply(b,O(g.values()));g.forEach(function(h,k){h===
e&&f.push(k)});return f}},{key:"isFloat",value:function(a){var b;if(window.isNaN(b=window.parseFloat(a))||Math.floor(b)==b)return!1;if(a.endsWith("%")){if(100<b)return!1}else if(a.endsWith("\u2030")){if(1E3<b)return!1}else return!1;return!0}},{key:"getMinLegalSize",value:function(a,b){var c=[];var e=a[0]/a[1];var f=1>e?0:1;var g=Number(!f);a[f]<b[f]?(c[f]=b[f],c[g]=0===f?b[f]/e:b[f]*e):c=a;return c}},{key:"getMaxLegalSize",value:function(a,b){if(!a||!b||a[0]<=b[0]&&a[1]<=b[1])return a;var c=[];var e=
a[0]/a[1];var f=1<=b[0]/b[1]?1:0;var g=Number(!f);a[f]>b[f]?(c[f]=b[f],c[g]=0===f?b[f]/e:b[f]*e):c=a;return c}},{key:"intervalJudgment",value:function(a,b){b=b.replace(/ /g,"").toLowerCase();var c={"(":">",")":"<","[":">=","]":"<="};var e=b[0];var f=b.slice(-1);var g=Object.keys(c);b=b.slice(1,-1).split(",");b[0]=Number(b[0]);b[1]=Number(b[1]);return g.includes(e)||g.includes(f)?(new Function('"use strict"; return '+(a+c[e]+b[0]+"&&"+a+c[f]+b[1])))():!1}},{key:"insideRect",value:function(a,b){var c=
b[0];b=b[1];return a[0]<c[0]||a[1]<c[1]||a[0]>b[0]||a[1]>b[1]?!1:!0}}]);return d}();window.math&&(Y=Object.assign(Y,window.math));Object.defineProperty(R._assistant,"number",{value:Y});
var Ea=function(){function d(){H(this,d)}I(d,null,[{key:"base64Encode",value:function(a){return window.btoa(window.unescape(window.encodeURIComponent(a)))}},{key:"base64Decode",value:function(a){return window.decodeURIComponent(window.escape(window.atob(a)))}},{key:"ucfirst",value:function(a){return a[0].toUpperCase()+a.substring(1)}},{key:"replace",value:function(a,b,c){var e,f,g,h,k,l=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,n,t;b=Array.isArray(b)?b:[b];c=Array.isArray(c)?c:[c];
Array.isArray(a)?n=!0:(a=[a],n=!1);if(1<c.length&&b.length!==c.length)throw Error("The number of search strings does not match the number of replacement strings.");var p=[];for(k=0;k<a.length;k++){p[k]="";var v=a[k];for(t=e=g=h=0;g<b.length;g++,h+=1<c.length?1:0){var u=[];var q=b[g];var w=c[h];for(f=0;0<=f&&(0===l||0<l&&t<l);)f=v.indexOf(q,0===f&&0===t?0:f+1),t+=0<=f?1:0,u.push(f);-1!==u[u.length-1]&&u.push(-1);for(var y=0;0<u.length;y++)f=u.shift(),p[k]+=0<=f?v.substring(e,f)+w:v.substring(e),e=
f+q.length;e=0;v=p[k];p[k]=""}p[k]=v}return n?p:p.shift()}},{key:"colorConvert",value:function(a){a=a.toLowerCase();var b=Error("Not a legal color.");if(0===a.indexOf("#")){var c="rgba(";a=a.substring(1);3===a.length&&(a=a.split("").reduce(function(f,g){return f+g+g},""));if(6===a.length)for(b=0;3>b;b++)c+=Number("0x"+a[2*b]+a[2*b+1])+", ";else throw b;c+="255)"}else if(0===a.indexOf("rgb")){c="#";a=a.replace(/(rgb\(|rgba\(|\)| )/g,"").split(",");for(var e=0;3>e;e++)b=Number(a[e]).toString(16),c+=
1===b.length?b+b:b}else throw b;return c}}]);return d}();Object.defineProperty(R._assistant,"string",{value:Ea});
var Fa=function(){function d(){H(this,d)}I(d,null,[{key:"isOverflow",value:function(a,b){a=a.getBoundingClientRect();b=b?b.getBoundingClientRect():{x:0,y:0,width:window.innerWidth,height:window.innerHeight};return a.x<b.x||a.x+a.width>b.x+b.width||a.y<b.y||a.y+a.height>b.y+b.height?!0:!1}},{key:"getAllElement",value:function(a){var b=[];a=a.children;if(0!==a.length)for(var c=0;c<a.length;c++)b.push(a[c]),b=b.concat(d.getAllElement(a[c]));return b}},{key:"getNodeHeight",value:function(a){return a.offsetTop+
a.offsetHeight+parseInt(getComputedStyle(a,null).marginBottom)}},{key:"getBeforeElementHeight",value:function(a){var b;for(b=0;(a=a.previousElementSibling)&&!["absolute","fixed"].includes(getComputedStyle(a,null).position);)b+=a.offsetHeight;return b}},{key:"getNodeOriginalSize",value:function(a){var b=[0,0];d.getAllElement(a).forEach(function(c){"absolute"!=getComputedStyle(c,null).position&&(b[0]=c.offsetWidth>b[0]?c.offsetWidth:b[0],c.parentNode===a&&(b[1]+=c.offsetHeight))});return b}},{key:"maxZIndex",
value:function(a){var b;a?b=d.a(a):b=Array.from(document.all);return parseInt(b.reduce(function(c,e){e=getComputedStyle(e,null).zIndex;return Math.max(c,isNaN(e)?0:e)},0))}},{key:"objectToNode",value:function(a){var b={},c;for(c in a){var e=document.createElement(a[c].nodeType);if("undefined"!=typeof a[c].nodeType){for(var f in a[c])if("nodeType"!=f)if("innerhtml"==f.toLocaleLowerCase()){var g=d.objectToNode(a[c][f]),h;for(h in g)e.insertAdjacentElement("beforeend",g[h])}else"innertext"==f.toLocaleLowerCase()?
e.insertAdjacentText("beforeend",a[c][f]):e.setAttribute(f,a[c][f]);b[c]=e}}return b}},{key:"launchFullscreen",value:function(a){return a.requestFullscreen(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{navigationUI:"show"})}},{key:"exitFullscreen",value:function(){document.exitFullscreen()}},{key:"getFullscreenNode",value:function(){return document.fullscreenElement}},{key:"createScript",value:function(a){var b=document.createElement("script");"src type async defer charset innerHTML".split(" ").forEach(function(c){a[c]&&
(b[c]=a[c])});return b}}]);return d}();Object.defineProperty(R._assistant,"element",{value:Fa});
var Ga=function(){function d(){H(this,d)}I(d,null,[{key:"getDistribution",value:function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:2,e,f;if(1===c&&Array.isArray(a))throw Error("One-dimensional operation position value cannot be an array");if(2===c&&!Array.isArray(a))throw Error("Two-dimensional operation position value must be an array");(f=X.get("gaussian",d))||(f=new Map,X.set("gaussian",f,d));(e=f.get(b))||(e=Object.create(null),e.square=b*b,e.multiplier=[1/(b*Math.sqrt(2*
Math.PI)),1/(2*Math.PI*e.square)],f.set(b,e));switch(c){case 1:var g=Math.exp(-(a*a)/(2*e.square));break;case 2:g=Math.exp(-(Math.pow(a[0],2)+Math.pow(a[1],2))/(2*e.square))}return e.multiplier[c-1]*g}}]);return d}();Object.defineProperty(R._assistant,"formula",{value:Ga});
var Z=function(){function d(){H(this,d)}I(d,null,[{key:"getStorage",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];if(!d._achieve[a])throw Error("The specified storage ".concat(a," was not found."));return ua(d._achieve[a],O(b))}}]);return d}();N(Z,"_achieve",Object.create(null));Object.defineProperty(R._assistant,"storage",{value:Z});
var Ha=function(){function d(){H(this,d)}I(d,null,[{key:"drawText",value:function(a,b){b=W.o(b,{text:null,fill:!0,color:"black",direction:"ltr",textAlign:"center",textBaseline:"middle",font:"normal 16px Microsoft YaHei, serif",point:[a.canvas.width/2,a.canvas.height/2]});b.text&&(a.save(),a.font=b.font,a.fillStyle=b.color,a.direction=b.direction,a.textAlign=b.textAlign,a.textBaseline=b.textBaseline,b.point[1]+=a.measureText(b.text).G/2,!0===b.fill?a.fillText.apply(a,[b.text].concat(O(b.point),[b.maxWidth])):
a.strokeText.apply(a,[b.text].concat(O(b.point),[b.maxWidth])),a.restore())}},{key:"drawRound",value:function(a,b){b=W.o(b,{step:[],radius:5,fill:!0,borderWidth:5,borderColor:"black",fillColor:"transparent",point:[a.canvas.width/2,a.canvas.height/2]});a.save();a.fillStyle=b.fillColor;a.lineWidth=b.borderWidth;a.strokeStyle=b.borderColor;a.beginPath();a.setLineDash(b.step);a.arc.apply(a,O(b.point).concat([b.radius,0,2*Math.PI]));a.stroke();!0===b.fill&&a.fill();a.restore()}},{key:"drawRect",value:function(a){var b=
1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,e=3<arguments.length?arguments[3]:void 0,f=4<arguments.length?arguments[4]:void 0,g=5<arguments.length&&void 0!==arguments[5]?arguments[5]:1,h=6<arguments.length&&void 0!==arguments[6]?arguments[6]:"white",k=7<arguments.length&&void 0!==arguments[7]?arguments[7]:!1;a.save();a.lineWidth=g;Array.isArray(k)?(a.strokeStyle=h,a.setLineDash(k),a.strokeRect(b,c,e,f)):(a.fillStyle=h,a.fillRect(b,
c,e,f));a.restore()}},{key:"drawLBorder",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,e=3<arguments.length?arguments[3]:void 0,f=4<arguments.length?arguments[4]:void 0,g=5<arguments.length&&void 0!==arguments[5]?arguments[5]:25,h=6<arguments.length&&void 0!==arguments[6]?arguments[6]:5,k=7<arguments.length&&void 0!==arguments[7]?arguments[7]:"#0eb0f1",l=8<arguments.length&&void 0!==arguments[8]?arguments[8]:
!1;a.save();Array.isArray(l)?a.strokeStyle=k:(a.fillStyle=k,a.fillRect(b,c,g,h),a.fillRect(b,c,h,g),a.fillRect(b+e,c,-g,h),a.fillRect(b+e,c,-h,g),a.fillRect(b+e,c+f,-g,-h),a.fillRect(b+e,c+f,-h,-g),a.fillRect(b,c+f,g,-h),a.fillRect(b,c+f,h,-g));a.restore()}},{key:"drawGrid",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,e=3<arguments.length?arguments[3]:void 0,f=4<arguments.length?arguments[4]:void 0,g=5<
arguments.length&&void 0!==arguments[5]?arguments[5]:1,h=6<arguments.length&&void 0!==arguments[6]?arguments[6]:"black",k=7<arguments.length&&void 0!==arguments[7]?arguments[7]:"quarter",l=8<arguments.length&&void 0!==arguments[8]?arguments[8]:!1;if(d["drawGrid"+Ea.ucfirst(k)]instanceof Function)d["drawGrid"+Ea.ucfirst(k)](a,b,c,null!==e&&void 0!==e?e:a.canvas.width,null!==f&&void 0!==f?f:a.canvas.height,g,h,l);else throw Error(k+" grid not detected");}},{key:"drawGridQuarter",value:function(a){var b=
1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,e=3<arguments.length?arguments[3]:void 0,f=4<arguments.length?arguments[4]:void 0,g=5<arguments.length&&void 0!==arguments[5]?arguments[5]:1,h=6<arguments.length&&void 0!==arguments[6]?arguments[6]:"black",k=7<arguments.length&&void 0!==arguments[7]?arguments[7]:!1;var l=[Y.divide(e,4),Y.divide(f,4)];a.save();a.beginPath();a.lineWidth=g;a.strokeStyle=h;Array.isArray(k)&&a.setLineDash(k);
for(g=1;4>g;g++)a.moveTo(l[0]*g+b,c),a.lineTo(l[0]*g+b,c+f),a.moveTo(b,l[1]*g+c),a.lineTo(b+e,l[1]*g+c);a.stroke();a.restore()}},{key:"layerMerge",value:function(a,b,c,e,f){var g=5<arguments.length&&void 0!==arguments[5]?arguments[5]:"source-over",h;(h=X.get("mergeCas",d))||(h=new OffscreenCanvas(a.canvas.width,a.canvas.height),X.set("mergeCas",h,d));var k=h.getContext("2d");k.save();k.drawImage.apply(k,[b].concat(O(c)));k.globalCompositeOperation=g;k.drawImage.apply(k,[e].concat(O(f)));a.clearRect(0,
0,a.canvas.width,a.canvas.height);a.drawImage(h,0,0);k.restore();k.clearRect(0,0,h.width,h.height)}},{key:"download",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"canvas",c=2<arguments.length?arguments[2]:void 0;if(X.has("downloadNode",d))var e=X.get("downloadNode",d);else e=document.createElement("a"),X.set("downloadNode",e,d);e.download=b;e.href=a.toDataURL(c);e.click()}}]);return d}();Object.defineProperty(R._assistant,"canvas",{value:Ha});
var Ia=function(){function d(){H(this,d)}I(d,null,[{key:"getImagedata",value:function(a){if(a instanceof Image){var b=document.createElement("canvas");var c=b.getContext("2d");c.drawImage(a,0,0);a=c.getImageData(0,0,b.width,b.height)}else if(!(a instanceof ImageData))throw Error("can not parse image");return a}},{key:"grayscale",value:function(a){try{var b=d.getImagedata(a);var c=b.width*b.height*4;var e=new Uint8ClampedArray(b.data.length);for(a=0;a<c;a+=4){var f=b.data[a];var g=b.data[a+1];var h=
b.data[a+2];var k=b.data[a+3];var l=.299*f+.587*g+.114*h;e[a]=l;e[a+1]=l;e[a+2]=l;e[a+3]=k}}catch(n){throw n;}return new ImageData(e,b.width,b.height)}},{key:"gaussianBlur",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:3,c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,e,f,g,h,k,l,n;try{var t=d.getImagedata(a);var p=t.width;var v=t.height;var u=0;(f=X.get("gaussianMask",d))||(f=new Map,X.set("gaussianMask",f,d));if(!(e=f.get("".concat(b,",").concat(c)))){e=
[];for(n=-b;n<=b;n++){var q=Ga.getDistribution(n,c,1);e.push(q);u+=q}for(q=0;q<e.length;q++)e[q]/=u;f.set("".concat(b,",").concat(c),e)}var w=new Uint8ClampedArray(t.data.length);for(l=0;l<v;l++)for(k=0;k<p;k++){var y=g=h=u=0;var r=4*(l*p+k);for(c=-b;c<=b;c++){var J=k+c;n=c+b;if(0<=J&&J<p){var K=4*(l*p+J);y+=t.data[K]*e[n];g+=t.data[K+1]*e[n];h+=t.data[K+2]*e[n];u+=e[n]}}w[r]=y/u;w[r+1]=g/u;w[r+2]=h/u;w[r+3]=t.data[r+3]}for(k=0;k<p;k++)for(l=0;l<v;l++){y=g=h=u=0;r=4*(l*p+k);for(t=-b;t<=b;t++)J=l+
t,n=t+b,0<=J&&J<v&&(K=4*(J*p+k),y+=w[K]*e[n],g+=w[K+1]*e[n],h+=w[K+2]*e[n],u+=e[n]);w[r]=y/u;w[r+1]=g/u;w[r+2]=h/u}}catch(V){throw V;}return new ImageData(w,p,v)}},{key:"mirror",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,c,e;try{var f=d.getImagedata(a);var g=f.width;var h=f.height;var k=new Uint8ClampedArray(f.data.length);for(e=0;e<h;e++)for(c=0;c<g;c++){var l=4*(e*g+c);if(0==b)var n=4*(e*g+g-c);else if(1==b)n=4*((h-e)*g+c);else throw Error("not give axis");
k[l]=f.data[n];k[l+1]=f.data[n+1];k[l+2]=f.data[n+2];k[l+3]=f.data[n+3];k[n]=f.data[l];k[n+1]=f.data[l+1];k[n+2]=f.data[l+2];k[n+3]=f.data[l+3]}}catch(t){throw t;}return new ImageData(k,g,h)}}]);return d}();N(Ia,"__gaussianMask",{});Object.defineProperty(R._assistant,"canvasFilter",{value:Ia});
var Ja=function(){function d(){H(this,d)}I(d,null,[{key:"loadFailedFade",value:function(a,b){var c,e,f,g;if(!(a instanceof CanvasRenderingContext2D))throw Error('Requires a value of type "CanvasRenderingContext2D"');W.isEmpty(b)&&(b=Object.create(null));var h="animation-loadFailedFade-"+Date.now()+"-"+performance.now()+(b.sign?"-"+b.sign:"");b=W.o(b,{duration:4,speed:null,icon:{size:72,"char":["!","?"],color:"rgba(220, 53, 69)",font:"bold 72px Microsoft YaHei, serif"},text:{size:16,color:"black",
text:"Load Failed",font:"normal 16px Microsoft YaHei, serif"},round:{step:[5],radius:48,fill:!1,borderWidth:5,fillColor:"#ddd",borderColor:"#ddd"}});var k=JSON.stringify(b.icon);var l=JSON.stringify(b.text);var n=JSON.stringify(b.round);b.speed=null!==(c=b.speed)&&void 0!==c?c:b.duration/(2*b.icon["char"].length);(c=X.get("loadFailedFade",d))||(c=new Map,X.set("loadFailedFade",c,d));if(!(f=c.get(k))){f=[];for(var t=0;t<b.icon["char"].length;t++){f[t]=new OffscreenCanvas(b.icon.size,b.icon.size);var p=
f[t].getContext("2d");b.icon.text=b.icon["char"][t];Ha.drawText(p,b.icon)}c.set(k,f)}(g=c.get(l))||(g=new OffscreenCanvas(b.text.size*b.text.text.length,2*b.text.size),k=g.getContext("2d"),Ha.drawText(k,b.text),c.set(l,g));(l=c.get(n))||(l=k=2*(b.round.radius+b.round.borderWidth),l=new OffscreenCanvas(l,k),k=l.getContext("2d"),Ha.drawRound(k,b.round),c.set(n,l));var v=1;var u=e=0;var q=[a.canvas.width/2,a.canvas.height/2];c=[l.width/2,(l.height+g.height)/2];n=[g.width/2,(l.height-g.height)/2];var w=
1/(b.duration/f.length/2*1E3/(1E3/60));var y=function(){var r=w*v,J=Number(a.canvas.getAttribute(h)),K=[f[u].width/2,(f[u].height+g.height)/2];void 0!==J&&0!==J&&(a.clearRect(q[0]-K[0],q[1]-K[1],f[u].width,f[u].height),1<e+r?(e=1,v=-v):0>e+r?(e=0,v=-v,u=u+1<f.length?u+1:0):e+=r,a.globalAlpha=e,a.drawImage(f[u],q[0]-K[0],q[1]-K[1]),window.requestAnimationFrame(y))};a.globalAlpha=1;a.drawImage(l,q[0]-c[0],q[1]-c[1]);a.drawImage(g,q[0]-n[0],q[1]+n[1]);a.canvas.setAttribute(h,1);window.requestAnimationFrame(y);
return h}}]);return d}();Object.defineProperty(R._assistant,"canvasAnimation",{value:Ja});
var Ka=function(d){function a(){H(this,a);return b.apply(this,arguments)}F(a,d);var b=G(a);I(a,[{key:"initOption",value:function(c){D(E(a.prototype),"initOption",this).call(this,c);this.option.layer=R._assistant.object.merge(this.option.layer,R._option.page)}},{key:"linkageOption",value:function(){D(E(a.prototype),"linkageOption",this).call(this);null!==this.option.layer.src&&null!==this.option.layer.srcdoc&&(this.option.layer.srcdoc=null)}},{key:"initStruct",value:function(){D(E(a.prototype),"initStruct",
this).call(this);var c=this.variable.struct._build.container;var e=this.variable.struct._backup.title=R._struct.title;var f=this.variable.struct._backup.action=R._struct.action;var g=this.variable.struct._backup.content=R._struct.content;var h=this.variable.struct._backup.content_page=R._struct.content_page;var k=this.variable.struct._backup.action_button=R._struct.action_button;f.innerHTML.push(k.minimize,k.expand,k.close);e.innerHTML.push(f);!1!==this.option.title&&c.innerHTML.push(e);g.innerHTML.push(h);
c.innerHTML.push(g);this.option.resize.enable&&(h=this.variable.struct._backup.resize_box=R._struct.resize_box,c.innerHTML.push(h));this.option.progress.enable&&(h=this.variable.struct._backup.progress_bar=R._struct.progress_bar,c.innerHTML.push(h))}},{key:"initNode",value:function(){var c=this;D(E(a.prototype),"initNode",this).call(this);var e=this.variable.nodes.container.querySelector(".modal-layer-page-content");var f="display: block; width: "+this.option.layer.area[0]+"px; height: "+this.option.layer.area[1]+
"px";Object.keys(this.option.layer).forEach(function(h){R._assistant.object.isEmpty(c.option.layer[h])||("name"===h?e.setAttribute("name",c.option.layer.name+c.option.index):e.setAttribute(h,c.option.layer[h]))});e.style=f;this.variable.animationName.minimize_queue_transition_scale="transition-scale-50-50-animation";if(!R._assistant.css.hasCss("transition-scale-50-50-animation")){var g={from:"transform: scale(0.5, 0.5)",to:"transform: scale(1, 1)"};f=R._assistant.css.createAnimation("transition-scale-50-50-animation",
g);R._assistant.css.addCss("transition-scale-50-50-animation",f);R._assistant.css.addCss("transition-scale-50-50-animation-reverse",R._assistant.css.createAnimation("transition-scale-50-50-animation-reverse",{from:g.to,to:g.from}))}}},{key:"resize",value:function(){var c=0;var e=this.variable.nodes.container;var f=e.children;var g=e.querySelector("iframe[name="+this.option.layer.name+this.option.index+"]");g=g.offsetWidth+2*g.parentNode.offsetLeft;for(var h=0;h<f.length;h++)c="absolute"==getComputedStyle(f[h],
null).position?c:Math.max(R._assistant.element.getNodeHeight(f[h]),c);e.style.width=g+"px";e.style.height=c+"px";this.variable.defaultArea=[g,c]}}]);return a}(R);R._achieve.set("page",Ka);
var La=function(d){function a(){H(this,a);return b.apply(this,arguments)}F(a,d);var b=G(a);I(a,[{key:"initStruct",value:function(){D(E(a.prototype),"initStruct",this).call(this);var c=this.variable.struct._build.container;var e=this.variable.struct._backup.title=R._struct.title;var f=this.variable.struct._backup.action=R._struct.action;var g=this.variable.struct._backup.content=R._struct.content;var h=this.variable.struct._backup.interaction=R._struct.interaction;var k=this.variable.struct._backup.action_button=
R._struct.action_button;var l=this.variable.struct._backup.interaction_button=R._struct.interaction_button;f.innerHTML.push(k.close);e.innerHTML.push(f);!1!==this.option.title&&c.innerHTML.push(e);c.innerHTML.push(g);this.option.resize.enable&&(f=this.variable.struct._backup.resize_box=R._struct.resize_box,c.innerHTML.push(f));this.option.progress.enable&&(f=this.variable.struct._backup.progress_bar=R._struct.progress_bar,c.innerHTML.push(f));h.innerHTML.push(l.ok);c.innerHTML.push(h)}},{key:"initNode",
value:function(){D(E(a.prototype),"initNode",this).call(this);var c=this.variable.nodes.container.querySelector(".modal-layer-content");if(Array.isArray(this.option.content.value)){var e=R._assistant.element.objectToNode(this.option.content.value);Object.keys(e).forEach(function(f){c.appendChild(e[f])})}else c.innerHTML=this.option.content.value}}]);return a}(R);R._achieve.set("alert",La);
var Na=function(d){function a(){H(this,a);return b.apply(this,arguments)}F(a,d);var b=G(a);I(a,[{key:"initOption",value:function(c){var e=this,f;D(E(a.prototype),"initOption",this).call(this,c);this.option.layer=R._assistant.object.merge(this.option.layer,R._option.image);var g=[window.innerWidth,window.innerHeight];Object.values(this.option.layer.sizeRange).forEach(function(h){h.forEach(function(k,l){if((""+k).endsWith("%"))f=100;else if((""+k).endsWith("\u2030"))f=1E3;else if((""+k).includes("0."))f=
1;else return k;h[l]=g[l]*window.parseFloat(k)/f})});this.option.layer.sizeRange.min[0]>this.option.layer.sizeRange.max[0]&&(this.option.layer.sizeRange.min[0]=this.option.layer.sizeRange.max[0]);this.option.layer.sizeRange.min[1]>this.option.layer.sizeRange.max[1]&&(this.option.layer.sizeRange.min[1]=this.option.layer.sizeRange.max[1]);Object.keys(this.option.layer.toolbar.config).forEach(function(h,k){k=e.option.layer.toolbar.config[h];"boolean"==typeof k&&(e.option.layer.toolbar.config[h]={enable:k,
title:R._option.image.toolbar.config[h].title,icon:R._option.image.toolbar.config[h].icon});R._assistant.object.isOnlyObject(k.config)?Object.keys(k.config).forEach(function(l,n){n=k.config[l];"boolean"==typeof n&&(e.option.layer.toolbar.config[h].config[l]={enable:n,title:R._option.image.toolbar.config[h].config[l].title,icon:R._option.image.toolbar.config[h].config[l].icon})}):R._option.image.toolbar.config[h].config&&(e.option.layer.toolbar.config[h].config=JSON.parse(JSON.stringify(R._option.image.toolbar.config[h].config)))})}},
{key:"compatibleOption",value:function(c){var e,f;D(E(a.prototype),"compatibleOption",this).call(this,c);var g=R._assistant.object.get(c,"layer.image");g instanceof FileList&&(c.layer.image=Object.values(g));Array.isArray(c.layer.image)||(c.layer.image=[c.layer.image]);var h=null!==(e=R._assistant.object.get(c,"layer.toolbar.config"))&&void 0!==e?e:[];Object.keys(h).forEach(function(l){h[l]="boolean"===typeof h[l]?{enable:h[l]}:h[l]});var k=null!==(f=R._assistant.object.get(c,"layer.toolbar.config.filter.config"))&&
void 0!==f?f:[];Object.keys(k).forEach(function(l){k[l]="boolean"===typeof k[l]?{enable:k[l]}:k[l]})}},{key:"linkageOption",value:function(){var c;D(E(a.prototype),"linkageOption",this).call(this);var e=c=!1;var f=Object.entries(this.option.layer.toolbar.config);var g=Object.entries(this.option.layer.toolbar.config.filter.config);for(var h=0;h<g.length;h++)if(!0===g[h][1].enable){c=!0;break}this.option.layer.toolbar.config.filter.enable=c;for(c=0;c<f.length;c++)if(!0===f[c][1].enable){e=!0;break}this.option.layer.toolbar.enable=
e;!1===this.option.layer.toolbar.config.crop.enable&&(this.option.layer.toolbar.config.crop.grid=!1)}},{key:"checkOption",value:function(){D(E(a.prototype),"checkOption",this).call(this);if(R._assistant.object.isEmpty(this.option.layer.image))throw Error("layer.image can not be empty!");if(this.option.layer.size&&!Array.isArray(this.option.layer.size))throw Error("layer.size does not meet expectations.");if(!this.option.layer.size&&(window.isNaN(parseInt(this.option.layer.sizeRange.min[0]))||window.isNaN(parseInt(this.option.layer.sizeRange.min[1]))||
window.isNaN(parseInt(this.option.layer.sizeRange.max[0]))||window.isNaN(parseInt(this.option.layer.sizeRange.max[1]))))throw Error("layer.sizeRange does not meet expectations.");}},{key:"initVariable",value:function(){D(E(a.prototype),"initVariable",this).call(this);this.variable.image={spin:{scale:1,angle:90},"default":{size:null,imageData:null},reload:0,link:null,history:[],finish:null,status:R._enum.LOAD_STATUS.LOADING}}},{key:"initStruct",value:function(){var c=this;D(E(a.prototype),"initStruct",
this).call(this);var e=this.variable.struct._build.container;var f=this.variable.struct._backup.title=R._struct.title;var g=this.variable.struct._backup.action=R._struct.action;var h=this.variable.struct._backup.toolbar=R._struct.toolbar;var k=this.variable.struct._backup.tools=R._struct.image_tools;var l=this.variable.struct._backup.content=R._struct.content;var n=this.variable.struct._backup.action_button=R._struct.action_button;var t=this.variable.struct._backup.content_image=R._struct.content_image;
var p=this.variable.struct._backup.image_tools_child=R._struct.image_tools_child;g.innerHTML.push(n.close);f.innerHTML.push(g);!1!==this.option.title&&e.innerHTML.push(f);Object.keys(this.option.layer.toolbar.config).forEach(function(v){c.option.layer.toolbar.config[v].enable&&h.innerHTML.push(k[v]);c.option.layer.toolbar.config[v].config instanceof Object&&c.option.layer.toolbar.config[v].enable&&Object.keys(c.option.layer.toolbar.config[v].config).forEach(function(u){k[v].innerHTML[1].innerHTML.push(p[v][u])})});
this.option.layer.toolbar.enable&&e.innerHTML.push(h);l.innerHTML.push(t);e.innerHTML.push(l);this.option.resize.enable&&(g=this.variable.struct._backup.resize_box=R._struct.resize_box,e.innerHTML.push(g));this.option.progress.enable&&(g=this.variable.struct._backup.progress_bar=R._struct.progress_bar,e.innerHTML.push(g))}},{key:"initNode",value:function(){var c=this;D(E(a.prototype),"initNode",this).call(this);var e=this.variable.nodes.container.querySelector(".modal-layer-toolbar");this.option.layer.toolbar.enable&&
Object.keys(this.option.layer.toolbar.config).forEach(function(f,g){g=c.option.layer.toolbar.config[f];if(g.enable){var h;var k=e.querySelector('.modal-layer-toolbar-item[tool-type="'+f+'"]');var l=k.querySelector(".modal-layer-toolbar-item-icon");k.setAttribute("title",g.title);(h=l.classList).add.apply(h,O(g.icon.split(" ")));g.config instanceof Object&&Object.entries(g.config).forEach(function(n,t){t=n[0];n=n[1];if(n.enable){var p=k.querySelector(".modal-layer-toolbar-item-child-list");t=k.querySelector(".modal-layer-toolbar-"+
f+"-icon["+f+'-type="'+t+'"]');p.setAttribute("title",n.title);n.icon?t.classList.add(n.icon):t.innerText=n.textIcon}})}});this.variable.image.finish=this.load().then(function(f){return c.loaded(f)})["catch"](function(){return c.failed()})}},{key:"bindEvent",value:function(){var c=this;D(E(a.prototype),"bindEvent",this).call(this);var e={once:!1,capture:!1,passive:!1,mozSystemGroup:!1};var f=this.variable.nodes.container;var g=R._assistant.object.getKeyByValue(R._enum.LOAD_STATUS,R._enum.LOAD_STATUS.FAILED);
this.variable.eventSymbol.imageReload=R._assistant.event.add(f,"click",'.modal-layer-image-canvas[load-status="'+g+'"]',this.reload,this,null,e);Object.keys(this.event.imageTools).forEach(function(h){c.event.imageTools[h]&&c.event.imageTools[h]instanceof Function&&(c.variable.eventSymbol["imageTool".concat(h)]=R._assistant.event.add(f,"click",'.modal-layer-toolbar-item[tool-type="'.concat(h,'"]'),c.event.imageTools[h],c,null,e))})}},{key:"resize",value:function(){var c;var e=this.variable.nodes.container;
var f=e.querySelector(".modal-layer-content");var g=f.querySelector(".modal-layer-image-canvas").getBoundingClientRect();var h=e.querySelector(".modal-layer-toolbar");var k=h.getBoundingClientRect().height;var l=window.getComputedStyle(f,null);var n=R._assistant.element.getBeforeElementHeight(f);f=f.offsetTop-n;n+=this.option.content.fullContainer?0:2*f;this.option.layer.size?c=O(this.option.layer.size):this.variable.image.status!==R._enum.LOAD_STATUS.LOADING?c=[g.width,g.height]:c=O(this.option.layer.sizeRange.min);
c[0]+=parseFloat(l.marginLeft)+parseFloat(l.marginRight);c[1]+=n;e.style.width=c[0]+"px";this.option.layer.toolbar.enable&&(g=h.getBoundingClientRect().height,c[1]=c[1]-k+g);e.style.height=c[1]+"px";this.variable.defaultArea=c;!this.option.drag.overflow&&R._assistant.element.isOverflow(e,this.option.window)&&(e.style.cssText+="margin-top: auto; margin-left: auto")}},{key:"load",value:function(){var c=this,e=this.variable.nodes.container.querySelector(".modal-layer-image-canvas");this.variable.image.status=
R._enum.LOAD_STATUS.LOADING;e.setAttribute("load-status",R._assistant.object.getKeyByValue(R._enum.LOAD_STATUS,R._enum.LOAD_STATUS.LOADING));this.variable.image.fadeAttr&&e.removeAttribute(this.variable.image.fadeAttr);this.variable.image.layer instanceof Ma?this.variable.image.layer.show():this.variable.image.layer=R.loading({mask:!1,popupTime:0,layer:{icon:1,duration:1,color:"deepskyblue"},window:this.variable.nodes.container.querySelector(".modal-layer-content")},function(f){throw f;});return this.variable.image.finish=
new Promise(function(f,g){for(var h=new Image;!c.variable.image.link&&c.variable.image.reload<c.option.layer.image.length;){var k;(null===(k=c.variable.image.link)||void 0===k?0:k.startsWith("blob:"))&&URL.revokeObjectURL(c.variable.image.link);c.variable.image.link=R._assistant.file.getImage(c.option.layer.image[c.variable.image.reload++])}h.onload=function(){return f(h)};h.onerror=g;h.src=c.variable.image.link})}},{key:"reload",value:function(){var c=this;this.variable.image.finish=this.load().then(function(e){return c.loaded(e)})["catch"](function(){return c.failed()})["finally"](function(){return c.resize()})}},
{key:"loaded",value:function(c){var e=this;var f=this.variable.nodes.container.querySelector(".modal-layer-image-canvas");this.variable.image.status=R._enum.LOAD_STATUS.LOADED;this.variable.image["default"].size=this.option.layer.size?this.option.layer.size:c.naturalWidth>this.option.layer.sizeRange.max[0]||c.naturalHeight>this.option.layer.sizeRange.max[1]?R._assistant.number.getMaxLegalSize([c.naturalWidth,c.naturalHeight],this.option.layer.sizeRange.max):c.naturalWidth<this.option.layer.sizeRange.min[0]||
c.naturalHeight<this.option.layer.sizeRange.min[1]?R._assistant.number.getMinLegalSize([c.naturalWidth,c.naturalHeight],this.option.layer.sizeRange.min):[c.naturalWidth,c.naturalHeight];f.width=this.variable.image["default"].size[0];f.height=this.variable.image["default"].size[1];f.setAttribute("load-status",R._assistant.object.getKeyByValue(R._enum.LOAD_STATUS,R._enum.LOAD_STATUS.LOADED));window.requestAnimationFrame(function(){var g,h;e.variable.image.layer&&e.variable.image.layer instanceof Ma&&
e.variable.image.layer.hide();(g=f.getContext("2d")).drawImage.apply(g,[c,0,0,c.width,c.height,0,0].concat(O(e.variable.image["default"].size)));e.variable.image["default"].imageData=(h=f.getContext("2d")).getImageData.apply(h,[0,0].concat(O(e.variable.image["default"].size)))})}},{key:"failed",value:function(){var c,e;var f=this.variable.nodes.container.querySelector(".modal-layer-image-canvas");this.variable.image.status=R._enum.LOAD_STATUS.FAILED;f.setAttribute("load-status",R._assistant.object.getKeyByValue(R._enum.LOAD_STATUS,
R._enum.LOAD_STATUS.FAILED));this.variable.image.reload<this.option.layer.image.length?e={duration:4,sign:"load-failed",icon:{size:72,"char":"!?",color:"rgba(220, 53, 69)",font:"bold 72px Microsoft YaHei, serif"},round:{step:[4],radius:50,borderWidth:5,borderColor:"rgb(230, 230, 230)"},text:{color:"rgba(220, 53, 69)",text:"\u56fe\u7247\u52a0\u8f7d\u5931\u8d25, \u8bf7\u70b9\u51fb\u91cd\u8bd5",font:"lighter 16px Microsoft YaHei, serif"}}:e={duration:4,sign:"finally-load-failed",icon:{size:80,"char":"\u00d7",
font:"bold 80px Microsoft YaHei, serif"},round:{step:[5],radius:50,borderWidth:5,borderColor:"rgb(230, 230, 230)"},text:{color:"rgba(220, 53, 69)",text:"\u56fe\u7247\u52a0\u8f7d\u5931\u8d25, \u8bf7\u8054\u7cfb\u7ba1\u7406\u5458",font:"lighter 16px Microsoft YaHei, serif"}};this.variable.image.fadeAttr=R._assistant.canvasAnimation.loadFailedFade(f.getContext("2d"),e);(null===(c=this.variable.image.link)||void 0===c?0:c.startsWith("blob:"))&&URL.revokeObjectURL(this.variable.image.link);this.variable.image.link=
null;this.variable.image.layer instanceof Ma&&this.variable.image.layer.hide()}},{key:"removeAllEvent",value:function(){var c=this,e=this.variable.nodes.container;D(E(a.prototype),"removeAllEvent",this).call(this);Object.keys(this.event.imageTools).forEach(function(f){c.event.imageTools[f]&&c.event.imageTools[f]instanceof Function&&e.removeEventListener("click",c.event.imageTools[f])})}},{key:"crop",value:function(){var c=this,e,f;var g=!0;var h=null;var k=[];var l=R._assistant.number.divide(5,2);
k[2]=R._assistant.number.multiply(5,2);k[4]=R._assistant.number.multiply(5,4);k[6]=R._assistant.number.multiply(5,6);var n=this.variable.nodes.container.querySelector(".modal-layer-image-canvas");var t=n.width;var p=n.height;var v=R._assistant.number.floor(.1*t);var u=R._assistant.number.floor(.1*p);var q=n.cloneNode();var w=q.getContext("2d");q.width=window.innerWidth;q.height=window.innerHeight;q.style="display: block; position: fixed; top: 0px; bottom: 0px; left: 0px; right: 0px; visibility: visible; opacity: 1; border: 0px; margin: 0px; z-index: "+
R._assistant.element.maxZIndex()+";";var y=[R._assistant.number.chain(q.width).subtract(t).divide(2).round().done(),R._assistant.number.chain(q.height).subtract(p).divide(2).round().done()];var r=[].concat(O(y),[t,p]);var J=function(){var x;w.save();w.clearRect(0,0,q.width,q.height);w.fillStyle="rgba(0, 0, 0, 0.4)";w.fillRect(0,0,q.width,q.height);w.globalCompositeOperation="destination-out";w.fillStyle="white";w.fillRect.apply(w,O(r));w.globalCompositeOperation="source-over";(x=R._assistant.canvas).drawGrid.apply(x,
[w].concat(O(r),[2,"white","quarter"]));R._assistant.canvas.drawRect(w,r[0]-l,r[1]-l,r[2]+5,r[3]+5,5,"white",[0]);R._assistant.canvas.drawLBorder(w,r[0]-k[2],r[1]-k[2],r[2]+k[4],r[3]+k[4],k[6],5,"white");w.globalCompositeOperation="destination-over";w.drawImage.apply(w,[n].concat(O(y)));w.restore();g?h=window.requestAnimationFrame(J):window.cancelAnimationFrame(h)};var K=function(){document.removeEventListener("keyup",V);q.removeEventListener("mousemove",Aa);q.removeEventListener("dbclick",qa);g=
!1;q.remove()};var V=function(x){var C;x=null!==(C=x)&&void 0!==C?C:window.event;switch(x.code){case "Enter":qa();x.preventDefault();break;case "Escape":c.show(),K(),x.preventDefault()}};var qa=function(x){var C;K();x=null!==(C=x)&&void 0!==C?C:window.event;x=new OffscreenCanvas(n.width,n.height);x.getContext("2d").drawImage(n,0,0);n.width=r[2];n.height=r[3];n.getContext("2d").drawImage(x,r[0]-y[0],r[1]-y[1],r[2],r[3],0,0,n.width,n.height);c.show().then(function(){return c.resize()})};var Aa=function(x){var C;
x=null!==(C=x)&&void 0!==C?C:window.event;if(e&&1===x.buttons)if("drag"===e)r[0]+x.movementX>y[0]&&r[0]+r[2]+x.movementX<y[0]+t&&(r[0]+=x.movementX),r[1]+x.movementY>y[1]&&r[1]+r[3]+x.movementY<y[1]+p&&(r[1]+=x.movementY);else{if("resize"===e){C=O(r);f.includes(R._enum.POSITION.WEST)&&(r[0]+=x.movementX,r[2]-=x.movementX);f.includes(R._enum.POSITION.EAST)&&(r[2]+=x.movementX);f.includes(R._enum.POSITION.NORTH)&&(r[1]+=x.movementY,r[3]-=x.movementY);f.includes(R._enum.POSITION.SOUTH)&&(r[3]+=x.movementY);
if(r[0]<y[0]||r[0]+r[2]>y[0]+t)r[0]=C[0],r[2]=C[2];if(r[1]<y[1]||r[1]+r[3]>y[1]+p)r[1]=C[1],r[3]=C[3];r[2]<v&&(r[2]=C[2],r[0]+r[2]>y[0]+t&&(r[0]=y[0]+t-r[2]));r[3]<u&&(r[3]=C[3],r[1]+r[3]>y[1]+p&&(r[1]=y[1]+p-r[3]))}}else{x=[x.x,x.y];var L=[r[0]-k[2],r[1]-k[2],r[2]+k[4],r[3]+k[4]];var M=[r[0]-l,r[1]-l,r[2]+5,r[3]+5];x[0]>M[0]&&x[0]<M[0]+M[2]&&x[1]>M[1]&&x[1]<M[1]+M[3]?(C="move",e="drag"):x[0]>L[0]&&x[0]<L[0]+L[2]&&x[1]>L[1]&&x[1]<L[1]+L[3]?(e="resize",C=f="",x[1]>L[1]&&x[1]<M[1]&&(C=f+=R._enum.POSITION.NORTH),
x[1]>M[1]+M[3]&&x[1]<L[1]+L[3]&&(C=f+=R._enum.POSITION.SOUTH),x[0]>L[0]&&x[0]<M[0]&&(C=f+=R._enum.POSITION.WEST),x[0]>M[0]+M[2]&&x[0]<L[0]+L[2]&&(C=f+=R._enum.POSITION.EAST),C+="-resize"):(e=null,C="default");q.style.cssText+="cursor: "+C}};this.hide();J();document.addEventListener("keyup",V);q.addEventListener("mousemove",Aa);q.addEventListener("dblclick",qa);document.body.appendChild(q)}},{key:"spin",value:function(){var c=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:void 0,f,g,
h,k;var l=this.variable.nodes.container.querySelector(".modal-layer-image-canvas");var n=l.getContext("2d");var t=new OffscreenCanvas(l.width,l.height);t.getContext("2d").drawImage(l,0,0,l.width,l.height);this.variable.image.finish.then(function(){var p;e=null!==(p=e)&&void 0!==p?p:c.variable.image.spin.angle;l.style.transform="rotate("+e+"deg)";f=l.getBoundingClientRect();l.style.transform="scale(".concat(c.variable.image.spin.scale,")");c.option.layer.size||c.option.layer.sizeRange.max[0]>=f.width&&
c.option.layer.sizeRange.max[1]>=f.height?h=c.variable.image.spin.scale:(k=R._assistant.number.getMaxLegalSize([f.width,f.height],c.option.layer.sizeRange.max),h=k[0]/f.width);l.width=f.width;l.height=f.height;l.style.transform="scale(".concat(h,")");g=e*Math.PI/180;n.save();n.translate(l.width/2,l.height/2);n.rotate(g);n.drawImage(t,-t.width/2,-t.height/2);n.restore();c.resize()})}},{key:"filter",value:function(c){var e=this,f,g;var h=c.getAttribute("filter-type");var k=this.variable.nodes.container.querySelector(".modal-layer-image-canvas");
if(k.getAttribute("load-status")!=R._enum.LOAD_STATUS.FAILED&&h){var l=k.getContext("2d");var n=l.getImageData(0,0,k.width,k.height);var t=this.variable.image.layer.show();if(R._env.feature.Worker){var p="image-layer-worker-"+Date.now();var v="!"+R._worker.get("canvasFilter").toString()+"()";v=URL.createObjectURL(new Blob(v.split(""),{type:"text/javascript"}));R._assistant.worker.has(p)||R._assistant.worker.create(p,v);R._assistant.worker.listener(p).then(function(u){0==u.data.error?l.putImageData(new ImageData(new Uint8ClampedArray(u.data.buffer),
k.width,k.height),0,0):console.error(Error(u.data.message));t.then(function(){return e.variable.image.layer.hide()});R._assistant.worker.close(p)})}null===(f=(g={blur:function(){var u,q;var w=null!==(u=Number(c.getAttribute("data-sigma")))&&void 0!==u?u:1;u=null!==(q=Number(c.getAttribute("data-radius")))&&void 0!==q?q:3;if(R._env.feature.worker){var y;if(R._assistant.canvasFilter.__gaussianMask[["".concat(u,",").concat(w)]])var r=R._assistant.canvasFilter.__gaussianMask[["".concat(u,",").concat(w)]];
else{q=0;r=[];for(y=-u;y<=u;y++){var J=R._assistant.formula.getDistribution(y,w,1);r.push(J);q+=J}for(y=0;y<r.length;y++)r[y]/=q;R._assistant.canvasFilter.__gaussianMask[["".concat(u,",").concat(w)]]=r}R._assistant.worker.get(p).postMessage({sigma:w,radius:u,type:h,gaussianMask:r,buffer:n.data.buffer,size:[k.width,k.height]},[n.data.buffer])}else n=R._assistant.canvasFilter.gaussianBlur(n,u,w),l.putImageData(n,0,0),t.then(function(){return e.variable.image.layer.hide()})},gray:function(){R._env.feature.worker?
R._assistant.worker.get(p).postMessage({type:h,buffer:n.data.buffer},[n.data.buffer]):(n=R._assistant.canvasFilter.grayscale(l.getImageData(0,0,k.width,k.height)),l.putImageData(n,0,0),t.then(function(){return e.variable.image.layer.hide()}))},mirror:function(){var u,q=null!==(u=Number(c.getAttribute("mirror-axis")))&&void 0!==u?u:0;R._env.feature.worker?R._assistant.worker.get(p).postMessage({axis:q,type:h,buffer:n.data.buffer,size:[k.width,k.height]},[n.data.buffer]):(n=R._assistant.canvasFilter.mirror(l.getImageData(0,
0,k.width,k.height),q),l.putImageData(n,0,0),t.then(function(){return e.variable.image.layer.hide()}))}})[h])||void 0===f?void 0:f.call(g)}}},{key:"revert",value:function(){var c=this.variable.nodes.container.querySelector(".modal-layer-image-canvas");var e=c.getContext("2d");this.variable.image.spin.scale=1;c.width=this.variable.image["default"].size[0];c.height=this.variable.image["default"].size[1];c.removeAttribute("style");e.putImageData(this.variable.image["default"].imageData,0,0);this.resize()}},
{key:"download",value:function(){var c,e=this.variable.nodes.container.querySelector(".modal-layer-image-canvas"),f=null!==(c=e.getAttribute("download-filename"))&&void 0!==c?c:this.option.layer.toolbar.config.download.name+Date.now();R._assistant.canvas.download(e,f,this.option.layer.toolbar.config.download.mime)}}]);return a}(R);R._achieve.set("image",Na);
var Oa=function(d){function a(){H(this,a);return b.apply(this,arguments)}F(a,d);var b=G(a);I(a,[{key:"initStruct",value:function(){D(E(a.prototype),"initStruct",this).call(this);this.variable.struct._backup.interaction.innerHTML.push(this.variable.struct._backup.interaction_button.cancel)}}]);return a}(La);R._achieve.set("prompt",Oa);
var Pa=function(d){function a(){H(this,a);return b.apply(this,arguments)}F(a,d);var b=G(a);I(a,[{key:"initStruct",value:function(){D(E(a.prototype),"initStruct",this).call(this);this.variable.struct._backup.interaction.innerHTML.push(this.variable.struct._backup.interaction_button.no)}}]);return a}(La);R._achieve.set("confirm",Pa);
var Ma=function(d){function a(){H(this,a);return b.apply(this,arguments)}F(a,d);var b=G(a);I(a,[{key:"initOption",value:function(c){D(E(a.prototype),"initOption",this).call(this,c);this.option.layer=R._assistant.object.merge(this.option.layer,R._option.loading);this.option.title=!1;this.option.drag.enable=!1;this.option.resize.enable=!1;this.option.progress.enable=!1}},{key:"compatibleOption",value:function(c){var e={center:"center",right:"flex-end",left:"flex-start"};D(E(a.prototype),"compatibleOption",
this).call(this,c);if(!R._assistant.object.isEmpty(c.layer.position)){Array.isArray(c.layer.position)||(c.layer.position=[c.layer.position,c.layer.position]);for(var f=0;2>f;f++)c.layer.position[f]=e[c.layer.position[f]]}}},{key:"checkOption",value:function(){D(E(a.prototype),"checkOption",this).call(this);if(!Array.isArray(this.option.layer.position)&&!["left","center","right"].includes(this.option.layer.position))throw Error("layer.position does not meet expectations");}},{key:"initStruct",value:function(){D(E(a.prototype),
"initStruct",this).call(this);var c=this.variable.struct._build.container;var e=this.variable.struct._backup.content=R._struct.content;var f=this.variable.struct._backup.content_loading=R._struct.content_loading;var g=this.variable.struct._backup.content_loading_icon=R._struct.content_loading_icon;window.isNaN(Number(this.option.layer.icon))?f.innerHTML[0]["class"]+=" "+this.option.layer.icon:f.innerHTML[0]=g[this.option.layer.icon];e.innerHTML.push(f);c.innerHTML.push(e)}},{key:"initNodeFinally",
value:function(){D(E(a.prototype),"initNodeFinally",this).call(this);var c=this.variable.nodes.container;var e=c.querySelector(".modal-layer-content");var f=e.querySelector(".modal-layer-loading-icon");var g=e.querySelector(".modal-layer-loading-box");c.style.cssText+="background: transparent; box-shadow: none;";e.style.cssText+="background: "+this.option.layer.background;g.style.cssText="justify-content: "+this.option.layer.position[0]+"; align-items: "+this.option.layer.position[1];f.style.cssText+=
"font-size: "+this.option.layer.size+"px; width: "+this.option.layer.area[0]+"px; height: "+this.option.layer.area[1]+"px; color: "+this.option.layer.color+"; animation-duration: "+this.option.layer.duration+"s;";R._assistant.object.isEmpty(this.option.layer.rate)||(f.style.animationTimingFunction=this.option.layer.rate)}}]);return a}(R);R._achieve.set("loading",Ma);
var Qa=function(d){function a(){H(this,a);return b.apply(this,arguments)}F(a,d);var b=G(a);I(a,[{key:"initOption",value:function(c){D(E(a.prototype),"initOption",this).call(this,c);this.option.title=!1;this.option.drag.enable=!1;this.option.drag.overflow=!1}},{key:"initStruct",value:function(){D(E(a.prototype),"initStruct",this).call(this);var c=this.variable.struct._build.container;var e=this.variable.struct._backup.content=R._struct.content;c.innerHTML.push(e);this.option.resize.enable&&(e=this.variable.struct._backup.resize_box=
R._struct.resize_box,c.innerHTML.push(e));this.option.progress.enable&&(e=this.variable.struct._backup.progress_bar=R._struct.progress_bar,c.innerHTML.push(e))}},{key:"initNode",value:function(){D(E(a.prototype),"initNode",this).call(this);var c=this.variable.nodes.container.querySelector(".modal-layer-content");if(this.option.content.value instanceof Object){var e=R._assistant.element.objectToNode(this.option.content.value);Object.keys(e).forEach(function(f){c.appendChild(e[f])})}else c.innerHTML=
this.option.content.value}}]);return a}(R);R._achieve.set("msg",Qa);R._achieve.set("message",Qa);window.Worker&&R._worker.set("canvasFilter",function(){this.onmessage=function(d){var a,b;d=null===(a=(b=d.data).type)||void 0===a?void 0:a.call(b,d.data);this.postMessage({error:0,buffer:d?d.buffer:void 0},[d.buffer])};this.C=function(){this.postMessage({error:1,message:"Failed to send message."})}});
var Ra=function(d){function a(){var c=0<arguments.length&&void 0!==arguments[0]?arguments[0]:R._enum.BROWSER_STORAGE.SESSIONSTORAGE;H(this,a);if(!window[c])throw Error("The current browser does not support ".concat(c," function"));var e=b.call(this);e._record=[];e._type=c;e._storage=window[c];return e}F(a,d);var b=G(a);I(a,[{key:"has",value:function(c){return null!==this._storage.getItem(c)?!0:!1}},{key:"get",value:function(c){var e;return null!==(e=this._storage.getItem(c))&&void 0!==e?e:!1}},{key:"set",
value:function(c){this._storage.setItem(c,1<arguments.length&&void 0!==arguments[1]?arguments[1]:"");this._record.push(c);return!0}},{key:"del",value:function(c){var e=this._record.indexOf(c);if(!(1<arguments.length&&void 0!==arguments[1]&&arguments[1])&&0>e)return!1;0<=e&&this._record.splice(e,1);this._storage.removeItem(c);return!0}},{key:"clear",value:function(){for(;0<this._record.length;)this._storage.removeItem(this._record.shift());return!0}}]);return a}(function(){function d(){H(this,d);N(this,
"_type",null);N(this,"_record",null);N(this,"_storage",null)}I(d,[{key:"has",value:function(){}},{key:"get",value:function(){}},{key:"set",value:function(){}},{key:"del",value:function(){}},{key:"clear",value:function(){}}]);return d}());Z&&(Object.defineProperty(Z._achieve,R._enum.BROWSER_STORAGE.LOCALSTORAGE,{value:Ra}),Object.defineProperty(Z._achieve,R._enum.BROWSER_STORAGE.SESSIONSTORAGE,{value:Ra}));}(window);
